{
    "version": "https://jsonfeed.org/version/1",
    "title": "逐梦 • All posts by \"证书\" tag",
    "description": "Welcome to my blog",
    "home_page_url": "https://0xdadream.github.io",
    "items": [
        {
            "id": "https://0xdadream.github.io/2025/05/25/zheng-shu-hou-zhui/",
            "url": "https://0xdadream.github.io/2025/05/25/zheng-shu-hou-zhui/",
            "title": "证书后缀",
            "date_published": "2025-05-25T04:25:00.000Z",
            "content_html": "<h1 id=\"证书后缀\"><a href=\"#证书后缀\" class=\"headerlink\" title=\"证书后缀\"></a>证书后缀</h1><p>我们来详细解释一下 <code>key</code> / <code>crt</code> / <code>pem</code> 之间的关系：</p>\n<hr>\n<h2 id=\"一、三种常见文件类型的说明\"><a href=\"#一、三种常见文件类型的说明\" class=\"headerlink\" title=\"一、三种常见文件类型的说明\"></a>一、三种常见文件类型的说明</h2><table>\n<thead>\n<tr>\n<th>文件名扩展名</th>\n<th>作用</th>\n<th>内容</th>\n<th>是否可以互相转换</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>.key</code></td>\n<td><strong>私钥文件</strong></td>\n<td>通常是 RSA 或 ECC 私钥（PEM 格式）</td>\n<td>✅</td>\n</tr>\n<tr>\n<td><code>.crt</code></td>\n<td><strong>证书文件</strong></td>\n<td>公钥证书，通常是 PEM 编码的 X.509</td>\n<td>✅</td>\n</tr>\n<tr>\n<td><code>.pem</code></td>\n<td><strong>通用容器格式</strong>（推荐）</td>\n<td>可以包含私钥、证书、CA链等内容</td>\n<td>✅</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"二、-pem-是通用格式（包括-key-和-crt）\"><a href=\"#二、-pem-是通用格式（包括-key-和-crt）\" class=\"headerlink\" title=\"二、.pem 是通用格式（包括 .key 和 .crt）\"></a>二、<code>.pem</code> 是通用格式（包括 <code>.key</code> 和 <code>.crt</code>）</h2><p><code>.pem</code>（Privacy-Enhanced Mail）是一种 <strong>Base64 编码的 ASCII 文本格式</strong>，广泛用于存储各种加密材料。</p>\n<p>它的内容可能是：</p>\n<ul>\n<li>只包含私钥（相当于 <code>.key</code>）</li>\n<li>只包含证书（相当于 <code>.crt</code>）</li>\n<li>包含完整的证书链（即 fullchain.pem）</li>\n</ul>\n<h3 id=\"示例：\"><a href=\"#示例：\" class=\"headerlink\" title=\"示例：\"></a>示例：</h3><h4 id=\"1-私钥-key-key-pem\"><a href=\"#1-私钥-key-key-pem\" class=\"headerlink\" title=\"1. 私钥 .key / key.pem\"></a>1. 私钥 <code>.key</code> / <code>key.pem</code></h4><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9<span class=\"token punctuation\">..</span>.\n-----END PRIVATE KEY-----<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"2-证书-crt-cert-pem\"><a href=\"#2-证书-crt-cert-pem\" class=\"headerlink\" title=\"2. 证书 .crt / cert.pem\"></a>2. 证书 <code>.crt</code> / <code>cert.pem</code></h4><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">-----BEGIN CERTIFICATE-----\nMIIDdTCCAl2gAwIBAgIJ<span class=\"token punctuation\">..</span>.\n-----END CERTIFICATE-----<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3-完整链-fullchain-pem\"><a href=\"#3-完整链-fullchain-pem\" class=\"headerlink\" title=\"3. 完整链 .fullchain.pem\"></a>3. 完整链 <code>.fullchain.pem</code></h4><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">-----BEGIN CERTIFICATE-----   <span class=\"token comment\"># leaf cert</span>\n<span class=\"token punctuation\">..</span>.\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----   <span class=\"token comment\"># intermediate cert</span>\n<span class=\"token punctuation\">..</span>.\n-----END CERTIFICATE-----<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<hr>\n<h2 id=\"三、Nginx-Apache-Java-各如何使用\"><a href=\"#三、Nginx-Apache-Java-各如何使用\" class=\"headerlink\" title=\"三、Nginx / Apache / Java 各如何使用\"></a>三、Nginx / Apache / Java 各如何使用</h2><table>\n<thead>\n<tr>\n<th>应用</th>\n<th>需要什么文件</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>Nginx</strong></td>\n<td><code>ssl_certificate</code> 用 <code>.crt</code> 或 <code>.pem</code>   <code>ssl_certificate_key</code> 用 <code>.key</code> 或 <code>.key.pem</code></td>\n</tr>\n<tr>\n<td><strong>Apache</strong></td>\n<td>类似，支持 <code>.pem</code> 更推荐</td>\n</tr>\n<tr>\n<td><strong>Java keystore</strong></td>\n<td>需要转换成 <code>.p12</code> 或 <code>.jks</code></td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"四、转换方法\"><a href=\"#四、转换方法\" class=\"headerlink\" title=\"四、转换方法\"></a>四、转换方法</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 分离 fullchain.pem 为单独证书和中间证书</span>\nopenssl x509 <span class=\"token parameter variable\">-in</span> fullchain.pem <span class=\"token parameter variable\">-out</span> cert.crt\n\n<span class=\"token comment\"># 转换 PEM -&gt; PFX（含私钥）</span>\nopenssl pkcs12 <span class=\"token parameter variable\">-export</span> <span class=\"token parameter variable\">-out</span> cert.pfx <span class=\"token parameter variable\">-inkey</span> key.pem <span class=\"token parameter variable\">-in</span> fullchain.pem<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<hr>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><ul>\n<li><code>.pem</code> 是一种格式，而 <code>.key</code> / <code>.crt</code> 是常见用途的命名方式。</li>\n<li><code>fullchain.pem</code> 包含了完整的证书链。</li>\n<li>所有这些文件 <strong>实际内容可能都是 PEM 格式</strong>，只是用途不同。</li>\n<li>使用时只要指定路径正确、软件支持即可，无论扩展名叫啥。</li>\n</ul>\n",
            "tags": [
                "证书"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2025/05/15/shen-qing-mian-fei-zheng-shu/",
            "url": "https://0xdadream.github.io/2025/05/15/shen-qing-mian-fei-zheng-shu/",
            "title": "申请免费证书",
            "date_published": "2025-05-15T14:25:00.000Z",
            "content_html": "<h1 id=\"申请免费证书\"><a href=\"#申请免费证书\" class=\"headerlink\" title=\"申请免费证书\"></a>申请免费证书</h1><p>【增强版 Bash 脚本】：交互选择使用 Cloudflare DNS 或 HTTP 验证，支持三大 CA</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"====== Acme.sh 证书申请一键脚本 ======\"</span>\n\n<span class=\"token comment\"># ===== 输入基本信息 =====</span>\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"请输入你的主域名（如 example.com）: \"</span> DOMAIN\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"是否使用泛域名（*.<span class=\"token variable\">${DOMAIN}</span>)? [y/N]: \"</span> WILDCARD\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"请输入你的邮箱地址（如 me@example.com）: \"</span> EMAIL\n\n<span class=\"token comment\"># ===== 选择 CA 机构 =====</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>请选择你要使用的证书颁发机构（CA）:\"</span>\n<span class=\"token keyword\">select</span> <span class=\"token for-or-select variable\">CA_PROVIDER</span> <span class=\"token keyword\">in</span> <span class=\"token string\">\"Let's Encrypt\"</span> <span class=\"token string\">\"ZeroSSL\"</span> <span class=\"token string\">\"Buypass\"</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">case</span> <span class=\"token environment constant\">$REPLY</span> <span class=\"token keyword\">in</span>\n    <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">CA_SERVER</span><span class=\"token operator\">=</span><span class=\"token string\">\"letsencrypt\"</span><span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">break</span> <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">CA_SERVER</span><span class=\"token operator\">=</span><span class=\"token string\">\"zerossl\"</span><span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">break</span> <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">CA_SERVER</span><span class=\"token operator\">=</span><span class=\"token string\">\"buypass\"</span><span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">break</span> <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    *<span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"请输入 1-3 的数字\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">esac</span>\n<span class=\"token keyword\">done</span>\n\n<span class=\"token comment\"># ===== 选择验证方式 =====</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>请选择验证方式:\"</span>\n<span class=\"token keyword\">select</span> <span class=\"token for-or-select variable\">VERIFY_METHOD</span> <span class=\"token keyword\">in</span> <span class=\"token string\">\"Cloudflare DNS 验证（推荐用于泛域名）\"</span> <span class=\"token string\">\"Standalone HTTP 验证（监听80端口）\"</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">case</span> <span class=\"token environment constant\">$REPLY</span> <span class=\"token keyword\">in</span>\n    <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">VERIFY_METHOD</span><span class=\"token operator\">=</span><span class=\"token string\">\"dns_cf\"</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">DNS_MODE</span><span class=\"token operator\">=</span>true<span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">break</span> <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">VERIFY_METHOD</span><span class=\"token operator\">=</span><span class=\"token string\">\"standalone\"</span><span class=\"token punctuation\">;</span> <span class=\"token assign-left variable\">DNS_MODE</span><span class=\"token operator\">=</span>false<span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">break</span> <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n    *<span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"请输入 1 或 2\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">esac</span>\n<span class=\"token keyword\">done</span>\n\n<span class=\"token comment\"># ===== 安装 acme.sh =====</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token operator\">!</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"<span class=\"token environment constant\">$HOME</span>/.acme.sh\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"[+] 安装 acme.sh ...\"</span>\n  <span class=\"token function\">curl</span> https://get.acme.sh <span class=\"token operator\">|</span> <span class=\"token function\">sh</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token builtin class-name\">source</span> <span class=\"token string\">\"<span class=\"token environment constant\">$HOME</span>/.acme.sh/acme.sh.env\"</span>\n\n<span class=\"token comment\"># ===== 注册账户 =====</span>\nacme.sh --set-default-ca <span class=\"token parameter variable\">--server</span> <span class=\"token variable\">$CA_SERVER</span>\nacme.sh --register-account <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"<span class=\"token variable\">$EMAIL</span>\"</span>\n\n<span class=\"token comment\"># ===== 处理域名格式 =====</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$WILDCARD</span>\"</span> <span class=\"token operator\">=~</span> ^<span class=\"token punctuation\">[</span>Yy<span class=\"token punctuation\">]</span>$ <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token assign-left variable\">CERT_DOMAIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"*.<span class=\"token variable\">$DOMAIN</span>\"</span>\n<span class=\"token keyword\">else</span>\n  <span class=\"token assign-left variable\">CERT_DOMAIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$DOMAIN</span>\"</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># ===== 如果使用 Cloudflare，输入 Token =====</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$DNS_MODE</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"请输入你的 Cloudflare API Token: \"</span> CF_API_TOKEN\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token parameter variable\">-z</span> <span class=\"token string\">\"<span class=\"token variable\">$CF_API_TOKEN</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"[✗] Token 不能为空！\"</span>\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n  <span class=\"token keyword\">fi</span>\n  <span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CF_Token</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$CF_API_TOKEN</span>\"</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># ===== 执行证书申请 =====</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"[+] 开始申请证书: <span class=\"token variable\">$CERT_DOMAIN</span>\"</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$DNS_MODE</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  acme.sh <span class=\"token parameter variable\">--issue</span> <span class=\"token parameter variable\">--dns</span> <span class=\"token string\">\"<span class=\"token variable\">$VERIFY_METHOD</span>\"</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"<span class=\"token variable\">$CERT_DOMAIN</span>\"</span> <span class=\"token parameter variable\">--force</span>\n<span class=\"token keyword\">else</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"[!] 请确保 80 端口未被占用（如 nginx），或已临时关闭\"</span>\n  <span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"确认后按回车继续...\"</span>\n  acme.sh <span class=\"token parameter variable\">--issue</span> <span class=\"token parameter variable\">--standalone</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"<span class=\"token variable\">$CERT_DOMAIN</span>\"</span> <span class=\"token parameter variable\">--force</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># ===== 安装证书到系统路径 =====</span>\n<span class=\"token assign-left variable\">REAL_DOMAIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">${DOMAIN<span class=\"token operator\">#</span>*.}</span>\"</span>  <span class=\"token comment\"># 去掉 *.</span>\n<span class=\"token assign-left variable\">CERT_DIR</span><span class=\"token operator\">=</span><span class=\"token string\">\"/etc/ssl/<span class=\"token variable\">$REAL_DOMAIN</span>\"</span>\n<span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"<span class=\"token variable\">$CERT_DIR</span>\"</span>\n\nacme.sh --install-cert <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"<span class=\"token variable\">$CERT_DOMAIN</span>\"</span> <span class=\"token punctuation\">\\</span>\n  --key-file       <span class=\"token string\">\"<span class=\"token variable\">$CERT_DIR</span>/key.pem\"</span> <span class=\"token punctuation\">\\</span>\n  --fullchain-file <span class=\"token string\">\"<span class=\"token variable\">$CERT_DIR</span>/fullchain.pem\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--reloadcmd</span> <span class=\"token string\">\"echo '[✓] 可配置 nginx reload 命令'\"</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token parameter variable\">--force</span>\n\n<span class=\"token comment\"># ===== 自动更新启用 =====</span>\nacme.sh <span class=\"token parameter variable\">--upgrade</span> --auto-upgrade\n\n<span class=\"token comment\"># ===== 成功信息 =====</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>[✓] 证书申请成功！\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"私钥路径:      <span class=\"token variable\">$CERT_DIR</span>/key.pem\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"完整证书路径:  <span class=\"token variable\">$CERT_DIR</span>/fullchain.pem\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"自动续期:      已启用（每天检测）\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>保存为xxx.sh，执行</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> +x acme_cert_auto.sh\n<span class=\"token function\">sudo</span> ./acme_cert_auto.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n",
            "tags": [
                "证书"
            ]
        }
    ]
}