{
    "version": "https://jsonfeed.org/version/1",
    "title": "逐梦 • All posts by \"server\" category",
    "description": "Welcome to my blog",
    "home_page_url": "https://0xdadream.github.io",
    "items": [
        {
            "id": "https://0xdadream.github.io/2021/08/12/jiang-hexo-bu-shu-dao-fu-wu-qi/",
            "url": "https://0xdadream.github.io/2021/08/12/jiang-hexo-bu-shu-dao-fu-wu-qi/",
            "title": "将hexo部署到服务器",
            "date_published": "2021-08-12T12:11:00.000Z",
            "content_html": "<h1 id=\"将hexo部署到服务器\"><a href=\"#将hexo部署到服务器\" class=\"headerlink\" title=\"将hexo部署到服务器\"></a>将hexo部署到服务器</h1><p>我以前是部署在github上的，本机的部署都是完成了的，本机部署请看其他教程</p>\n<h2 id=\"安装git\"><a href=\"#安装git\" class=\"headerlink\" title=\"安装git\"></a>安装git</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> <span class=\"token function\">git</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"创建git用户\"><a href=\"#创建git用户\" class=\"headerlink\" title=\"创建git用户\"></a>创建git用户</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">adduser <span class=\"token function\">git</span> <span class=\"token comment\">#/home 目录下生成一个git目录</span>\n<span class=\"token function\">passwd</span> <span class=\"token function\">git</span> <span class=\"token comment\">#设置密码</span>\n<span class=\"token function\">chmod</span> a+w /etc/sudoers\n<span class=\"token function\">vim</span> /etc/sudoers <span class=\"token comment\">#添加git ALL=(ALL) ALL</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"配置SSH密钥\"><a href=\"#配置SSH密钥\" class=\"headerlink\" title=\"配置SSH密钥\"></a>配置SSH密钥</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> ~/.ssh/authorized_keys\n<span class=\"token comment\">#在物理机中复制C:\\Users\\youruser\\.ssh\\id_rsa.pub中的公钥到上面的文件中</span>\n保存退出<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"创建仓库\"><a href=\"#创建仓库\" class=\"headerlink\" title=\"创建仓库\"></a>创建仓库</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">su</span> <span class=\"token function\">git</span>\n<span class=\"token builtin class-name\">cd</span> /home/git\n<span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> projects/hexo <span class=\"token comment\"># 建立项目目录</span>\n<span class=\"token function\">mkdir</span> repos <span class=\"token comment\">#创建仓库目录</span>\n<span class=\"token builtin class-name\">cd</span> repos\n<span class=\"token function\">git</span> init <span class=\"token parameter variable\">--bare</span> hexo.git <span class=\"token comment\">#创建仓库</span>\n<span class=\"token function\">chown</span> <span class=\"token parameter variable\">-R</span> git:git /home/git/repos/hexo.git <span class=\"token comment\"># 给git用户添加权限</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"创建一个钩子\"><a href=\"#创建一个钩子\" class=\"headerlink\" title=\"创建一个钩子\"></a>创建一个钩子</h2><p>接上面继续操作</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> hexo.git/hooks\n<span class=\"token function\">vim</span> post-receive <span class=\"token comment\"># 创建一个钩子</span>\n<span class=\"token comment\">#添加如下文件</span>\n<span class=\"token comment\">#!/bin/sh</span>\n<span class=\"token function\">git</span> --work-tree<span class=\"token operator\">=</span>/var/www/blog --git-dir<span class=\"token operator\">=</span>/home/git/repos/hexo.git checkout <span class=\"token parameter variable\">-f</span>\n<span class=\"token function\">chmod</span> +x post-receive <span class=\"token comment\"># 添加可执行权限</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"本地建立SSH信任关系\"><a href=\"#本地建立SSH信任关系\" class=\"headerlink\" title=\"本地建立SSH信任关系\"></a>本地建立SSH信任关系</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">ssh-copy-id <span class=\"token parameter variable\">-i</span> ~/.ssh/id_rsa.pub git@server_ip <span class=\"token comment\"># 建立信任关系</span>\n<span class=\"token function\">ssh</span> git@server_ip <span class=\"token comment\"># 试一下能不能登录</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"更改git用户默认的shell\"><a href=\"#更改git用户默认的shell\" class=\"headerlink\" title=\"更改git用户默认的shell\"></a>更改git用户默认的shell</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> /etc/shells <span class=\"token comment\"># 查看 git-shell 是否在登录方式里面</span>\n<span class=\"token function\">which</span> git-shell <span class=\"token comment\"># 找到git-shell的路径，记下来</span>\n<span class=\"token function\">vim</span> /etc/shells\n然后把刚才记下来的路径添加进去\n\n<span class=\"token function\">vim</span> /etc/passwd\n<span class=\"token comment\">#把git:x:1000:1000::/home/git:/bin/bash修改为git:x:1000:1000:,,,:/home/git:/usr/bin/git-shell</span>\n<span class=\"token comment\">#没有就算了</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"BUG\"><a href=\"#BUG\" class=\"headerlink\" title=\"BUG\"></a>BUG</h2><p>报错<code>remote: fatal: cannot create directory at '2019': Permission denied</code></p>\n<p>部署目录没有写的权限，改法</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> go+w /home/git/projects/hexo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n",
            "tags": [
                "tip",
                "server"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/08/11/apache-bu-shu-ssl/",
            "url": "https://0xdadream.github.io/2021/08/11/apache-bu-shu-ssl/",
            "title": "apache部署ssl",
            "date_published": "2021-08-10T20:11:00.000Z",
            "content_html": "<h1 id=\"apache部署ssl\"><a href=\"#apache部署ssl\" class=\"headerlink\" title=\"apache部署ssl\"></a>apache部署ssl</h1><h2 id=\"开启mod-ssl模块\"><a href=\"#开启mod-ssl模块\" class=\"headerlink\" title=\"开启mod_ssl模块\"></a>开启mod_ssl模块</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">LoadModule socache_shmcb_module modules/mod_socache_shmcb.so\nLoadModule ssl_module modules/mod_ssl.so<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"加载配置文件\"><a href=\"#加载配置文件\" class=\"headerlink\" title=\"加载配置文件\"></a>加载配置文件</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">includeOptionalconf.d/*.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"保存证书\"><a href=\"#保存证书\" class=\"headerlink\" title=\"保存证书\"></a>保存证书</h2><p>在apache安装目录中新建cert目录，将证书解压至此</p>\n<h2 id=\"修改ssl-conf配置文件\"><a href=\"#修改ssl-conf配置文件\" class=\"headerlink\" title=\"修改ssl.conf配置文件\"></a>修改ssl.conf配置文件</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>VirtualHost *:44<span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&gt;</span>     \n    ServerName   <span class=\"token comment\">#修改为申请证书时绑定的域名www.YourDomainName1.com。                    </span>\n    DocumentRoot  /data/www/hbappserver/public          \n    SSLEngine on   \n    SSLProtocol all <span class=\"token parameter variable\">-SSLv2</span> <span class=\"token parameter variable\">-SSLv3</span> <span class=\"token comment\"># 添加SSL协议支持协议，去掉不安全的协议。</span>\n    SSLCipherSuite HIGH:<span class=\"token operator\">!</span>RC4:<span class=\"token operator\">!</span>MD5:<span class=\"token operator\">!</span>aNULL:<span class=\"token operator\">!</span>eNULL:<span class=\"token operator\">!</span>NULL:<span class=\"token operator\">!</span>DH:<span class=\"token operator\">!</span>EDH:<span class=\"token operator\">!</span>EXP:+MEDIUM   <span class=\"token comment\"># 修改加密套件。</span>\n    SSLHonorCipherOrder on\n    SSLCertificateFile cert/domain name1_public.crt   <span class=\"token comment\"># 将domain name1_public.crt替换成您证书文件名。</span>\n    SSLCertificateKeyFile cert/domain name1.key   <span class=\"token comment\"># 将domain name1.key替换成您证书的密钥文件名。</span>\n    SSLCertificateChainFile cert/domain name1_chain.crt  <span class=\"token comment\"># 将domain name1_chain.crt替换成您证书的密钥文件名；证书链开头如果有#字符，请删除。</span>\n<span class=\"token operator\">&lt;</span>/VirtualHost<span class=\"token operator\">&gt;</span>\n\n<span class=\"token comment\">#如果证书包含多个域名，复制以上参数，并将ServerName替换成第二个域名。 </span>\n<span class=\"token operator\">&lt;</span>VirtualHost *:44<span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>&gt;</span>     \n    ServerName   <span class=\"token comment\">#修改为申请证书时绑定的第二个域名www.YourDomainName2.com。                    </span>\n    DocumentRoot  /data/www/hbappserver/public          \n    SSLEngine on   \n    SSLProtocol all <span class=\"token parameter variable\">-SSLv2</span> <span class=\"token parameter variable\">-SSLv3</span> <span class=\"token comment\"># 添加SSL协议支持协议，去掉不安全的协议。</span>\n    SSLCipherSuite HIGH:<span class=\"token operator\">!</span>RC4:<span class=\"token operator\">!</span>MD5:<span class=\"token operator\">!</span>aNULL:<span class=\"token operator\">!</span>eNULL:<span class=\"token operator\">!</span>NULL:<span class=\"token operator\">!</span>DH:<span class=\"token operator\">!</span>EDH:<span class=\"token operator\">!</span>EXP:+MEDIUM   <span class=\"token comment\"># 修改加密套件。</span>\n    SSLHonorCipherOrder on\n    SSLCertificateFile cert/domain name2_public.crt   <span class=\"token comment\"># 将domain name2替换成您申请证书时的第二个域名。</span>\n    SSLCertificateKeyFile cert/domain name2.key   <span class=\"token comment\"># 将domain name2替换成您申请证书时的第二个域名。</span>\n    SSLCertificateChainFile cert/domain name2_chain.crt  <span class=\"token comment\"># 将domain name2替换成您申请证书时的第二个域名；证书链开头如果有#字符，请删除。</span>\n<span class=\"token operator\">&lt;</span>/VirtualHost<span class=\"token operator\">&gt;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"重启生效\"><a href=\"#重启生效\" class=\"headerlink\" title=\"重启生效\"></a>重启生效</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">service</span> httpd restart<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"HTTP请求自动跳转HTTPS\"><a href=\"#HTTP请求自动跳转HTTPS\" class=\"headerlink\" title=\"HTTP请求自动跳转HTTPS\"></a>HTTP请求自动跳转HTTPS</h2><p>httpd.conf文件中的<code>&lt;VirtualHost *:80&gt; &lt;/VirtualHost&gt;</code>中间，添加以下重定向代码。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">RewriteEngine on\nRewriteCond %<span class=\"token punctuation\">{</span>SERVER_PORT<span class=\"token punctuation\">}</span> <span class=\"token operator\">!</span>^443$\nRewriteRule ^<span class=\"token punctuation\">(</span>.*<span class=\"token punctuation\">)</span>$ https://%<span class=\"token punctuation\">{</span>SERVER_NAME<span class=\"token punctuation\">}</span><span class=\"token variable\">$1</span> <span class=\"token punctuation\">[</span>L,R<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n",
            "tags": [
                "tip",
                "server"
            ]
        },
        {
            "id": "https://0xdadream.github.io/2021/08/11/apache-an-zhuang/",
            "url": "https://0xdadream.github.io/2021/08/11/apache-an-zhuang/",
            "title": "Apache安装",
            "date_published": "2021-08-10T18:11:00.000Z",
            "content_html": "<h1 id=\"Apache安装\"><a href=\"#Apache安装\" class=\"headerlink\" title=\"Apache安装\"></a>Apache安装</h1><p>首先安装apr，apr-util，apr-iconv，prce，这几个依赖包能提高生产力</p>\n<h2 id=\"apr\"><a href=\"#apr\" class=\"headerlink\" title=\"apr\"></a>apr</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://downloads.apache.org//apr/apr-1.7.0.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> apr-1.7.0.tar.gz\n<span class=\"token builtin class-name\">cd</span> apr-1.7.0\n./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/usr/local/apr\n<span class=\"token function\">make</span> \n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"apr-util\"><a href=\"#apr-util\" class=\"headerlink\" title=\"apr-util\"></a>apr-util</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://downloads.apache.org/apr/apr-util-1.6.1.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> apr-util-1.6.1.tar.gz\n<span class=\"token builtin class-name\">cd</span> apr-util-1.6.1\n./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/usr/local/apr-util --with-apr<span class=\"token operator\">=</span>/usr/local/apr\n<span class=\"token function\">make</span> \n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"apr-iconv\"><a href=\"#apr-iconv\" class=\"headerlink\" title=\"apr-iconv\"></a>apr-iconv</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://downloads.apache.org/apr/apr-iconv-1.2.2.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> apr-iconv-1.2.2.tar.gz\n<span class=\"token builtin class-name\">cd</span> apr-iconv-1.2.2\n./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/usr/local/apr-iconv --with-apr<span class=\"token operator\">=</span>/usr/local/apr\n<span class=\"token function\">make</span> \n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"prce\"><a href=\"#prce\" class=\"headerlink\" title=\"prce\"></a>prce</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://sourceforge.net/projects/pcre/files/pcre/8.44/pcre-8.44.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> pcre-8.44.tar.gz\n<span class=\"token builtin class-name\">cd</span> pcre-8.44\n./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/usr/local/pcre\n<span class=\"token function\">make</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a>apache</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://apache.mirror.digitalpacific.com.au//httpd/httpd-2.4.48.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> httpd-2.4.48.tar.gz\n<span class=\"token builtin class-name\">cd</span> httpd-2.4.48\n./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/usr/local/httpd --with-apr<span class=\"token operator\">=</span>/usr/local/apr/apr --with-apr-util<span class=\"token operator\">=</span>/usr/local/apr/util --with-pcre<span class=\"token operator\">=</span>/usr/local/pcre\n<span class=\"token function\">make</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n",
            "tags": [
                "tip",
                "server"
            ]
        }
    ]
}