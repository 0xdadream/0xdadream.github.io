<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Sing-box 搭建您的专属科学上网节点实用指南, 逐梦">
    <meta name="description" content="Sing-box 搭建您的专属科学上网节点实用指南">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Sing-box 搭建您的专属科学上网节点实用指南 | 逐梦</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    
    <style>
        body{
            background-image: url(/medias/banner/5.jpg);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="逐梦" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">逐梦</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">逐梦</div>
        <div class="logo-desc">
            
            Welcome to my blog
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/0xdadream/0xdadream.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/0xdadream/0xdadream.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/1.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Sing-box 搭建您的专属科学上网节点实用指南</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E6%95%99%E7%A8%8B/">
                                <span class="chip bg-color">教程</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%BD%91%E7%BB%9C/" class="post-category">
                                网络
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2025-05-31
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2025-06-01
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    15.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    56 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Sing-box-搭建您的专属“科学上网”节点实用指南"><a href="#Sing-box-搭建您的专属“科学上网”节点实用指南" class="headerlink" title="Sing-box 搭建您的专属“科学上网”节点实用指南"></a>Sing-box 搭建您的专属“科学上网”节点实用指南</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="Sing-box-简介：强大的通用代理平台"><a href="#Sing-box-简介：强大的通用代理平台" class="headerlink" title="Sing-box 简介：强大的通用代理平台"></a>Sing-box 简介：强大的通用代理平台</h3><p>Sing-box 是一款新兴且功能强大的通用代理平台，被广泛认为是 V2Ray 和 Xray 等成熟工具的有力替代品 。它凭借其卓越的性能、轻量化的设计、对多种代理协议的广泛支持、高度模块化的架构以及积极的社区开发，迅速获得了用户的青睐 。Sing-box 基于 Go 语言开发，并以开源形式发布，这不仅保证了其透明度和安全性，也促进了社区的共同发展和完善 。</p>
<h3 id="本教程目标"><a href="#本教程目标" class="headerlink" title="本教程目标"></a>本教程目标</h3><p>本教程旨在提供一个从零开始的详尽指南，帮助具备一定技术背景的用户在自己的服务器上成功安装和配置 sing-box，并部署多种当前流行且高效的代理协议。通过本教程，用户将能够：</p>
<ul>
<li>选择合适的服务器并完成 sing-box 的安装。</li>
<li>理解 sing-box 的核心概念和配置文件结构。</li>
<li>配置服务器防火墙，确保代理服务的正常运行。</li>
<li>详细配置 VLESS (配合 Reality)、Trojan (配合 TLS)、Shadowsocks (2022新加密)、Hysteria2 和 TUIC 等主流代理协议。</li>
<li>了解客户端的基本配置方法和主流客户端软件。</li>
<li>初步接触如使用 CDN 隐藏服务器 IP、配置基本路由和故障转移等高级技巧。</li>
</ul>
<p>尽管本教程力求详尽，但 sing-box 的功能远不止于此。鼓励用户在掌握基础后，进一步查阅其官方文档 ，探索更多高级定制功能，以满足个性化需求。</p>
<h2 id="第一章：理解与安装-Sing-box"><a href="#第一章：理解与安装-Sing-box" class="headerlink" title="第一章：理解与安装 Sing-box"></a>第一章：理解与安装 Sing-box</h2><h3 id="1-1-Sing-box-核心概念：构建代理节点的基石"><a href="#1-1-Sing-box-核心概念：构建代理节点的基石" class="headerlink" title="1.1. Sing-box 核心概念：构建代理节点的基石"></a>1.1. Sing-box 核心概念：构建代理节点的基石</h3><p>理解 sing-box 的核心组件及其交互方式，是成功配置和高效使用该平台的基础。其模块化设计允许用户灵活组合不同的功能模块，以适应多样化的网络环境和需求。</p>
<ul>
<li><p><strong>入站连接 (Inbounds):</strong> 入站连接负责处理从客户端设备（例如您的电脑或手机）传入 sing-box 服务器的连接请求。Sing-box 支持多种入站协议类型，常见的包括 Shadowsocks、Trojan、VLESS、VMess、Hysteria2、TUIC、Naive、ShadowTLS，以及用于创建虚拟网卡的 Tun 和用于透明代理的 Redirect 等 。用户可以根据客户端的支持情况和安全需求选择合适的入站协议。</p>
</li>
<li><p><strong>出站连接 (Outbounds):</strong> 出站连接定义了 sing-box 服务器如何处理经过其的数据流，即如何将数据转发到目标互联网地址或其他代理服务器。常见的出站类型有 Direct（直接连接）、Block（阻止连接）、Shadowsocks、Trojan、VLESS、WireGuard、Hysteria2、TUIC，以及专门用于 DNS 查询的 DNS、用于节点选择的 Selector 和用于故障转移的 URLTest 等 。这种设计使得 sing-box 不仅能作为代理服务器，还能作为客户端连接其他代理，或实现复杂的代理链。</p>
</li>
<li><p><strong>路由 (Route):</strong> 路由模块是 sing-box 实现精细化流量控制的核心。用户可以通过定义一系列路由规则，根据流量的目标地址（如 GeoIP 数据库判断的地理位置、Geosite 预设的网站域名集合）、域名、协议类型等多种条件，将特定的流量导向不同的出站连接 。例如，可以配置国内网站直连，国外网站通过代理访问，从而优化访问速度和资源利用。</p>
</li>
<li><p><strong>DNS 配置:</strong> DNS（域名系统）在网络通信中扮演着将域名转换为 IP 地址的关键角色。Sing-box 内建了强大的 DNS 处理能力，允许用户配置自定义 DNS 服务器、设定 DNS 路由规则，并支持如 FakeIP（虚拟 IP）等高级功能，以防止 DNS 泄露，确保域名解析的准确性和安全性 。</p>
</li>
<li><p><strong>配置文件 (<code>config.json</code>):</strong> Sing-box 的所有配置均通过一个 JSON 格式的文件进行管理，通常命名为 <code>config.json</code> 。该文件包含了日志、DNS、入站、出站、路由等所有模块的配置信息。其顶层结构通常如下所示：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"log"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"dns"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
  <span class="token property">"route"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"experimental"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>熟悉 JSON 语法并理解各配置项的含义对于手动配置 sing-box至关重要。</p>
</li>
</ul>
<p>sing-box 的架构设计体现了高度的模块化，官方文档 在其配置结构中明确区分了入站、出站和路由等组件。这种设计带来了显著的灵活性，例如支持同时作为客户端和服务器运行 ，以及实现多协议负载均衡 。这意味着用户可以根据具体需求自由组合这些模块，构建从简单的个人代理到复杂的多跳转发网关等各种应用场景，这相较于一些功能固化的工具是一个显著的优势。</p>
<h3 id="1-2-选择您的服务器-VPS-：地理位置与操作系统考量"><a href="#1-2-选择您的服务器-VPS-：地理位置与操作系统考量" class="headerlink" title="1.2. 选择您的服务器 (VPS)：地理位置与操作系统考量"></a>1.2. 选择您的服务器 (VPS)：地理位置与操作系统考量</h3><p>选择一台合适的虚拟专用服务器（VPS）是搭建稳定高效代理服务的前提。以下是一些关键考量因素：</p>
<ul>
<li><strong>地理位置:</strong> 服务器的地理位置直接影响到您的访问速度和能否顺畅访问特定区域的内容。应选择距离用户较近且能提供良好国际网络连接的地区。</li>
<li><strong>服务商信誉:</strong> 选择知名且信誉良好的 VPS 服务商，以确保服务的稳定性、可靠的技术支持和合理的资源分配。</li>
<li><strong>资源需求:</strong> 根据预期的负载情况，选择合适的 CPU、内存（RAM）和带宽。对于个人使用，通常入门级配置即可满足需求，但如果用户较多或流量较大，则需相应提高配置。</li>
<li><strong>操作系统:</strong> 强烈推荐选用 Linux 发行版，特别是 <strong>Ubuntu 或 Debian</strong>。这两个发行版拥有庞大的用户社区、丰富的文档资源，并且 sing-box 官方提供了便捷的安装脚本和软件包支持 。</li>
</ul>
<p>绝大多数关于 sing-box 及类似代理工具的安装指南和社区讨论都集中在 Linux 平台 。这并非偶然，Linux 服务器以其经济高效、命令行环境的强大管理能力以及 <code>systemd</code> 等标准化服务管理工具 1成为自建代理服务的首选。Sing-box 本身也对 Linux 提供了深度支持，包括一些依赖特定操作系统内核的功能（如 TUN 模式） 。因此，对于追求稳定、文档完善且易于维护的服务器端部署而言，选择 Ubuntu 或 Debian Linux 将是最直接且高效的路径。</p>
<h3 id="1-3-在您的服务器上安装-Sing-box-以-Ubuntu-Debian-为例"><a href="#1-3-在您的服务器上安装-Sing-box-以-Ubuntu-Debian-为例" class="headerlink" title="1.3. 在您的服务器上安装 Sing-box (以 Ubuntu/Debian 为例)"></a>1.3. 在您的服务器上安装 Sing-box (以 Ubuntu/Debian 为例)</h3><p>Sing-box 提供了多种安装方式，对于 Ubuntu/Debian 系统，推荐使用官方提供的安装脚本，操作简便快捷。</p>
<ul>
<li><p>使用官方通用安装脚本:</p>
<p>通过以下命令下载并执行安装脚本，该脚本会自动检测系统并安装最新稳定版的 sing-box：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">curl -fsSL https://sing-box.app/install.sh | sudo bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果偏好专门为 Debian/Ubuntu 优化的脚本，可以使用：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">curl -fsSL https://sing-box.app/deb-install.sh | sudo bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>安装特定版本或 Beta 测试版:</p>
<p>如果需要安装 Beta 版本以体验最新功能，或指定安装某一特定版本，可以在执行脚本时附加参数：</p>
<ul>
<li><p>安装最新 Beta 版：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">curl -fsSL https://sing-box.app/install.sh | sudo bash -s -- --beta<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>安装特定版本 (例如 1.8.0)：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">curl -fsSL https://sing-box.app/install.sh | sudo bash -s -- --version 1.8.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
</li>
<li><p>通过 APT 软件源安装 (适用于 Debian/Ubuntu):</p>
<p>对于希望通过系统包管理器管理 sing-box 的用户，可以添加 SagerNet 的官方 APT 软件源：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo mkdir -p /etc/apt/keyrings &amp;&amp; \
sudo curl -fsSL https://sing-box.app/gpg.key -o /etc/apt/keyrings/sagernet.asc &amp;&amp; \
sudo chmod a+r /etc/apt/keyrings/sagernet.asc &amp;&amp; \
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/sagernet.asc] https://deb.sagernet.org/ * *" | \
sudo tee /etc/apt/sources.list.d/sagernet.list &gt; /dev/null &amp;&amp; \
sudo apt-get update &amp;&amp; \
sudo apt-get install sing-box<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这种方式便于后续的更新和维护。</p>
</li>
<li><p>其他操作系统安装简介:</p>
<p>尽管本教程主要关注 Linux 服务器，但 sing-box 的命令行版本也支持其他操作系统。例如，macOS 用户可以通过 Homebrew (brew install sing-box) 安装，Windows 用户可以使用 Scoop (scoop install sing-box) 或 Chocolatey (choco install sing-box) 进行安装 。这些主要适用于在本地计算机上使用 sing-box 命令行客户端的场景。</p>
</li>
</ul>
<h3 id="1-4-Sing-box-核心命令行工具-CLI"><a href="#1-4-Sing-box-核心命令行工具-CLI" class="headerlink" title="1.4. Sing-box 核心命令行工具 (CLI)"></a>1.4. Sing-box 核心命令行工具 (CLI)</h3><p>掌握 sing-box 的命令行工具对于服务器管理、配置调试和自动化操作至关重要。以下是一些最常用的命令：</p>
<ul>
<li><code>sing-box version</code>: 显示已安装的 sing-box 版本信息，包括构建标签 (build tags) 。构建标签指明了编译时包含了哪些特性，例如 <code>with_reality_server</code> 表示支持 Reality 协议，<code>with_quic</code> 表示支持 QUIC 协议。</li>
<li><code>sing-box run -c /etc/sing-box/config.json</code>: 使用指定的配置文件启动 sing-box 服务 。默认情况下，sing-box 会查找 <code>/etc/sing-box/config.json</code>。</li>
<li><code>sing-box check -c /etc/sing-box/config.json</code>: 校验配置文件的语法和基本逻辑是否正确，这是在启动或重启服务前非常重要的一步 。</li>
<li><code>sing-box format -w -c /etc/sing-box/config.json</code>: 格式化（美化）JSON 配置文件，使其更易读。<code>-w</code> 参数表示直接写入修改到原文件 。</li>
<li><code>sing-box generate uuid</code>: 生成一个标准的 UUID (通用唯一识别码)，常用于 VLESS、VMess 等协议的用户ID配置 。</li>
<li><code>sing-box generate reality-keypair</code>: 生成一对公私钥，专用于配置 VLESS Reality 协议 。</li>
<li><strong>通过 <code>systemd</code> 管理服务 (若已安装为系统服务):</strong><ul>
<li><code>sudo systemctl start sing-box</code>: 启动服务。</li>
<li><code>sudo systemctl stop sing-box</code>: 停止服务。</li>
<li><code>sudo systemctl restart sing-box</code>: 重启服务。</li>
<li><code>sudo systemctl enable sing-box</code>: 设置服务开机自启。</li>
<li><code>sudo systemctl status sing-box</code>: 查看服务运行状态。</li>
<li><code>sudo journalctl -u sing-box -f --output cat</code>: 实时查看服务日志（ <code>-f</code> 表示 follow，<code>--output cat</code> 以简化格式输出） 。</li>
</ul>
</li>
</ul>
<p>sing-box 提供的一系列命令行工具，覆盖了从运行、配置管理到密钥生成的各个核心环节 。这些工具不仅是手动管理 sing-box 实例的基础，更是实现自动化部署、配置更新等高级操作的基石。例如，<code>generate uuid</code> 和 <code>generate reality-keypair</code> 等命令简化了需要特定加密材料的协议的配置过程。同时，通过 <code>systemctl</code> 与 Linux 标准服务管理体系的集成，确保了 sing-box 服务的稳定可靠运行。因此，即使未来出现更多图形化管理界面，熟练运用这些命令行工具对于任何希望深度掌控和高效运维 sing-box 服务器的管理员来说，都是不可或缺的技能。</p>
<h3 id="1-5-config-json-文件结构解析-再探"><a href="#1-5-config-json-文件结构解析-再探" class="headerlink" title="1.5. config.json 文件结构解析 (再探)"></a>1.5. <code>config.json</code> 文件结构解析 (再探)</h3><p>再次强调 <code>config.json</code> 的核心地位及其主要构成部分，有助于用户在后续章节中更好地理解和修改配置。</p>
<ul>
<li><strong><code>log</code></strong>: 配置日志记录的级别（如 <code>info</code>, <code>warn</code>, <code>error</code>, <code>debug</code>, <code>trace</code>）、输出位置（默认标准输出，可指定文件路径）以及是否添加时间戳等 。</li>
<li><strong><code>dns</code></strong>: 管理 DNS 解析行为，包括设置上游 DNS 服务器、DNS 策略（如 IPv4_only）、DNS 规则（如根据域名分流到不同 DNS 服务器）、FakeIP 等 。</li>
<li><strong><code>ntp</code></strong>: 网络时间协议 (NTP) 配置，用于同步服务器时间，确保时间准确性，这对于某些依赖时间戳的加密协议和证书验证非常重要 。</li>
<li><strong><code>inbounds</code></strong>: 定义一个或多个入站连接处理器。每个入站配置指定了监听的 IP 地址、端口、协议类型（如 VLESS, Trojan）以及该协议所需的用户认证、TLS 等参数 。</li>
<li><strong><code>outbounds</code></strong>: 定义一个或多个出站连接处理器。每个出站配置指定了连接的目标服务器、端口、协议类型（如 <code>direct</code> 直连, <code>block</code> 阻止, 或具体的代理协议）以及相应的认证和传输参数 。</li>
<li><strong><code>route</code></strong>: 包含路由规则列表。这些规则决定了符合特定条件的入站流量应该被转发到哪个出站连接。规则可以基于域名、IP、地理位置、端口、进程名等多种条件 。</li>
<li><strong><code>experimental</code></strong>: 用于配置一些实验性功能，例如 Clash API 兼容接口，允许通过 Clash 兼容的控制面板管理 sing-box 。</li>
</ul>
<p>对这些主要部分的理解，将为后续针对不同协议的具体配置打下坚实基础。</p>
<h2 id="第二章：准备您的服务器环境"><a href="#第二章：准备您的服务器环境" class="headerlink" title="第二章：准备您的服务器环境"></a>第二章：准备您的服务器环境</h2><p>在正式配置 sing-box 代理协议之前，确保服务器环境的安全性与网络通畅性至关重要。</p>
<h3 id="2-1-基础服务器安全加固-简述"><a href="#2-1-基础服务器安全加固-简述" class="headerlink" title="2.1. 基础服务器安全加固 (简述)"></a>2.1. 基础服务器安全加固 (简述)</h3><p>一台暴露在公网的服务器需要基本的安全防护措施：</p>
<ul>
<li><p>系统更新:</p>
<p> 始终保持操作系统及其软件包为最新版本，以修复已知的安全漏洞。</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo apt update &amp;&amp; sudo apt upgrade -y<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>SSH 安全:</p>
<ul>
<li><strong>使用密钥认证:</strong> 强烈建议禁用密码登录，转而使用 SSH 密钥对进行认证，这能极大提高登录安全性。</li>
<li><strong>禁止 root 登录:</strong> 修改 SSHD 配置 (<code>/etc/ssh/sshd_config</code>)，设置 <code>PermitRootLogin no</code>，并使用普通用户登录后再通过 <code>sudo</code> 执行特权命令。</li>
<li><strong>(可选) 修改 SSH 默认端口:</strong> 将 SSH 服务从默认的 22 端口迁移到其他非标准端口，可以在一定程度上减少自动化的扫描和爆破尝试，但这更多的是一种“安全靠隐蔽”的次要措施。</li>
</ul>
</li>
</ul>
<p>本教程不提供详尽的服务器安全指南，以上仅为最基础的建议。用户应根据自身情况参考更专业的安全文档进行加固。</p>
<h3 id="2-2-防火墙配置：为代理协议开放端口"><a href="#2-2-防火墙配置：为代理协议开放端口" class="headerlink" title="2.2. 防火墙配置：为代理协议开放端口"></a>2.2. 防火墙配置：为代理协议开放端口</h3><p>防火墙是服务器的第一道网络防线，它控制着哪些端口允许外部访问。您必须为计划使用的代理协议开放相应的服务器端口。</p>
<ul>
<li><p>在 Ubuntu/Debian 上使用 UFW (Uncomplicated Firewall):</p>
<p>UFW 是一个用户友好的防火墙管理工具。</p>
<ol>
<li><p>安装 UFW (如果尚未安装):</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo apt install ufw<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>设置默认策略:</p>
<p> 拒绝所有传入连接，允许所有传出连接。</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo ufw default deny incoming
sudo ufw default allow outgoing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>允许 SSH 连接 (关键步骤):</p>
<p> 在启用 UFW 之前，务必先允许 SSH 连接，否则您可能会失去对服务器的访问权限。</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo ufw allow ssh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>或者，如果您修改了 SSH 端口：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo ufw allow &lt;您的_SSH_端口&gt;/tcp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>为代理协议开放端口:</p>
<p> 根据您选择的协议和配置的端口，使用以下命令开放 TCP 和/或 UDP 端口。例如，如果您计划在 8443 端口上运行一个 TCP 协议，在 9000-9005 端口范围运行一个 UDP 协议：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo ufw allow 8443/tcp
sudo ufw allow 9000:9005/udp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>启用 UFW:</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo ufw enable<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>系统会提示操作可能中断现有 SSH 连接，确认即可。 </p>
</li>
<li><p>查看状态:</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo ufw status verbose<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
</li>
<li><p>在 CentOS/RHEL/Fedora (及部分 Debian/Ubuntu) 上使用 firewalld:</p>
<p>firewalld 是另一款常用的动态防火墙管理工具。</p>
<ol>
<li><p>查看 <code>firewalld</code> 状态:</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo firewall-cmd --state<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>永久开放端口:</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo firewall-cmd --permanent --add-port=&lt;端口号&gt;/tcp
sudo firewall-cmd --permanent --add-port=&lt;端口号&gt;/udp
sudo firewall-cmd --permanent --add-port=&lt;起始端口&gt;-&lt;结束端口&gt;/tcp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>永久开放服务 (例如 HTTPS，如果协议伪装在 443 端口):</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo firewall-cmd --permanent --add-service=https<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>重新加载 <code>firewalld</code> 配置使其生效:</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo firewall-cmd --reload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>查看已开放的端口:</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo firewall-cmd --list-ports<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
</li>
<li><p><strong>表 2.2.1: 常见代理协议及其默认/推荐端口</strong></p>
</li>
</ul>
<table>
<thead>
<tr>
<th><strong>协议</strong></th>
<th><strong>默认/常用端口</strong></th>
<th><strong>TCP/UDP</strong></th>
<th><strong>备注</strong></th>
</tr>
</thead>
<tbody><tr>
<td>VLESS (Reality)</td>
<td>443, 80, 其他自定义端口</td>
<td>TCP</td>
<td>常使用 443 端口伪装成 HTTPS。Reality 可灵活使用多种端口。</td>
</tr>
<tr>
<td>Trojan (TLS)</td>
<td>443</td>
<td>TCP</td>
<td>通常使用 443 端口进行 TLS 加密通信。</td>
</tr>
<tr>
<td>Shadowsocks</td>
<td>用户自定义 (如 8388, 443)</td>
<td>TCP/UDP</td>
<td>无标准端口；443 端口可用于流量混淆。</td>
</tr>
<tr>
<td>Hysteria2</td>
<td>用户自定义</td>
<td>UDP</td>
<td>基于 QUIC，常使用高位端口或 443/udp。</td>
</tr>
<tr>
<td>TUIC</td>
<td>用户自定义</td>
<td>UDP</td>
<td>基于 QUIC，常使用高位端口或 443/udp。</td>
</tr>
<tr>
<td>VMess</td>
<td>用户自定义</td>
<td>TCP/UDP</td>
<td>无标准端口。</td>
</tr>
<tr>
<td>ShadowTLS</td>
<td>443 (外层)</td>
<td>TCP</td>
<td>包装其他协议，外层连接通常在 443 端口。</td>
</tr>
<tr>
<td>NaiveProxy</td>
<td>443, 80</td>
<td>TCP</td>
<td>模仿标准 Web 流量。</td>
</tr>
</tbody></table>
<p>无论是 UFW  还是 <code>firewalld</code>，其默认策略通常是拒绝所有未经明确允许的入站连接。这是一种基础且重要的安全实践，旨在最小化服务器的潜在攻击面。因此，用户必须显式地为 SSH（远程管理）和计划运行的代理协议开放端口。忽略或错误配置防火墙，不仅可能导致代理服务无法访问，还可能使服务器暴露于不必要的安全风险之下。因此，防火墙的正确配置是保障代理节点正常运作和安全性的前提条件。</p>
<h2 id="第三章：在-Sing-box-中配置热门协议"><a href="#第三章：在-Sing-box-中配置热门协议" class="headerlink" title="第三章：在 Sing-box 中配置热门协议"></a>第三章：在 Sing-box 中配置热门协议</h2><p>本章节将详细介绍如何在 sing-box 中配置当前流行且在“科学上网”场景下表现优异的几种代理协议。每个协议的配置都将包含服务器端（入站）和客户端（出站）的 JSON 代码片段，并对关键字段进行解释。</p>
<p><em>通用说明：</em></p>
<ul>
<li><em>每个协议小节都会简要介绍其特性、基于的传输方式（TCP/UDP）、加密和混淆技术，以及其在规避审查方面的有效性。</em></li>
<li><em>所有配置示例均为 sing-box 的 JSON 格式，并附带注释说明。</em></li>
<li><em>会提及配置该协议可能需要的前提条件，如域名、SSL 证书、生成的密钥对等。</em></li>
</ul>
<h3 id="3-1-VLESS-配合-Reality-和-或-XTLS-Vision"><a href="#3-1-VLESS-配合-Reality-和-或-XTLS-Vision" class="headerlink" title="3.1. VLESS (配合 Reality 和/或 XTLS-Vision)"></a>3.1. VLESS (配合 Reality 和/或 XTLS-Vision)</h3><ul>
<li><p><strong>协议概述:</strong> VLESS 以其高性能和灵活性著称。Reality 是一种先进的流量伪装技术，它使得代理服务器在未授权的探测者看来完全像一个真实的、普通的网站（例如 <code>www.microsoft.com</code>），从而极大地增强了抗审查能力。XTLS-Vision 是一种流控模式，旨在进一步优化性能 。</p>
</li>
<li><p><strong>服务器 (入站) 配置 (VLESS + Reality):</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
      <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"server_name"</span><span class="token operator">:</span> <span class="token string">"your.actual.domain.com"</span><span class="token punctuation">,</span> <span class="token comment">// 你的真实域名，用于申请证书 (如果使用 ACME)</span>
        <span class="token property">"reality"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">"handshake"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"server"</span><span class="token operator">:</span> <span class="token string">"www.microsoft.com"</span><span class="token punctuation">,</span> <span class="token comment">// 伪装的目标网站域名</span>
            <span class="token property">"server_port"</span><span class="token operator">:</span> <span class="token number">443</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">"private_key"</span><span class="token operator">:</span> <span class="token string">"YOUR_REALITY_PRIVATE_KEY"</span><span class="token punctuation">,</span> <span class="token comment">// 使用 'sing-box generate reality-keypair' 生成</span>
          <span class="token property">"short_id"</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token comment">// 1到2个字节的十六进制字符串，例如 "01" 或 "abcd"</span>
          <span class="token property">"max_time_difference"</span><span class="token operator">:</span> <span class="token string">"1m"</span> <span class="token comment">// 允许客户端与服务器的最大时间差</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 如果不使用 Reality 自签名证书，而是为 your.actual.domain.com 申请真实证书，</span>
        <span class="token comment">// 则需要配置 ACME 或 certificate_path/key_path</span>
        <span class="token comment">// "acme": {</span>
        <span class="token comment">//   "domain": "your.actual.domain.com",</span>
        <span class="token comment">//   "email": "your-email@example.com"</span>
        <span class="token comment">// }</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>关键解释:<ul>
<li><code>uuid</code>: 用户的唯一标识符。</li>
<li><code>tls.server_name</code>: 对于 Reality 而言，此处的 <code>server_name</code> 是您希望 Reality “伪装”成的目标网站的域名，客户端连接时会使用这个 SNI。</li>
<li><code>reality.handshake.server</code>: 实际发起 TLS 握手的目标服务器，通常是知名的大型网站，以增加伪装的真实性。</li>
<li><code>reality.private_key</code>: 通过 <code>sing-box generate reality-keypair</code> 命令生成的私钥。公钥需要配置在客户端。</li>
<li><code>reality.short_id</code>: 一个或多个短ID（1-2字节的十六进制字符串），客户端连接时需要匹配其中一个。</li>
<li><code>flow: "xtls-rprx-vision"</code>: VLESS 的一种流处理模式，可提升性能 。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>客户端 (出站) 配置 (VLESS + Reality):</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>关键解释:<ul>
<li><code>tls.server_name</code>: 客户端在发起 TLS 握手时使用的 SNI，<strong>必须</strong>与服务器端 <code>reality.handshake.server</code> 字段中配置的域名完全一致。</li>
<li><code>tls.reality.public_key</code>: 服务器端通过 <code>sing-box generate reality-keypair</code> 生成的公钥。</li>
<li><code>tls.utls.fingerprint</code>: 模拟特定浏览器的 TLS 指纹，例如 “chrome”, “firefox”, “safari” 等，这有助于使流量看起来更像普通浏览器发出的流量，从而进一步抵抗指纹识别 。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Reality 技术的出现，是针对日益复杂的网络审查中主动探测和基于 SNI 封锁的有效回应 。传统的代理协议，即使流量加密，其 TLS 握手特征或服务器行为也可能被主动探测识别。同时，审查系统也可能直接封锁指向可疑服务器 IP 的特定 SNI 请求。Reality 通过“借用”一个高信誉、大流量的知名网站（如 <code>www.microsoft.com</code>）的 TLS 握手信息作为“外壳”，使得 sing-box 服务器在初始连接阶段的行为与该知名网站无法区分，从而有效规避主动探测。在这次“伪装”握手之后，真实的 VLESS 代理流量才通过这对由 <code>private_key</code> 和 <code>public_key</code> 保护的加密通道进行传输。这种机制使得 VLESS + Reality 组合在当前环境下拥有极高的隐蔽性和抗封锁能力，是其广受欢迎的主要原因。</p>
<h3 id="3-2-Trojan-配合-TLS，可选-WebSocket-传输"><a href="#3-2-Trojan-配合-TLS，可选-WebSocket-传输" class="headerlink" title="3.2. Trojan (配合 TLS，可选 WebSocket 传输)"></a>3.2. Trojan (配合 TLS，可选 WebSocket 传输)</h3><ul>
<li><p><strong>协议概述:</strong> Trojan 协议通过模仿 HTTPS 流量的特征，使其在网络传输中难以被识别和区分。它通常需要配合一个真实的域名和有效的 SSL/TLS 证书使用。WebSocket (WS) 作为一种可选的传输层协议，可以将 Trojan 流量进一步封装在标准的 HTTP/HTTPS 连接中，这不仅增强了伪装性，还使得流量可以通过 CDN (内容分发网络) 进行中转，隐藏真实服务器 IP 。</p>
</li>
<li><p><strong>服务器 (入站) 配置 (Trojan + TLS):</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
      <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"server_name"</span><span class="token operator">:</span> <span class="token string">"your.domain.com"</span><span class="token punctuation">,</span> <span class="token comment">// 你的域名</span>
        <span class="token comment">// 使用 ACME 自动申请和续签证书 (推荐)</span>
        <span class="token property">"acme"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token string">"your.domain.com"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"your-email@example.com"</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 或者手动指定证书路径</span>
        <span class="token comment">// "certificate_path": "/path/to/your/fullchain.pem",</span>
        <span class="token comment">// "key_path": "/path/to/your/private.key"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"multiplex"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 启用多路复用以提高性能</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 如果需要 WebSocket 传输 (例如配合 CDN)</span>
      <span class="token comment">// "transport": {</span>
      <span class="token comment">//   "type": "ws",</span>
      <span class="token comment">//   "path": "/your-secret-websocket-path" // 自定义 WebSocket 路径</span>
      <span class="token comment">// }</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>关键解释:<ul>
<li><code>users.password</code>: Trojan 协议的认证密码。</li>
<li><code>tls.server_name</code>: 必须是您拥有的、并且 DNS 解析指向您服务器 IP 的域名。</li>
<li><code>tls.acme</code>: 推荐使用 ACME 自动管理 TLS 证书，sing-box 支持 Let’s Encrypt 等机构。</li>
<li><code>multiplex.enabled</code>: 启用多路复用可以减少连接数，提高并发处理能力 。</li>
<li><code>transport</code> (可选): 如果配置为 <code>"ws"</code>，则启用 WebSocket 传输。<code>path</code> 是 WebSocket 的访问路径，应设置为一个不易被猜到的字符串。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>客户端 (出站) 配置 (Trojan + TLS):</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>29 (WebSocket 部分参考 39)</p>
<ul>
<li>关键解释:<ul>
<li><code>server</code>: 连接的服务器地址，推荐使用域名。</li>
<li><code>tls.server_name</code>: 客户端进行 TLS 握手时提供的 SNI，必须与服务器证书绑定的域名一致，否则会导致握手失败。</li>
<li><code>tls.utls.fingerprint</code>: 模拟特定浏览器的 TLS 客户端行为，增强伪装性 。</li>
<li><code>transport.headers.Host</code> (使用 WS 时): 当通过 CDN 或反向代理连接时，通常需要设置正确的 <code>Host</code> 头，使其指向您的源服务器域名。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Trojan 协议的核心设计理念在于其高度的 HTTPS 流量模拟能力 。配置中对 TLS 参数（如 <code>server_name</code>、<code>certificate_path</code>、<code>key_path</code>）的强调，正是为了实现这种逼真的伪装 。一个与 <code>server_name</code>（即您的域名）匹配的有效 TLS 证书，是构成可信 HTTPS 通信的基础。如果使用自签名证书或 SNI 不匹配，很容易被中间的网络设备识别为异常流量。将 Trojan 服务部署在标准的 HTTPS 端口 443 上，能进一步增强其隐蔽性。因此，选择 Trojan 协议的用户，必须准备好获取一个域名，并为该域名配置有效的 TLS 证书（可以通过 sing-box 内置的 ACME 功能自动申请，或手动配置）。若缺乏这些要素，Trojan 协议主要的伪装特性将大打折扣，其抗审查能力也会显著下降。</p>
<h3 id="3-3-Shadowsocks-重点关注-AEAD-2022-系列加密算法"><a href="#3-3-Shadowsocks-重点关注-AEAD-2022-系列加密算法" class="headerlink" title="3.3. Shadowsocks (重点关注 AEAD 2022 系列加密算法)"></a>3.3. Shadowsocks (重点关注 AEAD 2022 系列加密算法)</h3><ul>
<li><p><strong>协议概述:</strong> Shadowsocks 是一种轻量级、广泛应用的代理协议。其 2022 系列的 AEAD (Authenticated Encryption with Associated Data) 加密算法，如 <code>2022-blake3-aes-128-gcm</code>，因其在安全性和抗探测性方面的提升而被官方推荐使用 。</p>
</li>
<li><p><strong>服务器 (入站) 配置:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>关键解释:<ul>
<li><code>method</code>: 选择一个 2022 系列的 AEAD 加密算法。</li>
<li><code>password</code>: Shadowsocks 的连接密码。</li>
<li><code>multiplex.enabled</code>: 启用多路复用。对于 Shadowsocks 而言，这不仅能提升性能，还能改善 UDP 流量的传输和隐蔽性 。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>客户端 (出站) 配置:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>sing-box 官方文档在介绍 Shadowsocks 时，<em>强烈建议</em>开启多路复用功能来传输 UDP 流量，并指出“否则很容易受到被动检测” 。究其原因，传统的 Shadowsocks 实现（尤其是较早的加密方式或未启用多路复用的 UDP 传输）存在一些可被深度包检测（DPI）识别的流量特征 。多路复用技术（如 Shadowsocks 常用的 smux）允许在单个 TCP 连接上承载多个逻辑数据流，这不仅改变了流量模式，使其更难与使用连接池的常规网络流量区分开来，还为在 TCP 连接内隧道化 UDP 数据包提供了一种更为健壮和标准化的方式，这在许多受审查的网络环境中比直接转发原始 UDP 包更为可靠。因此，在 sing-box 中配置 Shadowsocks 时，用户应始终启用多路复用，特别是当需要可靠传输 UDP 流量（例如用于 QUIC 协议的应用、WebRTC 或在线游戏）时。忽视此建议将显著增加协议被探测和封锁的风险。</p>
<h3 id="3-4-Hysteria2-基于-QUIC，高性能"><a href="#3-4-Hysteria2-基于-QUIC，高性能" class="headerlink" title="3.4. Hysteria2 (基于 QUIC，高性能)"></a>3.4. Hysteria2 (基于 QUIC，高性能)</h3><ul>
<li><p><strong>协议概述:</strong> Hysteria2 专为在不稳定和高丢包网络环境下提供高速传输而设计。它基于定制的 QUIC 协议，并采用名为 “Brutal” 的拥塞控制算法，力求在恶劣网络条件下榨干带宽。其流量特征旨在伪装成标准的 HTTP/3 流量 。</p>
</li>
<li><p><strong>服务器 (入站) 配置:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
      <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"server_name"</span><span class="token operator">:</span> <span class="token string">"your.domain.com"</span><span class="token punctuation">,</span> <span class="token comment">// 你的域名</span>
        <span class="token comment">// 使用 ACME 自动申请证书</span>
        <span class="token property">"acme"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token string">"your.domain.com"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"your-email@example.com"</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 或手动指定证书</span>
        <span class="token comment">// "certificate_path": "/path/to/your/fullchain.pem",</span>
        <span class="token comment">// "key_path": "/path/to/your/private.key"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"obfs"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 可选的 QUIC 流量混淆</span>
         <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"salamander"</span><span class="token punctuation">,</span> <span class="token comment">// 目前仅支持 salamander</span>
         <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"YOUR_OBFS_PASSWORD"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>关键解释:<ul>
<li><code>up_mbps</code>, <code>down_mbps</code>: 定义服务器的上下行带宽限制。客户端也需要配置相应的值。</li>
<li><code>users.password</code> (或顶层 <code>password</code>): Hysteria2 的认证密码。注意 sing-box 不支持官方 Hysteria 客户端的 <code>username:password</code> 组合作为 <code>userpass</code> 的别名，需要直接填写组合后的密码 。</li>
<li><code>tls</code>: Hysteria2 依赖 TLS 进行加密和认证，配置方式与 Trojan 类似，需要域名和证书。</li>
<li><code>obfs</code> (可选): Salamander 混淆器可以对 QUIC 流量进行额外处理，可能增加抗检测性，但也会带来性能开销 。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>客户端 (出站) 配置:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>Hysteria2 的核心优势在于其基于 UDP (QUIC) 的特性以及独特的 “Brutal” 拥塞控制算法，这使其在网络质量较差、丢包率高的环境下仍能努力维持高吞吐量 。然而，这也可能成为其潜在的弱点。正如 sing-box 文档所警示的，“基于 UDP 的代理……实际上比基于 TCP 的代理具有更明显的特征” 。尽管 QUIC 对大部分头部信息进行了加密，但在某些严格审查的网络中，大量非标准端口的 UDP 通信本身就可能引起注意。此外，“Brutal”拥塞控制算法为了追求带宽最大化，其产生的流量模式可能与常规 Web 流量所使用的标准 TCP 拥塞控制算法（如 Cubic 或 BBR）有所不同，长期来看存在被指纹识别的风险。因此，用户在选择 Hysteria2 时，应权衡其在恶劣网络下的性能优势与这种潜在的可检测性。</p>
<h3 id="3-5-TUIC-基于-QUIC，低延迟"><a href="#3-5-TUIC-基于-QUIC，低延迟" class="headerlink" title="3.5. TUIC (基于 QUIC，低延迟)"></a>3.5. TUIC (基于 QUIC，低延迟)</h3><ul>
<li><p><strong>协议概述:</strong> TUIC 是另一款基于 QUIC 的代理协议，其设计重点在于最小化连接握手延迟，并支持 0-RTT 连接建立。它也提供了高效的 UDP 代理能力 。</p>
</li>
<li><p><strong>服务器 (入站) 配置:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
      <span class="token property">"congestion_control"</span><span class="token operator">:</span> <span class="token string">"bbr"</span><span class="token punctuation">,</span> <span class="token comment">// 拥塞控制算法，可选 "cubic", "new_reno", "bbr"</span>
      <span class="token property">"auth_timeout"</span><span class="token operator">:</span> <span class="token string">"3s"</span><span class="token punctuation">,</span> <span class="token comment">// 认证超时时间</span>
      <span class="token property">"heartbeat_interval"</span><span class="token operator">:</span> <span class="token string">"10s"</span><span class="token punctuation">,</span> <span class="token comment">// 心跳间隔 (sing-box v1.9+ 使用此字段名)</span>
      <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"server_name"</span><span class="token operator">:</span> <span class="token string">"your.domain.com"</span><span class="token punctuation">,</span>
        <span class="token property">"acme"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"domain"</span><span class="token operator">:</span> <span class="token string">"your.domain.com"</span><span class="token punctuation">,</span>
          <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"your-email@example.com"</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 或手动指定证书</span>
        <span class="token comment">// "certificate_path": "/path/to/your/fullchain.pem",</span>
        <span class="token comment">// "key_path": "/path/to/your/private.key"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// "zero_rtt_handshake": false // 服务端通常不建议开启 0-RTT，有安全风险</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(字段名 <code>heartbeat_interval</code> 对应新版 sing-box，旧版可能为 <code>heartbeat</code>)</p>
<ul>
<li>关键解释:<ul>
<li><code>users</code>: 包含 <code>uuid</code> 和 <code>password</code> 用于认证。</li>
<li><code>congestion_control</code>: 选择适合网络环境的 QUIC 拥塞控制算法。</li>
<li><code>tls</code>: 与 Hysteria2 类似，需要域名和证书。</li>
<li><code>zero_rtt_handshake</code>: 服务端通常应保持禁用（默认或显式设置为 <code>false</code>），以避免重放攻击的风险 。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>客户端 (出站) 配置:</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token comment">// QUIC 通常使用 h3 作为 ALPN</span>
        <span class="token property">"utls"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">"fingerprint"</span><span class="token operator">:</span> <span class="token string">"chrome"</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// "insecure": true, // 如果服务器使用自签名证书且了解风险</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>TUIC 协议以其 0-RTT（零往返时间）握手能力作为提升连接速度、降低延迟的一大亮点 。0-RTT 允许客户端在第一个数据包中就携带应用数据，这通过复用先前连接中协商好的会话参数来实现。然而，正如 sing-box 官方入站配置文档所强调的，服务端启用 <code>zero_rtt_handshake</code> 存在被重放攻击的风险，并引用了 Cloudflare 关于“克隆人攻击”的文章作为佐证 。这种攻击的原理是，如果攻击者捕获了包含 0-RTT 数据的初始数据包，他们可以将这些数据包重放给服务器。由于服务器在处理 0-RTT 数据时无法轻易判断其新鲜度，这可能导致数据被重复处理或引发其他安全问题。尽管 QUIC 协议自身包含一些针对 0-RTT 的重放缓解措施，但并非万无一失。因此，对于注重安全性的应用场景，普遍建议谨慎对待 0-RTT，或避免将其用于非幂等请求。这意味着，尽管 TUIC 的 0-RTT 特性对延迟敏感型应用很有吸引力，用户必须清醒认识到相关的安全风险。为最大化安全性，服务端通常应禁用 0-RTT，即便这会牺牲部分握手延迟的极致优化。客户端仍可尝试发起 0-RTT 连接，但服务器端是否接受应由用户在充分理解并接受潜在风险后决定。</p>
<ul>
<li><strong>表 3.1: 特色协议对比概览</strong></li>
</ul>
<table>
<thead>
<tr>
<th><strong>特性/协议</strong></th>
<th><strong>VLESS (+Reality)</strong></th>
<th><strong>Trojan (+TLS/WSS)</strong></th>
<th><strong>Shadowsocks (2022)</strong></th>
<th><strong>Hysteria2</strong></th>
<th><strong>TUIC</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>基础协议</strong></td>
<td>TCP (VLESS 本身传输层无关)</td>
<td>TCP</td>
<td>TCP (UDP via Mux)</td>
<td>UDP (QUIC)</td>
<td>UDP (QUIC)</td>
</tr>
<tr>
<td><strong>主要混淆方式</strong></td>
<td>TLS (Reality 伪装真实网站)</td>
<td>TLS (模仿 HTTPS)</td>
<td>加密流, AEAD 加密</td>
<td>QUIC 加密 (伪装 HTTP/3)</td>
<td>QUIC 加密</td>
</tr>
<tr>
<td><strong>隐蔽性 (vs GFW)</strong></td>
<td>高 (Reality)</td>
<td>高 (如果配置得当)</td>
<td>中到高 (2022 + Mux)</td>
<td>中 (UDP 可能被针对)</td>
<td>中 (UDP 可能被针对)</td>
</tr>
<tr>
<td><strong>性能表现</strong></td>
<td>良好至优秀</td>
<td>良好</td>
<td>良好</td>
<td>优秀 (尤其在恶劣网络)</td>
<td>优秀 (低延迟)</td>
</tr>
<tr>
<td><strong>配置复杂度</strong></td>
<td>中 (Reality 增加步骤)</td>
<td>中 (需域名/证书)</td>
<td>低到中</td>
<td>中</td>
<td>中</td>
</tr>
<tr>
<td><strong>核心优势</strong></td>
<td>Reality 带来的高隐蔽性</td>
<td>强大的 HTTPS 模仿能力</td>
<td>简洁, 广泛支持</td>
<td>恶劣网络下的高吞吐</td>
<td>低握手延迟, 0-RTT 选项</td>
</tr>
<tr>
<td><strong>主要劣势</strong></td>
<td>Reality 配置可能较复杂</td>
<td>域名/证书管理</td>
<td>旧版/不当配置易被检测</td>
<td>UDP 封锁/限速, “明显特征” 30</td>
<td>UDP 封锁/限速, 0-RTT 风险</td>
</tr>
</tbody></table>
<h2 id="第四章：配置您的客户端设备"><a href="#第四章：配置您的客户端设备" class="headerlink" title="第四章：配置您的客户端设备"></a>第四章：配置您的客户端设备</h2><p>成功搭建 sing-box 服务器后，下一步是在您的设备上配置客户端以连接并使用该服务。</p>
<h3 id="4-1-Sing-box-客户端通用配置原则"><a href="#4-1-Sing-box-客户端通用配置原则" class="headerlink" title="4.1. Sing-box 客户端通用配置原则"></a>4.1. Sing-box 客户端通用配置原则</h3><p>无论是使用 sing-box 命令行作为客户端，还是使用图形化客户端，其核心配置逻辑是相似的：客户端的 <code>outbounds</code>（出站）设置必须与服务器端的 <code>inbounds</code>（入站）设置相匹配。</p>
<p>关键匹配参数包括：</p>
<ul>
<li><strong>服务器地址 (server) 和端口 (server_port):</strong> 客户端必须正确指向服务器的 IP 地址或域名，以及服务器上相应协议监听的端口。</li>
<li><strong>用户凭证 (UUID/password):</strong> 对于需要认证的协议（如 VLESS, Trojan, Shadowsocks, Hysteria2, TUIC），客户端配置的 UUID 或密码必须与服务器端为该用户设定的凭证完全一致。</li>
<li><strong>加密方法 (method/security):</strong> 客户端选择的加密算法必须是服务器端支持并为该用户启用的。</li>
<li><strong>传输设置 (transport):</strong> 如果服务器端使用了特定的传输方式（如 WebSocket 的路径 <code>path</code>，gRPC 的服务名 <code>serviceName</code>），客户端必须进行相应的配置。</li>
<li>TLS 设置 (tls):<ul>
<li><strong>SNI (Server Name Indication):</strong> 对于使用 TLS 的协议，客户端配置的 <code>server_name</code> (SNI) 通常需要与服务器证书的域名或 Reality/Trojan 等协议期望的 SNI 一致。</li>
<li><strong>证书验证:</strong> 客户端默认会验证服务器证书的有效性。如果服务器使用自签名证书，客户端需要配置信任该证书或（在了解风险的前提下）设置为不安全连接 (<code>insecure: true</code>)。</li>
<li><strong>Reality/uTLS:</strong> 如果服务器端配置了 Reality，客户端必须配置对应的 <code>public_key</code> 和 <code>short_id</code>。使用 <code>utls</code> 模拟浏览器指纹可以增强伪装性。</li>
</ul>
</li>
<li><strong>协议类型 (type):</strong> 客户端 <code>outbounds</code> 中的 <code>type</code> 字段必须与服务器端 <code>inbounds</code> 中配置的协议类型相对应。</li>
</ul>
<h3 id="4-2-使用-Sing-box-命令行作为客户端-适用于高级用户或连接其他服务器"><a href="#4-2-使用-Sing-box-命令行作为客户端-适用于高级用户或连接其他服务器" class="headerlink" title="4.2. 使用 Sing-box 命令行作为客户端 (适用于高级用户或连接其他服务器)"></a>4.2. 使用 Sing-box 命令行作为客户端 (适用于高级用户或连接其他服务器)</h3><p>对于高级用户，或者当您希望将一台设备（如另一台服务器或本地 Linux/macOS 机器）作为连接到主 sing-box 服务器的客户端时，可以直接使用 sing-box 命令行程序。</p>
<p>以下是一个最小化的客户端 <code>config.json</code> 示例，它包含日志、DNS、一个连接到 VLESS+Reality 服务器的出站，以及一个本地 SOCKS5 入站，允许本机其他应用程序通过此 sing-box 客户端进行代理：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"log"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"info"</span><span class="token punctuation">,</span> <span class="token comment">// 日志级别，可根据需要调整为 "debug" 获取更详细信息</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"dns"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"servers"</span><span class="token operator">:</span><span class="token punctuation">,</span>
    <span class="token property">"final"</span><span class="token operator">:</span> <span class="token string">"dns-remote"</span><span class="token punctuation">,</span> <span class="token comment">// 默认所有 DNS 查询走 "dns-remote"</span>
    <span class="token property">"strategy"</span><span class="token operator">:</span> <span class="token string">"ipv4_only"</span> <span class="token comment">// DNS 解析策略，可按需选择</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"inbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span>
  <span class="token property">"route"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"rules"</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token property">"outbound"</span><span class="token operator">:</span> <span class="token string">"direct"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// { "geosite": "category-ads-all", "outbound": "block" }</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"final"</span><span class="token operator">:</span> <span class="token string">"proxy"</span><span class="token punctuation">,</span> <span class="token comment">// 默认情况下，所有其他流量都通过名为 "proxy" 的出站</span>
    <span class="token property">"auto_detect_interface"</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 自动检测出口网络接口，某些情况下需要</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>将上述配置保存为 <code>client_config.json</code>，然后通过 <code>sing-box run -c client_config.json</code> 运行。之后，将需要代理的应用程序的 SOCKS5 代理设置为 <code>127.0.0.1:1080</code> 即可。</p>
<h3 id="4-3-主流图形化客户端-GUI-概览"><a href="#4-3-主流图形化客户端-GUI-概览" class="headerlink" title="4.3. 主流图形化客户端 (GUI) 概览"></a>4.3. 主流图形化客户端 (GUI) 概览</h3><p>对于不习惯命令行的用户，或者希望在日常设备上便捷使用代理，可以选择各种支持 sing-box 内核或其协议的图形化客户端。</p>
<ul>
<li><strong>桌面端 (Windows/macOS/Linux):</strong><ul>
<li><strong>GUI.for.SingBox (下一代 Clash Verge):</strong> 这是一款专为 sing-box 设计的图形化配置和管理工具，支持通过 GUI 创建和调整配置，管理配置文件（Profiles），最终生成 sing-box 可用的 <code>config.json</code> 。</li>
<li><strong>Nekoray / NekoBox:</strong> 广受欢迎的多协议客户端，支持 sing-box、Xray、Clash 等多种核心，界面友好，易于上手 。</li>
<li><strong>Hiddify-Next:</strong> 另一款支持多种协议和 sing-box 的第三方 GUI 客户端 。</li>
<li><strong>Clash Verge:</strong> 主要为 Clash 核心设计，但由于其配置范式与 sing-box 有相似之处，且社区活跃，部分衍生项目或新版本可能增强对 sing-box 的兼容性或提供类似体验 。</li>
</ul>
</li>
<li><strong>移动端:</strong><ul>
<li>Android:<ul>
<li><strong>Sing-box for Android (官方):</strong> 由 SagerNet 开发的官方 Android 客户端，功能全面，紧跟 sing-box 内核更新 。</li>
<li><strong>SagerNet:</strong> 也是 SagerNet 开发的一款支持多种协议（包括 sing-box 协议）的客户端 。</li>
<li><strong>NekoBox for Android:</strong> Nekoray 的 Android 版本，同样支持 sing-box 。</li>
</ul>
</li>
<li>iOS:<ul>
<li><strong>Sing-box for Apple (官方):</strong> 官方 iOS 客户端，提供原生体验 。</li>
<li><strong>Shadowrocket (“小火箭”):</strong> 老牌且功能强大的 iOS 网络工具，支持包括 Trojan, VLESS, Shadowsocks, Hysteria2, TUIC 在内的多种 sing-box 兼容协议 。</li>
<li><strong>Stash:</strong> 另一款流行的 iOS 代理客户端，以其强大的规则引擎和 sing-box 协议支持闻名 。</li>
<li><strong>Egern:</strong> 支持多种协议，包括 sing-box 的主流协议 。</li>
<li><strong>FoXray:</strong> 也被推荐用于 iOS 设备，支持 VLESS 等协议 。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>大多数图形化客户端都支持通过订阅链接（机场服务商提供）自动更新节点信息和配置，或者允许用户手动导入 sing-box 的 JSON 配置文件、单个节点的分享链接或扫描二维码添加节点 。</p>
<p>近年来，通用型图形化客户端的兴起极大地简化了用户在多协议环境下的使用体验。诸如 Nekoray、GUI.for.SingBox、Hiddify 以及移动端的官方 sing-box 应用、Shadowrocket、Stash 等客户端，其设计目标就是兼容多种代理核心（如 sing-box, Clash, Xray）或 sing-box 所支持的广泛协议集 。这种趋势的背后，是用户往往拥有运行不同协议的服务器，或者需要根据网络状况和特定需求灵活切换协议。为每种协议维护独立的客户端应用显然十分繁琐。通用客户端通过提供统一的用户界面，简化了配置管理（通常通过配置文件或订阅链接实现）和代理切换的流程。Sing-box 作为库或核心的能力 ，也为其被集成到这些第三方 GUI 客户端提供了便利。这意味着用户不再被束缚于单一协议的特定客户端，而是可以选择功能丰富、支持 sing-box 的图形化工具，从而更便捷地管理和使用其“科学上网”服务。</p>
<h2 id="第五章：增强您的配置-高级技巧"><a href="#第五章：增强您的配置-高级技巧" class="headerlink" title="第五章：增强您的配置 (高级技巧)"></a>第五章：增强您的配置 (高级技巧)</h2><p>在掌握了 sing-box 的基本安装和协议配置之后，可以进一步探索一些高级技巧，以增强代理服务的隐蔽性、稳定性和灵活性。</p>
<h3 id="5-1-使用-CDN-隐藏服务器-IP-例如-Cloudflare"><a href="#5-1-使用-CDN-隐藏服务器-IP-例如-Cloudflare" class="headerlink" title="5.1. 使用 CDN 隐藏服务器 IP (例如 Cloudflare)"></a>5.1. 使用 CDN 隐藏服务器 IP (例如 Cloudflare)</h3><ul>
<li><p><strong>核心概念:</strong> 将代理服务器的流量通过内容分发网络 (CDN) 如 Cloudflare 进行中转，可以有效隐藏真实服务器的 IP 地址。这使得即使代理服务器的 IP 被直接探测或封锁，只要 CDN 节点可用，服务依然能够访问，从而提高了抗封锁能力 。</p>
</li>
<li><p><strong>工作原理:</strong></p>
<ol>
<li>将您的域名解析指向 Cloudflare 的服务器（在 Cloudflare DNS 设置中开启橙色云朵代理）。</li>
<li>Sing-box 服务器配置为监听来自 Cloudflare IP 段的流量。</li>
<li>客户端连接您的域名（实际上是连接到离客户端最近的 Cloudflare 边缘节点）。</li>
<li>Cloudflare 接收到流量后，再将其转发到您的源代理服务器。</li>
</ol>
</li>
<li><p><strong>必要条件:</strong></p>
<ul>
<li>一个您拥有的域名。</li>
<li>一个 Cloudflare 账户（免费套餐通常已足够）。</li>
<li>选择能够被 CDN 可靠代理的协议和传输方式。通常是基于 WebSocket (WS) 并通过 TLS 加密（通常在 443 端口）的协议，例如 Trojan + WS 或 VLESS + WS 。</li>
</ul>
</li>
<li><p>Sing-box 配置示例 (客户端 Trojan + WS over CDN):</p>
<p>服务器端需要配置相应的 Trojan + WebSocket 入站。客户端出站配置如下：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>注意：这里的 <code>server</code> 字段直接使用您的域名，因为 Cloudflare 会处理 IP 解析和转发。</p>
</li>
<li><p><strong>服务器端注意事项:</strong></p>
<ul>
<li>服务器上的 sing-box 需配置为监听 WebSocket 流量，并使用与客户端一致的路径。</li>
<li>在 Cloudflare 的 DNS 设置中，确保对应域名的代理状态（橙色云朵）已开启。</li>
<li>Cloudflare 的 SSL/TLS 加密模式建议设置为“完全”或“完全（严格）”，以确保从客户端到 Cloudflare 以及从 Cloudflare 到源服务器的全程加密。</li>
</ul>
</li>
<li><p><strong>益处:</strong></p>
<ul>
<li>显著提高抵抗 IP 直接封锁的能力。</li>
<li>CDN 的全球节点分布可能（但不一定）为部分用户带来访问延迟的改善（对于动态代理流量，CDN 缓存效果有限，但其路由优化仍有一定作用）。</li>
</ul>
</li>
</ul>
<p>将 CDN 置于代理服务器之前，相当于引入了一个广受信赖的中间层 。这种做法通常与 WebSocket 等能封装在标准 HTTP/HTTPS 请求中的传输协议配合使用。直接连接代理服务器 IP 的方式，一旦该 IP 地址被标记并封锁，服务即告中断。而 CDN 服务商（如 Cloudflare）拥有海量的 IP 地址资源，这些 IP 被大量合法网站共享。大规模封锁这些共享 IP 会造成巨大的“附带伤害”，审查机构对此通常较为谨慎。通过 CDN 传输的、使用 WebSocket 并以 TLS 加密的流量（尤其是在 443 端口），其外观与普通网站的 HTTPS 流量极为相似。CDN 在其边缘节点处理 TLS 握手，然后将流量（可能重新加密）转发至源服务器。这种方式不仅隐藏了真实服务器的 IP，还使得代理流量能够混入海量的、通过 CDN 的合法 HTTPS 流量之中，从而显著提升了抗审查的持久性。这对于在严格审查环境下维持代理服务的长期可用性是一项关键技术。</p>
<h3 id="5-2-Sing-box-基础路由：智能分流流量"><a href="#5-2-Sing-box-基础路由：智能分流流量" class="headerlink" title="5.2. Sing-box 基础路由：智能分流流量"></a>5.2. Sing-box 基础路由：智能分流流量</h3><p>Sing-box 强大的路由功能允许用户根据多种条件精细控制流量走向，实现国内外分流、广告屏蔽、特定服务加速等目的。路由配置在 <code>config.json</code> 文件的 <code>route</code> 块中定义 。</p>
<ul>
<li><p><strong>常用规则类型:</strong></p>
<ul>
<li><strong>域名匹配:</strong> <code>domain</code> (精确匹配), <code>domain_suffix</code> (域名后缀匹配，如 <code>google.com</code>), <code>domain_keyword</code> (域名关键词匹配)。</li>
<li><strong>IP 匹配:</strong> <code>ip_cidr</code> (IP 地址段匹配), <code>geoip</code> (基于 IP 的地理位置，如 <code>geoip:cn</code> 匹配中国大陆 IP) 。</li>
<li><strong>预设网站列表:</strong> <code>geosite</code> (匹配预定义的网站分类，如 <code>geosite:google</code> 匹配谷歌相关服务) 。</li>
<li><strong>协议类型:</strong> <code>protocol</code> (如 <code>dns</code> 专门匹配 DNS 查询流量) 。</li>
<li><strong>端口:</strong> <code>port</code> (匹配目标端口)。</li>
<li><strong>进程名/包名 (客户端):</strong> <code>process_name</code> (Windows/Linux 进程名) 或 <code>package_name</code> (Android 应用包名)。</li>
</ul>
</li>
<li><p><strong>简单分流示例 (国内直连，国外代理):</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"route"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"rules"</span><span class="token operator">:</span><span class="token punctuation">,</span>
    <span class="token property">"final"</span><span class="token operator">:</span> <span class="token string">"proxy"</span><span class="token punctuation">,</span> <span class="token comment">// 所有未匹配上述规则的流量，默认通过名为 "proxy" 的出站 (即您的主代理出站)</span>
    <span class="token property">"auto_detect_interface"</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 建议开启，自动检测网络接口</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>规则集 (<code>rule_set</code>):</strong> 为了方便管理大量的域名或 IP 列表，可以使用 <code>rule_set</code> 功能，引用预先编译好的规则文件（通常是 <code>.srs</code> 或 <code>.db</code> 格式）。这些规则集可以从远程 URL 下载更新。</p>
</li>
</ul>
<h3 id="5-3-实现故障转移与基础负载均衡-URLTest-和-Selector"><a href="#5-3-实现故障转移与基础负载均衡-URLTest-和-Selector" class="headerlink" title="5.3. 实现故障转移与基础负载均衡 (URLTest 和 Selector)"></a>5.3. 实现故障转移与基础负载均衡 (URLTest 和 Selector)</h3><p>为了提高代理连接的稳定性和可用性，sing-box 提供了 <code>URLTest</code> 和 <code>Selector</code> 两种特殊的出站类型。</p>
<ul>
<li><p><strong>URLTest 出站 (自动选择最佳节点):</strong></p>
<ul>
<li><p><strong>用途:</strong> <code>URLTest</code> 会定期测试一组预定义的出站代理节点，并自动选择其中延迟最低（或最先成功响应）的节点作为当前使用的出站9。这主要用于实现故障自动切换 (failover) 和基于延迟的简单负载均衡。</p>
</li>
<li><p>关键字段:</p>
<ul>
<li><code>outbounds</code>: 一个包含多个代理出站标签（tag）的列表，<code>URLTest</code> 将对这些出站进行测试。</li>
<li><code>url</code>: 用于测试的 URL，例如 <code>http://www.gstatic.com/generate_204</code> (谷歌提供的用于测试网络连通性的 URL，返回 HTTP 204 No Content)。如果为空，sing-box 有默认测试地址。</li>
<li><code>interval</code>: 测试间隔时间，例如 <code>"5m"</code> 表示每 5 分钟测试一次。</li>
<li><code>tolerance</code>: 延迟容忍度（毫秒），用于判断节点是否可用或切换的阈值。</li>
</ul>
</li>
<li><p>示例:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"outbounds"</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token comment">// 参与测试的代理出站标签列表</span>
      <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://www.gstatic.com/generate_204"</span><span class="token punctuation">,</span>
      <span class="token property">"interval"</span><span class="token operator">:</span> <span class="token string">"5m"</span><span class="token punctuation">,</span> <span class="token comment">// 每5分钟测试一次</span>
      <span class="token property">"tolerance"</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token comment">// 延迟容忍度 100ms</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后，在路由规则中（例如 route.final）使用 “auto-proxy-selector”作为出站。</p>
</li>
</ul>
</li>
<li><p><strong>Selector 出站 (手动选择节点):</strong></p>
<ul>
<li><p><strong>用途:</strong> <code>Selector</code> 允许用户从一个预定义的出站列表中手动选择一个当前使用的出站。这种选择通常通过外部 API (例如 sing-box 的 Clash API 兼容接口) 进行控制，图形化客户端常利用此功能提供节点切换界面 。</p>
</li>
<li><p>关键字段:</p>
<ul>
<li><code>outbounds</code>: 一个包含多个出站标签（可以是具体代理，也可以是 <code>direct</code> 或其他 <code>URLTest</code> 组）的列表。</li>
<li><code>default</code>: 默认选中的出站标签。</li>
</ul>
</li>
<li><p>示例:</p>
<pre class="line-numbers language-JSON" data-language="JSON"><code class="language-JSON">{
  "outbounds":, // 可供选择的出站列表
      "default": "proxy-vless" // 默认选择 "proxy-vless"
    }
  ]
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>同样，可以在路由规则中使用 “manual-proxy-selector”。</p>
</li>
</ul>
</li>
</ul>
<p><code>URLTest</code> 和 <code>Selector</code> 为 sing-box 提供了强大的流量管理能力。<code>URLTest</code> 通过自动化的健康检查和延迟测试 ，确保了连接的韧性：当某个代理节点失效或表现不佳时，它能自动切换到其他可用节点，从而在无需用户干预的情况下维持“科学上网”的通畅。这对于故障转移至关重要。另一方面，<code>Selector</code> 则赋予用户明确的控制权 ，允许用户根据特定需求（如访问特定区域的地理限制内容，或临时切换到直连）主动选择出口。Clash API 的支持使得图形化客户端能够方便地集成这种手动选择功能。实际应用中，一种常见的模式是将多个 <code>URLTest</code> 分组（例如，一组美国服务器，一组日本服务器），然后使用一个 <code>Selector</code> 在这些分组或单个优质代理之间进行选择。这种组合既满足了自动化故障恢复的需求，也兼顾了用户的主动偏好。</p>
<h2 id="第六章：故障排除与日常维护"><a href="#第六章：故障排除与日常维护" class="headerlink" title="第六章：故障排除与日常维护"></a>第六章：故障排除与日常维护</h2><p>即使配置无误，有时也可能遇到连接问题。了解如何排查故障和进行日常维护，是确保代理服务长期稳定运行的关键。</p>
<h3 id="6-1-“芝麻开门”：通过-Sing-box-日志寻找线索"><a href="#6-1-“芝麻开门”：通过-Sing-box-日志寻找线索" class="headerlink" title="6.1. “芝麻开门”：通过 Sing-box 日志寻找线索"></a>6.1. “芝麻开门”：通过 Sing-box 日志寻找线索</h3><p>日志是排查问题的第一手资料。当遇到连接失败、速度缓慢或其他异常行为时，首先应该查看 sing-box 的日志。</p>
<ul>
<li><p><strong>服务器端日志:</strong> 如果 sing-box 作为系统服务运行 (通过 <code>systemd</code> 管理)，可以使用以下命令查看实时日志：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sudo journalctl -u sing-box -f --output cat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果直接通过 sing-box run 命令在前台运行，日志会直接输出到终端，或者根据 config.json 中 log.output 的设置输出到指定文件。</p>
</li>
<li><p><strong>客户端日志:</strong></p>
<ul>
<li>如果使用 sing-box 命令行作为客户端，日志同样会输出到终端或配置文件中指定的位置。</li>
<li>图形化客户端通常内置了日志查看器，方便用户查阅。</li>
</ul>
</li>
<li><p><strong>关注日志中的关键信息:</strong></p>
<ul>
<li><strong>错误信息 (Error messages):</strong> 明确指示问题的发生，如连接超时、认证失败、证书错误等。</li>
<li><strong>警告信息 (Warning messages):</strong> 可能提示潜在问题或配置不当。</li>
<li><strong>连接尝试与结果:</strong> 可以看到客户端的连接请求、使用的协议、目标地址等。</li>
<li><strong>路由决策:</strong> 对于复杂的路由配置，日志可以显示流量是如何根据规则被导向特定出站的。</li>
<li><strong>日志级别 (<code>log.level</code>):</strong> 在 <code>config.json</code> 中，可以将 <code>log.level</code> 设置为 <code>"debug"</code> 甚至 <code>"trace"</code> 以获取更详细的诊断信息，但在正常运行时建议使用 <code>"info"</code> 或 <code>"warn"</code> 以避免日志过于庞大 。</li>
</ul>
</li>
</ul>
<h3 id="6-2-配置检查：使用-sing-box-check-进行预检"><a href="#6-2-配置检查：使用-sing-box-check-进行预检" class="headerlink" title="6.2. 配置检查：使用 sing-box check 进行预检"></a>6.2. 配置检查：使用 <code>sing-box check</code> 进行预检</h3><p>在修改 <code>config.json</code> 文件后，启动或重启 sing-box 服务之前，务必使用 <code>sing-box check</code> 命令校验配置文件的有效性：</p>
<pre class="line-numbers language-Bash" data-language="Bash"><code class="language-Bash">sing-box check -c /path/to/your/config.json<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>该命令会检查 JSON 语法是否正确、字段名和值是否符合 sing-box 的规范。</p>
<p><code>sing-box check</code> 命令是配置管理流程中不可或缺的“预飞检查”环节 。JSON 格式对逗号、括号、引号等符号要求严格，而 sing-box 的配置项众多且可能存在嵌套，手动编辑时很容易出现笔误或使用了不正确的字段名。如果直接运行一个有错误的配置文件，可能导致 sing-box 服务启动失败、意外崩溃或行为异常。例如，某些 GitHub issue 中报告的崩溃问题，部分可能源于配置不当（提到的一个与 tun 配置相关的崩溃，如果涉及到需要 root 权限的资源访问，<code>check</code> 命令在尝试校验时或许能提前发现权限问题或配置冲突）。因此，在每次修改配置文件后、重启服务前，执行 <code>sing-box check</code>，可以及时发现并修正这些低级错误，从而节省大量的排错时间和避免不必要的服务中断。</p>
<h3 id="6-3-常见连接问题及其解决方案"><a href="#6-3-常见连接问题及其解决方案" class="headerlink" title="6.3. 常见连接问题及其解决方案"></a>6.3. 常见连接问题及其解决方案</h3><ul>
<li><strong>防火墙阻挡端口:</strong><ul>
<li><strong>症状:</strong> 客户端无法连接到服务器的指定端口。</li>
<li><strong>排查:</strong> 仔细检查服务器的防火墙规则 (UFW, firewalld)，确保已为 sing-box 使用的协议和端口正确开放了 TCP 和/或 UDP 流量。</li>
</ul>
</li>
<li><strong>客户端配置错误:</strong><ul>
<li><strong>症状:</strong> 连接失败，日志提示认证错误、地址错误等。</li>
<li><strong>排查:</strong> 逐项核对客户端配置中的服务器地址、端口、用户ID (UUID)、密码、加密方法、传输参数（如 WebSocket 路径）、TLS SNI 等，确保与服务器端的入站配置完全一致。</li>
</ul>
</li>
<li><strong>TLS 相关错误 (适用于 VLESS, Trojan, Hysteria2, TUIC 等):</strong><ul>
<li><strong>SNI 不匹配:</strong> 客户端 <code>tls.server_name</code> 与服务器证书或 Reality/Trojan 期望的 SNI 不符。</li>
<li><strong>服务器证书无效/过期:</strong> 检查服务器证书状态，及时续签或修复。</li>
<li><strong>客户端无法验证服务器证书:</strong> 如果服务器使用自签名证书，客户端需要导入该证书或（不推荐，但可用于测试）设置 <code>insecure: true</code>。对于 Reality，确保客户端的 <code>tls.server_name</code> 与服务器 <code>reality.handshake.server</code> 一致。</li>
</ul>
</li>
<li><strong>DNS 解析问题:</strong><ul>
<li><strong>症状:</strong> 可以连接代理，但无法访问网站，或特定网站无法打开。</li>
<li>排查:<ul>
<li>检查客户端和服务器 <code>dns</code> 配置块。</li>
<li>确保代理服务器自身能够正常解析外部域名（可在服务器上用 <code>ping</code> 或 <code>nslookup</code> 测试）。</li>
<li>客户端 DNS 是否正确通过代理或指定 DNS 服务器解析，避免 DNS 泄露。</li>
<li>因 IPv6 偏好设置导致的 DNS 解析问题，提示注意 DNS 策略配置。</li>
</ul>
</li>
</ul>
</li>
<li><strong>Reality 握手失败:</strong><ul>
<li><strong>症状:</strong> VLESS+Reality 连接失败。</li>
<li><strong>排查:</strong> 确认客户端的 <code>public_key</code>、<code>short_id</code> 与服务器端的 <code>private_key</code>、<code>short_id</code> 对应且正确。确认客户端 <code>tls.server_name</code> 与服务器端 <code>reality.handshake.server</code> 配置的域名一致。检查伪装的目标网站 (<code>reality.handshake.server</code>) 是否可访问且其 TLS 证书有效。</li>
</ul>
</li>
<li><strong>网络不可达 (“network is unreachable”):</strong><ul>
<li><strong>症状:</strong> 日志中出现此类错误。</li>
<li><strong>排查:</strong> 服务器可能已宕机，服务器 IP 可能被 ISP 封锁，或者存在网络路由问题。检查服务器状态和网络连通性 。</li>
</ul>
</li>
<li><strong>时间同步问题:</strong><ul>
<li><strong>症状:</strong> 某些协议（特别是依赖 TLS 和证书的）连接失败。</li>
<li><strong>排查:</strong> 确保客户端和服务器的时间基本同步。在服务器上配置并启用 NTP 服务（sing-box 配置中也有 <code>ntp</code> 模块）。</li>
</ul>
</li>
<li><strong>服务器资源耗尽:</strong><ul>
<li><strong>症状:</strong> 连接不稳定，速度极慢，服务频繁重启。</li>
<li><strong>排查:</strong> 登录服务器检查 CPU、内存、带宽使用情况。如果资源不足，考虑升级 VPS 配置或优化 sing-box 配置（如限制并发连接数）。</li>
</ul>
</li>
<li><strong>Sing-box 进程崩溃 (panic):</strong><ul>
<li><strong>症状:</strong> 服务意外停止，日志中出现 <code>panic:</code> 开头的错误信息和堆栈跟踪。</li>
<li><strong>排查:</strong> <code>panic</code> 通常指示程序内部错误（bug）、不兼容的配置、或严重的资源问题 24。仔细阅读 <code>panic</code> 信息和相关的上下文日志。如果怀疑是 sing-box 的 bug，可以附上详细的日志、可复现的配置和操作步骤，到 sing-box 的 GitHub Issues 页面报告。</li>
</ul>
</li>
</ul>
<h3 id="6-4-保持更新：维护-Sing-box-及配置的有效性"><a href="#6-4-保持更新：维护-Sing-box-及配置的有效性" class="headerlink" title="6.4. 保持更新：维护 Sing-box 及配置的有效性"></a>6.4. 保持更新：维护 Sing-box 及配置的有效性</h3><p>网络审查技术和代理协议本身都在不断发展和演变。为了保持代理服务的有效性和安全性，需要进行持续的维护：</p>
<ul>
<li><strong>定期更新 Sing-box:</strong> 关注 SagerNet/sing-box 的 GitHub Releases 页面，及时将 sing-box 程序更新到最新的稳定版本。新版本通常包含 bug 修复、性能优化、安全更新以及对新特性或协议的支持。可以通过重新运行安装脚本或使用系统的包管理器进行更新。</li>
<li><strong>关注社区动态:</strong> 留意 sing-box 的 GitHub Issues 、官方文档更新以及相关的技术社区和论坛。这些渠道通常会讨论最新的审查手段、协议的有效性变化以及新的规避策略。</li>
<li><strong>更新路由规则集:</strong> 如果在路由配置中使用了 GeoIP、Geosite 等远程规则集，应确保这些规则集能够定期更新，以保证分流的准确性。部分客户端或辅助工具可能提供自动更新规则集的功能 。</li>
</ul>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>Sing-box 作为一个强大且灵活的通用代理平台，为用户提供了构建自定义“科学上网”节点的坚实基础。通过本教程的指引，用户应能掌握从服务器准备、sing-box 安装、核心协议配置到客户端设置的完整流程。无论是追求极致隐蔽性的 VLESS+Reality、模仿 HTTPS 的 Trojan，还是经典高效的 Shadowsocks，亦或是面向特定网络优化的 Hysteria2 和 TUIC，sing-box 都能提供良好的支持。</p>
<p>然而，需要强调的是，网络审查与规避技术之间的博弈是一个持续动态的过程。今天有效的协议或配置，明天可能就会面临新的挑战。因此，保持学习的热情，关注技术前沿，并根据实际情况灵活调整策略，是确保长期顺畅访问互联网的关键。</p>
<p>最后，请负责任地使用本教程提供的知识和工具，遵守当地法律法规，并将其用于促进信息自由交流和个人学习研究等正当目的。</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="A-1-Sing-box-常用命令行-CLI-命令参考"><a href="#A-1-Sing-box-常用命令行-CLI-命令参考" class="headerlink" title="A.1. Sing-box 常用命令行 (CLI) 命令参考"></a>A.1. Sing-box 常用命令行 (CLI) 命令参考</h3><p>尽管 sing-box 的命令行参数和子命令的官方集中文档尚不完善，但通过分析其源码、社区讨论和实际使用，可以总结出以下常用命令：</p>
<ul>
<li><p><strong>核心操作:</strong></p>
<ul>
<li><pre><code>sing-box run [options]
<pre class="line-numbers language-none"><code class="language-none">
  : 运行 sing-box 实例。

  - `-c, --config &lt;path&gt;`: 指定一个或多个配置文件路径（JSON 或 SJSON 格式）。可以指定目录，sing-box 会加载目录内所有 `.json` 文件 22。
  - `-D, --directory &lt;path&gt;`: 指定配置文件目录，与 `-c` 配合使用。
  - `--disable-color`: 禁用彩色日志输出。

- ```
  sing-box check [options]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

: 检查配置文件的有效性。

- `-c, --config &lt;path&gt;`: 同 `run` 命令。
- `-D, --directory &lt;path&gt;`: 同 `run` 命令。
- `--format`: 检查后自动格式化配置文件。
</code></pre>
</li>
<li><pre><code>sing-box format [options]
<pre class="line-numbers language-none"><code class="language-none">
  : 格式化（美化）配置文件。

  - `-c, --config &lt;path&gt;`: 指定输入配置文件。
  - `-D, --directory &lt;path&gt;`: 指定配置文件目录。
  - `-w, --write`: 将格式化后的内容写回原文件 5。
  - `-o, --output &lt;path&gt;`: 将格式化后的内容输出到指定文件。

- ```
  sing-box version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

: 显示版本信息，包括构建标签 。



- `-n, --name`: 只显示版本名称。
</code></pre>
</li>
</ul>
</li>
<li><p><strong>密钥生成:</strong></p>
<ul>
<li><code>sing-box generate uuid</code>: 生成一个 UUID 11。</li>
<li><code>sing-box generate reality-keypair</code>: 生成 Reality 公私钥对 11。</li>
<li><code>sing-box generate rand &lt;length&gt;</code>: 生成指定长度的随机字符串（可用于密码）。</li>
</ul>
</li>
<li><p><strong>其他 (可能存在或特定构建中包含):</strong></p>
<ul>
<li><code>sing-box geoip export &lt;path&gt;</code>: 导出 GeoIP 数据。</li>
<li><code>sing-box geosite export &lt;path&gt;</code>: 导出 Geosite 数据。</li>
<li><code>sing-box rule-set compile</code>: 编译规则集。</li>
<li><code>sing-box rule-set merge</code>: 合并规则集。</li>
</ul>
</li>
<li><p><strong>通过 <code>systemd</code> 进行服务管理 (Linux):</strong></p>
<ul>
<li><code>sudo systemctl start sing-box</code></li>
<li><code>sudo systemctl stop sing-box</code></li>
<li><code>sudo systemctl restart sing-box</code></li>
<li><code>sudo systemctl enable sing-box</code></li>
<li><code>sudo systemctl disable sing-box</code></li>
<li><code>sudo systemctl status sing-box</code></li>
<li><code>sudo journalctl -u sing-box -f --output cat</code> 11</li>
</ul>
</li>
</ul>
<p>目前关于 sing-box 命令行工具的详细信息较为分散，可见于 GitHub issue 讨论 24、博客文章 19、官方文档的特定子页面 5 以及 Go 语言的源代码文件 22。尚无一个统一、详尽的“man page”式参考手册。上述列表整合了目前已知的主要命令及其功能，对于习惯使用命令行的用户而言，这是一个实用的快速参考。最准确和完整的参数列表，理论上可以通过 <code>sing-box --help</code> 或 <code>sing-box &lt;subcommand&gt; --help</code> 获取，但具体输出内容未在本次研究资料中直接提供。</p>
<h3 id="A-2-关键术语解释"><a href="#A-2-关键术语解释" class="headerlink" title="A.2. 关键术语解释"></a>A.2. 关键术语解释</h3><ul>
<li><strong>CDN (Content Delivery Network, 内容分发网络):</strong> 一组分布在不同地理位置的服务器，用于缓存和加速网站内容的传递。在代理场景中，可用于隐藏源服务器 IP。</li>
<li><strong>DPI (Deep Packet Inspection, 深度包检测):</strong> 一种网络数据包过滤技术，通过检查数据包的内容来识别协议类型、应用或特定数据模式，常用于网络审查。</li>
<li><strong>GFW (Great Firewall, 防火长城):</strong> 指中国大陆用于互联网审查和内容过滤的一系列技术和行政手段的俗称。</li>
<li><strong>GeoIP:</strong> 基于 IP 地址确定其地理位置的技术或数据库。</li>
<li><strong>Geosite:</strong> 预定义的网站域名分类列表，常用于路由规则中对特定类型的网站进行分流。</li>
<li><strong>Inbound (入站):</strong> Sing-box 中处理传入连接的配置模块。</li>
<li><strong>Outbound (出站):</strong> Sing-box 中处理传出连接的配置模块。</li>
<li><strong>Multiplexing (多路复用):</strong> 在单个网络连接（通常是 TCP 连接）上承载多个独立的逻辑数据流的技术，可以提高连接效率和并发性能。</li>
<li><strong>QUIC (Quick UDP Internet Connections):</strong> 一种基于 UDP 的新型传输层网络协议，旨在提供比 TCP 更低的延迟和更好的拥塞控制，是 HTTP/3 的基础。</li>
<li><strong>Reality:</strong> 一种 VLESS 协议的扩展，通过模拟真实网站的 TLS 握手来增强代理服务器的隐蔽性，抵抗主动探测。</li>
<li><strong>SNI (Server Name Indication):</strong> TLS 协议的一个扩展，允许客户端在 TLS 握手初期就告知服务器其希望连接的域名，使得同一 IP 地址可以托管多个 HTTPS 网站。</li>
<li><strong>TLS (Transport Layer Security, 传输层安全协议):</strong> 用于在两个通信应用程序之间提供私密性和数据完整性的加密协议，是 HTTPS 的基础。</li>
<li><strong>UDP (User Datagram Protocol, 用户数据报协议):</strong> 一种无连接的传输层协议，提供快速但不可靠的数据传输。</li>
<li><strong>UUID (Universally Unique Identifier, 通用唯一识别码):</strong> 一个128位的数字，用于在计算机系统中唯一地标识信息。在代理协议中常用作用户ID。</li>
<li><strong>WebSocket (WS):</strong> 一种在单个 TCP 连接上进行全双工通信的协议，常用于 Web 应用。在代理中，可将流量封装在类似 HTTP 的连接中，便于穿透防火墙或通过 CDN。</li>
<li><strong>XTLS-Vision:</strong> VLESS 协议的一种流控模式，旨在减少加密开销，提高性能。</li>
</ul>
<h3 id="A-3-进一步学习资源"><a href="#A-3-进一步学习资源" class="headerlink" title="A.3. 进一步学习资源"></a>A.3. 进一步学习资源</h3><ul>
<li><strong>Sing-box 官方文档:</strong> <a target="_blank" rel="noopener" href="https://sing-box.sagernet.org/">https://sing-box.sagernet.org/</a> 5</li>
<li><strong>Sing-box GitHub 仓库:</strong>(<a target="_blank" rel="noopener" href="https://github.com/SagerNet/sing-box">https://github.com/SagerNet/sing-box</a>) 7</li>
<li><strong>GUI.for.SingBox (图形化客户端):</strong>(<a target="_blank" rel="noopener" href="https://github.com/GUI-for-Cores/GUI.for.SingBox">https://github.com/GUI-for-Cores/GUI.for.SingBox</a>) 56</li>
<li><strong>Nekoray / NekoBox (图形化客户端):</strong>(<a target="_blank" rel="noopener" href="https://github.com/MatsuriDayo/nekoray">https://github.com/MatsuriDayo/nekoray</a>) (原版，新版可搜索 NekoBox)</li>
<li><strong>Hiddify-Next (图形化客户端):</strong> <a target="_blank" rel="noopener" href="https://github.com/hiddify/hiddify-next">https://github.com/hiddify/hiddify-next</a></li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">0xdadream</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://0xdadream.github.io/2025/05/31/sing-box-da-jian-jie-dian/">https://0xdadream.github.io/2025/05/31/sing-box-da-jian-jie-dian/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">0xdadream</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E6%95%99%E7%A8%8B/">
                                    <span class="chip bg-color">教程</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: '8bNIlpEr08g4V4XysfF9PwEx-gzGzoHsz',
        appKey: 'TlwBq6NRJV9V5XcmP3fAXKls',
        serverURLs: 'https://8bnilper.lc-cn-n1-shared.com',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2025/05/31/cloudflare-dai-li-pei-zhi-duan-kou/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/40.jpg" class="responsive-img" alt="Cloudflare代理配置端口">
                        
                        <span class="card-title">Cloudflare代理配置端口</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Cloudflare代理配置端口
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-05-31
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BD%91%E7%BB%9C/" class="post-category">
                                    网络
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/cloudflare/">
                        <span class="chip bg-color">cloudflare</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/05/25/zheng-shu-hou-zhui/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/56.jpg" class="responsive-img" alt="证书后缀">
                        
                        <span class="card-title">证书后缀</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            证书后缀
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-05-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="post-category">
                                    服务器
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AF%81%E4%B9%A6/">
                        <span class="chip bg-color">证书</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 逐梦<br />'
            + '文章作者: 0xdadream<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2025</span>
            
            <a href="/about" target="_blank">0xdadream</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">295.8k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>


            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/0xdadream" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:320088413@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=320088413" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 320088413" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>





    <a href="https://www.zhihu.com/people/zhu-meng-16-1" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/zhu-meng-16-1" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    
        
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/sakura.js"><\/script>');
            }
        </script>
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?60ba8127252096f2c85afea30efed9e2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
